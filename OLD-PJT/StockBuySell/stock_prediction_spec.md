
# SPEC-1-Stock Prediction Bot

## Background

주식 시장에 관심은 있지만 직접 분석하거나 판단하기 어려운 개인 투자자들이 많음.  
기존 정보 제공 앱들은 뉴스나 지표 위주라, 직관적인 "매수/매도 시점 예측"이 부족함.  
이에 따라 AI 기반으로 특정 종목의 상승 또는 하락 가능성을 요약해주는 챗봇을 기획함.

## Requirements

- **Must Have**

  - 사용자가 종목을 입력하면 해당 주식의 단기적 상승/하락 예측을 반환해야 함
  - 챗봇 형식으로 질문/응답 가능한 UI 제공 (웹 또는 앱)
  - 챗봇은 텔레그램 또는 디스코드 등을 이용
  - 예측 결과에 대한 간단한 근거(예: 뉴스, 기술적 지표 등)를 함께 출력
  - 최신 주식 데이터를 일정 주기로 수집하고 저장
  - 모의 매수/매도 데이터 저장

- **Should Have**

  - 한국 주식(코스피/코스닥) 종목 전체 지원
  - 종목 추천 기능 (예: 오늘 주목할 만한 종목)
  - 사용자별 종목 관심 목록 저장 기능
  - 모의 매수/매도로 추천의 수익율 계산

- **Could Have**

  - 예측 정확도에 대한 과거 기록 제공
  - 과거 기준 모의 매수/매도에 의한 수익율 계산
  - 사용자 피드백 반영한 모델 개선

- **Won't Have (초기에는 제외)**

  - 실시간 거래 기능
  - 해외 주식 지원

## Method

아키텍처는 크게 4개 레이어로 나뉨:

1. 챗봇 인터페이스 (Telegram/Discord Bot)
2. 예측 서비스 API
3. 데이터 수집/저장 모듈
4. 예측 로직 모듈

## Implementation

### 기술 스택 제안

- Python, FastAPI, SQLite/PostgreSQL
- Pandas, requests, BeautifulSoup
- python-telegram-bot 또는 discord.py
- Docker, GitHub Actions

### 단계별 구현

#### Phase 1: 데이터 인프라 구축
- 종목 테이블 및 주가 수집 모듈
- Naver 금융 크롤링 + 크론 스케줄러

#### Phase 2: 예측 로직 MVP
- 기술적 분석 룰셋 구현
- JSON 기반 추천 결과 생성

#### Phase 3: API 서버 구축
- FastAPI로 `/predict` endpoint 생성
- DB 조회 → 예측 → 응답 처리

#### Phase 4: 챗봇 연동
- 텔레그램 챗봇 → API 호출 → 결과 메시지 출력

#### Phase 5: 사용자 기능 추가
- 관심 종목 저장
- 모의 매매 + 수익률 계산

#### Phase 6: 정확도 추적 & ML 실험
- 예측 정확도 기록
- 뉴스/거래량 등 보조지표 실험
- ML 기반 교체 테스트

## Milestones

1. ✅ 데이터 수집기 + 스키마 구축 (1주)
2. ✅ 예측 룰셋 + API 완성 (1주)
3. ✅ 챗봇 MVP 완료 (1주)
4. 🔜 사용자/모의매매 기능 (2주)
5. 🔜 정확도 평가, 개선 루프 적용 (2~4주)

## Gathering Results

- 사용자 피드백 기반 예측 정확도 평가
- 추천에 따른 모의 수익률 측정
- 사용자의 관심 종목 등록/조회 빈도 분석
- 모델 개선 반복 후 실제 예측 성능 향상 추적

## 예측 결과 구조 (JSON 예시)

```json
{
  "prediction": "buy",
  "trend": "strong_up",
  "trend_duration": "5일",
  "movement_type": "급상승",
  "movement_duration": "3일",
  "trend_count": {"up": 4, "down": 3},
  "reason": "5일간 연속 상승 + 거래량 급증",
  "confidence": 0.72
}
```

## 분석 항목 계산 규칙

| 항목 | 설명 | 계산 기준 |
|------|------|-----------|
| movement_type | 최근 며칠 간의 급등/급락/횡보 | 종가 기준 등락률의 절대값 ≥ 4% → 급등/급락, 1% 미만 → 횡보 |
| trend | 상승/하락/횡보 추세 해석 | 5일 이동평균선과의 거리 및 방향성 분석 |
| trend_duration | 현재 추세가 지속된 일 수 | 동일 방향의 종가 연속 일 수 |
| trend_count | 최근 20일 내 상승/하락 반복 횟수 | 종가 기준 연속 방향 전환 수 |
| 추천 (buy/sell/hold) | 행동 판단 | 룰셋 기반: 급등 후 횡보 → sell, 저점 횡보 → buy, 불확실 → hold |

## 자연어 응답 샘플

"삼성전자(005930)는 최근 5일 연속 상승하며 강한 상승 추세입니다. 특히 거래량도 3일 연속 증가하고 있어 '급상승' 상태로 판단됩니다. 현재 추세는 5일째 지속 중이며, 최근 20일 내 상승/하락 전환이 7회 발생했습니다. 따라서 매수 추천 드립니다. (신뢰도: 72%)"
