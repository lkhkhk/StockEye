2025-07-29 16:47:57,915 - main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:47:57,920 - main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:47:57,923 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:47:57,924 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:47:57,924 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:47:57,924 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:48:38,227 - main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:48:38,233 - main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:48:38,236 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:48:38,237 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:48:38,237 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:48:38,238 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:49:20,753 - main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:49:20,759 - main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:49:20,762 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:49:20,763 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:49:20,764 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:49:20,764 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:49:38,898 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:49:38,907 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:49:38,911 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:49:38,912 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:49:38,913 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:49:38,913 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:49:40,044 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:40,049 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 16:49:40,054 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-07-29 16:49:40,055 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '<unknown>'
2025-07-29 16:49:40,055 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-07-29 16:49:40,318 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:40,322 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 16:49:40,565 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:40,570 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 16:49:40,810 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:40,814 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 16:49:40,816 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 16:49:40,819 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3102865064, username=testuser_3102865064
2025-07-29 16:49:40,835 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=1, telegram_id=3102865064
2025-07-29 16:49:41,072 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:41,321 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 200 OK"
2025-07-29 16:49:41,326 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4480143140, username=testuser_4480143140
2025-07-29 16:49:41,333 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=3, telegram_id=4480143140
2025-07-29 16:49:41,566 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:41,803 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:41,807 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2368312973, username=testuser_2368312973
2025-07-29 16:49:41,813 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=5, telegram_id=2368312973
2025-07-29 16:49:42,051 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:42,056 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:42,061 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7125907634, username=testuser_7125907634
2025-07-29 16:49:42,067 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=7, telegram_id=7125907634
2025-07-29 16:49:42,300 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:42,548 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 200 OK"
2025-07-29 16:49:42,554 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7155258816, username=testuser_7155258816
2025-07-29 16:49:42,562 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=9, telegram_id=7155258816
2025-07-29 16:49:42,800 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:43,048 - src.api.routers.admin - ERROR - /admin/update_master 서버 오류: DB connection error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 36, in update_stock_master
    result = await stock_service.update_stock_master(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DB connection error
2025-07-29 16:49:43,051 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:49:43,059 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7499674372, username=testuser_7499674372
2025-07-29 16:49:43,066 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=11, telegram_id=7499674372
2025-07-29 16:49:43,317 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:43,556 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:43,561 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3694943063, username=testuser_3694943063
2025-07-29 16:49:43,568 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=13, telegram_id=3694943063
2025-07-29 16:49:43,802 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:43,807 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:43,812 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6037865612, username=testuser_6037865612
2025-07-29 16:49:43,817 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=15, telegram_id=6037865612
2025-07-29 16:49:44,048 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:44,285 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 200 OK"
2025-07-29 16:49:44,290 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9612540166, username=testuser_9612540166
2025-07-29 16:49:44,298 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=17, telegram_id=9612540166
2025-07-29 16:49:44,533 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:44,858 - src.api.routers.admin - ERROR - /admin/update_price 서버 오류: API call failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 53, in update_daily_price
    result = await stock_service.update_daily_prices(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: API call failed
2025-07-29 16:49:44,860 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:49:44,865 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3652757773, username=testuser_3652757773
2025-07-29 16:49:44,871 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=19, telegram_id=3652757773
2025-07-29 16:49:45,118 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:45,369 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:45,374 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3798526041, username=testuser_3798526041
2025-07-29 16:49:45,382 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=21, telegram_id=3798526041
2025-07-29 16:49:45,615 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:45,621 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:45,625 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7297602576, username=testuser_7297602576
2025-07-29 16:49:45,630 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=23, telegram_id=7297602576
2025-07-29 16:49:45,865 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:46,105 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7effb668d3c0>
2025-07-29 16:49:46,105 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:49:46,107 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 200 OK"
2025-07-29 16:49:46,112 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3700523400, username=testuser_3700523400
2025-07-29 16:49:46,119 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=25, telegram_id=3700523400
2025-07-29 16:49:46,354 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:46,595 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7effb668e0e0>
2025-07-29 16:49:46,595 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:49:46,597 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 200 OK"
2025-07-29 16:49:46,602 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8101622689, username=testuser_8101622689
2025-07-29 16:49:46,611 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=27, telegram_id=8101622689
2025-07-29 16:49:46,852 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:47,099 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7effb64fdb10>
2025-07-29 16:49:47,099 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:49:47,101 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=%EC%B9%B4%EC%B9%B4%EC%98%A4 "HTTP/1.1 200 OK"
2025-07-29 16:49:47,105 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2807202432, username=testuser_2807202432
2025-07-29 16:49:47,112 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=29, telegram_id=2807202432
2025-07-29 16:49:47,347 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:47,596 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7effb64fc160>
2025-07-29 16:49:47,596 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:49:47,598 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=0013456 "HTTP/1.1 200 OK"
2025-07-29 16:49:47,603 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4050695546, username=testuser_4050695546
2025-07-29 16:49:47,611 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=31, telegram_id=4050695546
2025-07-29 16:49:47,846 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:48,088 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7effb656b220>
2025-07-29 16:49:48,088 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:49:48,090 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=NONEXIST "HTTP/1.1 404 Not Found"
2025-07-29 16:49:48,098 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6850420242, username=testuser_6850420242
2025-07-29 16:49:48,106 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=33, telegram_id=6850420242
2025-07-29 16:49:48,351 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:48,594 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7effb656b820>
2025-07-29 16:49:48,595 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:49:48,595 - src.api.routers.admin - ERROR - /admin/update_disclosure 서버 오류: DART API error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 126, in update_disclosure
    result = await stock_service.update_disclosures(db, corp_code=corp_code, stock_code=stock_code or '', stock_name=stock_name or '')
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DART API error
2025-07-29 16:49:48,596 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:49:48,601 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3474229982, username=testuser_3474229982
2025-07-29 16:49:48,608 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=35, telegram_id=3474229982
2025-07-29 16:49:48,843 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:49,084 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:49,090 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6800077398, username=testuser_6800077398
2025-07-29 16:49:49,098 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=37, telegram_id=6800077398
2025-07-29 16:49:49,342 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:49,348 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:49,352 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3966364475, username=testuser_3966364475
2025-07-29 16:49:49,358 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=39, telegram_id=3966364475
2025-07-29 16:49:49,607 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:49,852 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 16:49:49,856 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1198003069, username=testuser_1198003069
2025-07-29 16:49:49,864 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=41, telegram_id=1198003069
2025-07-29 16:49:50,097 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:50,334 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 16:49:50,339 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6318417020, username=testuser_6318417020
2025-07-29 16:49:50,346 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=43, telegram_id=6318417020
2025-07-29 16:49:50,580 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:50,819 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:50,824 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6012830242, username=testuser_6012830242
2025-07-29 16:49:50,832 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=45, telegram_id=6012830242
2025-07-29 16:49:51,069 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:51,075 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:51,080 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8977267974, username=testuser_8977267974
2025-07-29 16:49:51,085 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=47, telegram_id=8977267974
2025-07-29 16:49:51,318 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:51,568 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 16:49:51,569 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 16:49:51,575 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8608729114, username=testuser_8608729114
2025-07-29 16:49:51,583 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=49, telegram_id=8608729114
2025-07-29 16:49:51,831 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:52,079 - src.api.routers.admin - ERROR - [trigger_job] 잡 실행 실패: test_job - Job execution failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 175, in trigger_job
    job.func(*job.args, **job.kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: Job execution failed

2025-07-29 16:49:52,080 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:49:52,084 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2262176895, username=testuser_2262176895
2025-07-29 16:49:52,092 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=51, telegram_id=2262176895
2025-07-29 16:49:52,327 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:52,647 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:52,651 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2816568718, username=testuser_2816568718
2025-07-29 16:49:52,660 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=53, telegram_id=2816568718
2025-07-29 16:49:52,897 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:52,904 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:52,909 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8718960820, username=testuser_8718960820
2025-07-29 16:49:52,916 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=55, telegram_id=8718960820
2025-07-29 16:49:53,153 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:53,404 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 16:49:53,405 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 200 OK"
2025-07-29 16:49:53,411 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5804786798, username=testuser_5804786798
2025-07-29 16:49:53,421 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=57, telegram_id=5804786798
2025-07-29 16:49:53,663 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:53,904 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 16:49:53,904 - src.api.routers.admin - ERROR - 공시 확인 잡 수동 실행 중 오류 발생: Disclosure check failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 193, in trigger_check_disclosures_job
    await stock_service.check_and_notify_new_disclosures(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: Disclosure check failed
2025-07-29 16:49:53,905 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:49:53,911 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8237729581, username=testuser_8237729581
2025-07-29 16:49:53,920 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=59, telegram_id=8237729581
2025-07-29 16:49:54,168 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:54,407 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:54,411 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9760947130, username=testuser_9760947130
2025-07-29 16:49:54,419 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=61, telegram_id=9760947130
2025-07-29 16:49:54,657 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:54,663 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:54,669 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2043953294, username=testuser_2043953294
2025-07-29 16:49:54,676 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=63, telegram_id=2043953294
2025-07-29 16:49:54,913 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:55,167 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:55,170 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=65, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:49:55,179 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=1, user_id=65, symbol=005930
2025-07-29 16:49:55,181 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:49:55,188 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6074043611, username=testuser_6074043611
2025-07-29 16:49:55,194 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=66, telegram_id=6074043611
2025-07-29 16:49:55,432 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:55,438 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:55,442 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8694714008, username=testuser_8694714008
2025-07-29 16:49:55,448 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=68, telegram_id=8694714008
2025-07-29 16:49:55,683 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:55,934 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:55,935 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 16:49:55,940 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4189761262, username=testuser_4189761262
2025-07-29 16:49:55,945 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=71, telegram_id=4189761262
2025-07-29 16:49:56,182 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:56,424 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:56,425 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:49:56,430 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=2, user_id=73, symbol=005930
2025-07-29 16:49:56,432 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:49:56,434 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:56,435 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=035720, target_price=50000.0, condition=lte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:49:56,440 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=3, user_id=73, symbol=035720
2025-07-29 16:49:56,441 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:49:56,443 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:56,445 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 조회 시도.
2025-07-29 16:49:56,448 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 2개 조회됨.
2025-07-29 16:49:56,449 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:49:56,453 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4000606365, username=testuser_4000606365
2025-07-29 16:49:56,459 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=74, telegram_id=4000606365
2025-07-29 16:49:56,694 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:56,937 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:56,938 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 조회 시도.
2025-07-29 16:49:56,939 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 0개 조회됨.
2025-07-29 16:49:56,941 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:49:56,945 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8750266634, username=testuser_8750266634
2025-07-29 16:49:56,951 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=77, telegram_id=8750266634
2025-07-29 16:49:57,185 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:57,188 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:57,192 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4496732173, username=testuser_4496732173
2025-07-29 16:49:57,197 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=79, telegram_id=4496732173
2025-07-29 16:49:57,282 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:57,523 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:57,524 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=81, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:49:57,530 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=4, user_id=81, symbol=005930
2025-07-29 16:49:57,532 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:49:57,536 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:57,537 - src.api.services.price_alert_service - DEBUG - 사용자(81)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:49:57,541 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=4
2025-07-29 16:49:57,542 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/81/symbol/005930 "HTTP/1.1 200 OK"
2025-07-29 16:49:57,548 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5447513156, username=testuser_5447513156
2025-07-29 16:49:57,558 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=82, telegram_id=5447513156
2025-07-29 16:49:57,794 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:58,042 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:58,042 - src.api.services.price_alert_service - DEBUG - 사용자(84)와 종목(NONEXISTENT)으로 가격 알림 조회 시도.
2025-07-29 16:49:58,044 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=84, symbol=NONEXISTENT
2025-07-29 16:49:58,045 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/84/symbol/NONEXISTENT "HTTP/1.1 404 Not Found"
2025-07-29 16:49:58,049 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7266387156, username=testuser_7266387156
2025-07-29 16:49:58,053 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=85, telegram_id=7266387156
2025-07-29 16:49:58,289 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:58,527 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:58,528 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=87, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:49:58,533 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=5, user_id=87, symbol=005930
2025-07-29 16:49:58,534 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:49:58,536 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:58,539 - src.api.services.price_alert_service - DEBUG - 가격 알림(5) 수정 시도: update_data={'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 16:49:58,541 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:49:58,542 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 16:49:58,542 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:49:58,547 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:49:58,547 - src.api.services.price_alert_service - INFO - 가격 알림(5) 수정 성공.
2025-07-29 16:49:58,549 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/5 "HTTP/1.1 200 OK"
2025-07-29 16:49:58,554 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3466240376, username=testuser_3466240376
2025-07-29 16:49:58,560 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=88, telegram_id=3466240376
2025-07-29 16:49:58,782 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:59,011 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:59,012 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=90, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:49:59,017 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=6, user_id=90, symbol=005930
2025-07-29 16:49:59,019 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:49:59,022 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/6 "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:59,026 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7646674404, username=testuser_7646674404
2025-07-29 16:49:59,032 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=91, telegram_id=7646674404
2025-07-29 16:49:59,257 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:59,555 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:59,556 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 16:49:59,557 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 16:49:59,558 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 16:49:59,563 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3821671559, username=testuser_3821671559
2025-07-29 16:49:59,569 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=94, telegram_id=3821671559
2025-07-29 16:49:59,798 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:00,263 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:00,264 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=96, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:50:00,269 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=7, user_id=96, symbol=005930
2025-07-29 16:50:00,271 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:50:00,274 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:00,274 - src.api.services.price_alert_service - DEBUG - 가격 알림(7) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 16:50:00,276 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:50:00,276 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0}
2025-07-29 16:50:00,276 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:50:00,281 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:50:00,282 - src.api.services.price_alert_service - INFO - 가격 알림(7) 수정 성공.
2025-07-29 16:50:00,284 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/7 "HTTP/1.1 403 Forbidden"
2025-07-29 16:50:00,288 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2666967382, username=testuser_2666967382
2025-07-29 16:50:00,294 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=98, telegram_id=2666967382
2025-07-29 16:50:00,528 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:00,761 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:00,762 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=100, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:50:00,768 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=8, user_id=100, symbol=005930
2025-07-29 16:50:00,769 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:50:00,772 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:00,775 - src.api.services.price_alert_service - DEBUG - 가격 알림(8) 삭제 시도.
2025-07-29 16:50:00,780 - src.api.services.price_alert_service - INFO - 가격 알림(8) 삭제 성공.
2025-07-29 16:50:00,781 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/8 "HTTP/1.1 200 OK"
2025-07-29 16:50:00,787 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7836582547, username=testuser_7836582547
2025-07-29 16:50:00,793 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=101, telegram_id=7836582547
2025-07-29 16:50:01,021 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:01,254 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:01,254 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=103, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:50:01,260 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=9, user_id=103, symbol=005930
2025-07-29 16:50:01,262 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:50:01,264 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/9 "HTTP/1.1 403 Forbidden"
2025-07-29 16:50:01,269 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1022545311, username=testuser_1022545311
2025-07-29 16:50:01,275 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=104, telegram_id=1022545311
2025-07-29 16:50:01,500 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:01,733 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:01,735 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 삭제 시도.
2025-07-29 16:50:01,737 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 16:50:01,738 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 16:50:01,743 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4950847469, username=testuser_4950847469
2025-07-29 16:50:01,748 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=107, telegram_id=4950847469
2025-07-29 16:50:01,978 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:02,442 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:02,444 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=109, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:50:02,451 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=10, user_id=109, symbol=005930
2025-07-29 16:50:02,453 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:50:02,456 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:02,463 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/10 "HTTP/1.1 403 Forbidden"
2025-07-29 16:50:02,469 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3710425891, username=testuser_3710425891
2025-07-29 16:50:02,477 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=111, telegram_id=3710425891
2025-07-29 16:50:02,713 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:02,719 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 16:50:02,724 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2543659563, username=testuser_2543659563
2025-07-29 16:50:02,730 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=113, telegram_id=2543659563
2025-07-29 16:50:02,960 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:02,967 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 16:50:02,975 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:02,979 - httpx - INFO - HTTP Request: GET http://testserver/ "HTTP/1.1 200 OK"
2025-07-29 16:50:02,981 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6638204787, username=testuser_6638204787
2025-07-29 16:50:02,987 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=115, telegram_id=6638204787
2025-07-29 16:50:03,233 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:03,237 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:50:03,240 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:50:03,241 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 16:50:03,244 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 16:50:03,244 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 16:50:03,245 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 16:50:03,250 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8179816402, username=testuser_8179816402
2025-07-29 16:50:03,255 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=117, telegram_id=8179816402
2025-07-29 16:50:03,491 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:03,495 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:50:03,499 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=INVALID
2025-07-29 16:50:03,499 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=INVALID, days=40
2025-07-29 16:50:03,501 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 16:50:03,501 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 16:50:03,503 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 16:50:03,507 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2803246226, username=testuser_2803246226
2025-07-29 16:50:03,513 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=119, telegram_id=2803246226
2025-07-29 16:50:03,749 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:03,752 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:50:03,756 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 16:50:03,764 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8066334638, username=testuser_8066334638
2025-07-29 16:50:03,770 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=121, telegram_id=8066334638
2025-07-29 16:50:04,003 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:04,248 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=123, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 16:50:04,253 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 16:50:04,256 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:50:04,258 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/123 "HTTP/1.1 200 OK"
2025-07-29 16:50:04,266 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8042917500, username=testuser_8042917500
2025-07-29 16:50:04,273 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=124, telegram_id=8042917500
2025-07-29 16:50:04,510 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:04,516 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=99999, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 16:50:04,518 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 16:50:04,520 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:50:04,521 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/99999 "HTTP/1.1 200 OK"
2025-07-29 16:50:04,528 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6908187352, username=testuser_6908187352
2025-07-29 16:50:04,534 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=126, telegram_id=6908187352
2025-07-29 16:50:04,773 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:05,009 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=128, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 16:50:05,010 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 16:50:05,011 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:50:05,012 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/128 "HTTP/1.1 200 OK"
2025-07-29 16:50:05,018 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1600873935, username=testuser_1600873935
2025-07-29 16:50:05,023 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=129, telegram_id=1600873935
2025-07-29 16:50:05,256 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:05,529 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=1, page_size=5, symbol=None, prediction=None
2025-07-29 16:50:05,531 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 16:50:05,533 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 1, 페이지 크기 5).
2025-07-29 16:50:05,535 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=1&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 16:50:05,537 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=2, page_size=5, symbol=None, prediction=None
2025-07-29 16:50:05,540 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 16:50:05,541 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 2, 페이지 크기 5).
2025-07-29 16:50:05,543 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=2&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 16:50:05,551 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1058974798, username=testuser_1058974798
2025-07-29 16:50:05,557 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=132, telegram_id=1058974798
2025-07-29 16:50:05,799 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:06,044 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=134, page=1, page_size=10, symbol=005930, prediction=None
2025-07-29 16:50:06,044 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 16:50:06,047 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 16:50:06,050 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:50:06,052 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/134?symbol=005930 "HTTP/1.1 200 OK"
2025-07-29 16:50:06,058 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7288556958, username=testuser_7288556958
2025-07-29 16:50:06,063 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=135, telegram_id=7288556958
2025-07-29 16:50:06,295 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:06,546 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=137, page=1, page_size=10, symbol=None, prediction=상승
2025-07-29 16:50:06,546 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=상승
2025-07-29 16:50:06,549 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 16:50:06,551 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:50:06,553 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/137?prediction=%EC%83%81%EC%8A%B9 "HTTP/1.1 200 OK"
2025-07-29 16:50:06,559 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4036508486, username=testuser_4036508486
2025-07-29 16:50:06,564 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=138, telegram_id=4036508486
2025-07-29 16:50:06,803 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:07,064 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=140, page=1, page_size=10, symbol=005930, prediction=유지
2025-07-29 16:50:07,065 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 16:50:07,065 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=유지
2025-07-29 16:50:07,071 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 16:50:07,075 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:50:07,077 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/140?symbol=005930&prediction=%EC%9C%A0%EC%A7%80 "HTTP/1.1 200 OK"
2025-07-29 16:50:07,083 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7657071198, username=testuser_7657071198
2025-07-29 16:50:07,089 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=141, telegram_id=7657071198
2025-07-29 16:50:07,326 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:07,337 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=143, symbol=005930, trade_type=buy
2025-07-29 16:50:07,337 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 16:50:07,340 - src.api.services.stock_service - WARNING - 현재가 없음: 005930. 임시 가격 생성.
2025-07-29 16:50:07,340 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: 161178
2025-07-29 16:50:07,346 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=143, symbol=005930, trade_type=buy
2025-07-29 16:50:07,347 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 16:50:07,351 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=143
2025-07-29 16:50:07,353 - src.api.routers.simulated_trade - DEBUG - 사용자(143)의 모의매매 이력 1건 조회됨.
2025-07-29 16:50:07,354 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 16:50:07,355 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/143 "HTTP/1.1 200 OK"
2025-07-29 16:50:07,362 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5561840485, username=testuser_5561840485
2025-07-29 16:50:07,368 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=144, telegram_id=5561840485
2025-07-29 16:50:07,598 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:07,613 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 16:50:07,620 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2057089273, username=testuser_2057089273
2025-07-29 16:50:07,626 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=146, telegram_id=2057089273
2025-07-29 16:50:07,859 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:07,866 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 16:50:07,873 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9896663349, username=testuser_9896663349
2025-07-29 16:50:07,879 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=148, telegram_id=9896663349
2025-07-29 16:50:08,110 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:08,123 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%82%BC%EC%84%B1%EC%A0%84%EC%9E%90 "HTTP/1.1 200 OK"
2025-07-29 16:50:08,131 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2778764333, username=testuser_2778764333
2025-07-29 16:50:08,136 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=150, telegram_id=2778764333
2025-07-29 16:50:08,369 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:08,388 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=035720 "HTTP/1.1 200 OK"
2025-07-29 16:50:08,396 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4247580218, username=testuser_4247580218
2025-07-29 16:50:08,401 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=152, telegram_id=4247580218
2025-07-29 16:50:08,645 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:08,661 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=sk%ED%95%98%EC%9D%B4%EB%8B%89%EC%8A%A4 "HTTP/1.1 200 OK"
2025-07-29 16:50:08,670 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2087608438, username=testuser_2087608438
2025-07-29 16:50:08,676 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=154, telegram_id=2087608438
2025-07-29 16:50:08,914 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:08,923 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%97%86%EB%8A%94%EC%A2%85%EB%AA%A9 "HTTP/1.1 200 OK"
2025-07-29 16:50:08,928 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4783767111, username=testuser_4783767111
2025-07-29 16:50:08,935 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=156, telegram_id=4783767111
2025-07-29 16:50:09,175 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:09,182 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query= "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 16:50:09,188 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8437121729, username=testuser_8437121729
2025-07-29 16:50:09,193 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=158, telegram_id=8437121729
2025-07-29 16:50:09,428 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:09,437 - httpx - INFO - HTTP Request: GET http://testserver/symbols/005930/current_price_and_change "HTTP/1.1 200 OK"
2025-07-29 16:50:09,443 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5817413249, username=testuser_5817413249
2025-07-29 16:50:09,449 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=160, telegram_id=5817413249
2025-07-29 16:50:09,681 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:09,689 - httpx - INFO - HTTP Request: GET http://testserver/symbols/NONEXISTENT/current_price_and_change "HTTP/1.1 404 Not Found"
2025-07-29 16:50:09,693 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1980816938, username=testuser_1980816938
2025-07-29 16:50:09,698 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=162, telegram_id=1980816938
2025-07-29 16:50:09,937 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:10,184 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 16:50:10,189 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6113046972, username=testuser_6113046972
2025-07-29 16:50:10,195 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=165, telegram_id=6113046972
2025-07-29 16:50:10,428 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:10,669 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 400 Bad Request"
2025-07-29 16:50:10,674 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7126985004, username=testuser_7126985004
2025-07-29 16:50:10,679 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=168, telegram_id=7126985004
2025-07-29 16:50:10,921 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:11,453 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 16:50:11,458 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2250296124, username=testuser_2250296124
2025-07-29 16:50:11,463 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=171, telegram_id=2250296124
2025-07-29 16:50:11,700 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:11,708 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 16:50:11,713 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3035800371, username=testuser_3035800371
2025-07-29 16:50:11,718 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=173, telegram_id=3035800371
2025-07-29 16:50:11,961 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:12,424 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 16:50:12,430 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8307383778, username=testuser_8307383778
2025-07-29 16:50:12,437 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=176, telegram_id=8307383778
2025-07-29 16:50:12,671 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:12,913 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 178
2025-07-29 16:50:12,916 - src.api.services.user_service - DEBUG - User found by id: user_id=178
2025-07-29 16:50:12,921 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 16:50:12,926 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4942143022, username=testuser_4942143022
2025-07-29 16:50:12,933 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=179, telegram_id=4942143022
2025-07-29 16:50:13,183 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:13,187 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 403 Forbidden"
2025-07-29 16:50:13,192 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5566850506, username=testuser_5566850506
2025-07-29 16:50:13,198 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=181, telegram_id=5566850506
2025-07-29 16:50:13,435 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:13,696 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 183
2025-07-29 16:50:13,697 - src.api.services.user_service - DEBUG - User found by id: user_id=183
2025-07-29 16:50:13,709 - httpx - INFO - HTTP Request: PUT http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 16:50:13,714 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7816845155, username=testuser_7816845155
2025-07-29 16:50:13,719 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=184, telegram_id=7816845155
2025-07-29 16:50:13,955 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:13,970 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 16:50:13,975 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8267531605, username=testuser_8267531605
2025-07-29 16:50:13,981 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=187, telegram_id=8267531605
2025-07-29 16:50:14,213 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:14,458 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 16:50:14,461 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8766985272, username=testuser_8766985272
2025-07-29 16:50:14,467 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=190, telegram_id=8766985272
2025-07-29 16:50:14,708 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:14,961 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/192 "HTTP/1.1 200 OK"
2025-07-29 16:50:14,967 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4291641631, username=testuser_4291641631
2025-07-29 16:50:14,974 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=193, telegram_id=4291641631
2025-07-29 16:50:15,223 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:15,233 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/99999 "HTTP/1.1 404 Not Found"
2025-07-29 16:50:15,239 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7193174311, username=testuser_7193174311
2025-07-29 16:50:15,246 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=195, telegram_id=7193174311
2025-07-29 16:50:15,492 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:16,003 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 197
2025-07-29 16:50:16,005 - src.api.services.user_service - DEBUG - User found by id: user_id=197
2025-07-29 16:50:16,020 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 200 OK"
2025-07-29 16:50:16,026 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8422709371, username=testuser_8422709371
2025-07-29 16:50:16,033 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=199, telegram_id=8422709371
2025-07-29 16:50:16,278 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:16,543 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 201
2025-07-29 16:50:16,544 - src.api.services.user_service - DEBUG - User found by id: user_id=201
2025-07-29 16:50:16,546 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 403 Forbidden"
2025-07-29 16:50:16,552 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8461565591, username=testuser_8461565591
2025-07-29 16:50:16,559 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=202, telegram_id=8461565591
2025-07-29 16:50:16,803 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:16,813 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=204, symbol=005930
2025-07-29 16:50:16,825 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=204, symbol=005930
2025-07-29 16:50:16,828 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 16:50:16,832 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 시도: user_id=204
2025-07-29 16:50:16,835 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 성공: user_id=204, 1개 종목.
2025-07-29 16:50:16,837 - httpx - INFO - HTTP Request: GET http://testserver/watchlist/get/204 "HTTP/1.1 200 OK"
2025-07-29 16:50:16,843 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:16,846 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:50:16,847 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:50:16,852 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:16,858 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12345
2025-07-29 16:50:16,863 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=1, telegram_id=12345
2025-07-29 16:50:16,864 - src.api.services.price_alert_service - DEBUG - 사용자(1)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:50:16,869 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=1
2025-07-29 16:50:16,869 - src.api.services.price_alert_service - DEBUG - 가격 알림(1) 수정 시도: update_data={'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 16:50:16,872 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:50:16,872 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 16:50:16,873 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:50:16,877 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:50:16,877 - src.api.services.price_alert_service - INFO - 가격 알림(1) 수정 성공.
2025-07-29 16:50:16,879 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:50:16,886 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:50:16,886 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:50:16,890 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:16,891 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 16:50:16,894 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 16:50:16,894 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:50:16,897 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 16:50:16,897 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 16:50:16,900 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:50:16,900 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 16:50:16,901 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:50:16,911 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:50:16,911 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 16:50:16,913 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:50:16,917 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:16,919 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 16:50:16,921 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 16:50:16,922 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:50:16,924 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 16:50:16,924 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 16:50:16,926 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:50:16,926 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 16:50:16,927 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:50:16,933 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:50:16,933 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 16:50:16,934 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:50:16,949 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2430340888, username=testuser_2430340888
2025-07-29 16:50:16,955 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=205, telegram_id=2430340888
2025-07-29 16:50:16,957 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:16,960 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:50:16,962 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:16,966 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 2430340888
2025-07-29 16:50:16,969 - src.api.services.user_service - DEBUG - User not found for telegram_id: 2430340888
2025-07-29 16:50:16,970 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2430340888, username=testuser_2430340888
2025-07-29 16:50:16,979 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=190, telegram_id=2430340888
2025-07-29 16:50:16,979 - src.api.services.price_alert_service - DEBUG - 사용자(190)와 종목(GOOG)으로 가격 알림 조회 시도.
2025-07-29 16:50:16,981 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=190, symbol=GOOG
2025-07-29 16:50:16,981 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=190, symbol=GOOG, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:50:16,988 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=189, user_id=190, symbol=GOOG
2025-07-29 16:50:16,989 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:50:16,991 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:50:16,999 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6005592234, username=testuser_6005592234
2025-07-29 16:50:17,005 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=206, telegram_id=6005592234
2025-07-29 16:50:17,006 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,009 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:50:17,010 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:17,011 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 6005592234
2025-07-29 16:50:17,013 - src.api.services.user_service - DEBUG - User not found for telegram_id: 6005592234
2025-07-29 16:50:17,014 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6005592234, username=telegram_user_6005592234
2025-07-29 16:50:17,019 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=191, telegram_id=6005592234
2025-07-29 16:50:17,020 - src.api.services.price_alert_service - DEBUG - 사용자(191)와 종목(MSFT)으로 가격 알림 조회 시도.
2025-07-29 16:50:17,021 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=191, symbol=MSFT
2025-07-29 16:50:17,022 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=191, symbol=MSFT, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:50:17,029 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=190, user_id=191, symbol=MSFT
2025-07-29 16:50:17,031 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:50:17,034 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:50:17,041 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9278798157, username=testuser_9278798157
2025-07-29 16:50:17,048 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=207, telegram_id=9278798157
2025-07-29 16:50:17,052 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,056 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:50:17,057 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:17,058 - src.api.routers.bot_router - DEBUG - Before toggle: existing_alert.notify_on_disclosure = True
2025-07-29 16:50:17,058 - src.api.routers.bot_router - DEBUG - Calculated new_status: False
2025-07-29 16:50:17,059 - src.api.routers.bot_router - DEBUG - After update_alert call: updated_alert_orm.notify_on_disclosure = False
2025-07-29 16:50:17,060 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:50:17,062 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:50:17,068 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7444469257, username=testuser_7444469257
2025-07-29 16:50:17,076 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=208, telegram_id=7444469257
2025-07-29 16:50:17,080 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,086 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:50:17,087 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:17,088 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 7444469257
2025-07-29 16:50:17,090 - src.api.services.user_service - DEBUG - User not found for telegram_id: 7444469257
2025-07-29 16:50:17,090 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7444469257, username=telegram_user_7444469257
2025-07-29 16:50:17,095 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=192, telegram_id=7444469257
2025-07-29 16:50:17,095 - src.api.services.price_alert_service - DEBUG - 사용자(192)와 종목(NFLX)으로 가격 알림 조회 시도.
2025-07-29 16:50:17,097 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=192, symbol=NFLX
2025-07-29 16:50:17,098 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=192, symbol=NFLX, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:50:17,103 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=191, user_id=192, symbol=NFLX
2025-07-29 16:50:17,105 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:50:17,107 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:50:17,112 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9798289585, username=testuser_9798289585
2025-07-29 16:50:17,118 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=209, telegram_id=9798289585
2025-07-29 16:50:17,120 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,122 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:50:17,123 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:17,123 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 9798289585
2025-07-29 16:50:17,125 - src.api.services.user_service - DEBUG - User not found for telegram_id: 9798289585
2025-07-29 16:50:17,125 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9798289585, username=testuser_9798289585
2025-07-29 16:50:17,130 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=193, telegram_id=9798289585
2025-07-29 16:50:17,131 - src.api.services.price_alert_service - DEBUG - 사용자(193)와 종목(NVDA)으로 가격 알림 조회 시도.
2025-07-29 16:50:17,132 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=193, symbol=NVDA
2025-07-29 16:50:17,133 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=193, symbol=NVDA, target_price=1000.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:50:17,139 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=192, user_id=193, symbol=NVDA
2025-07-29 16:50:17,140 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:50:17,143 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:50:17,149 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1940552641, username=testuser_1940552641
2025-07-29 16:50:17,158 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=210, telegram_id=1940552641
2025-07-29 16:50:17,162 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,165 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:50:17,167 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:17,168 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 1940552641
2025-07-29 16:50:17,170 - src.api.services.user_service - DEBUG - User not found for telegram_id: 1940552641
2025-07-29 16:50:17,170 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1940552641, username=telegram_user_1940552641
2025-07-29 16:50:17,176 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=194, telegram_id=1940552641
2025-07-29 16:50:17,176 - src.api.services.price_alert_service - DEBUG - 사용자(194)와 종목(GOOGL)으로 가격 알림 조회 시도.
2025-07-29 16:50:17,178 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=194, symbol=GOOGL
2025-07-29 16:50:17,178 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=194, symbol=GOOGL, target_price=110.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=weekly
2025-07-29 16:50:17,184 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=193, user_id=194, symbol=GOOGL
2025-07-29 16:50:17,185 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:50:17,187 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:50:17,193 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3033881384, username=testuser_3033881384
2025-07-29 16:50:17,204 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=211, telegram_id=3033881384
2025-07-29 16:50:17,208 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,211 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:50:17,212 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:17,213 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 3033881384
2025-07-29 16:50:17,216 - src.api.services.user_service - DEBUG - User not found for telegram_id: 3033881384
2025-07-29 16:50:17,216 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3033881384, username=telegram_user_3033881384
2025-07-29 16:50:17,222 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=195, telegram_id=3033881384
2025-07-29 16:50:17,222 - src.api.services.price_alert_service - DEBUG - 사용자(195)와 종목(FB)으로 가격 알림 조회 시도.
2025-07-29 16:50:17,224 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=195, symbol=FB
2025-07-29 16:50:17,224 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=195, symbol=FB, target_price=300.0, condition=above, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:50:17,230 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=194, user_id=195, symbol=FB
2025-07-29 16:50:17,232 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:50:17,234 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:50:17,240 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,240 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,249 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,253 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,254 - src.common.dart_utils - ERROR - DART CORPCODE.xml 요청 실패: Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 25, in dart_get_all_stocks
    resp = await session.get(url, timeout=60)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 16:50:17,258 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,265 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,271 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,276 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,278 - src.common.dart_utils - ERROR - DART 공시 조회 API 요청 실패 (corp_code: 00123456): Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 79, in dart_get_disclosures
    resp = await session.get(url, params=params, timeout=10)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 16:50:17,283 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,287 - src.common.dart_utils - ERROR - DART 공시 API가 오류를 반환했습니다. status: 001, message: API 호출 오류, corp_code: 00123456
2025-07-29 16:50:17,402 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9633982537, username=testuser_9633982537
2025-07-29 16:50:17,412 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=212, telegram_id=9633982537
2025-07-29 16:50:17,660 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,918 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 16:50:18,167 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 16:50:18,171 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=214, symbol=005930
2025-07-29 16:50:18,178 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=214, symbol=005930
2025-07-29 16:50:18,179 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 16:50:18,185 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 214
2025-07-29 16:50:18,186 - src.api.services.user_service - DEBUG - User found by id: user_id=214
2025-07-29 16:50:18,187 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:18,188 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=214, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:50:18,198 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=11, user_id=214, symbol=005930
2025-07-29 16:50:18,200 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:50:18,204 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:50:18,207 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:50:18,208 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 16:50:18,209 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 16:50:18,210 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 16:50:18,217 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 16:50:18,222 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=214, symbol=005930, trade_type=buy
2025-07-29 16:50:18,222 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 16:50:18,226 - src.api.services.stock_service - WARNING - 현재가 없음: 005930. 임시 가격 생성.
2025-07-29 16:50:18,226 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: 195784
2025-07-29 16:50:18,232 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=214, symbol=005930, trade_type=buy
2025-07-29 16:50:18,233 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 16:50:18,236 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=214
2025-07-29 16:50:18,238 - src.api.routers.simulated_trade - DEBUG - 사용자(214)의 모의매매 이력 1건 조회됨.
2025-07-29 16:50:18,239 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 16:50:18,240 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/214 "HTTP/1.1 200 OK"
2025-07-29 16:50:18,251 - src.api.main - INFO - [APScheduler] 가격 알림 체크 잡 실행: 2025-07-29 16:50:18.251715
2025-07-29 16:50:18,252 - src.api.main - DEBUG - 활성 알림 수: 3
2025-07-29 16:50:18,252 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 16:50:18,252 - src.api.main - DEBUG - 종목 정상종목 현재가: 110
2025-07-29 16:50:18,256 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='139636728751888'>, 목표 가격: 100, 조건: gte, 반복 주기: <MagicMock name='mock.repeat_interval' id='139636740656432'>
2025-07-29 16:50:18,256 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목, 현재가: 110, 목표가: 100
2025-07-29 16:50:18,260 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='139636730575120'>)
2025-07-29 16:50:18,263 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 16:50:18,263 - src.api.main - DEBUG - 종목 오류종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 16:50:18,263 - src.api.main - ERROR - 가격 알림 확인 중 '오류종목' 처리 오류: 현재가 조회 실패
Traceback (most recent call last):
  File "/app/src/api/main.py", line 145, in check_price_alerts_job
    price_data = stock_service.get_current_price_and_change(symbol, db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1179, in _execute_mock_call
    result = effect(*args, **kwargs)
  File "/app/src/api/tests/test_main_jobs.py", line 34, in get_current_price_side_effect
    raise ValueError("현재가 조회 실패")
ValueError: 현재가 조회 실패
2025-07-29 16:50:18,264 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 16:50:18,264 - src.api.main - DEBUG - 종목 정상종목2 현재가: 290
2025-07-29 16:50:18,265 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='139636727051264'>, 목표 가격: 300, 조건: lte, 반복 주기: <MagicMock name='mock.repeat_interval' id='139636727099840'>
2025-07-29 16:50:18,266 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목2, 현재가: 290, 목표가: 300
2025-07-29 16:50:18,267 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='139636730575120'>)
2025-07-29 16:50:18,267 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 16:50:18,268 - src.api.main - DEBUG - 모든 가격 알림 체크 및 DB 커밋 완료.
2025-07-29 16:50:18,273 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:50:18,274 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(10일)
2025-07-29 16:50:18,281 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:50:18,282 - src.api.services.predict_service - ERROR - 예측 불가: 데이터 분석 실패
2025-07-29 16:50:18,288 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:50:18,289 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:50:18,303 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 상승 (24일 지속). 금일 변동: 보합. 최근 20일간 상승일: 19일, 하락일: 0일.
2025-07-29 16:50:18,304 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 16:50:18,310 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:50:18,311 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:50:18,318 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 하락 (24일 지속). 금일 변동: 보합. 최근 20일간 상승일: 0일, 하락일: 19일.
2025-07-29 16:50:18,319 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 16:50:18,329 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:50:18,330 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:50:18,337 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 횡보 (1일 지속). 금일 변동: 보합. 최근 20일간 상승일: 12일, 하락일: 7일.
2025-07-29 16:50:18,337 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 16:50:18,343 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:50:18,344 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:50:18,351 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=buy, reason=최근 추세: 하락 (1일 지속). 금일 변동: 횡보. 최근 20일간 상승일: 2일, 하락일: 17일. (저점 횡보 패턴 감지)
2025-07-29 16:50:18,351 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: buy
2025-07-29 16:50:18,357 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:50:18,359 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 22개 데이터.
2025-07-29 16:50:18,370 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, reason=최근 추세: 상승 (21일 지속). 금일 변동: 횡보. 최근 20일간 상승일: 19일, 하락일: 0일. (급등 후 횡보 패턴 감지)
2025-07-29 16:50:18,371 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 16:50:18,374 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:18,381 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 16:50:18,383 - src.api.services.stock_service - INFO - 신규 공시가 없습니다. (DB 기준: 202301010000001)
2025-07-29 16:50:18,638 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:18,643 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 16:50:18,650 - src.api.services.stock_service - ERROR - 신규 공시 확인 및 알림 작업 중 예상치 못한 오류 발생: (psycopg2.ProgrammingError) can't adapt type 'MagicMock'
[SQL: INSERT INTO system_config (key, value, created_at, updated_at) VALUES (%(key)s, %(value)s, now(), now()) RETURNING system_config.created_at, system_config.updated_at]
[parameters: {'key': 'last_checked_rcept_no', 'value': <MagicMock name='dart_get_disclosures().__getitem__().__getitem__()' id='139636728684960'>}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
psycopg2.ProgrammingError: can't adapt type 'MagicMock'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 59, in check_and_notify_new_disclosures
    db.commit()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4345, in flush
    self._flush(objects)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4480, in _flush
    with util.safe_reraise():
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4441, in _flush
    flush_context.execute()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1415, in execute
    return meth(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context
    return self._exec_single_context(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.ProgrammingError) can't adapt type 'MagicMock'
[SQL: INSERT INTO system_config (key, value, created_at, updated_at) VALUES (%(key)s, %(value)s, now(), now()) RETURNING system_config.created_at, system_config.updated_at]
[parameters: {'key': 'last_checked_rcept_no', 'value': <MagicMock name='dart_get_disclosures().__getitem__().__getitem__()' id='139636728684960'>}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-07-29 16:50:18,728 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:18,736 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 16:50:18,738 - src.api.services.stock_service - INFO - 신규 공시가 없습니다. (DB 기준: 202301010000001)
2025-07-29 16:50:18,803 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:18,873 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:18,986 - src.api.services.stock_service - ERROR - 신규 공시 확인 및 알림 작업 중 예상치 못한 오류 발생: (psycopg2.ProgrammingError) can't adapt type 'MagicMock'
[SQL: INSERT INTO system_config (key, value, created_at, updated_at) VALUES (%(key)s, %(value)s, now(), now()) RETURNING system_config.created_at, system_config.updated_at]
[parameters: {'key': 'last_checked_rcept_no', 'value': <MagicMock name='dart_get_disclosures().__getitem__().__getitem__()' id='139636730498592'>}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
psycopg2.ProgrammingError: can't adapt type 'MagicMock'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 59, in check_and_notify_new_disclosures
    db.commit()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4345, in flush
    self._flush(objects)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4480, in _flush
    with util.safe_reraise():
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4441, in _flush
    flush_context.execute()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1415, in execute
    return meth(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context
    return self._exec_single_context(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.ProgrammingError) can't adapt type 'MagicMock'
[SQL: INSERT INTO system_config (key, value, created_at, updated_at) VALUES (%(key)s, %(value)s, now(), now()) RETURNING system_config.created_at, system_config.updated_at]
[parameters: {'key': 'last_checked_rcept_no', 'value': <MagicMock name='dart_get_disclosures().__getitem__().__getitem__()' id='139636730498592'>}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-07-29 16:50:19,045 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:08,618 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:51:08,624 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:51:08,628 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:51:08,628 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:51:08,628 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:51:08,629 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:51:09,494 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:09,509 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 16:51:09,516 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-07-29 16:51:09,517 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '<unknown>'
2025-07-29 16:51:09,518 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-07-29 16:51:09,802 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:09,805 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 16:51:10,042 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:10,046 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 16:51:10,279 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:10,282 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 16:51:10,284 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 16:51:10,288 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5839932131, username=testuser_5839932131
2025-07-29 16:51:10,305 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=1, telegram_id=5839932131
2025-07-29 16:51:10,539 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:10,784 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 200 OK"
2025-07-29 16:51:10,790 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3172757779, username=testuser_3172757779
2025-07-29 16:51:10,797 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=3, telegram_id=3172757779
2025-07-29 16:51:11,030 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:11,267 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:11,272 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3211233319, username=testuser_3211233319
2025-07-29 16:51:11,280 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=5, telegram_id=3211233319
2025-07-29 16:51:11,526 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:11,533 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:11,538 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9471744458, username=testuser_9471744458
2025-07-29 16:51:11,544 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=7, telegram_id=9471744458
2025-07-29 16:51:11,784 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:12,034 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 200 OK"
2025-07-29 16:51:12,041 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8403439400, username=testuser_8403439400
2025-07-29 16:51:12,048 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=9, telegram_id=8403439400
2025-07-29 16:51:12,281 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:12,522 - src.api.routers.admin - ERROR - /admin/update_master 서버 오류: DB connection error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 36, in update_stock_master
    result = await stock_service.update_stock_master(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DB connection error
2025-07-29 16:51:12,524 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:51:12,530 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8037801170, username=testuser_8037801170
2025-07-29 16:51:12,536 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=11, telegram_id=8037801170
2025-07-29 16:51:12,769 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:13,004 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:13,008 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2864150847, username=testuser_2864150847
2025-07-29 16:51:13,015 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=13, telegram_id=2864150847
2025-07-29 16:51:13,256 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:13,261 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:13,266 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7425587640, username=testuser_7425587640
2025-07-29 16:51:13,272 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=15, telegram_id=7425587640
2025-07-29 16:51:13,514 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:13,755 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 200 OK"
2025-07-29 16:51:13,760 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4509921235, username=testuser_4509921235
2025-07-29 16:51:13,767 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=17, telegram_id=4509921235
2025-07-29 16:51:14,001 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:14,250 - src.api.routers.admin - ERROR - /admin/update_price 서버 오류: API call failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 53, in update_daily_price
    result = await stock_service.update_daily_prices(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: API call failed
2025-07-29 16:51:14,251 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:51:14,257 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9843735005, username=testuser_9843735005
2025-07-29 16:51:14,265 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=19, telegram_id=9843735005
2025-07-29 16:51:14,502 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:14,742 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:14,747 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9412588891, username=testuser_9412588891
2025-07-29 16:51:14,755 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=21, telegram_id=9412588891
2025-07-29 16:51:14,993 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:14,999 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:15,004 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8680088242, username=testuser_8680088242
2025-07-29 16:51:15,009 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=23, telegram_id=8680088242
2025-07-29 16:51:15,244 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:15,486 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7fc8d3365690>
2025-07-29 16:51:15,487 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:51:15,490 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 200 OK"
2025-07-29 16:51:15,495 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2266521201, username=testuser_2266521201
2025-07-29 16:51:15,504 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=25, telegram_id=2266521201
2025-07-29 16:51:15,748 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:15,992 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7fc8d337c880>
2025-07-29 16:51:15,992 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:51:15,993 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 200 OK"
2025-07-29 16:51:15,998 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1517188221, username=testuser_1517188221
2025-07-29 16:51:16,005 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=27, telegram_id=1517188221
2025-07-29 16:51:16,243 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:16,496 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7fc8d324b850>
2025-07-29 16:51:16,496 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:51:16,498 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=%EC%B9%B4%EC%B9%B4%EC%98%A4 "HTTP/1.1 200 OK"
2025-07-29 16:51:16,503 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3459344634, username=testuser_3459344634
2025-07-29 16:51:16,509 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=29, telegram_id=3459344634
2025-07-29 16:51:16,743 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:17,067 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7fc8d30b4970>
2025-07-29 16:51:17,067 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:51:17,068 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=0013456 "HTTP/1.1 200 OK"
2025-07-29 16:51:17,073 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1007686879, username=testuser_1007686879
2025-07-29 16:51:17,079 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=31, telegram_id=1007686879
2025-07-29 16:51:17,311 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:17,557 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7fc8d30b6f80>
2025-07-29 16:51:17,557 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:51:17,559 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=NONEXIST "HTTP/1.1 404 Not Found"
2025-07-29 16:51:17,565 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7298894412, username=testuser_7298894412
2025-07-29 16:51:17,572 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=33, telegram_id=7298894412
2025-07-29 16:51:17,817 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:18,069 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7fc8d45078b0>
2025-07-29 16:51:18,070 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:51:18,070 - src.api.routers.admin - ERROR - /admin/update_disclosure 서버 오류: DART API error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 126, in update_disclosure
    result = await stock_service.update_disclosures(db, corp_code=corp_code, stock_code=stock_code or '', stock_name=stock_name or '')
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DART API error
2025-07-29 16:51:18,071 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:51:18,075 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4583124757, username=testuser_4583124757
2025-07-29 16:51:18,081 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=35, telegram_id=4583124757
2025-07-29 16:51:18,313 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:18,559 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:18,563 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9827778383, username=testuser_9827778383
2025-07-29 16:51:18,569 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=37, telegram_id=9827778383
2025-07-29 16:51:18,812 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:18,819 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:18,823 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7748697073, username=testuser_7748697073
2025-07-29 16:51:18,830 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=39, telegram_id=7748697073
2025-07-29 16:51:19,074 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:19,433 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 16:51:19,439 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6010615240, username=testuser_6010615240
2025-07-29 16:51:19,449 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=41, telegram_id=6010615240
2025-07-29 16:51:19,695 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:19,943 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 16:51:19,948 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2129829009, username=testuser_2129829009
2025-07-29 16:51:19,956 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=43, telegram_id=2129829009
2025-07-29 16:51:20,206 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:20,457 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:20,462 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8621201518, username=testuser_8621201518
2025-07-29 16:51:20,469 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=45, telegram_id=8621201518
2025-07-29 16:51:20,722 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:20,727 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:20,732 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2356442631, username=testuser_2356442631
2025-07-29 16:51:20,738 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=47, telegram_id=2356442631
2025-07-29 16:51:20,980 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:21,232 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 16:51:21,232 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 16:51:21,238 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9331014433, username=testuser_9331014433
2025-07-29 16:51:21,245 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=49, telegram_id=9331014433
2025-07-29 16:51:21,491 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:21,746 - src.api.routers.admin - ERROR - [trigger_job] 잡 실행 실패: test_job - Job execution failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 175, in trigger_job
    job.func(*job.args, **job.kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: Job execution failed

2025-07-29 16:51:21,746 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:51:21,753 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1577941775, username=testuser_1577941775
2025-07-29 16:51:21,760 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=51, telegram_id=1577941775
2025-07-29 16:51:22,008 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:22,255 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:22,260 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9669785474, username=testuser_9669785474
2025-07-29 16:51:22,270 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=53, telegram_id=9669785474
2025-07-29 16:51:22,526 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:22,533 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:22,539 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9290194202, username=testuser_9290194202
2025-07-29 16:51:22,547 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=55, telegram_id=9290194202
2025-07-29 16:51:22,792 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:23,045 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 16:51:23,047 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 200 OK"
2025-07-29 16:51:23,052 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3889334060, username=testuser_3889334060
2025-07-29 16:51:23,061 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=57, telegram_id=3889334060
2025-07-29 16:51:23,306 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:23,552 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 16:51:23,552 - src.api.routers.admin - ERROR - 공시 확인 잡 수동 실행 중 오류 발생: Disclosure check failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 193, in trigger_check_disclosures_job
    await stock_service.check_and_notify_new_disclosures(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: Disclosure check failed
2025-07-29 16:51:23,553 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:51:23,558 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5722029645, username=testuser_5722029645
2025-07-29 16:51:23,566 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=59, telegram_id=5722029645
2025-07-29 16:51:23,804 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:24,044 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:24,050 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3466754624, username=testuser_3466754624
2025-07-29 16:51:24,056 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=61, telegram_id=3466754624
2025-07-29 16:51:24,292 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:24,299 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:24,305 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7867421049, username=testuser_7867421049
2025-07-29 16:51:24,311 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=63, telegram_id=7867421049
2025-07-29 16:51:24,563 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:24,813 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:24,816 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=65, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:24,826 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=1, user_id=65, symbol=005930
2025-07-29 16:51:24,827 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:24,833 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6410775450, username=testuser_6410775450
2025-07-29 16:51:24,839 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=66, telegram_id=6410775450
2025-07-29 16:51:25,082 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:25,088 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:25,094 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9629907456, username=testuser_9629907456
2025-07-29 16:51:25,101 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=68, telegram_id=9629907456
2025-07-29 16:51:25,337 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:25,581 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:25,583 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 16:51:25,587 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5769411957, username=testuser_5769411957
2025-07-29 16:51:25,593 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=71, telegram_id=5769411957
2025-07-29 16:51:25,827 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:26,077 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:26,078 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:26,083 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=2, user_id=73, symbol=005930
2025-07-29 16:51:26,085 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:26,088 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:26,090 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=035720, target_price=50000.0, condition=lte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:26,097 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=3, user_id=73, symbol=035720
2025-07-29 16:51:26,099 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:26,101 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:26,103 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 조회 시도.
2025-07-29 16:51:26,106 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 2개 조회됨.
2025-07-29 16:51:26,108 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:26,113 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9789407197, username=testuser_9789407197
2025-07-29 16:51:26,118 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=74, telegram_id=9789407197
2025-07-29 16:51:26,419 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:26,672 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:26,673 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 조회 시도.
2025-07-29 16:51:26,674 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 0개 조회됨.
2025-07-29 16:51:26,676 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:26,681 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9808399772, username=testuser_9808399772
2025-07-29 16:51:26,687 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=77, telegram_id=9808399772
2025-07-29 16:51:26,782 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:26,786 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:26,790 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2330235692, username=testuser_2330235692
2025-07-29 16:51:26,796 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=79, telegram_id=2330235692
2025-07-29 16:51:27,029 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:27,264 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:27,265 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=81, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:27,270 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=4, user_id=81, symbol=005930
2025-07-29 16:51:27,271 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:27,275 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:27,275 - src.api.services.price_alert_service - DEBUG - 사용자(81)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:51:27,278 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=4
2025-07-29 16:51:27,280 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/81/symbol/005930 "HTTP/1.1 200 OK"
2025-07-29 16:51:27,284 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4954736157, username=testuser_4954736157
2025-07-29 16:51:27,289 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=82, telegram_id=4954736157
2025-07-29 16:51:27,519 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:27,752 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:27,753 - src.api.services.price_alert_service - DEBUG - 사용자(84)와 종목(NONEXISTENT)으로 가격 알림 조회 시도.
2025-07-29 16:51:27,754 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=84, symbol=NONEXISTENT
2025-07-29 16:51:27,755 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/84/symbol/NONEXISTENT "HTTP/1.1 404 Not Found"
2025-07-29 16:51:27,760 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4628016166, username=testuser_4628016166
2025-07-29 16:51:27,766 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=85, telegram_id=4628016166
2025-07-29 16:51:27,993 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:28,223 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:28,224 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=87, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:28,229 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=5, user_id=87, symbol=005930
2025-07-29 16:51:28,231 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:28,233 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:28,237 - src.api.services.price_alert_service - DEBUG - 가격 알림(5) 수정 시도: update_data={'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 16:51:28,239 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:51:28,240 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 16:51:28,240 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:51:28,247 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:51:28,248 - src.api.services.price_alert_service - INFO - 가격 알림(5) 수정 성공.
2025-07-29 16:51:28,250 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/5 "HTTP/1.1 200 OK"
2025-07-29 16:51:28,254 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2731320690, username=testuser_2731320690
2025-07-29 16:51:28,260 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=88, telegram_id=2731320690
2025-07-29 16:51:28,483 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:28,715 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:28,716 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=90, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:28,722 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=6, user_id=90, symbol=005930
2025-07-29 16:51:28,724 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:28,727 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/6 "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:28,732 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6543934334, username=testuser_6543934334
2025-07-29 16:51:28,739 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=91, telegram_id=6543934334
2025-07-29 16:51:28,971 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:29,207 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:29,209 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 16:51:29,210 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 16:51:29,212 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 16:51:29,216 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6006888757, username=testuser_6006888757
2025-07-29 16:51:29,222 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=94, telegram_id=6006888757
2025-07-29 16:51:29,458 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:29,920 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:29,921 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=96, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:29,926 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=7, user_id=96, symbol=005930
2025-07-29 16:51:29,928 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:29,931 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:29,932 - src.api.services.price_alert_service - DEBUG - 가격 알림(7) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 16:51:29,934 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:51:29,934 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0}
2025-07-29 16:51:29,934 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:51:29,939 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:51:29,940 - src.api.services.price_alert_service - INFO - 가격 알림(7) 수정 성공.
2025-07-29 16:51:29,942 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/7 "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:29,947 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1085667523, username=testuser_1085667523
2025-07-29 16:51:29,953 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=98, telegram_id=1085667523
2025-07-29 16:51:30,204 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:30,440 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:30,440 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=100, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:30,446 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=8, user_id=100, symbol=005930
2025-07-29 16:51:30,448 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:30,451 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:30,454 - src.api.services.price_alert_service - DEBUG - 가격 알림(8) 삭제 시도.
2025-07-29 16:51:30,460 - src.api.services.price_alert_service - INFO - 가격 알림(8) 삭제 성공.
2025-07-29 16:51:30,462 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/8 "HTTP/1.1 200 OK"
2025-07-29 16:51:30,469 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1467817409, username=testuser_1467817409
2025-07-29 16:51:30,476 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=101, telegram_id=1467817409
2025-07-29 16:51:30,723 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:30,963 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:30,964 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=103, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:30,969 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=9, user_id=103, symbol=005930
2025-07-29 16:51:30,970 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:30,972 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/9 "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:30,976 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1142489708, username=testuser_1142489708
2025-07-29 16:51:30,982 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=104, telegram_id=1142489708
2025-07-29 16:51:31,219 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:31,464 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:31,467 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 삭제 시도.
2025-07-29 16:51:31,468 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 16:51:31,470 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 16:51:31,475 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5086290191, username=testuser_5086290191
2025-07-29 16:51:31,481 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=107, telegram_id=5086290191
2025-07-29 16:51:31,709 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:32,170 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:32,171 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=109, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:32,176 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=10, user_id=109, symbol=005930
2025-07-29 16:51:32,178 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:32,181 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:32,185 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/10 "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:32,189 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3802940605, username=testuser_3802940605
2025-07-29 16:51:32,195 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=111, telegram_id=3802940605
2025-07-29 16:51:32,424 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:32,431 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 16:51:32,437 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9911567006, username=testuser_9911567006
2025-07-29 16:51:32,443 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=113, telegram_id=9911567006
2025-07-29 16:51:32,677 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:32,682 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 16:51:32,688 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:32,691 - httpx - INFO - HTTP Request: GET http://testserver/ "HTTP/1.1 200 OK"
2025-07-29 16:51:32,694 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8097499011, username=testuser_8097499011
2025-07-29 16:51:32,699 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=115, telegram_id=8097499011
2025-07-29 16:51:32,928 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:32,933 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:51:32,940 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:51:32,940 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 16:51:32,946 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 16:51:32,946 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 16:51:32,949 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 16:51:32,954 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3607982503, username=testuser_3607982503
2025-07-29 16:51:32,960 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=117, telegram_id=3607982503
2025-07-29 16:51:33,204 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:33,207 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:51:33,210 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=INVALID
2025-07-29 16:51:33,211 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=INVALID, days=40
2025-07-29 16:51:33,212 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 16:51:33,212 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 16:51:33,213 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 16:51:33,218 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9553148843, username=testuser_9553148843
2025-07-29 16:51:33,223 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=119, telegram_id=9553148843
2025-07-29 16:51:33,459 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:33,464 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:51:33,467 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 16:51:33,477 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7369134342, username=testuser_7369134342
2025-07-29 16:51:33,485 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=121, telegram_id=7369134342
2025-07-29 16:51:33,721 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:33,957 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=123, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 16:51:33,961 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 16:51:33,963 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:51:33,965 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/123 "HTTP/1.1 200 OK"
2025-07-29 16:51:33,973 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8104704834, username=testuser_8104704834
2025-07-29 16:51:33,979 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=124, telegram_id=8104704834
2025-07-29 16:51:34,214 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:34,220 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=99999, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 16:51:34,223 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 16:51:34,224 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:51:34,226 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/99999 "HTTP/1.1 200 OK"
2025-07-29 16:51:34,232 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4858453332, username=testuser_4858453332
2025-07-29 16:51:34,239 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=126, telegram_id=4858453332
2025-07-29 16:51:34,474 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:34,717 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=128, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 16:51:34,719 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 16:51:34,720 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:51:34,721 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/128 "HTTP/1.1 200 OK"
2025-07-29 16:51:34,726 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7214325411, username=testuser_7214325411
2025-07-29 16:51:34,732 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=129, telegram_id=7214325411
2025-07-29 16:51:35,051 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:35,315 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=1, page_size=5, symbol=None, prediction=None
2025-07-29 16:51:35,317 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 16:51:35,319 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 1, 페이지 크기 5).
2025-07-29 16:51:35,320 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=1&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 16:51:35,322 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=2, page_size=5, symbol=None, prediction=None
2025-07-29 16:51:35,324 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 16:51:35,325 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 2, 페이지 크기 5).
2025-07-29 16:51:35,327 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=2&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 16:51:35,334 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3202871781, username=testuser_3202871781
2025-07-29 16:51:35,341 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=132, telegram_id=3202871781
2025-07-29 16:51:35,576 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:35,829 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=134, page=1, page_size=10, symbol=005930, prediction=None
2025-07-29 16:51:35,830 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 16:51:35,834 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 16:51:35,837 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:51:35,839 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/134?symbol=005930 "HTTP/1.1 200 OK"
2025-07-29 16:51:35,846 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8846863453, username=testuser_8846863453
2025-07-29 16:51:35,853 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=135, telegram_id=8846863453
2025-07-29 16:51:36,084 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:36,334 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=137, page=1, page_size=10, symbol=None, prediction=상승
2025-07-29 16:51:36,335 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=상승
2025-07-29 16:51:36,338 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 16:51:36,340 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:51:36,342 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/137?prediction=%EC%83%81%EC%8A%B9 "HTTP/1.1 200 OK"
2025-07-29 16:51:36,348 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3298992274, username=testuser_3298992274
2025-07-29 16:51:36,354 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=138, telegram_id=3298992274
2025-07-29 16:51:36,585 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:36,825 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=140, page=1, page_size=10, symbol=005930, prediction=유지
2025-07-29 16:51:36,826 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 16:51:36,826 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=유지
2025-07-29 16:51:36,829 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 16:51:36,831 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:51:36,833 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/140?symbol=005930&prediction=%EC%9C%A0%EC%A7%80 "HTTP/1.1 200 OK"
2025-07-29 16:51:36,839 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5666338747, username=testuser_5666338747
2025-07-29 16:51:36,844 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=141, telegram_id=5666338747
2025-07-29 16:51:37,080 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:37,090 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=143, symbol=005930, trade_type=buy
2025-07-29 16:51:37,091 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 16:51:37,093 - src.api.services.stock_service - WARNING - 현재가 없음: 005930. 임시 가격 생성.
2025-07-29 16:51:37,093 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: 153129
2025-07-29 16:51:37,098 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=143, symbol=005930, trade_type=buy
2025-07-29 16:51:37,100 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 16:51:37,104 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=143
2025-07-29 16:51:37,107 - src.api.routers.simulated_trade - DEBUG - 사용자(143)의 모의매매 이력 1건 조회됨.
2025-07-29 16:51:37,108 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 16:51:37,109 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/143 "HTTP/1.1 200 OK"
2025-07-29 16:51:37,116 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8140746837, username=testuser_8140746837
2025-07-29 16:51:37,122 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=144, telegram_id=8140746837
2025-07-29 16:51:37,360 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:37,383 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 16:51:37,393 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7256368150, username=testuser_7256368150
2025-07-29 16:51:37,400 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=146, telegram_id=7256368150
2025-07-29 16:51:37,657 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:37,665 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 16:51:37,674 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3530652217, username=testuser_3530652217
2025-07-29 16:51:37,682 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=148, telegram_id=3530652217
2025-07-29 16:51:37,929 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:37,946 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%82%BC%EC%84%B1%EC%A0%84%EC%9E%90 "HTTP/1.1 200 OK"
2025-07-29 16:51:37,954 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4500095411, username=testuser_4500095411
2025-07-29 16:51:37,960 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=150, telegram_id=4500095411
2025-07-29 16:51:38,192 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:38,210 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=035720 "HTTP/1.1 200 OK"
2025-07-29 16:51:38,220 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4186529078, username=testuser_4186529078
2025-07-29 16:51:38,227 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=152, telegram_id=4186529078
2025-07-29 16:51:38,459 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:38,476 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=sk%ED%95%98%EC%9D%B4%EB%8B%89%EC%8A%A4 "HTTP/1.1 200 OK"
2025-07-29 16:51:38,485 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7230607113, username=testuser_7230607113
2025-07-29 16:51:38,491 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=154, telegram_id=7230607113
2025-07-29 16:51:38,726 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:38,736 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%97%86%EB%8A%94%EC%A2%85%EB%AA%A9 "HTTP/1.1 200 OK"
2025-07-29 16:51:38,741 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3790481712, username=testuser_3790481712
2025-07-29 16:51:38,746 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=156, telegram_id=3790481712
2025-07-29 16:51:38,977 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:38,984 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query= "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 16:51:38,989 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9622388470, username=testuser_9622388470
2025-07-29 16:51:38,994 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=158, telegram_id=9622388470
2025-07-29 16:51:39,227 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:39,234 - httpx - INFO - HTTP Request: GET http://testserver/symbols/005930/current_price_and_change "HTTP/1.1 200 OK"
2025-07-29 16:51:39,240 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1992904762, username=testuser_1992904762
2025-07-29 16:51:39,245 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=160, telegram_id=1992904762
2025-07-29 16:51:39,480 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:39,488 - httpx - INFO - HTTP Request: GET http://testserver/symbols/NONEXISTENT/current_price_and_change "HTTP/1.1 404 Not Found"
2025-07-29 16:51:39,494 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4499118994, username=testuser_4499118994
2025-07-29 16:51:39,501 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=162, telegram_id=4499118994
2025-07-29 16:51:39,750 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:39,999 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 16:51:40,004 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5313302683, username=testuser_5313302683
2025-07-29 16:51:40,012 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=165, telegram_id=5313302683
2025-07-29 16:51:40,255 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:40,515 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 400 Bad Request"
2025-07-29 16:51:40,520 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2778889636, username=testuser_2778889636
2025-07-29 16:51:40,526 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=168, telegram_id=2778889636
2025-07-29 16:51:40,798 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:41,298 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 16:51:41,305 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1423687767, username=testuser_1423687767
2025-07-29 16:51:41,313 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=171, telegram_id=1423687767
2025-07-29 16:51:41,557 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:41,567 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 16:51:41,573 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4394607266, username=testuser_4394607266
2025-07-29 16:51:41,579 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=173, telegram_id=4394607266
2025-07-29 16:51:41,829 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:42,325 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 16:51:42,332 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6302676479, username=testuser_6302676479
2025-07-29 16:51:42,340 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=176, telegram_id=6302676479
2025-07-29 16:51:42,594 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:42,850 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 178
2025-07-29 16:51:42,854 - src.api.services.user_service - DEBUG - User found by id: user_id=178
2025-07-29 16:51:42,860 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 16:51:42,864 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8178716124, username=testuser_8178716124
2025-07-29 16:51:42,870 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=179, telegram_id=8178716124
2025-07-29 16:51:43,183 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:43,189 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:43,196 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8356060306, username=testuser_8356060306
2025-07-29 16:51:43,203 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=181, telegram_id=8356060306
2025-07-29 16:51:43,446 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:43,694 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 183
2025-07-29 16:51:43,697 - src.api.services.user_service - DEBUG - User found by id: user_id=183
2025-07-29 16:51:43,712 - httpx - INFO - HTTP Request: PUT http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 16:51:43,718 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4728735665, username=testuser_4728735665
2025-07-29 16:51:43,723 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=184, telegram_id=4728735665
2025-07-29 16:51:43,964 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:43,980 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 16:51:43,985 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1097728833, username=testuser_1097728833
2025-07-29 16:51:43,991 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=187, telegram_id=1097728833
2025-07-29 16:51:44,234 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:44,508 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 16:51:44,514 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1227072926, username=testuser_1227072926
2025-07-29 16:51:44,521 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=190, telegram_id=1227072926
2025-07-29 16:51:44,774 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:45,021 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/192 "HTTP/1.1 200 OK"
2025-07-29 16:51:45,025 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7020462219, username=testuser_7020462219
2025-07-29 16:51:45,031 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=193, telegram_id=7020462219
2025-07-29 16:51:45,268 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:45,276 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/99999 "HTTP/1.1 404 Not Found"
2025-07-29 16:51:45,281 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2537060991, username=testuser_2537060991
2025-07-29 16:51:45,287 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=195, telegram_id=2537060991
2025-07-29 16:51:45,531 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:46,002 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 197
2025-07-29 16:51:46,005 - src.api.services.user_service - DEBUG - User found by id: user_id=197
2025-07-29 16:51:46,020 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 200 OK"
2025-07-29 16:51:46,025 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8468263640, username=testuser_8468263640
2025-07-29 16:51:46,031 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=199, telegram_id=8468263640
2025-07-29 16:51:46,287 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:46,537 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 201
2025-07-29 16:51:46,539 - src.api.services.user_service - DEBUG - User found by id: user_id=201
2025-07-29 16:51:46,541 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:46,547 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1492868425, username=testuser_1492868425
2025-07-29 16:51:46,555 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=202, telegram_id=1492868425
2025-07-29 16:51:46,823 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:46,834 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=204, symbol=005930
2025-07-29 16:51:46,845 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=204, symbol=005930
2025-07-29 16:51:46,847 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 16:51:46,852 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 시도: user_id=204
2025-07-29 16:51:46,856 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 성공: user_id=204, 1개 종목.
2025-07-29 16:51:46,858 - httpx - INFO - HTTP Request: GET http://testserver/watchlist/get/204 "HTTP/1.1 200 OK"
2025-07-29 16:51:46,865 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:46,868 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:51:46,868 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:51:46,874 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:46,877 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12345
2025-07-29 16:51:46,881 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=1, telegram_id=12345
2025-07-29 16:51:46,881 - src.api.services.price_alert_service - DEBUG - 사용자(1)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:51:46,886 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=1
2025-07-29 16:51:46,886 - src.api.services.price_alert_service - DEBUG - 가격 알림(1) 수정 시도: update_data={'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 16:51:46,889 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:51:46,890 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 16:51:46,890 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:51:46,893 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:51:46,893 - src.api.services.price_alert_service - INFO - 가격 알림(1) 수정 성공.
2025-07-29 16:51:46,895 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:51:46,902 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:51:46,903 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:51:46,908 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:46,909 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 16:51:46,912 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 16:51:46,913 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:51:46,915 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 16:51:46,916 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 16:51:46,917 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:51:46,918 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 16:51:46,918 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:51:46,929 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:51:46,929 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 16:51:46,931 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:51:46,935 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:46,936 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 16:51:46,939 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 16:51:46,939 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:51:46,941 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 16:51:46,941 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 16:51:46,943 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:51:46,943 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 16:51:46,944 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:51:46,951 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:51:46,951 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 16:51:46,953 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:51:46,966 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7877467834, username=testuser_7877467834
2025-07-29 16:51:46,975 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=205, telegram_id=7877467834
2025-07-29 16:51:46,978 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:46,981 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:51:46,982 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:46,985 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 7877467834
2025-07-29 16:51:46,989 - src.api.services.user_service - DEBUG - User not found for telegram_id: 7877467834
2025-07-29 16:51:46,990 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7877467834, username=testuser_7877467834
2025-07-29 16:51:46,998 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=196, telegram_id=7877467834
2025-07-29 16:51:46,998 - src.api.services.price_alert_service - DEBUG - 사용자(196)와 종목(GOOG)으로 가격 알림 조회 시도.
2025-07-29 16:51:46,999 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=196, symbol=GOOG
2025-07-29 16:51:46,999 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=196, symbol=GOOG, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:47,006 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=195, user_id=196, symbol=GOOG
2025-07-29 16:51:47,008 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:51:47,010 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:51:47,016 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1779291909, username=testuser_1779291909
2025-07-29 16:51:47,023 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=206, telegram_id=1779291909
2025-07-29 16:51:47,026 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,030 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:51:47,031 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:47,032 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 1779291909
2025-07-29 16:51:47,034 - src.api.services.user_service - DEBUG - User not found for telegram_id: 1779291909
2025-07-29 16:51:47,034 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1779291909, username=telegram_user_1779291909
2025-07-29 16:51:47,042 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=197, telegram_id=1779291909
2025-07-29 16:51:47,043 - src.api.services.price_alert_service - DEBUG - 사용자(197)와 종목(MSFT)으로 가격 알림 조회 시도.
2025-07-29 16:51:47,045 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=197, symbol=MSFT
2025-07-29 16:51:47,045 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=197, symbol=MSFT, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:47,052 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=196, user_id=197, symbol=MSFT
2025-07-29 16:51:47,054 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:51:47,057 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:51:47,064 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6179910988, username=testuser_6179910988
2025-07-29 16:51:47,072 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=207, telegram_id=6179910988
2025-07-29 16:51:47,078 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,081 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:51:47,082 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:47,082 - src.api.routers.bot_router - DEBUG - Before toggle: existing_alert.notify_on_disclosure = True
2025-07-29 16:51:47,083 - src.api.routers.bot_router - DEBUG - Calculated new_status: False
2025-07-29 16:51:47,083 - src.api.routers.bot_router - DEBUG - After update_alert call: updated_alert_orm.notify_on_disclosure = False
2025-07-29 16:51:47,084 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:51:47,086 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:51:47,093 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1813104434, username=testuser_1813104434
2025-07-29 16:51:47,100 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=208, telegram_id=1813104434
2025-07-29 16:51:47,103 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,108 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:51:47,109 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:47,110 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 1813104434
2025-07-29 16:51:47,111 - src.api.services.user_service - DEBUG - User not found for telegram_id: 1813104434
2025-07-29 16:51:47,112 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1813104434, username=telegram_user_1813104434
2025-07-29 16:51:47,116 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=198, telegram_id=1813104434
2025-07-29 16:51:47,117 - src.api.services.price_alert_service - DEBUG - 사용자(198)와 종목(NFLX)으로 가격 알림 조회 시도.
2025-07-29 16:51:47,118 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=198, symbol=NFLX
2025-07-29 16:51:47,118 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=198, symbol=NFLX, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:47,124 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=197, user_id=198, symbol=NFLX
2025-07-29 16:51:47,125 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:51:47,127 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:51:47,132 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9963877916, username=testuser_9963877916
2025-07-29 16:51:47,138 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=209, telegram_id=9963877916
2025-07-29 16:51:47,141 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,144 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:51:47,144 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:47,145 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 9963877916
2025-07-29 16:51:47,147 - src.api.services.user_service - DEBUG - User not found for telegram_id: 9963877916
2025-07-29 16:51:47,148 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9963877916, username=testuser_9963877916
2025-07-29 16:51:47,156 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=199, telegram_id=9963877916
2025-07-29 16:51:47,157 - src.api.services.price_alert_service - DEBUG - 사용자(199)와 종목(NVDA)으로 가격 알림 조회 시도.
2025-07-29 16:51:47,158 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=199, symbol=NVDA
2025-07-29 16:51:47,160 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=199, symbol=NVDA, target_price=1000.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:47,167 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=198, user_id=199, symbol=NVDA
2025-07-29 16:51:47,169 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:51:47,172 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:51:47,180 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2295460914, username=testuser_2295460914
2025-07-29 16:51:47,189 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=210, telegram_id=2295460914
2025-07-29 16:51:47,194 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,197 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:51:47,198 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:47,199 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 2295460914
2025-07-29 16:51:47,202 - src.api.services.user_service - DEBUG - User not found for telegram_id: 2295460914
2025-07-29 16:51:47,202 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2295460914, username=telegram_user_2295460914
2025-07-29 16:51:47,208 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=200, telegram_id=2295460914
2025-07-29 16:51:47,208 - src.api.services.price_alert_service - DEBUG - 사용자(200)와 종목(GOOGL)으로 가격 알림 조회 시도.
2025-07-29 16:51:47,210 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=200, symbol=GOOGL
2025-07-29 16:51:47,210 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=200, symbol=GOOGL, target_price=110.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=weekly
2025-07-29 16:51:47,216 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=199, user_id=200, symbol=GOOGL
2025-07-29 16:51:47,218 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:51:47,221 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:51:47,228 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1959456069, username=testuser_1959456069
2025-07-29 16:51:47,237 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=211, telegram_id=1959456069
2025-07-29 16:51:47,242 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,246 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:51:47,247 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:47,249 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 1959456069
2025-07-29 16:51:47,251 - src.api.services.user_service - DEBUG - User not found for telegram_id: 1959456069
2025-07-29 16:51:47,252 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1959456069, username=telegram_user_1959456069
2025-07-29 16:51:47,260 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=201, telegram_id=1959456069
2025-07-29 16:51:47,260 - src.api.services.price_alert_service - DEBUG - 사용자(201)와 종목(FB)으로 가격 알림 조회 시도.
2025-07-29 16:51:47,263 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=201, symbol=FB
2025-07-29 16:51:47,264 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=201, symbol=FB, target_price=300.0, condition=above, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:47,272 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=200, user_id=201, symbol=FB
2025-07-29 16:51:47,275 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:51:47,278 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:51:47,283 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,283 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,294 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,300 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,302 - src.common.dart_utils - ERROR - DART CORPCODE.xml 요청 실패: Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 25, in dart_get_all_stocks
    resp = await session.get(url, timeout=60)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 16:51:47,308 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,439 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,448 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,457 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,461 - src.common.dart_utils - ERROR - DART 공시 조회 API 요청 실패 (corp_code: 00123456): Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 79, in dart_get_disclosures
    resp = await session.get(url, params=params, timeout=10)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 16:51:47,469 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,473 - src.common.dart_utils - ERROR - DART 공시 API가 오류를 반환했습니다. status: 001, message: API 호출 오류, corp_code: 00123456
2025-07-29 16:51:47,605 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4379272337, username=testuser_4379272337
2025-07-29 16:51:47,613 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=212, telegram_id=4379272337
2025-07-29 16:51:47,889 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:48,155 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 16:51:48,412 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 16:51:48,418 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=214, symbol=005930
2025-07-29 16:51:48,425 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=214, symbol=005930
2025-07-29 16:51:48,427 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 16:51:48,432 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 214
2025-07-29 16:51:48,434 - src.api.services.user_service - DEBUG - User found by id: user_id=214
2025-07-29 16:51:48,435 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:48,435 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=214, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:48,442 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=11, user_id=214, symbol=005930
2025-07-29 16:51:48,444 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:48,446 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:51:48,449 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:51:48,449 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 16:51:48,452 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 16:51:48,453 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 16:51:48,458 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 16:51:48,462 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=214, symbol=005930, trade_type=buy
2025-07-29 16:51:48,462 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 16:51:48,465 - src.api.services.stock_service - WARNING - 현재가 없음: 005930. 임시 가격 생성.
2025-07-29 16:51:48,466 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: 60410
2025-07-29 16:51:48,471 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=214, symbol=005930, trade_type=buy
2025-07-29 16:51:48,474 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 16:51:48,477 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=214
2025-07-29 16:51:48,480 - src.api.routers.simulated_trade - DEBUG - 사용자(214)의 모의매매 이력 1건 조회됨.
2025-07-29 16:51:48,480 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 16:51:48,482 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/214 "HTTP/1.1 200 OK"
2025-07-29 16:51:48,492 - src.api.main - INFO - [APScheduler] 가격 알림 체크 잡 실행: 2025-07-29 16:51:48.492336
2025-07-29 16:51:48,492 - src.api.main - DEBUG - 활성 알림 수: 3
2025-07-29 16:51:48,493 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 16:51:48,495 - src.api.main - DEBUG - 종목 정상종목 현재가: 110
2025-07-29 16:51:48,497 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='140500512581680'>, 목표 가격: 100, 조건: gte, 반복 주기: <MagicMock name='mock.repeat_interval' id='140500512638624'>
2025-07-29 16:51:48,497 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목, 현재가: 110, 목표가: 100
2025-07-29 16:51:48,501 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='140500514976768'>)
2025-07-29 16:51:48,502 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 16:51:48,502 - src.api.main - DEBUG - 종목 오류종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 16:51:48,502 - src.api.main - ERROR - 가격 알림 확인 중 '오류종목' 처리 오류: 현재가 조회 실패
Traceback (most recent call last):
  File "/app/src/api/main.py", line 145, in check_price_alerts_job
    price_data = stock_service.get_current_price_and_change(symbol, db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1179, in _execute_mock_call
    result = effect(*args, **kwargs)
  File "/app/src/api/tests/test_main_jobs.py", line 34, in get_current_price_side_effect
    raise ValueError("현재가 조회 실패")
ValueError: 현재가 조회 실패
2025-07-29 16:51:48,503 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 16:51:48,503 - src.api.main - DEBUG - 종목 정상종목2 현재가: 290
2025-07-29 16:51:48,504 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='140500532217840'>, 목표 가격: 300, 조건: lte, 반복 주기: <MagicMock name='mock.repeat_interval' id='140500513535984'>
2025-07-29 16:51:48,504 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목2, 현재가: 290, 목표가: 300
2025-07-29 16:51:48,505 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='140500514976768'>)
2025-07-29 16:51:48,505 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 16:51:48,505 - src.api.main - DEBUG - 모든 가격 알림 체크 및 DB 커밋 완료.
2025-07-29 16:51:48,510 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:51:48,510 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(10일)
2025-07-29 16:51:48,513 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:51:48,514 - src.api.services.predict_service - ERROR - 예측 불가: 데이터 분석 실패
2025-07-29 16:51:48,516 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:51:48,517 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:51:48,523 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 상승 (24일 지속). 금일 변동: 보합. 최근 20일간 상승일: 19일, 하락일: 0일.
2025-07-29 16:51:48,523 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 16:51:48,526 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:51:48,527 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:51:48,532 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 하락 (24일 지속). 금일 변동: 보합. 최근 20일간 상승일: 0일, 하락일: 19일.
2025-07-29 16:51:48,532 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 16:51:48,536 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:51:48,536 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:51:48,543 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 횡보 (1일 지속). 금일 변동: 보합. 최근 20일간 상승일: 12일, 하락일: 7일.
2025-07-29 16:51:48,544 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 16:51:48,548 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:51:48,549 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:51:48,557 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=buy, reason=최근 추세: 하락 (1일 지속). 금일 변동: 횡보. 최근 20일간 상승일: 2일, 하락일: 17일. (저점 횡보 패턴 감지)
2025-07-29 16:51:48,557 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: buy
2025-07-29 16:51:48,562 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:51:48,562 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 22개 데이터.
2025-07-29 16:51:48,568 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, reason=최근 추세: 상승 (21일 지속). 금일 변동: 횡보. 최근 20일간 상승일: 19일, 하락일: 0일. (급등 후 횡보 패턴 감지)
2025-07-29 16:51:48,569 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 16:51:48,572 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:48,579 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 16:51:48,579 - src.api.services.stock_service - INFO - 신규 공시가 없습니다. (DB 기준: 202301010000001)
2025-07-29 16:51:48,585 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:48,591 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 16:51:48,598 - src.api.services.stock_service - INFO - 최초 실행. 기준 접수번호를 202301020000001로 DB에 설정합니다.
2025-07-29 16:51:48,700 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:48,707 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 16:51:48,707 - src.api.services.stock_service - INFO - 2건의 신규 공시를 발견했습니다.
2025-07-29 16:51:48,708 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 16:51:48,710 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 16:51:48,710 - src.api.services.stock_service - INFO - 마지막 확인 접수번호를 202301020000002로 DB에 갱신합니다.
2025-07-29 16:51:48,800 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:48,806 - src.api.services.stock_service - CRITICAL - DART API 사용 한도를 초과했습니다: [020] 사용 한도 초과
2025-07-29 16:51:48,820 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:48,826 - src.api.services.stock_service - ERROR - DART 공시 조회 중 API 오류 발생: [999] 기타 API 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 39, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
src.common.exceptions.DartApiError: [999] 기타 API 오류
2025-07-29 16:51:48,839 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:48,848 - src.api.services.stock_service - ERROR - 신규 공시 확인 및 알림 작업 중 예상치 못한 오류 발생: 예상치 못한 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 39, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: 예상치 못한 오류
2025-07-29 16:52:38,294 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:52:38,300 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:52:38,303 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:52:38,303 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:52:38,304 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:52:38,304 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:52:39,207 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:39,211 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 16:52:39,216 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-07-29 16:52:39,217 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '<unknown>'
2025-07-29 16:52:39,218 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-07-29 16:52:39,479 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:39,482 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 16:52:39,718 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:39,721 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 16:52:39,955 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:39,957 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 16:52:39,959 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 16:52:39,961 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9626613260, username=testuser_9626613260
2025-07-29 16:52:39,974 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=1, telegram_id=9626613260
2025-07-29 16:52:40,218 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:40,486 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 200 OK"
2025-07-29 16:52:40,490 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2589948735, username=testuser_2589948735
2025-07-29 16:52:40,497 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=3, telegram_id=2589948735
2025-07-29 16:52:40,743 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:40,990 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:40,993 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7903469062, username=testuser_7903469062
2025-07-29 16:52:41,000 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=5, telegram_id=7903469062
2025-07-29 16:52:41,236 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:41,241 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:41,244 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9878293546, username=testuser_9878293546
2025-07-29 16:52:41,249 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=7, telegram_id=9878293546
2025-07-29 16:52:41,481 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:41,723 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 200 OK"
2025-07-29 16:52:41,727 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8991244088, username=testuser_8991244088
2025-07-29 16:52:41,734 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=9, telegram_id=8991244088
2025-07-29 16:52:41,964 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:42,206 - src.api.routers.admin - ERROR - /admin/update_master 서버 오류: DB connection error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 36, in update_stock_master
    result = await stock_service.update_stock_master(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DB connection error
2025-07-29 16:52:42,208 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:52:42,213 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8256812271, username=testuser_8256812271
2025-07-29 16:52:42,219 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=11, telegram_id=8256812271
2025-07-29 16:52:42,482 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:42,761 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:42,765 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3029266170, username=testuser_3029266170
2025-07-29 16:52:42,772 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=13, telegram_id=3029266170
2025-07-29 16:52:43,021 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:43,028 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:43,034 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7351893568, username=testuser_7351893568
2025-07-29 16:52:43,042 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=15, telegram_id=7351893568
2025-07-29 16:52:43,313 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:43,565 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 200 OK"
2025-07-29 16:52:43,570 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2788205584, username=testuser_2788205584
2025-07-29 16:52:43,577 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=17, telegram_id=2788205584
2025-07-29 16:52:43,817 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:44,059 - src.api.routers.admin - ERROR - /admin/update_price 서버 오류: API call failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 53, in update_daily_price
    result = await stock_service.update_daily_prices(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: API call failed
2025-07-29 16:52:44,061 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:52:44,065 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3283062181, username=testuser_3283062181
2025-07-29 16:52:44,073 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=19, telegram_id=3283062181
2025-07-29 16:52:44,314 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:44,579 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:44,584 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8668962007, username=testuser_8668962007
2025-07-29 16:52:44,591 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=21, telegram_id=8668962007
2025-07-29 16:52:44,834 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:44,842 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:44,848 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4132025116, username=testuser_4132025116
2025-07-29 16:52:44,855 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=23, telegram_id=4132025116
2025-07-29 16:52:45,088 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:45,334 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f70e47e7a60>
2025-07-29 16:52:45,335 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:52:45,338 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 200 OK"
2025-07-29 16:52:45,344 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2436143430, username=testuser_2436143430
2025-07-29 16:52:45,353 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=25, telegram_id=2436143430
2025-07-29 16:52:45,606 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:45,845 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f70e47fc9d0>
2025-07-29 16:52:45,846 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:52:45,847 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 200 OK"
2025-07-29 16:52:45,851 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9653232589, username=testuser_9653232589
2025-07-29 16:52:45,858 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=27, telegram_id=9653232589
2025-07-29 16:52:46,164 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:46,409 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f70e46cb8e0>
2025-07-29 16:52:46,410 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:52:46,411 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=%EC%B9%B4%EC%B9%B4%EC%98%A4 "HTTP/1.1 200 OK"
2025-07-29 16:52:46,417 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3229488963, username=testuser_3229488963
2025-07-29 16:52:46,425 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=29, telegram_id=3229488963
2025-07-29 16:52:46,660 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:47,000 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f70e4536920>
2025-07-29 16:52:47,000 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:52:47,001 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=0013456 "HTTP/1.1 200 OK"
2025-07-29 16:52:47,007 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5652841417, username=testuser_5652841417
2025-07-29 16:52:47,015 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=31, telegram_id=5652841417
2025-07-29 16:52:47,254 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:47,505 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f70e4537970>
2025-07-29 16:52:47,505 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:52:47,506 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=NONEXIST "HTTP/1.1 404 Not Found"
2025-07-29 16:52:47,511 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2733026704, username=testuser_2733026704
2025-07-29 16:52:47,519 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=33, telegram_id=2733026704
2025-07-29 16:52:47,760 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:48,002 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f70e592e0e0>
2025-07-29 16:52:48,003 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:52:48,003 - src.api.routers.admin - ERROR - /admin/update_disclosure 서버 오류: DART API error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 126, in update_disclosure
    result = await stock_service.update_disclosures(db, corp_code=corp_code, stock_code=stock_code or '', stock_name=stock_name or '')
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DART API error
2025-07-29 16:52:48,005 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:52:48,010 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3043175187, username=testuser_3043175187
2025-07-29 16:52:48,016 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=35, telegram_id=3043175187
2025-07-29 16:52:48,250 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:48,498 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:48,502 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3958682570, username=testuser_3958682570
2025-07-29 16:52:48,508 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=37, telegram_id=3958682570
2025-07-29 16:52:48,745 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:48,752 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:48,757 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9573860523, username=testuser_9573860523
2025-07-29 16:52:48,762 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=39, telegram_id=9573860523
2025-07-29 16:52:48,999 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:49,261 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 16:52:49,266 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3064006361, username=testuser_3064006361
2025-07-29 16:52:49,273 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=41, telegram_id=3064006361
2025-07-29 16:52:49,507 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:49,749 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 16:52:49,755 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1306569441, username=testuser_1306569441
2025-07-29 16:52:49,762 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=43, telegram_id=1306569441
2025-07-29 16:52:50,001 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:50,241 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:50,247 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8025156843, username=testuser_8025156843
2025-07-29 16:52:50,254 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=45, telegram_id=8025156843
2025-07-29 16:52:50,487 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:50,492 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:50,497 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5733295091, username=testuser_5733295091
2025-07-29 16:52:50,504 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=47, telegram_id=5733295091
2025-07-29 16:52:50,743 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:50,985 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 16:52:50,986 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 16:52:50,990 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9824992906, username=testuser_9824992906
2025-07-29 16:52:50,996 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=49, telegram_id=9824992906
2025-07-29 16:52:51,234 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:51,481 - src.api.routers.admin - ERROR - [trigger_job] 잡 실행 실패: test_job - Job execution failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 175, in trigger_job
    job.func(*job.args, **job.kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: Job execution failed

2025-07-29 16:52:51,482 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:52:51,486 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4274319598, username=testuser_4274319598
2025-07-29 16:52:51,494 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=51, telegram_id=4274319598
2025-07-29 16:52:51,733 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:51,984 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:51,989 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7681497399, username=testuser_7681497399
2025-07-29 16:52:51,996 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=53, telegram_id=7681497399
2025-07-29 16:52:52,240 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:52,245 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:52,251 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1327568253, username=testuser_1327568253
2025-07-29 16:52:52,258 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=55, telegram_id=1327568253
2025-07-29 16:52:52,500 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:52,737 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 16:52:52,738 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 200 OK"
2025-07-29 16:52:52,742 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3945652005, username=testuser_3945652005
2025-07-29 16:52:52,750 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=57, telegram_id=3945652005
2025-07-29 16:52:53,010 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:53,329 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 16:52:53,329 - src.api.routers.admin - ERROR - 공시 확인 잡 수동 실행 중 오류 발생: Disclosure check failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 193, in trigger_check_disclosures_job
    await stock_service.check_and_notify_new_disclosures(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: Disclosure check failed
2025-07-29 16:52:53,331 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:52:53,340 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8438879635, username=testuser_8438879635
2025-07-29 16:52:53,348 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=59, telegram_id=8438879635
2025-07-29 16:52:53,655 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:53,895 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:53,900 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1686466610, username=testuser_1686466610
2025-07-29 16:52:53,907 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=61, telegram_id=1686466610
2025-07-29 16:52:54,146 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:54,153 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:54,159 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4315813680, username=testuser_4315813680
2025-07-29 16:52:54,165 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=63, telegram_id=4315813680
2025-07-29 16:52:54,407 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:54,648 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:54,651 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=65, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:52:54,660 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=1, user_id=65, symbol=005930
2025-07-29 16:52:54,662 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:52:54,669 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2639229709, username=testuser_2639229709
2025-07-29 16:52:54,674 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=66, telegram_id=2639229709
2025-07-29 16:52:54,909 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:54,914 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:54,919 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9267291991, username=testuser_9267291991
2025-07-29 16:52:54,925 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=68, telegram_id=9267291991
2025-07-29 16:52:55,168 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:55,410 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:55,412 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 16:52:55,416 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1166279083, username=testuser_1166279083
2025-07-29 16:52:55,422 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=71, telegram_id=1166279083
2025-07-29 16:52:55,667 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:55,914 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:55,915 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:52:55,920 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=2, user_id=73, symbol=005930
2025-07-29 16:52:55,922 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:52:55,924 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:55,926 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=035720, target_price=50000.0, condition=lte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:52:55,931 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=3, user_id=73, symbol=035720
2025-07-29 16:52:55,933 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:52:55,935 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:55,938 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 조회 시도.
2025-07-29 16:52:55,940 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 2개 조회됨.
2025-07-29 16:52:55,942 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:52:55,948 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8706146985, username=testuser_8706146985
2025-07-29 16:52:55,956 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=74, telegram_id=8706146985
2025-07-29 16:52:56,199 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:56,295 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:56,296 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 조회 시도.
2025-07-29 16:52:56,298 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 0개 조회됨.
2025-07-29 16:52:56,299 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:52:56,305 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9106297261, username=testuser_9106297261
2025-07-29 16:52:56,311 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=77, telegram_id=9106297261
2025-07-29 16:52:56,548 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:56,552 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:56,556 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4479992524, username=testuser_4479992524
2025-07-29 16:52:56,561 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=79, telegram_id=4479992524
2025-07-29 16:52:56,797 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:57,045 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:57,046 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=81, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:52:57,051 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=4, user_id=81, symbol=005930
2025-07-29 16:52:57,052 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:52:57,056 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:57,056 - src.api.services.price_alert_service - DEBUG - 사용자(81)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:52:57,059 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=4
2025-07-29 16:52:57,061 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/81/symbol/005930 "HTTP/1.1 200 OK"
2025-07-29 16:52:57,066 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5099234413, username=testuser_5099234413
2025-07-29 16:52:57,071 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=82, telegram_id=5099234413
2025-07-29 16:52:57,298 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:57,534 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:57,534 - src.api.services.price_alert_service - DEBUG - 사용자(84)와 종목(NONEXISTENT)으로 가격 알림 조회 시도.
2025-07-29 16:52:57,536 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=84, symbol=NONEXISTENT
2025-07-29 16:52:57,537 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/84/symbol/NONEXISTENT "HTTP/1.1 404 Not Found"
2025-07-29 16:52:57,542 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2227422185, username=testuser_2227422185
2025-07-29 16:52:57,547 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=85, telegram_id=2227422185
2025-07-29 16:52:57,775 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:58,008 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:58,009 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=87, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:52:58,014 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=5, user_id=87, symbol=005930
2025-07-29 16:52:58,016 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:52:58,018 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:58,021 - src.api.services.price_alert_service - DEBUG - 가격 알림(5) 수정 시도: update_data={'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 16:52:58,024 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:52:58,025 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 16:52:58,025 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:52:58,031 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:52:58,032 - src.api.services.price_alert_service - INFO - 가격 알림(5) 수정 성공.
2025-07-29 16:52:58,035 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/5 "HTTP/1.1 200 OK"
2025-07-29 16:52:58,040 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1108905592, username=testuser_1108905592
2025-07-29 16:52:58,048 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=88, telegram_id=1108905592
2025-07-29 16:52:58,278 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:58,523 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:58,524 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=90, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:52:58,528 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=6, user_id=90, symbol=005930
2025-07-29 16:52:58,530 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:52:58,532 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/6 "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:58,537 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1709752574, username=testuser_1709752574
2025-07-29 16:52:58,544 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=91, telegram_id=1709752574
2025-07-29 16:52:58,772 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:59,004 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:59,005 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 16:52:59,006 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 16:52:59,008 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 16:52:59,012 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4067867393, username=testuser_4067867393
2025-07-29 16:52:59,017 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=94, telegram_id=4067867393
2025-07-29 16:52:59,249 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:59,703 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:59,704 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=96, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:52:59,709 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=7, user_id=96, symbol=005930
2025-07-29 16:52:59,710 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:52:59,712 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:59,713 - src.api.services.price_alert_service - DEBUG - 가격 알림(7) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 16:52:59,714 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:52:59,714 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0}
2025-07-29 16:52:59,714 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:52:59,719 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:52:59,719 - src.api.services.price_alert_service - INFO - 가격 알림(7) 수정 성공.
2025-07-29 16:52:59,721 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/7 "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:59,726 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7758227545, username=testuser_7758227545
2025-07-29 16:52:59,731 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=98, telegram_id=7758227545
2025-07-29 16:52:59,970 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:00,282 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:00,283 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=100, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:53:00,290 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=8, user_id=100, symbol=005930
2025-07-29 16:53:00,292 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:53:00,296 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:00,300 - src.api.services.price_alert_service - DEBUG - 가격 알림(8) 삭제 시도.
2025-07-29 16:53:00,306 - src.api.services.price_alert_service - INFO - 가격 알림(8) 삭제 성공.
2025-07-29 16:53:00,308 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/8 "HTTP/1.1 200 OK"
2025-07-29 16:53:00,315 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5411842215, username=testuser_5411842215
2025-07-29 16:53:00,321 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=101, telegram_id=5411842215
2025-07-29 16:53:00,561 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:00,800 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:00,801 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=103, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:53:00,806 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=9, user_id=103, symbol=005930
2025-07-29 16:53:00,808 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:53:00,811 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/9 "HTTP/1.1 403 Forbidden"
2025-07-29 16:53:00,815 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3571647723, username=testuser_3571647723
2025-07-29 16:53:00,821 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=104, telegram_id=3571647723
2025-07-29 16:53:01,055 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:01,289 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:01,291 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 삭제 시도.
2025-07-29 16:53:01,292 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 16:53:01,293 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 16:53:01,297 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1272725276, username=testuser_1272725276
2025-07-29 16:53:01,303 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=107, telegram_id=1272725276
2025-07-29 16:53:01,530 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:01,996 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:01,998 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=109, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:53:02,004 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=10, user_id=109, symbol=005930
2025-07-29 16:53:02,006 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:53:02,010 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:02,016 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/10 "HTTP/1.1 403 Forbidden"
2025-07-29 16:53:02,021 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1579413125, username=testuser_1579413125
2025-07-29 16:53:02,029 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=111, telegram_id=1579413125
2025-07-29 16:53:02,265 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:02,270 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 16:53:02,275 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6720658480, username=testuser_6720658480
2025-07-29 16:53:02,282 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=113, telegram_id=6720658480
2025-07-29 16:53:02,509 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:02,514 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 16:53:02,520 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:02,524 - httpx - INFO - HTTP Request: GET http://testserver/ "HTTP/1.1 200 OK"
2025-07-29 16:53:02,527 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2278989827, username=testuser_2278989827
2025-07-29 16:53:02,533 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=115, telegram_id=2278989827
2025-07-29 16:53:02,772 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:02,777 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:53:02,782 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:53:02,782 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 16:53:02,786 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 16:53:02,787 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 16:53:02,788 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 16:53:02,792 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8091442634, username=testuser_8091442634
2025-07-29 16:53:02,798 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=117, telegram_id=8091442634
2025-07-29 16:53:03,029 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:03,033 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:53:03,037 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=INVALID
2025-07-29 16:53:03,037 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=INVALID, days=40
2025-07-29 16:53:03,039 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 16:53:03,039 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 16:53:03,041 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 16:53:03,049 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7695532561, username=testuser_7695532561
2025-07-29 16:53:03,056 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=119, telegram_id=7695532561
2025-07-29 16:53:03,307 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:03,310 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:53:03,314 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 16:53:03,321 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8393882223, username=testuser_8393882223
2025-07-29 16:53:03,327 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=121, telegram_id=8393882223
2025-07-29 16:53:03,559 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:03,802 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=123, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 16:53:03,806 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 16:53:03,808 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:53:03,810 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/123 "HTTP/1.1 200 OK"
2025-07-29 16:53:03,817 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8743606272, username=testuser_8743606272
2025-07-29 16:53:03,822 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=124, telegram_id=8743606272
2025-07-29 16:53:04,050 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:04,054 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=99999, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 16:53:04,056 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 16:53:04,057 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:53:04,058 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/99999 "HTTP/1.1 200 OK"
2025-07-29 16:53:04,065 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6652689624, username=testuser_6652689624
2025-07-29 16:53:04,070 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=126, telegram_id=6652689624
2025-07-29 16:53:04,314 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:04,550 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=128, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 16:53:04,552 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 16:53:04,553 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:53:04,555 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/128 "HTTP/1.1 200 OK"
2025-07-29 16:53:04,560 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6017349785, username=testuser_6017349785
2025-07-29 16:53:04,566 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=129, telegram_id=6017349785
2025-07-29 16:53:04,801 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:05,077 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=1, page_size=5, symbol=None, prediction=None
2025-07-29 16:53:05,080 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 16:53:05,081 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 1, 페이지 크기 5).
2025-07-29 16:53:05,082 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=1&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 16:53:05,085 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=2, page_size=5, symbol=None, prediction=None
2025-07-29 16:53:05,086 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 16:53:05,088 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 2, 페이지 크기 5).
2025-07-29 16:53:05,089 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=2&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 16:53:05,096 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7137502409, username=testuser_7137502409
2025-07-29 16:53:05,102 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=132, telegram_id=7137502409
2025-07-29 16:53:05,338 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:05,580 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=134, page=1, page_size=10, symbol=005930, prediction=None
2025-07-29 16:53:05,581 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 16:53:05,584 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 16:53:05,585 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:53:05,587 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/134?symbol=005930 "HTTP/1.1 200 OK"
2025-07-29 16:53:05,593 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7203555843, username=testuser_7203555843
2025-07-29 16:53:05,599 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=135, telegram_id=7203555843
2025-07-29 16:53:05,839 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:06,083 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=137, page=1, page_size=10, symbol=None, prediction=상승
2025-07-29 16:53:06,083 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=상승
2025-07-29 16:53:06,086 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 16:53:06,088 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:53:06,090 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/137?prediction=%EC%83%81%EC%8A%B9 "HTTP/1.1 200 OK"
2025-07-29 16:53:06,096 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7908953954, username=testuser_7908953954
2025-07-29 16:53:06,103 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=138, telegram_id=7908953954
2025-07-29 16:53:06,339 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:06,663 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=140, page=1, page_size=10, symbol=005930, prediction=유지
2025-07-29 16:53:06,664 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 16:53:06,665 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=유지
2025-07-29 16:53:06,669 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 16:53:06,672 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:53:06,674 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/140?symbol=005930&prediction=%EC%9C%A0%EC%A7%80 "HTTP/1.1 200 OK"
2025-07-29 16:53:06,679 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1767987261, username=testuser_1767987261
2025-07-29 16:53:06,685 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=141, telegram_id=1767987261
2025-07-29 16:53:06,924 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:06,935 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=143, symbol=005930, trade_type=buy
2025-07-29 16:53:06,935 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 16:53:06,937 - src.api.services.stock_service - WARNING - 현재가 없음: 005930. 임시 가격 생성.
2025-07-29 16:53:06,937 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: 72548
2025-07-29 16:53:06,942 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=143, symbol=005930, trade_type=buy
2025-07-29 16:53:06,943 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 16:53:06,947 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=143
2025-07-29 16:53:06,950 - src.api.routers.simulated_trade - DEBUG - 사용자(143)의 모의매매 이력 1건 조회됨.
2025-07-29 16:53:06,950 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 16:53:06,952 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/143 "HTTP/1.1 200 OK"
2025-07-29 16:53:06,958 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8007087248, username=testuser_8007087248
2025-07-29 16:53:06,964 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=144, telegram_id=8007087248
2025-07-29 16:53:07,205 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:07,223 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 16:53:07,231 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7156147005, username=testuser_7156147005
2025-07-29 16:53:07,236 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=146, telegram_id=7156147005
2025-07-29 16:53:07,473 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:07,481 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 16:53:07,488 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9961934838, username=testuser_9961934838
2025-07-29 16:53:07,494 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=148, telegram_id=9961934838
2025-07-29 16:53:07,738 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:07,759 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%82%BC%EC%84%B1%EC%A0%84%EC%9E%90 "HTTP/1.1 200 OK"
2025-07-29 16:53:07,766 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4283336927, username=testuser_4283336927
2025-07-29 16:53:07,773 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=150, telegram_id=4283336927
2025-07-29 16:53:08,007 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:08,026 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=035720 "HTTP/1.1 200 OK"
2025-07-29 16:53:08,037 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4335351302, username=testuser_4335351302
2025-07-29 16:53:08,043 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=152, telegram_id=4335351302
2025-07-29 16:53:08,277 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:08,291 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=sk%ED%95%98%EC%9D%B4%EB%8B%89%EC%8A%A4 "HTTP/1.1 200 OK"
2025-07-29 16:53:08,299 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2987471155, username=testuser_2987471155
2025-07-29 16:53:08,303 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=154, telegram_id=2987471155
2025-07-29 16:53:08,542 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:08,551 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%97%86%EB%8A%94%EC%A2%85%EB%AA%A9 "HTTP/1.1 200 OK"
2025-07-29 16:53:08,559 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1343281721, username=testuser_1343281721
2025-07-29 16:53:08,565 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=156, telegram_id=1343281721
2025-07-29 16:53:08,810 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:08,817 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query= "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 16:53:08,822 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6264288272, username=testuser_6264288272
2025-07-29 16:53:08,827 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=158, telegram_id=6264288272
2025-07-29 16:53:09,058 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:09,065 - httpx - INFO - HTTP Request: GET http://testserver/symbols/005930/current_price_and_change "HTTP/1.1 200 OK"
2025-07-29 16:53:09,072 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4178555793, username=testuser_4178555793
2025-07-29 16:53:09,078 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=160, telegram_id=4178555793
2025-07-29 16:53:09,324 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:09,332 - httpx - INFO - HTTP Request: GET http://testserver/symbols/NONEXISTENT/current_price_and_change "HTTP/1.1 404 Not Found"
2025-07-29 16:53:09,339 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1074568703, username=testuser_1074568703
2025-07-29 16:53:09,345 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=162, telegram_id=1074568703
2025-07-29 16:53:09,583 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:09,831 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 16:53:09,837 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7490951024, username=testuser_7490951024
2025-07-29 16:53:09,844 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=165, telegram_id=7490951024
2025-07-29 16:53:10,078 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:10,318 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 400 Bad Request"
2025-07-29 16:53:10,323 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1885021920, username=testuser_1885021920
2025-07-29 16:53:10,328 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=168, telegram_id=1885021920
2025-07-29 16:53:10,567 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:11,068 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 16:53:11,074 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6250758809, username=testuser_6250758809
2025-07-29 16:53:11,081 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=171, telegram_id=6250758809
2025-07-29 16:53:11,315 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:11,325 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 16:53:11,330 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4048690260, username=testuser_4048690260
2025-07-29 16:53:11,337 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=173, telegram_id=4048690260
2025-07-29 16:53:11,591 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:12,065 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 16:53:12,071 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9032057571, username=testuser_9032057571
2025-07-29 16:53:12,079 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=176, telegram_id=9032057571
2025-07-29 16:53:12,311 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:12,553 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 178
2025-07-29 16:53:12,556 - src.api.services.user_service - DEBUG - User found by id: user_id=178
2025-07-29 16:53:12,560 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 16:53:12,565 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9712028604, username=testuser_9712028604
2025-07-29 16:53:12,571 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=179, telegram_id=9712028604
2025-07-29 16:53:12,803 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:12,807 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 403 Forbidden"
2025-07-29 16:53:12,812 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9519434367, username=testuser_9519434367
2025-07-29 16:53:12,819 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=181, telegram_id=9519434367
2025-07-29 16:53:13,064 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:13,319 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 183
2025-07-29 16:53:13,321 - src.api.services.user_service - DEBUG - User found by id: user_id=183
2025-07-29 16:53:13,335 - httpx - INFO - HTTP Request: PUT http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 16:53:13,342 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3254638497, username=testuser_3254638497
2025-07-29 16:53:13,348 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=184, telegram_id=3254638497
2025-07-29 16:53:13,584 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:13,601 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 16:53:13,607 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7488616520, username=testuser_7488616520
2025-07-29 16:53:13,614 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=187, telegram_id=7488616520
2025-07-29 16:53:13,988 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:14,276 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 16:53:14,280 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4398282497, username=testuser_4398282497
2025-07-29 16:53:14,286 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=190, telegram_id=4398282497
2025-07-29 16:53:14,522 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:14,767 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/192 "HTTP/1.1 200 OK"
2025-07-29 16:53:14,773 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3188644781, username=testuser_3188644781
2025-07-29 16:53:14,779 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=193, telegram_id=3188644781
2025-07-29 16:53:15,016 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:15,025 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/99999 "HTTP/1.1 404 Not Found"
2025-07-29 16:53:15,030 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1744758267, username=testuser_1744758267
2025-07-29 16:53:15,036 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=195, telegram_id=1744758267
2025-07-29 16:53:15,272 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:15,754 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 197
2025-07-29 16:53:15,756 - src.api.services.user_service - DEBUG - User found by id: user_id=197
2025-07-29 16:53:15,774 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 200 OK"
2025-07-29 16:53:15,782 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8059267756, username=testuser_8059267756
2025-07-29 16:53:15,790 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=199, telegram_id=8059267756
2025-07-29 16:53:16,047 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:16,287 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 201
2025-07-29 16:53:16,288 - src.api.services.user_service - DEBUG - User found by id: user_id=201
2025-07-29 16:53:16,290 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 403 Forbidden"
2025-07-29 16:53:16,296 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9819555015, username=testuser_9819555015
2025-07-29 16:53:16,302 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=202, telegram_id=9819555015
2025-07-29 16:53:16,537 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:16,545 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=204, symbol=005930
2025-07-29 16:53:16,552 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=204, symbol=005930
2025-07-29 16:53:16,553 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 16:53:16,556 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 시도: user_id=204
2025-07-29 16:53:16,558 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 성공: user_id=204, 1개 종목.
2025-07-29 16:53:16,559 - httpx - INFO - HTTP Request: GET http://testserver/watchlist/get/204 "HTTP/1.1 200 OK"
2025-07-29 16:53:16,565 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:16,567 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:53:16,567 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:53:16,572 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:16,576 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12345
2025-07-29 16:53:16,581 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=1, telegram_id=12345
2025-07-29 16:53:16,581 - src.api.services.price_alert_service - DEBUG - 사용자(1)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:53:16,588 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=1
2025-07-29 16:53:16,588 - src.api.services.price_alert_service - DEBUG - 가격 알림(1) 수정 시도: update_data={'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 16:53:16,592 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:53:16,593 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 16:53:16,593 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:53:16,597 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:53:16,597 - src.api.services.price_alert_service - INFO - 가격 알림(1) 수정 성공.
2025-07-29 16:53:16,598 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:53:16,604 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:53:16,604 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:53:16,608 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:16,609 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 16:53:16,611 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 16:53:16,612 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:53:16,613 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 16:53:16,614 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 16:53:16,616 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:53:16,617 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 16:53:16,617 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:53:16,624 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:53:16,624 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 16:53:16,625 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:53:16,628 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:16,629 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 16:53:16,630 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 16:53:16,630 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:53:16,631 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 16:53:16,632 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 16:53:16,633 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:53:16,633 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 16:53:16,633 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:53:16,637 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:53:16,638 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 16:53:16,639 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:53:16,649 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8492317851, username=testuser_8492317851
2025-07-29 16:53:16,654 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=205, telegram_id=8492317851
2025-07-29 16:53:16,655 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:16,657 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:53:16,658 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:16,661 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 8492317851
2025-07-29 16:53:16,663 - src.api.services.user_service - DEBUG - User not found for telegram_id: 8492317851
2025-07-29 16:53:16,663 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8492317851, username=testuser_8492317851
2025-07-29 16:53:16,670 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=202, telegram_id=8492317851
2025-07-29 16:53:16,671 - src.api.services.price_alert_service - DEBUG - 사용자(202)와 종목(GOOG)으로 가격 알림 조회 시도.
2025-07-29 16:53:16,672 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=202, symbol=GOOG
2025-07-29 16:53:16,672 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=202, symbol=GOOG, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:53:16,678 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=201, user_id=202, symbol=GOOG
2025-07-29 16:53:16,679 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:53:16,683 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:53:16,689 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9963674589, username=testuser_9963674589
2025-07-29 16:53:16,695 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=206, telegram_id=9963674589
2025-07-29 16:53:16,697 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:16,700 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:53:16,701 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:16,701 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 9963674589
2025-07-29 16:53:16,703 - src.api.services.user_service - DEBUG - User not found for telegram_id: 9963674589
2025-07-29 16:53:16,703 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9963674589, username=telegram_user_9963674589
2025-07-29 16:53:16,708 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=203, telegram_id=9963674589
2025-07-29 16:53:16,708 - src.api.services.price_alert_service - DEBUG - 사용자(203)와 종목(MSFT)으로 가격 알림 조회 시도.
2025-07-29 16:53:16,709 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=203, symbol=MSFT
2025-07-29 16:53:16,710 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=203, symbol=MSFT, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:53:16,717 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=202, user_id=203, symbol=MSFT
2025-07-29 16:53:16,719 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:53:16,721 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:53:16,725 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7170948092, username=testuser_7170948092
2025-07-29 16:53:16,731 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=207, telegram_id=7170948092
2025-07-29 16:53:16,734 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:16,736 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:53:16,737 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:16,738 - src.api.routers.bot_router - DEBUG - Before toggle: existing_alert.notify_on_disclosure = True
2025-07-29 16:53:16,738 - src.api.routers.bot_router - DEBUG - Calculated new_status: False
2025-07-29 16:53:16,738 - src.api.routers.bot_router - DEBUG - After update_alert call: updated_alert_orm.notify_on_disclosure = False
2025-07-29 16:53:16,739 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:53:16,741 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:53:16,746 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5334206531, username=testuser_5334206531
2025-07-29 16:53:16,751 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=208, telegram_id=5334206531
2025-07-29 16:53:16,755 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:16,758 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:53:16,759 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:16,760 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 5334206531
2025-07-29 16:53:16,761 - src.api.services.user_service - DEBUG - User not found for telegram_id: 5334206531
2025-07-29 16:53:16,762 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5334206531, username=telegram_user_5334206531
2025-07-29 16:53:16,767 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=204, telegram_id=5334206531
2025-07-29 16:53:16,767 - src.api.services.price_alert_service - DEBUG - 사용자(204)와 종목(NFLX)으로 가격 알림 조회 시도.
2025-07-29 16:53:16,769 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=204, symbol=NFLX
2025-07-29 16:53:16,769 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=204, symbol=NFLX, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:53:16,774 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=203, user_id=204, symbol=NFLX
2025-07-29 16:53:16,775 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:53:16,777 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:53:16,785 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6111365165, username=testuser_6111365165
2025-07-29 16:53:16,791 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=209, telegram_id=6111365165
2025-07-29 16:53:16,793 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:16,796 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:53:16,797 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:16,798 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 6111365165
2025-07-29 16:53:16,800 - src.api.services.user_service - DEBUG - User not found for telegram_id: 6111365165
2025-07-29 16:53:16,800 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6111365165, username=testuser_6111365165
2025-07-29 16:53:16,806 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=205, telegram_id=6111365165
2025-07-29 16:53:16,806 - src.api.services.price_alert_service - DEBUG - 사용자(205)와 종목(NVDA)으로 가격 알림 조회 시도.
2025-07-29 16:53:16,808 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=205, symbol=NVDA
2025-07-29 16:53:16,808 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=205, symbol=NVDA, target_price=1000.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:53:16,815 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=204, user_id=205, symbol=NVDA
2025-07-29 16:53:16,816 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:53:16,818 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:53:16,827 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7430733776, username=testuser_7430733776
2025-07-29 16:53:16,834 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=210, telegram_id=7430733776
2025-07-29 16:53:16,837 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:16,840 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:53:16,841 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:16,841 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 7430733776
2025-07-29 16:53:16,844 - src.api.services.user_service - DEBUG - User not found for telegram_id: 7430733776
2025-07-29 16:53:16,844 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7430733776, username=telegram_user_7430733776
2025-07-29 16:53:16,850 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=206, telegram_id=7430733776
2025-07-29 16:53:16,851 - src.api.services.price_alert_service - DEBUG - 사용자(206)와 종목(GOOGL)으로 가격 알림 조회 시도.
2025-07-29 16:53:16,853 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=206, symbol=GOOGL
2025-07-29 16:53:16,853 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=206, symbol=GOOGL, target_price=110.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=weekly
2025-07-29 16:53:16,859 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=205, user_id=206, symbol=GOOGL
2025-07-29 16:53:16,860 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:53:16,862 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:53:16,868 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1733354498, username=testuser_1733354498
2025-07-29 16:53:16,874 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=211, telegram_id=1733354498
2025-07-29 16:53:16,877 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:16,881 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:53:16,882 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:16,882 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 1733354498
2025-07-29 16:53:16,884 - src.api.services.user_service - DEBUG - User not found for telegram_id: 1733354498
2025-07-29 16:53:16,884 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1733354498, username=telegram_user_1733354498
2025-07-29 16:53:16,889 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=207, telegram_id=1733354498
2025-07-29 16:53:16,889 - src.api.services.price_alert_service - DEBUG - 사용자(207)와 종목(FB)으로 가격 알림 조회 시도.
2025-07-29 16:53:16,890 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=207, symbol=FB
2025-07-29 16:53:16,890 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=207, symbol=FB, target_price=300.0, condition=above, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:53:16,895 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=206, user_id=207, symbol=FB
2025-07-29 16:53:16,897 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:53:16,899 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:53:16,904 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:16,905 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:17,010 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:17,015 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:17,018 - src.common.dart_utils - ERROR - DART CORPCODE.xml 요청 실패: Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 25, in dart_get_all_stocks
    resp = await session.get(url, timeout=60)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 16:53:17,023 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:17,032 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:17,040 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:17,046 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:17,048 - src.common.dart_utils - ERROR - DART 공시 조회 API 요청 실패 (corp_code: 00123456): Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 79, in dart_get_disclosures
    resp = await session.get(url, params=params, timeout=10)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 16:53:17,052 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:17,054 - src.common.dart_utils - ERROR - DART 공시 API가 오류를 반환했습니다. status: 001, message: API 호출 오류, corp_code: 00123456
2025-07-29 16:53:17,148 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7904479069, username=testuser_7904479069
2025-07-29 16:53:17,155 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=212, telegram_id=7904479069
2025-07-29 16:53:17,393 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:17,638 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 16:53:17,882 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 16:53:17,886 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=214, symbol=005930
2025-07-29 16:53:17,892 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=214, symbol=005930
2025-07-29 16:53:17,894 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 16:53:17,897 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 214
2025-07-29 16:53:17,899 - src.api.services.user_service - DEBUG - User found by id: user_id=214
2025-07-29 16:53:17,900 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:17,901 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=214, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:53:17,906 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=11, user_id=214, symbol=005930
2025-07-29 16:53:17,907 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:53:17,909 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:53:17,911 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:53:17,911 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 16:53:17,913 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 16:53:17,914 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 16:53:17,919 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 16:53:17,921 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=214, symbol=005930, trade_type=buy
2025-07-29 16:53:17,921 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 16:53:17,922 - src.api.services.stock_service - WARNING - 현재가 없음: 005930. 임시 가격 생성.
2025-07-29 16:53:17,923 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: 82344
2025-07-29 16:53:17,927 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=214, symbol=005930, trade_type=buy
2025-07-29 16:53:17,928 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 16:53:17,930 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=214
2025-07-29 16:53:17,932 - src.api.routers.simulated_trade - DEBUG - 사용자(214)의 모의매매 이력 1건 조회됨.
2025-07-29 16:53:17,932 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 16:53:17,933 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/214 "HTTP/1.1 200 OK"
2025-07-29 16:53:17,943 - src.api.main - INFO - [APScheduler] 가격 알림 체크 잡 실행: 2025-07-29 16:53:17.943077
2025-07-29 16:53:17,943 - src.api.main - DEBUG - 활성 알림 수: 3
2025-07-29 16:53:17,943 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 16:53:17,944 - src.api.main - DEBUG - 종목 정상종목 현재가: 110
2025-07-29 16:53:17,945 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='140122846614128'>, 목표 가격: 100, 조건: gte, 반복 주기: <MagicMock name='mock.repeat_interval' id='140122847119248'>
2025-07-29 16:53:17,946 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목, 현재가: 110, 목표가: 100
2025-07-29 16:53:17,949 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='140122841317536'>)
2025-07-29 16:53:17,950 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 16:53:17,950 - src.api.main - DEBUG - 종목 오류종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 16:53:17,950 - src.api.main - ERROR - 가격 알림 확인 중 '오류종목' 처리 오류: 현재가 조회 실패
Traceback (most recent call last):
  File "/app/src/api/main.py", line 145, in check_price_alerts_job
    price_data = stock_service.get_current_price_and_change(symbol, db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1179, in _execute_mock_call
    result = effect(*args, **kwargs)
  File "/app/src/api/tests/test_main_jobs.py", line 34, in get_current_price_side_effect
    raise ValueError("현재가 조회 실패")
ValueError: 현재가 조회 실패
2025-07-29 16:53:17,951 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 16:53:17,951 - src.api.main - DEBUG - 종목 정상종목2 현재가: 290
2025-07-29 16:53:17,952 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='140122864753184'>, 목표 가격: 300, 조건: lte, 반복 주기: <MagicMock name='mock.repeat_interval' id='140122847766000'>
2025-07-29 16:53:17,952 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목2, 현재가: 290, 목표가: 300
2025-07-29 16:53:17,953 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='140122841317536'>)
2025-07-29 16:53:17,953 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 16:53:17,953 - src.api.main - DEBUG - 모든 가격 알림 체크 및 DB 커밋 완료.
2025-07-29 16:53:17,959 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:53:17,960 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(10일)
2025-07-29 16:53:17,964 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:53:17,965 - src.api.services.predict_service - ERROR - 예측 불가: 데이터 분석 실패
2025-07-29 16:53:17,969 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:53:17,970 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:53:17,978 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 상승 (24일 지속). 금일 변동: 보합. 최근 20일간 상승일: 19일, 하락일: 0일.
2025-07-29 16:53:17,978 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 16:53:17,982 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:53:17,982 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:53:17,988 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 하락 (24일 지속). 금일 변동: 보합. 최근 20일간 상승일: 0일, 하락일: 19일.
2025-07-29 16:53:17,988 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 16:53:17,992 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:53:17,992 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:53:17,999 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 횡보 (1일 지속). 금일 변동: 보합. 최근 20일간 상승일: 12일, 하락일: 7일.
2025-07-29 16:53:18,000 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 16:53:18,003 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:53:18,003 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:53:18,008 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=buy, reason=최근 추세: 하락 (1일 지속). 금일 변동: 횡보. 최근 20일간 상승일: 2일, 하락일: 17일. (저점 횡보 패턴 감지)
2025-07-29 16:53:18,008 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: buy
2025-07-29 16:53:18,011 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:53:18,011 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 22개 데이터.
2025-07-29 16:53:18,016 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, reason=최근 추세: 상승 (21일 지속). 금일 변동: 횡보. 최근 20일간 상승일: 19일, 하락일: 0일. (급등 후 횡보 패턴 감지)
2025-07-29 16:53:18,017 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 16:53:18,020 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:18,026 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 16:53:18,027 - src.api.services.stock_service - INFO - 신규 공시가 없습니다. (DB 기준: 202301010000001)
2025-07-29 16:53:18,031 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:18,035 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 16:53:18,043 - src.api.services.stock_service - INFO - 최초 실행. 기준 접수번호를 202301020000001로 DB에 설정합니다.
2025-07-29 16:53:18,045 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 16:53:18,046 - src.api.services.stock_service - INFO - 최초 실행. 기준 접수번호를 202301020000001로 DB에 설정합니다.
2025-07-29 16:53:18,049 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:18,061 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 16:53:18,061 - src.api.services.stock_service - INFO - 2건의 신규 공시를 발견했습니다.
2025-07-29 16:53:18,063 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 16:53:18,063 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 16:53:18,064 - src.api.services.stock_service - INFO - 마지막 확인 접수번호를 202301020000002로 DB에 갱신합니다.
2025-07-29 16:53:18,070 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:18,074 - src.api.services.stock_service - CRITICAL - DART API 사용 한도를 초과했습니다: [020] 사용 한도 초과
2025-07-29 16:53:18,079 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:18,086 - src.api.services.stock_service - ERROR - DART 공시 조회 중 API 오류 발생: [999] 기타 API 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 39, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
src.common.exceptions.DartApiError: [999] 기타 API 오류
2025-07-29 16:53:18,090 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:18,099 - src.api.services.stock_service - ERROR - 신규 공시 확인 및 알림 작업 중 예상치 못한 오류 발생: 예상치 못한 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 39, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: 예상치 못한 오류
2025-07-29 17:02:48,710 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:02:48,726 - src.common.db_connector - DEBUG - DB 세션 종료.
