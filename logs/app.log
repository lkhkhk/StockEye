2025-07-29 16:47:57,915 - main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:47:57,920 - main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:47:57,923 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:47:57,924 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:47:57,924 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:47:57,924 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:48:38,227 - main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:48:38,233 - main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:48:38,236 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:48:38,237 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:48:38,237 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:48:38,238 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:49:20,753 - main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:49:20,759 - main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:49:20,762 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:49:20,763 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:49:20,764 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:49:20,764 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:49:38,898 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:49:38,907 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:49:38,911 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:49:38,912 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:49:38,913 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:49:38,913 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:49:40,044 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:40,049 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 16:49:40,054 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-07-29 16:49:40,055 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '<unknown>'
2025-07-29 16:49:40,055 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-07-29 16:49:40,318 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:40,322 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 16:49:40,565 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:40,570 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 16:49:40,810 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:40,814 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 16:49:40,816 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 16:49:40,819 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3102865064, username=testuser_3102865064
2025-07-29 16:49:40,835 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=1, telegram_id=3102865064
2025-07-29 16:49:41,072 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:41,321 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 200 OK"
2025-07-29 16:49:41,326 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4480143140, username=testuser_4480143140
2025-07-29 16:49:41,333 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=3, telegram_id=4480143140
2025-07-29 16:49:41,566 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:41,803 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:41,807 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2368312973, username=testuser_2368312973
2025-07-29 16:49:41,813 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=5, telegram_id=2368312973
2025-07-29 16:49:42,051 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:42,056 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:42,061 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7125907634, username=testuser_7125907634
2025-07-29 16:49:42,067 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=7, telegram_id=7125907634
2025-07-29 16:49:42,300 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:42,548 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 200 OK"
2025-07-29 16:49:42,554 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7155258816, username=testuser_7155258816
2025-07-29 16:49:42,562 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=9, telegram_id=7155258816
2025-07-29 16:49:42,800 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:43,048 - src.api.routers.admin - ERROR - /admin/update_master 서버 오류: DB connection error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 36, in update_stock_master
    result = await stock_service.update_stock_master(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DB connection error
2025-07-29 16:49:43,051 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:49:43,059 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7499674372, username=testuser_7499674372
2025-07-29 16:49:43,066 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=11, telegram_id=7499674372
2025-07-29 16:49:43,317 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:43,556 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:43,561 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3694943063, username=testuser_3694943063
2025-07-29 16:49:43,568 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=13, telegram_id=3694943063
2025-07-29 16:49:43,802 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:43,807 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:43,812 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6037865612, username=testuser_6037865612
2025-07-29 16:49:43,817 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=15, telegram_id=6037865612
2025-07-29 16:49:44,048 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:44,285 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 200 OK"
2025-07-29 16:49:44,290 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9612540166, username=testuser_9612540166
2025-07-29 16:49:44,298 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=17, telegram_id=9612540166
2025-07-29 16:49:44,533 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:44,858 - src.api.routers.admin - ERROR - /admin/update_price 서버 오류: API call failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 53, in update_daily_price
    result = await stock_service.update_daily_prices(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: API call failed
2025-07-29 16:49:44,860 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:49:44,865 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3652757773, username=testuser_3652757773
2025-07-29 16:49:44,871 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=19, telegram_id=3652757773
2025-07-29 16:49:45,118 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:45,369 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:45,374 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3798526041, username=testuser_3798526041
2025-07-29 16:49:45,382 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=21, telegram_id=3798526041
2025-07-29 16:49:45,615 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:45,621 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:45,625 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7297602576, username=testuser_7297602576
2025-07-29 16:49:45,630 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=23, telegram_id=7297602576
2025-07-29 16:49:45,865 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:46,105 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7effb668d3c0>
2025-07-29 16:49:46,105 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:49:46,107 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 200 OK"
2025-07-29 16:49:46,112 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3700523400, username=testuser_3700523400
2025-07-29 16:49:46,119 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=25, telegram_id=3700523400
2025-07-29 16:49:46,354 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:46,595 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7effb668e0e0>
2025-07-29 16:49:46,595 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:49:46,597 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 200 OK"
2025-07-29 16:49:46,602 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8101622689, username=testuser_8101622689
2025-07-29 16:49:46,611 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=27, telegram_id=8101622689
2025-07-29 16:49:46,852 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:47,099 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7effb64fdb10>
2025-07-29 16:49:47,099 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:49:47,101 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=%EC%B9%B4%EC%B9%B4%EC%98%A4 "HTTP/1.1 200 OK"
2025-07-29 16:49:47,105 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2807202432, username=testuser_2807202432
2025-07-29 16:49:47,112 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=29, telegram_id=2807202432
2025-07-29 16:49:47,347 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:47,596 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7effb64fc160>
2025-07-29 16:49:47,596 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:49:47,598 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=0013456 "HTTP/1.1 200 OK"
2025-07-29 16:49:47,603 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4050695546, username=testuser_4050695546
2025-07-29 16:49:47,611 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=31, telegram_id=4050695546
2025-07-29 16:49:47,846 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:48,088 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7effb656b220>
2025-07-29 16:49:48,088 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:49:48,090 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=NONEXIST "HTTP/1.1 404 Not Found"
2025-07-29 16:49:48,098 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6850420242, username=testuser_6850420242
2025-07-29 16:49:48,106 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=33, telegram_id=6850420242
2025-07-29 16:49:48,351 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:48,594 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7effb656b820>
2025-07-29 16:49:48,595 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:49:48,595 - src.api.routers.admin - ERROR - /admin/update_disclosure 서버 오류: DART API error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 126, in update_disclosure
    result = await stock_service.update_disclosures(db, corp_code=corp_code, stock_code=stock_code or '', stock_name=stock_name or '')
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DART API error
2025-07-29 16:49:48,596 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:49:48,601 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3474229982, username=testuser_3474229982
2025-07-29 16:49:48,608 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=35, telegram_id=3474229982
2025-07-29 16:49:48,843 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:49,084 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:49,090 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6800077398, username=testuser_6800077398
2025-07-29 16:49:49,098 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=37, telegram_id=6800077398
2025-07-29 16:49:49,342 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:49,348 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:49,352 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3966364475, username=testuser_3966364475
2025-07-29 16:49:49,358 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=39, telegram_id=3966364475
2025-07-29 16:49:49,607 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:49,852 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 16:49:49,856 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1198003069, username=testuser_1198003069
2025-07-29 16:49:49,864 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=41, telegram_id=1198003069
2025-07-29 16:49:50,097 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:50,334 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 16:49:50,339 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6318417020, username=testuser_6318417020
2025-07-29 16:49:50,346 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=43, telegram_id=6318417020
2025-07-29 16:49:50,580 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:50,819 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:50,824 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6012830242, username=testuser_6012830242
2025-07-29 16:49:50,832 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=45, telegram_id=6012830242
2025-07-29 16:49:51,069 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:51,075 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:51,080 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8977267974, username=testuser_8977267974
2025-07-29 16:49:51,085 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=47, telegram_id=8977267974
2025-07-29 16:49:51,318 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:51,568 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 16:49:51,569 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 16:49:51,575 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8608729114, username=testuser_8608729114
2025-07-29 16:49:51,583 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=49, telegram_id=8608729114
2025-07-29 16:49:51,831 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:52,079 - src.api.routers.admin - ERROR - [trigger_job] 잡 실행 실패: test_job - Job execution failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 175, in trigger_job
    job.func(*job.args, **job.kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: Job execution failed

2025-07-29 16:49:52,080 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:49:52,084 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2262176895, username=testuser_2262176895
2025-07-29 16:49:52,092 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=51, telegram_id=2262176895
2025-07-29 16:49:52,327 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:52,647 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:52,651 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2816568718, username=testuser_2816568718
2025-07-29 16:49:52,660 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=53, telegram_id=2816568718
2025-07-29 16:49:52,897 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:52,904 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:52,909 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8718960820, username=testuser_8718960820
2025-07-29 16:49:52,916 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=55, telegram_id=8718960820
2025-07-29 16:49:53,153 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:53,404 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 16:49:53,405 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 200 OK"
2025-07-29 16:49:53,411 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5804786798, username=testuser_5804786798
2025-07-29 16:49:53,421 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=57, telegram_id=5804786798
2025-07-29 16:49:53,663 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:53,904 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 16:49:53,904 - src.api.routers.admin - ERROR - 공시 확인 잡 수동 실행 중 오류 발생: Disclosure check failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 193, in trigger_check_disclosures_job
    await stock_service.check_and_notify_new_disclosures(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: Disclosure check failed
2025-07-29 16:49:53,905 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:49:53,911 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8237729581, username=testuser_8237729581
2025-07-29 16:49:53,920 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=59, telegram_id=8237729581
2025-07-29 16:49:54,168 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:54,407 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:54,411 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9760947130, username=testuser_9760947130
2025-07-29 16:49:54,419 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=61, telegram_id=9760947130
2025-07-29 16:49:54,657 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:54,663 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:54,669 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2043953294, username=testuser_2043953294
2025-07-29 16:49:54,676 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=63, telegram_id=2043953294
2025-07-29 16:49:54,913 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:55,167 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:55,170 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=65, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:49:55,179 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=1, user_id=65, symbol=005930
2025-07-29 16:49:55,181 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:49:55,188 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6074043611, username=testuser_6074043611
2025-07-29 16:49:55,194 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=66, telegram_id=6074043611
2025-07-29 16:49:55,432 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:55,438 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:55,442 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8694714008, username=testuser_8694714008
2025-07-29 16:49:55,448 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=68, telegram_id=8694714008
2025-07-29 16:49:55,683 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:55,934 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:55,935 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 16:49:55,940 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4189761262, username=testuser_4189761262
2025-07-29 16:49:55,945 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=71, telegram_id=4189761262
2025-07-29 16:49:56,182 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:56,424 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:56,425 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:49:56,430 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=2, user_id=73, symbol=005930
2025-07-29 16:49:56,432 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:49:56,434 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:56,435 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=035720, target_price=50000.0, condition=lte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:49:56,440 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=3, user_id=73, symbol=035720
2025-07-29 16:49:56,441 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:49:56,443 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:56,445 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 조회 시도.
2025-07-29 16:49:56,448 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 2개 조회됨.
2025-07-29 16:49:56,449 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:49:56,453 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4000606365, username=testuser_4000606365
2025-07-29 16:49:56,459 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=74, telegram_id=4000606365
2025-07-29 16:49:56,694 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:56,937 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:56,938 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 조회 시도.
2025-07-29 16:49:56,939 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 0개 조회됨.
2025-07-29 16:49:56,941 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:49:56,945 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8750266634, username=testuser_8750266634
2025-07-29 16:49:56,951 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=77, telegram_id=8750266634
2025-07-29 16:49:57,185 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:57,188 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:57,192 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4496732173, username=testuser_4496732173
2025-07-29 16:49:57,197 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=79, telegram_id=4496732173
2025-07-29 16:49:57,282 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:57,523 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:57,524 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=81, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:49:57,530 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=4, user_id=81, symbol=005930
2025-07-29 16:49:57,532 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:49:57,536 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:57,537 - src.api.services.price_alert_service - DEBUG - 사용자(81)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:49:57,541 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=4
2025-07-29 16:49:57,542 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/81/symbol/005930 "HTTP/1.1 200 OK"
2025-07-29 16:49:57,548 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5447513156, username=testuser_5447513156
2025-07-29 16:49:57,558 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=82, telegram_id=5447513156
2025-07-29 16:49:57,794 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:58,042 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:58,042 - src.api.services.price_alert_service - DEBUG - 사용자(84)와 종목(NONEXISTENT)으로 가격 알림 조회 시도.
2025-07-29 16:49:58,044 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=84, symbol=NONEXISTENT
2025-07-29 16:49:58,045 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/84/symbol/NONEXISTENT "HTTP/1.1 404 Not Found"
2025-07-29 16:49:58,049 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7266387156, username=testuser_7266387156
2025-07-29 16:49:58,053 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=85, telegram_id=7266387156
2025-07-29 16:49:58,289 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:58,527 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:58,528 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=87, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:49:58,533 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=5, user_id=87, symbol=005930
2025-07-29 16:49:58,534 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:49:58,536 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:58,539 - src.api.services.price_alert_service - DEBUG - 가격 알림(5) 수정 시도: update_data={'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 16:49:58,541 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:49:58,542 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 16:49:58,542 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:49:58,547 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:49:58,547 - src.api.services.price_alert_service - INFO - 가격 알림(5) 수정 성공.
2025-07-29 16:49:58,549 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/5 "HTTP/1.1 200 OK"
2025-07-29 16:49:58,554 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3466240376, username=testuser_3466240376
2025-07-29 16:49:58,560 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=88, telegram_id=3466240376
2025-07-29 16:49:58,782 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:59,011 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:59,012 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=90, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:49:59,017 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=6, user_id=90, symbol=005930
2025-07-29 16:49:59,019 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:49:59,022 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/6 "HTTP/1.1 403 Forbidden"
2025-07-29 16:49:59,026 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7646674404, username=testuser_7646674404
2025-07-29 16:49:59,032 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=91, telegram_id=7646674404
2025-07-29 16:49:59,257 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:49:59,555 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:49:59,556 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 16:49:59,557 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 16:49:59,558 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 16:49:59,563 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3821671559, username=testuser_3821671559
2025-07-29 16:49:59,569 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=94, telegram_id=3821671559
2025-07-29 16:49:59,798 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:00,263 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:00,264 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=96, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:50:00,269 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=7, user_id=96, symbol=005930
2025-07-29 16:50:00,271 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:50:00,274 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:00,274 - src.api.services.price_alert_service - DEBUG - 가격 알림(7) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 16:50:00,276 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:50:00,276 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0}
2025-07-29 16:50:00,276 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:50:00,281 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:50:00,282 - src.api.services.price_alert_service - INFO - 가격 알림(7) 수정 성공.
2025-07-29 16:50:00,284 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/7 "HTTP/1.1 403 Forbidden"
2025-07-29 16:50:00,288 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2666967382, username=testuser_2666967382
2025-07-29 16:50:00,294 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=98, telegram_id=2666967382
2025-07-29 16:50:00,528 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:00,761 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:00,762 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=100, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:50:00,768 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=8, user_id=100, symbol=005930
2025-07-29 16:50:00,769 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:50:00,772 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:00,775 - src.api.services.price_alert_service - DEBUG - 가격 알림(8) 삭제 시도.
2025-07-29 16:50:00,780 - src.api.services.price_alert_service - INFO - 가격 알림(8) 삭제 성공.
2025-07-29 16:50:00,781 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/8 "HTTP/1.1 200 OK"
2025-07-29 16:50:00,787 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7836582547, username=testuser_7836582547
2025-07-29 16:50:00,793 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=101, telegram_id=7836582547
2025-07-29 16:50:01,021 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:01,254 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:01,254 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=103, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:50:01,260 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=9, user_id=103, symbol=005930
2025-07-29 16:50:01,262 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:50:01,264 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/9 "HTTP/1.1 403 Forbidden"
2025-07-29 16:50:01,269 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1022545311, username=testuser_1022545311
2025-07-29 16:50:01,275 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=104, telegram_id=1022545311
2025-07-29 16:50:01,500 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:01,733 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:01,735 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 삭제 시도.
2025-07-29 16:50:01,737 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 16:50:01,738 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 16:50:01,743 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4950847469, username=testuser_4950847469
2025-07-29 16:50:01,748 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=107, telegram_id=4950847469
2025-07-29 16:50:01,978 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:02,442 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:02,444 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=109, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:50:02,451 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=10, user_id=109, symbol=005930
2025-07-29 16:50:02,453 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:50:02,456 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:02,463 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/10 "HTTP/1.1 403 Forbidden"
2025-07-29 16:50:02,469 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3710425891, username=testuser_3710425891
2025-07-29 16:50:02,477 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=111, telegram_id=3710425891
2025-07-29 16:50:02,713 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:02,719 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 16:50:02,724 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2543659563, username=testuser_2543659563
2025-07-29 16:50:02,730 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=113, telegram_id=2543659563
2025-07-29 16:50:02,960 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:02,967 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 16:50:02,975 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:02,979 - httpx - INFO - HTTP Request: GET http://testserver/ "HTTP/1.1 200 OK"
2025-07-29 16:50:02,981 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6638204787, username=testuser_6638204787
2025-07-29 16:50:02,987 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=115, telegram_id=6638204787
2025-07-29 16:50:03,233 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:03,237 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:50:03,240 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:50:03,241 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 16:50:03,244 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 16:50:03,244 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 16:50:03,245 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 16:50:03,250 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8179816402, username=testuser_8179816402
2025-07-29 16:50:03,255 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=117, telegram_id=8179816402
2025-07-29 16:50:03,491 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:03,495 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:50:03,499 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=INVALID
2025-07-29 16:50:03,499 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=INVALID, days=40
2025-07-29 16:50:03,501 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 16:50:03,501 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 16:50:03,503 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 16:50:03,507 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2803246226, username=testuser_2803246226
2025-07-29 16:50:03,513 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=119, telegram_id=2803246226
2025-07-29 16:50:03,749 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:03,752 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:50:03,756 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 16:50:03,764 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8066334638, username=testuser_8066334638
2025-07-29 16:50:03,770 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=121, telegram_id=8066334638
2025-07-29 16:50:04,003 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:04,248 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=123, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 16:50:04,253 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 16:50:04,256 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:50:04,258 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/123 "HTTP/1.1 200 OK"
2025-07-29 16:50:04,266 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8042917500, username=testuser_8042917500
2025-07-29 16:50:04,273 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=124, telegram_id=8042917500
2025-07-29 16:50:04,510 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:04,516 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=99999, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 16:50:04,518 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 16:50:04,520 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:50:04,521 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/99999 "HTTP/1.1 200 OK"
2025-07-29 16:50:04,528 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6908187352, username=testuser_6908187352
2025-07-29 16:50:04,534 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=126, telegram_id=6908187352
2025-07-29 16:50:04,773 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:05,009 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=128, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 16:50:05,010 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 16:50:05,011 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:50:05,012 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/128 "HTTP/1.1 200 OK"
2025-07-29 16:50:05,018 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1600873935, username=testuser_1600873935
2025-07-29 16:50:05,023 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=129, telegram_id=1600873935
2025-07-29 16:50:05,256 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:05,529 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=1, page_size=5, symbol=None, prediction=None
2025-07-29 16:50:05,531 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 16:50:05,533 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 1, 페이지 크기 5).
2025-07-29 16:50:05,535 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=1&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 16:50:05,537 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=2, page_size=5, symbol=None, prediction=None
2025-07-29 16:50:05,540 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 16:50:05,541 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 2, 페이지 크기 5).
2025-07-29 16:50:05,543 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=2&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 16:50:05,551 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1058974798, username=testuser_1058974798
2025-07-29 16:50:05,557 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=132, telegram_id=1058974798
2025-07-29 16:50:05,799 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:06,044 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=134, page=1, page_size=10, symbol=005930, prediction=None
2025-07-29 16:50:06,044 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 16:50:06,047 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 16:50:06,050 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:50:06,052 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/134?symbol=005930 "HTTP/1.1 200 OK"
2025-07-29 16:50:06,058 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7288556958, username=testuser_7288556958
2025-07-29 16:50:06,063 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=135, telegram_id=7288556958
2025-07-29 16:50:06,295 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:06,546 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=137, page=1, page_size=10, symbol=None, prediction=상승
2025-07-29 16:50:06,546 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=상승
2025-07-29 16:50:06,549 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 16:50:06,551 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:50:06,553 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/137?prediction=%EC%83%81%EC%8A%B9 "HTTP/1.1 200 OK"
2025-07-29 16:50:06,559 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4036508486, username=testuser_4036508486
2025-07-29 16:50:06,564 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=138, telegram_id=4036508486
2025-07-29 16:50:06,803 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:07,064 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=140, page=1, page_size=10, symbol=005930, prediction=유지
2025-07-29 16:50:07,065 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 16:50:07,065 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=유지
2025-07-29 16:50:07,071 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 16:50:07,075 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:50:07,077 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/140?symbol=005930&prediction=%EC%9C%A0%EC%A7%80 "HTTP/1.1 200 OK"
2025-07-29 16:50:07,083 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7657071198, username=testuser_7657071198
2025-07-29 16:50:07,089 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=141, telegram_id=7657071198
2025-07-29 16:50:07,326 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:07,337 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=143, symbol=005930, trade_type=buy
2025-07-29 16:50:07,337 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 16:50:07,340 - src.api.services.stock_service - WARNING - 현재가 없음: 005930. 임시 가격 생성.
2025-07-29 16:50:07,340 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: 161178
2025-07-29 16:50:07,346 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=143, symbol=005930, trade_type=buy
2025-07-29 16:50:07,347 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 16:50:07,351 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=143
2025-07-29 16:50:07,353 - src.api.routers.simulated_trade - DEBUG - 사용자(143)의 모의매매 이력 1건 조회됨.
2025-07-29 16:50:07,354 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 16:50:07,355 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/143 "HTTP/1.1 200 OK"
2025-07-29 16:50:07,362 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5561840485, username=testuser_5561840485
2025-07-29 16:50:07,368 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=144, telegram_id=5561840485
2025-07-29 16:50:07,598 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:07,613 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 16:50:07,620 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2057089273, username=testuser_2057089273
2025-07-29 16:50:07,626 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=146, telegram_id=2057089273
2025-07-29 16:50:07,859 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:07,866 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 16:50:07,873 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9896663349, username=testuser_9896663349
2025-07-29 16:50:07,879 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=148, telegram_id=9896663349
2025-07-29 16:50:08,110 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:08,123 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%82%BC%EC%84%B1%EC%A0%84%EC%9E%90 "HTTP/1.1 200 OK"
2025-07-29 16:50:08,131 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2778764333, username=testuser_2778764333
2025-07-29 16:50:08,136 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=150, telegram_id=2778764333
2025-07-29 16:50:08,369 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:08,388 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=035720 "HTTP/1.1 200 OK"
2025-07-29 16:50:08,396 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4247580218, username=testuser_4247580218
2025-07-29 16:50:08,401 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=152, telegram_id=4247580218
2025-07-29 16:50:08,645 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:08,661 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=sk%ED%95%98%EC%9D%B4%EB%8B%89%EC%8A%A4 "HTTP/1.1 200 OK"
2025-07-29 16:50:08,670 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2087608438, username=testuser_2087608438
2025-07-29 16:50:08,676 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=154, telegram_id=2087608438
2025-07-29 16:50:08,914 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:08,923 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%97%86%EB%8A%94%EC%A2%85%EB%AA%A9 "HTTP/1.1 200 OK"
2025-07-29 16:50:08,928 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4783767111, username=testuser_4783767111
2025-07-29 16:50:08,935 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=156, telegram_id=4783767111
2025-07-29 16:50:09,175 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:09,182 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query= "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 16:50:09,188 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8437121729, username=testuser_8437121729
2025-07-29 16:50:09,193 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=158, telegram_id=8437121729
2025-07-29 16:50:09,428 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:09,437 - httpx - INFO - HTTP Request: GET http://testserver/symbols/005930/current_price_and_change "HTTP/1.1 200 OK"
2025-07-29 16:50:09,443 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5817413249, username=testuser_5817413249
2025-07-29 16:50:09,449 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=160, telegram_id=5817413249
2025-07-29 16:50:09,681 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:09,689 - httpx - INFO - HTTP Request: GET http://testserver/symbols/NONEXISTENT/current_price_and_change "HTTP/1.1 404 Not Found"
2025-07-29 16:50:09,693 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1980816938, username=testuser_1980816938
2025-07-29 16:50:09,698 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=162, telegram_id=1980816938
2025-07-29 16:50:09,937 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:10,184 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 16:50:10,189 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6113046972, username=testuser_6113046972
2025-07-29 16:50:10,195 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=165, telegram_id=6113046972
2025-07-29 16:50:10,428 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:10,669 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 400 Bad Request"
2025-07-29 16:50:10,674 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7126985004, username=testuser_7126985004
2025-07-29 16:50:10,679 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=168, telegram_id=7126985004
2025-07-29 16:50:10,921 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:11,453 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 16:50:11,458 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2250296124, username=testuser_2250296124
2025-07-29 16:50:11,463 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=171, telegram_id=2250296124
2025-07-29 16:50:11,700 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:11,708 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 16:50:11,713 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3035800371, username=testuser_3035800371
2025-07-29 16:50:11,718 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=173, telegram_id=3035800371
2025-07-29 16:50:11,961 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:12,424 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 16:50:12,430 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8307383778, username=testuser_8307383778
2025-07-29 16:50:12,437 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=176, telegram_id=8307383778
2025-07-29 16:50:12,671 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:12,913 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 178
2025-07-29 16:50:12,916 - src.api.services.user_service - DEBUG - User found by id: user_id=178
2025-07-29 16:50:12,921 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 16:50:12,926 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4942143022, username=testuser_4942143022
2025-07-29 16:50:12,933 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=179, telegram_id=4942143022
2025-07-29 16:50:13,183 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:13,187 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 403 Forbidden"
2025-07-29 16:50:13,192 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5566850506, username=testuser_5566850506
2025-07-29 16:50:13,198 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=181, telegram_id=5566850506
2025-07-29 16:50:13,435 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:13,696 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 183
2025-07-29 16:50:13,697 - src.api.services.user_service - DEBUG - User found by id: user_id=183
2025-07-29 16:50:13,709 - httpx - INFO - HTTP Request: PUT http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 16:50:13,714 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7816845155, username=testuser_7816845155
2025-07-29 16:50:13,719 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=184, telegram_id=7816845155
2025-07-29 16:50:13,955 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:13,970 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 16:50:13,975 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8267531605, username=testuser_8267531605
2025-07-29 16:50:13,981 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=187, telegram_id=8267531605
2025-07-29 16:50:14,213 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:14,458 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 16:50:14,461 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8766985272, username=testuser_8766985272
2025-07-29 16:50:14,467 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=190, telegram_id=8766985272
2025-07-29 16:50:14,708 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:14,961 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/192 "HTTP/1.1 200 OK"
2025-07-29 16:50:14,967 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4291641631, username=testuser_4291641631
2025-07-29 16:50:14,974 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=193, telegram_id=4291641631
2025-07-29 16:50:15,223 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:15,233 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/99999 "HTTP/1.1 404 Not Found"
2025-07-29 16:50:15,239 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7193174311, username=testuser_7193174311
2025-07-29 16:50:15,246 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=195, telegram_id=7193174311
2025-07-29 16:50:15,492 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:16,003 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 197
2025-07-29 16:50:16,005 - src.api.services.user_service - DEBUG - User found by id: user_id=197
2025-07-29 16:50:16,020 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 200 OK"
2025-07-29 16:50:16,026 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8422709371, username=testuser_8422709371
2025-07-29 16:50:16,033 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=199, telegram_id=8422709371
2025-07-29 16:50:16,278 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:16,543 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 201
2025-07-29 16:50:16,544 - src.api.services.user_service - DEBUG - User found by id: user_id=201
2025-07-29 16:50:16,546 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 403 Forbidden"
2025-07-29 16:50:16,552 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8461565591, username=testuser_8461565591
2025-07-29 16:50:16,559 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=202, telegram_id=8461565591
2025-07-29 16:50:16,803 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:16,813 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=204, symbol=005930
2025-07-29 16:50:16,825 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=204, symbol=005930
2025-07-29 16:50:16,828 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 16:50:16,832 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 시도: user_id=204
2025-07-29 16:50:16,835 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 성공: user_id=204, 1개 종목.
2025-07-29 16:50:16,837 - httpx - INFO - HTTP Request: GET http://testserver/watchlist/get/204 "HTTP/1.1 200 OK"
2025-07-29 16:50:16,843 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:16,846 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:50:16,847 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:50:16,852 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:16,858 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12345
2025-07-29 16:50:16,863 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=1, telegram_id=12345
2025-07-29 16:50:16,864 - src.api.services.price_alert_service - DEBUG - 사용자(1)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:50:16,869 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=1
2025-07-29 16:50:16,869 - src.api.services.price_alert_service - DEBUG - 가격 알림(1) 수정 시도: update_data={'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 16:50:16,872 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:50:16,872 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 16:50:16,873 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:50:16,877 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:50:16,877 - src.api.services.price_alert_service - INFO - 가격 알림(1) 수정 성공.
2025-07-29 16:50:16,879 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:50:16,886 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:50:16,886 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:50:16,890 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:16,891 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 16:50:16,894 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 16:50:16,894 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:50:16,897 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 16:50:16,897 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 16:50:16,900 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:50:16,900 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 16:50:16,901 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:50:16,911 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:50:16,911 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 16:50:16,913 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:50:16,917 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:16,919 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 16:50:16,921 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 16:50:16,922 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:50:16,924 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 16:50:16,924 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 16:50:16,926 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:50:16,926 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 16:50:16,927 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:50:16,933 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:50:16,933 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 16:50:16,934 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:50:16,949 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2430340888, username=testuser_2430340888
2025-07-29 16:50:16,955 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=205, telegram_id=2430340888
2025-07-29 16:50:16,957 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:16,960 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:50:16,962 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:16,966 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 2430340888
2025-07-29 16:50:16,969 - src.api.services.user_service - DEBUG - User not found for telegram_id: 2430340888
2025-07-29 16:50:16,970 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2430340888, username=testuser_2430340888
2025-07-29 16:50:16,979 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=190, telegram_id=2430340888
2025-07-29 16:50:16,979 - src.api.services.price_alert_service - DEBUG - 사용자(190)와 종목(GOOG)으로 가격 알림 조회 시도.
2025-07-29 16:50:16,981 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=190, symbol=GOOG
2025-07-29 16:50:16,981 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=190, symbol=GOOG, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:50:16,988 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=189, user_id=190, symbol=GOOG
2025-07-29 16:50:16,989 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:50:16,991 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:50:16,999 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6005592234, username=testuser_6005592234
2025-07-29 16:50:17,005 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=206, telegram_id=6005592234
2025-07-29 16:50:17,006 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,009 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:50:17,010 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:17,011 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 6005592234
2025-07-29 16:50:17,013 - src.api.services.user_service - DEBUG - User not found for telegram_id: 6005592234
2025-07-29 16:50:17,014 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6005592234, username=telegram_user_6005592234
2025-07-29 16:50:17,019 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=191, telegram_id=6005592234
2025-07-29 16:50:17,020 - src.api.services.price_alert_service - DEBUG - 사용자(191)와 종목(MSFT)으로 가격 알림 조회 시도.
2025-07-29 16:50:17,021 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=191, symbol=MSFT
2025-07-29 16:50:17,022 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=191, symbol=MSFT, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:50:17,029 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=190, user_id=191, symbol=MSFT
2025-07-29 16:50:17,031 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:50:17,034 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:50:17,041 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9278798157, username=testuser_9278798157
2025-07-29 16:50:17,048 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=207, telegram_id=9278798157
2025-07-29 16:50:17,052 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,056 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:50:17,057 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:17,058 - src.api.routers.bot_router - DEBUG - Before toggle: existing_alert.notify_on_disclosure = True
2025-07-29 16:50:17,058 - src.api.routers.bot_router - DEBUG - Calculated new_status: False
2025-07-29 16:50:17,059 - src.api.routers.bot_router - DEBUG - After update_alert call: updated_alert_orm.notify_on_disclosure = False
2025-07-29 16:50:17,060 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:50:17,062 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:50:17,068 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7444469257, username=testuser_7444469257
2025-07-29 16:50:17,076 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=208, telegram_id=7444469257
2025-07-29 16:50:17,080 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,086 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:50:17,087 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:17,088 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 7444469257
2025-07-29 16:50:17,090 - src.api.services.user_service - DEBUG - User not found for telegram_id: 7444469257
2025-07-29 16:50:17,090 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7444469257, username=telegram_user_7444469257
2025-07-29 16:50:17,095 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=192, telegram_id=7444469257
2025-07-29 16:50:17,095 - src.api.services.price_alert_service - DEBUG - 사용자(192)와 종목(NFLX)으로 가격 알림 조회 시도.
2025-07-29 16:50:17,097 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=192, symbol=NFLX
2025-07-29 16:50:17,098 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=192, symbol=NFLX, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:50:17,103 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=191, user_id=192, symbol=NFLX
2025-07-29 16:50:17,105 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:50:17,107 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:50:17,112 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9798289585, username=testuser_9798289585
2025-07-29 16:50:17,118 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=209, telegram_id=9798289585
2025-07-29 16:50:17,120 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,122 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:50:17,123 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:17,123 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 9798289585
2025-07-29 16:50:17,125 - src.api.services.user_service - DEBUG - User not found for telegram_id: 9798289585
2025-07-29 16:50:17,125 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9798289585, username=testuser_9798289585
2025-07-29 16:50:17,130 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=193, telegram_id=9798289585
2025-07-29 16:50:17,131 - src.api.services.price_alert_service - DEBUG - 사용자(193)와 종목(NVDA)으로 가격 알림 조회 시도.
2025-07-29 16:50:17,132 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=193, symbol=NVDA
2025-07-29 16:50:17,133 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=193, symbol=NVDA, target_price=1000.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:50:17,139 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=192, user_id=193, symbol=NVDA
2025-07-29 16:50:17,140 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:50:17,143 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:50:17,149 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1940552641, username=testuser_1940552641
2025-07-29 16:50:17,158 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=210, telegram_id=1940552641
2025-07-29 16:50:17,162 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,165 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:50:17,167 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:17,168 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 1940552641
2025-07-29 16:50:17,170 - src.api.services.user_service - DEBUG - User not found for telegram_id: 1940552641
2025-07-29 16:50:17,170 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1940552641, username=telegram_user_1940552641
2025-07-29 16:50:17,176 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=194, telegram_id=1940552641
2025-07-29 16:50:17,176 - src.api.services.price_alert_service - DEBUG - 사용자(194)와 종목(GOOGL)으로 가격 알림 조회 시도.
2025-07-29 16:50:17,178 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=194, symbol=GOOGL
2025-07-29 16:50:17,178 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=194, symbol=GOOGL, target_price=110.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=weekly
2025-07-29 16:50:17,184 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=193, user_id=194, symbol=GOOGL
2025-07-29 16:50:17,185 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:50:17,187 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:50:17,193 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3033881384, username=testuser_3033881384
2025-07-29 16:50:17,204 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=211, telegram_id=3033881384
2025-07-29 16:50:17,208 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,211 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:50:17,212 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:17,213 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 3033881384
2025-07-29 16:50:17,216 - src.api.services.user_service - DEBUG - User not found for telegram_id: 3033881384
2025-07-29 16:50:17,216 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3033881384, username=telegram_user_3033881384
2025-07-29 16:50:17,222 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=195, telegram_id=3033881384
2025-07-29 16:50:17,222 - src.api.services.price_alert_service - DEBUG - 사용자(195)와 종목(FB)으로 가격 알림 조회 시도.
2025-07-29 16:50:17,224 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=195, symbol=FB
2025-07-29 16:50:17,224 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=195, symbol=FB, target_price=300.0, condition=above, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:50:17,230 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=194, user_id=195, symbol=FB
2025-07-29 16:50:17,232 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:50:17,234 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:50:17,240 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,240 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,249 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,253 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,254 - src.common.dart_utils - ERROR - DART CORPCODE.xml 요청 실패: Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 25, in dart_get_all_stocks
    resp = await session.get(url, timeout=60)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 16:50:17,258 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,265 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,271 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,276 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,278 - src.common.dart_utils - ERROR - DART 공시 조회 API 요청 실패 (corp_code: 00123456): Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 79, in dart_get_disclosures
    resp = await session.get(url, params=params, timeout=10)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 16:50:17,283 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,287 - src.common.dart_utils - ERROR - DART 공시 API가 오류를 반환했습니다. status: 001, message: API 호출 오류, corp_code: 00123456
2025-07-29 16:50:17,402 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9633982537, username=testuser_9633982537
2025-07-29 16:50:17,412 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=212, telegram_id=9633982537
2025-07-29 16:50:17,660 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:17,918 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 16:50:18,167 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 16:50:18,171 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=214, symbol=005930
2025-07-29 16:50:18,178 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=214, symbol=005930
2025-07-29 16:50:18,179 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 16:50:18,185 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 214
2025-07-29 16:50:18,186 - src.api.services.user_service - DEBUG - User found by id: user_id=214
2025-07-29 16:50:18,187 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:50:18,188 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=214, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:50:18,198 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=11, user_id=214, symbol=005930
2025-07-29 16:50:18,200 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:50:18,204 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:50:18,207 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:50:18,208 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 16:50:18,209 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 16:50:18,210 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 16:50:18,217 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 16:50:18,222 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=214, symbol=005930, trade_type=buy
2025-07-29 16:50:18,222 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 16:50:18,226 - src.api.services.stock_service - WARNING - 현재가 없음: 005930. 임시 가격 생성.
2025-07-29 16:50:18,226 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: 195784
2025-07-29 16:50:18,232 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=214, symbol=005930, trade_type=buy
2025-07-29 16:50:18,233 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 16:50:18,236 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=214
2025-07-29 16:50:18,238 - src.api.routers.simulated_trade - DEBUG - 사용자(214)의 모의매매 이력 1건 조회됨.
2025-07-29 16:50:18,239 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 16:50:18,240 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/214 "HTTP/1.1 200 OK"
2025-07-29 16:50:18,251 - src.api.main - INFO - [APScheduler] 가격 알림 체크 잡 실행: 2025-07-29 16:50:18.251715
2025-07-29 16:50:18,252 - src.api.main - DEBUG - 활성 알림 수: 3
2025-07-29 16:50:18,252 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 16:50:18,252 - src.api.main - DEBUG - 종목 정상종목 현재가: 110
2025-07-29 16:50:18,256 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='139636728751888'>, 목표 가격: 100, 조건: gte, 반복 주기: <MagicMock name='mock.repeat_interval' id='139636740656432'>
2025-07-29 16:50:18,256 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목, 현재가: 110, 목표가: 100
2025-07-29 16:50:18,260 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='139636730575120'>)
2025-07-29 16:50:18,263 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 16:50:18,263 - src.api.main - DEBUG - 종목 오류종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 16:50:18,263 - src.api.main - ERROR - 가격 알림 확인 중 '오류종목' 처리 오류: 현재가 조회 실패
Traceback (most recent call last):
  File "/app/src/api/main.py", line 145, in check_price_alerts_job
    price_data = stock_service.get_current_price_and_change(symbol, db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1179, in _execute_mock_call
    result = effect(*args, **kwargs)
  File "/app/src/api/tests/test_main_jobs.py", line 34, in get_current_price_side_effect
    raise ValueError("현재가 조회 실패")
ValueError: 현재가 조회 실패
2025-07-29 16:50:18,264 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 16:50:18,264 - src.api.main - DEBUG - 종목 정상종목2 현재가: 290
2025-07-29 16:50:18,265 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='139636727051264'>, 목표 가격: 300, 조건: lte, 반복 주기: <MagicMock name='mock.repeat_interval' id='139636727099840'>
2025-07-29 16:50:18,266 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목2, 현재가: 290, 목표가: 300
2025-07-29 16:50:18,267 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='139636730575120'>)
2025-07-29 16:50:18,267 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 16:50:18,268 - src.api.main - DEBUG - 모든 가격 알림 체크 및 DB 커밋 완료.
2025-07-29 16:50:18,273 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:50:18,274 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(10일)
2025-07-29 16:50:18,281 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:50:18,282 - src.api.services.predict_service - ERROR - 예측 불가: 데이터 분석 실패
2025-07-29 16:50:18,288 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:50:18,289 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:50:18,303 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 상승 (24일 지속). 금일 변동: 보합. 최근 20일간 상승일: 19일, 하락일: 0일.
2025-07-29 16:50:18,304 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 16:50:18,310 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:50:18,311 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:50:18,318 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 하락 (24일 지속). 금일 변동: 보합. 최근 20일간 상승일: 0일, 하락일: 19일.
2025-07-29 16:50:18,319 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 16:50:18,329 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:50:18,330 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:50:18,337 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 횡보 (1일 지속). 금일 변동: 보합. 최근 20일간 상승일: 12일, 하락일: 7일.
2025-07-29 16:50:18,337 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 16:50:18,343 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:50:18,344 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:50:18,351 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=buy, reason=최근 추세: 하락 (1일 지속). 금일 변동: 횡보. 최근 20일간 상승일: 2일, 하락일: 17일. (저점 횡보 패턴 감지)
2025-07-29 16:50:18,351 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: buy
2025-07-29 16:50:18,357 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:50:18,359 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 22개 데이터.
2025-07-29 16:50:18,370 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, reason=최근 추세: 상승 (21일 지속). 금일 변동: 횡보. 최근 20일간 상승일: 19일, 하락일: 0일. (급등 후 횡보 패턴 감지)
2025-07-29 16:50:18,371 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 16:50:18,374 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:18,381 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 16:50:18,383 - src.api.services.stock_service - INFO - 신규 공시가 없습니다. (DB 기준: 202301010000001)
2025-07-29 16:50:18,638 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:18,643 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 16:50:18,650 - src.api.services.stock_service - ERROR - 신규 공시 확인 및 알림 작업 중 예상치 못한 오류 발생: (psycopg2.ProgrammingError) can't adapt type 'MagicMock'
[SQL: INSERT INTO system_config (key, value, created_at, updated_at) VALUES (%(key)s, %(value)s, now(), now()) RETURNING system_config.created_at, system_config.updated_at]
[parameters: {'key': 'last_checked_rcept_no', 'value': <MagicMock name='dart_get_disclosures().__getitem__().__getitem__()' id='139636728684960'>}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
psycopg2.ProgrammingError: can't adapt type 'MagicMock'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 59, in check_and_notify_new_disclosures
    db.commit()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4345, in flush
    self._flush(objects)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4480, in _flush
    with util.safe_reraise():
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4441, in _flush
    flush_context.execute()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1415, in execute
    return meth(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context
    return self._exec_single_context(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.ProgrammingError) can't adapt type 'MagicMock'
[SQL: INSERT INTO system_config (key, value, created_at, updated_at) VALUES (%(key)s, %(value)s, now(), now()) RETURNING system_config.created_at, system_config.updated_at]
[parameters: {'key': 'last_checked_rcept_no', 'value': <MagicMock name='dart_get_disclosures().__getitem__().__getitem__()' id='139636728684960'>}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-07-29 16:50:18,728 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:18,736 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 16:50:18,738 - src.api.services.stock_service - INFO - 신규 공시가 없습니다. (DB 기준: 202301010000001)
2025-07-29 16:50:18,803 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:18,873 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:50:18,986 - src.api.services.stock_service - ERROR - 신규 공시 확인 및 알림 작업 중 예상치 못한 오류 발생: (psycopg2.ProgrammingError) can't adapt type 'MagicMock'
[SQL: INSERT INTO system_config (key, value, created_at, updated_at) VALUES (%(key)s, %(value)s, now(), now()) RETURNING system_config.created_at, system_config.updated_at]
[parameters: {'key': 'last_checked_rcept_no', 'value': <MagicMock name='dart_get_disclosures().__getitem__().__getitem__()' id='139636730498592'>}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
psycopg2.ProgrammingError: can't adapt type 'MagicMock'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 59, in check_and_notify_new_disclosures
    db.commit()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4345, in flush
    self._flush(objects)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4480, in _flush
    with util.safe_reraise():
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4441, in _flush
    flush_context.execute()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1233, in _emit_insert_statements
    result = connection.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1415, in execute
    return meth(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 523, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1637, in _execute_clauseelement
    ret = self._execute_context(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1842, in _execute_context
    return self._exec_single_context(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1982, in _exec_single_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2351, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1963, in _exec_single_context
    self.dialect.do_execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 943, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.ProgrammingError) can't adapt type 'MagicMock'
[SQL: INSERT INTO system_config (key, value, created_at, updated_at) VALUES (%(key)s, %(value)s, now(), now()) RETURNING system_config.created_at, system_config.updated_at]
[parameters: {'key': 'last_checked_rcept_no', 'value': <MagicMock name='dart_get_disclosures().__getitem__().__getitem__()' id='139636730498592'>}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-07-29 16:50:19,045 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:08,618 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:51:08,624 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:51:08,628 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:51:08,628 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:51:08,628 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:51:08,629 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:51:09,494 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:09,509 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 16:51:09,516 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-07-29 16:51:09,517 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '<unknown>'
2025-07-29 16:51:09,518 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-07-29 16:51:09,802 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:09,805 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 16:51:10,042 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:10,046 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 16:51:10,279 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:10,282 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 16:51:10,284 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 16:51:10,288 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5839932131, username=testuser_5839932131
2025-07-29 16:51:10,305 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=1, telegram_id=5839932131
2025-07-29 16:51:10,539 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:10,784 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 200 OK"
2025-07-29 16:51:10,790 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3172757779, username=testuser_3172757779
2025-07-29 16:51:10,797 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=3, telegram_id=3172757779
2025-07-29 16:51:11,030 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:11,267 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:11,272 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3211233319, username=testuser_3211233319
2025-07-29 16:51:11,280 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=5, telegram_id=3211233319
2025-07-29 16:51:11,526 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:11,533 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:11,538 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9471744458, username=testuser_9471744458
2025-07-29 16:51:11,544 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=7, telegram_id=9471744458
2025-07-29 16:51:11,784 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:12,034 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 200 OK"
2025-07-29 16:51:12,041 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8403439400, username=testuser_8403439400
2025-07-29 16:51:12,048 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=9, telegram_id=8403439400
2025-07-29 16:51:12,281 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:12,522 - src.api.routers.admin - ERROR - /admin/update_master 서버 오류: DB connection error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 36, in update_stock_master
    result = await stock_service.update_stock_master(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DB connection error
2025-07-29 16:51:12,524 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:51:12,530 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8037801170, username=testuser_8037801170
2025-07-29 16:51:12,536 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=11, telegram_id=8037801170
2025-07-29 16:51:12,769 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:13,004 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:13,008 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2864150847, username=testuser_2864150847
2025-07-29 16:51:13,015 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=13, telegram_id=2864150847
2025-07-29 16:51:13,256 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:13,261 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:13,266 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7425587640, username=testuser_7425587640
2025-07-29 16:51:13,272 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=15, telegram_id=7425587640
2025-07-29 16:51:13,514 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:13,755 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 200 OK"
2025-07-29 16:51:13,760 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4509921235, username=testuser_4509921235
2025-07-29 16:51:13,767 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=17, telegram_id=4509921235
2025-07-29 16:51:14,001 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:14,250 - src.api.routers.admin - ERROR - /admin/update_price 서버 오류: API call failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 53, in update_daily_price
    result = await stock_service.update_daily_prices(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: API call failed
2025-07-29 16:51:14,251 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:51:14,257 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9843735005, username=testuser_9843735005
2025-07-29 16:51:14,265 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=19, telegram_id=9843735005
2025-07-29 16:51:14,502 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:14,742 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:14,747 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9412588891, username=testuser_9412588891
2025-07-29 16:51:14,755 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=21, telegram_id=9412588891
2025-07-29 16:51:14,993 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:14,999 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:15,004 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8680088242, username=testuser_8680088242
2025-07-29 16:51:15,009 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=23, telegram_id=8680088242
2025-07-29 16:51:15,244 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:15,486 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7fc8d3365690>
2025-07-29 16:51:15,487 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:51:15,490 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 200 OK"
2025-07-29 16:51:15,495 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2266521201, username=testuser_2266521201
2025-07-29 16:51:15,504 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=25, telegram_id=2266521201
2025-07-29 16:51:15,748 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:15,992 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7fc8d337c880>
2025-07-29 16:51:15,992 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:51:15,993 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 200 OK"
2025-07-29 16:51:15,998 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1517188221, username=testuser_1517188221
2025-07-29 16:51:16,005 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=27, telegram_id=1517188221
2025-07-29 16:51:16,243 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:16,496 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7fc8d324b850>
2025-07-29 16:51:16,496 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:51:16,498 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=%EC%B9%B4%EC%B9%B4%EC%98%A4 "HTTP/1.1 200 OK"
2025-07-29 16:51:16,503 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3459344634, username=testuser_3459344634
2025-07-29 16:51:16,509 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=29, telegram_id=3459344634
2025-07-29 16:51:16,743 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:17,067 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7fc8d30b4970>
2025-07-29 16:51:17,067 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:51:17,068 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=0013456 "HTTP/1.1 200 OK"
2025-07-29 16:51:17,073 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1007686879, username=testuser_1007686879
2025-07-29 16:51:17,079 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=31, telegram_id=1007686879
2025-07-29 16:51:17,311 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:17,557 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7fc8d30b6f80>
2025-07-29 16:51:17,557 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:51:17,559 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=NONEXIST "HTTP/1.1 404 Not Found"
2025-07-29 16:51:17,565 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7298894412, username=testuser_7298894412
2025-07-29 16:51:17,572 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=33, telegram_id=7298894412
2025-07-29 16:51:17,817 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:18,069 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7fc8d45078b0>
2025-07-29 16:51:18,070 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:51:18,070 - src.api.routers.admin - ERROR - /admin/update_disclosure 서버 오류: DART API error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 126, in update_disclosure
    result = await stock_service.update_disclosures(db, corp_code=corp_code, stock_code=stock_code or '', stock_name=stock_name or '')
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DART API error
2025-07-29 16:51:18,071 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:51:18,075 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4583124757, username=testuser_4583124757
2025-07-29 16:51:18,081 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=35, telegram_id=4583124757
2025-07-29 16:51:18,313 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:18,559 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:18,563 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9827778383, username=testuser_9827778383
2025-07-29 16:51:18,569 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=37, telegram_id=9827778383
2025-07-29 16:51:18,812 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:18,819 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:18,823 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7748697073, username=testuser_7748697073
2025-07-29 16:51:18,830 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=39, telegram_id=7748697073
2025-07-29 16:51:19,074 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:19,433 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 16:51:19,439 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6010615240, username=testuser_6010615240
2025-07-29 16:51:19,449 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=41, telegram_id=6010615240
2025-07-29 16:51:19,695 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:19,943 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 16:51:19,948 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2129829009, username=testuser_2129829009
2025-07-29 16:51:19,956 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=43, telegram_id=2129829009
2025-07-29 16:51:20,206 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:20,457 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:20,462 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8621201518, username=testuser_8621201518
2025-07-29 16:51:20,469 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=45, telegram_id=8621201518
2025-07-29 16:51:20,722 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:20,727 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:20,732 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2356442631, username=testuser_2356442631
2025-07-29 16:51:20,738 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=47, telegram_id=2356442631
2025-07-29 16:51:20,980 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:21,232 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 16:51:21,232 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 16:51:21,238 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9331014433, username=testuser_9331014433
2025-07-29 16:51:21,245 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=49, telegram_id=9331014433
2025-07-29 16:51:21,491 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:21,746 - src.api.routers.admin - ERROR - [trigger_job] 잡 실행 실패: test_job - Job execution failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 175, in trigger_job
    job.func(*job.args, **job.kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: Job execution failed

2025-07-29 16:51:21,746 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:51:21,753 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1577941775, username=testuser_1577941775
2025-07-29 16:51:21,760 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=51, telegram_id=1577941775
2025-07-29 16:51:22,008 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:22,255 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:22,260 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9669785474, username=testuser_9669785474
2025-07-29 16:51:22,270 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=53, telegram_id=9669785474
2025-07-29 16:51:22,526 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:22,533 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:22,539 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9290194202, username=testuser_9290194202
2025-07-29 16:51:22,547 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=55, telegram_id=9290194202
2025-07-29 16:51:22,792 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:23,045 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 16:51:23,047 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 200 OK"
2025-07-29 16:51:23,052 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3889334060, username=testuser_3889334060
2025-07-29 16:51:23,061 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=57, telegram_id=3889334060
2025-07-29 16:51:23,306 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:23,552 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 16:51:23,552 - src.api.routers.admin - ERROR - 공시 확인 잡 수동 실행 중 오류 발생: Disclosure check failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 193, in trigger_check_disclosures_job
    await stock_service.check_and_notify_new_disclosures(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: Disclosure check failed
2025-07-29 16:51:23,553 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:51:23,558 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5722029645, username=testuser_5722029645
2025-07-29 16:51:23,566 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=59, telegram_id=5722029645
2025-07-29 16:51:23,804 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:24,044 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:24,050 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3466754624, username=testuser_3466754624
2025-07-29 16:51:24,056 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=61, telegram_id=3466754624
2025-07-29 16:51:24,292 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:24,299 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:24,305 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7867421049, username=testuser_7867421049
2025-07-29 16:51:24,311 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=63, telegram_id=7867421049
2025-07-29 16:51:24,563 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:24,813 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:24,816 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=65, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:24,826 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=1, user_id=65, symbol=005930
2025-07-29 16:51:24,827 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:24,833 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6410775450, username=testuser_6410775450
2025-07-29 16:51:24,839 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=66, telegram_id=6410775450
2025-07-29 16:51:25,082 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:25,088 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:25,094 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9629907456, username=testuser_9629907456
2025-07-29 16:51:25,101 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=68, telegram_id=9629907456
2025-07-29 16:51:25,337 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:25,581 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:25,583 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 16:51:25,587 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5769411957, username=testuser_5769411957
2025-07-29 16:51:25,593 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=71, telegram_id=5769411957
2025-07-29 16:51:25,827 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:26,077 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:26,078 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:26,083 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=2, user_id=73, symbol=005930
2025-07-29 16:51:26,085 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:26,088 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:26,090 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=035720, target_price=50000.0, condition=lte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:26,097 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=3, user_id=73, symbol=035720
2025-07-29 16:51:26,099 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:26,101 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:26,103 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 조회 시도.
2025-07-29 16:51:26,106 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 2개 조회됨.
2025-07-29 16:51:26,108 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:26,113 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9789407197, username=testuser_9789407197
2025-07-29 16:51:26,118 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=74, telegram_id=9789407197
2025-07-29 16:51:26,419 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:26,672 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:26,673 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 조회 시도.
2025-07-29 16:51:26,674 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 0개 조회됨.
2025-07-29 16:51:26,676 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:26,681 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9808399772, username=testuser_9808399772
2025-07-29 16:51:26,687 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=77, telegram_id=9808399772
2025-07-29 16:51:26,782 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:26,786 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:26,790 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2330235692, username=testuser_2330235692
2025-07-29 16:51:26,796 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=79, telegram_id=2330235692
2025-07-29 16:51:27,029 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:27,264 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:27,265 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=81, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:27,270 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=4, user_id=81, symbol=005930
2025-07-29 16:51:27,271 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:27,275 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:27,275 - src.api.services.price_alert_service - DEBUG - 사용자(81)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:51:27,278 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=4
2025-07-29 16:51:27,280 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/81/symbol/005930 "HTTP/1.1 200 OK"
2025-07-29 16:51:27,284 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4954736157, username=testuser_4954736157
2025-07-29 16:51:27,289 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=82, telegram_id=4954736157
2025-07-29 16:51:27,519 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:27,752 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:27,753 - src.api.services.price_alert_service - DEBUG - 사용자(84)와 종목(NONEXISTENT)으로 가격 알림 조회 시도.
2025-07-29 16:51:27,754 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=84, symbol=NONEXISTENT
2025-07-29 16:51:27,755 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/84/symbol/NONEXISTENT "HTTP/1.1 404 Not Found"
2025-07-29 16:51:27,760 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4628016166, username=testuser_4628016166
2025-07-29 16:51:27,766 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=85, telegram_id=4628016166
2025-07-29 16:51:27,993 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:28,223 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:28,224 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=87, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:28,229 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=5, user_id=87, symbol=005930
2025-07-29 16:51:28,231 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:28,233 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:28,237 - src.api.services.price_alert_service - DEBUG - 가격 알림(5) 수정 시도: update_data={'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 16:51:28,239 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:51:28,240 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 16:51:28,240 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:51:28,247 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:51:28,248 - src.api.services.price_alert_service - INFO - 가격 알림(5) 수정 성공.
2025-07-29 16:51:28,250 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/5 "HTTP/1.1 200 OK"
2025-07-29 16:51:28,254 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2731320690, username=testuser_2731320690
2025-07-29 16:51:28,260 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=88, telegram_id=2731320690
2025-07-29 16:51:28,483 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:28,715 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:28,716 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=90, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:28,722 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=6, user_id=90, symbol=005930
2025-07-29 16:51:28,724 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:28,727 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/6 "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:28,732 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6543934334, username=testuser_6543934334
2025-07-29 16:51:28,739 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=91, telegram_id=6543934334
2025-07-29 16:51:28,971 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:29,207 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:29,209 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 16:51:29,210 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 16:51:29,212 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 16:51:29,216 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6006888757, username=testuser_6006888757
2025-07-29 16:51:29,222 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=94, telegram_id=6006888757
2025-07-29 16:51:29,458 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:29,920 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:29,921 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=96, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:29,926 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=7, user_id=96, symbol=005930
2025-07-29 16:51:29,928 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:29,931 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:29,932 - src.api.services.price_alert_service - DEBUG - 가격 알림(7) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 16:51:29,934 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:51:29,934 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0}
2025-07-29 16:51:29,934 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:51:29,939 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:51:29,940 - src.api.services.price_alert_service - INFO - 가격 알림(7) 수정 성공.
2025-07-29 16:51:29,942 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/7 "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:29,947 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1085667523, username=testuser_1085667523
2025-07-29 16:51:29,953 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=98, telegram_id=1085667523
2025-07-29 16:51:30,204 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:30,440 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:30,440 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=100, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:30,446 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=8, user_id=100, symbol=005930
2025-07-29 16:51:30,448 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:30,451 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:30,454 - src.api.services.price_alert_service - DEBUG - 가격 알림(8) 삭제 시도.
2025-07-29 16:51:30,460 - src.api.services.price_alert_service - INFO - 가격 알림(8) 삭제 성공.
2025-07-29 16:51:30,462 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/8 "HTTP/1.1 200 OK"
2025-07-29 16:51:30,469 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1467817409, username=testuser_1467817409
2025-07-29 16:51:30,476 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=101, telegram_id=1467817409
2025-07-29 16:51:30,723 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:30,963 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:30,964 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=103, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:30,969 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=9, user_id=103, symbol=005930
2025-07-29 16:51:30,970 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:30,972 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/9 "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:30,976 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1142489708, username=testuser_1142489708
2025-07-29 16:51:30,982 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=104, telegram_id=1142489708
2025-07-29 16:51:31,219 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:31,464 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:31,467 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 삭제 시도.
2025-07-29 16:51:31,468 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 16:51:31,470 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 16:51:31,475 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5086290191, username=testuser_5086290191
2025-07-29 16:51:31,481 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=107, telegram_id=5086290191
2025-07-29 16:51:31,709 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:32,170 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:32,171 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=109, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:32,176 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=10, user_id=109, symbol=005930
2025-07-29 16:51:32,178 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:32,181 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:32,185 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/10 "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:32,189 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3802940605, username=testuser_3802940605
2025-07-29 16:51:32,195 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=111, telegram_id=3802940605
2025-07-29 16:51:32,424 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:32,431 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 16:51:32,437 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9911567006, username=testuser_9911567006
2025-07-29 16:51:32,443 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=113, telegram_id=9911567006
2025-07-29 16:51:32,677 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:32,682 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 16:51:32,688 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:32,691 - httpx - INFO - HTTP Request: GET http://testserver/ "HTTP/1.1 200 OK"
2025-07-29 16:51:32,694 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8097499011, username=testuser_8097499011
2025-07-29 16:51:32,699 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=115, telegram_id=8097499011
2025-07-29 16:51:32,928 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:32,933 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:51:32,940 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:51:32,940 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 16:51:32,946 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 16:51:32,946 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 16:51:32,949 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 16:51:32,954 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3607982503, username=testuser_3607982503
2025-07-29 16:51:32,960 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=117, telegram_id=3607982503
2025-07-29 16:51:33,204 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:33,207 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:51:33,210 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=INVALID
2025-07-29 16:51:33,211 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=INVALID, days=40
2025-07-29 16:51:33,212 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 16:51:33,212 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 16:51:33,213 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 16:51:33,218 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9553148843, username=testuser_9553148843
2025-07-29 16:51:33,223 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=119, telegram_id=9553148843
2025-07-29 16:51:33,459 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:33,464 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:51:33,467 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 16:51:33,477 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7369134342, username=testuser_7369134342
2025-07-29 16:51:33,485 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=121, telegram_id=7369134342
2025-07-29 16:51:33,721 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:33,957 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=123, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 16:51:33,961 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 16:51:33,963 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:51:33,965 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/123 "HTTP/1.1 200 OK"
2025-07-29 16:51:33,973 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8104704834, username=testuser_8104704834
2025-07-29 16:51:33,979 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=124, telegram_id=8104704834
2025-07-29 16:51:34,214 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:34,220 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=99999, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 16:51:34,223 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 16:51:34,224 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:51:34,226 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/99999 "HTTP/1.1 200 OK"
2025-07-29 16:51:34,232 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4858453332, username=testuser_4858453332
2025-07-29 16:51:34,239 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=126, telegram_id=4858453332
2025-07-29 16:51:34,474 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:34,717 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=128, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 16:51:34,719 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 16:51:34,720 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:51:34,721 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/128 "HTTP/1.1 200 OK"
2025-07-29 16:51:34,726 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7214325411, username=testuser_7214325411
2025-07-29 16:51:34,732 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=129, telegram_id=7214325411
2025-07-29 16:51:35,051 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:35,315 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=1, page_size=5, symbol=None, prediction=None
2025-07-29 16:51:35,317 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 16:51:35,319 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 1, 페이지 크기 5).
2025-07-29 16:51:35,320 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=1&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 16:51:35,322 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=2, page_size=5, symbol=None, prediction=None
2025-07-29 16:51:35,324 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 16:51:35,325 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 2, 페이지 크기 5).
2025-07-29 16:51:35,327 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=2&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 16:51:35,334 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3202871781, username=testuser_3202871781
2025-07-29 16:51:35,341 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=132, telegram_id=3202871781
2025-07-29 16:51:35,576 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:35,829 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=134, page=1, page_size=10, symbol=005930, prediction=None
2025-07-29 16:51:35,830 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 16:51:35,834 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 16:51:35,837 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:51:35,839 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/134?symbol=005930 "HTTP/1.1 200 OK"
2025-07-29 16:51:35,846 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8846863453, username=testuser_8846863453
2025-07-29 16:51:35,853 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=135, telegram_id=8846863453
2025-07-29 16:51:36,084 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:36,334 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=137, page=1, page_size=10, symbol=None, prediction=상승
2025-07-29 16:51:36,335 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=상승
2025-07-29 16:51:36,338 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 16:51:36,340 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:51:36,342 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/137?prediction=%EC%83%81%EC%8A%B9 "HTTP/1.1 200 OK"
2025-07-29 16:51:36,348 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3298992274, username=testuser_3298992274
2025-07-29 16:51:36,354 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=138, telegram_id=3298992274
2025-07-29 16:51:36,585 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:36,825 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=140, page=1, page_size=10, symbol=005930, prediction=유지
2025-07-29 16:51:36,826 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 16:51:36,826 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=유지
2025-07-29 16:51:36,829 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 16:51:36,831 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:51:36,833 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/140?symbol=005930&prediction=%EC%9C%A0%EC%A7%80 "HTTP/1.1 200 OK"
2025-07-29 16:51:36,839 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5666338747, username=testuser_5666338747
2025-07-29 16:51:36,844 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=141, telegram_id=5666338747
2025-07-29 16:51:37,080 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:37,090 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=143, symbol=005930, trade_type=buy
2025-07-29 16:51:37,091 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 16:51:37,093 - src.api.services.stock_service - WARNING - 현재가 없음: 005930. 임시 가격 생성.
2025-07-29 16:51:37,093 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: 153129
2025-07-29 16:51:37,098 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=143, symbol=005930, trade_type=buy
2025-07-29 16:51:37,100 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 16:51:37,104 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=143
2025-07-29 16:51:37,107 - src.api.routers.simulated_trade - DEBUG - 사용자(143)의 모의매매 이력 1건 조회됨.
2025-07-29 16:51:37,108 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 16:51:37,109 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/143 "HTTP/1.1 200 OK"
2025-07-29 16:51:37,116 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8140746837, username=testuser_8140746837
2025-07-29 16:51:37,122 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=144, telegram_id=8140746837
2025-07-29 16:51:37,360 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:37,383 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 16:51:37,393 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7256368150, username=testuser_7256368150
2025-07-29 16:51:37,400 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=146, telegram_id=7256368150
2025-07-29 16:51:37,657 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:37,665 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 16:51:37,674 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3530652217, username=testuser_3530652217
2025-07-29 16:51:37,682 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=148, telegram_id=3530652217
2025-07-29 16:51:37,929 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:37,946 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%82%BC%EC%84%B1%EC%A0%84%EC%9E%90 "HTTP/1.1 200 OK"
2025-07-29 16:51:37,954 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4500095411, username=testuser_4500095411
2025-07-29 16:51:37,960 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=150, telegram_id=4500095411
2025-07-29 16:51:38,192 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:38,210 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=035720 "HTTP/1.1 200 OK"
2025-07-29 16:51:38,220 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4186529078, username=testuser_4186529078
2025-07-29 16:51:38,227 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=152, telegram_id=4186529078
2025-07-29 16:51:38,459 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:38,476 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=sk%ED%95%98%EC%9D%B4%EB%8B%89%EC%8A%A4 "HTTP/1.1 200 OK"
2025-07-29 16:51:38,485 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7230607113, username=testuser_7230607113
2025-07-29 16:51:38,491 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=154, telegram_id=7230607113
2025-07-29 16:51:38,726 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:38,736 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%97%86%EB%8A%94%EC%A2%85%EB%AA%A9 "HTTP/1.1 200 OK"
2025-07-29 16:51:38,741 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3790481712, username=testuser_3790481712
2025-07-29 16:51:38,746 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=156, telegram_id=3790481712
2025-07-29 16:51:38,977 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:38,984 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query= "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 16:51:38,989 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9622388470, username=testuser_9622388470
2025-07-29 16:51:38,994 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=158, telegram_id=9622388470
2025-07-29 16:51:39,227 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:39,234 - httpx - INFO - HTTP Request: GET http://testserver/symbols/005930/current_price_and_change "HTTP/1.1 200 OK"
2025-07-29 16:51:39,240 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1992904762, username=testuser_1992904762
2025-07-29 16:51:39,245 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=160, telegram_id=1992904762
2025-07-29 16:51:39,480 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:39,488 - httpx - INFO - HTTP Request: GET http://testserver/symbols/NONEXISTENT/current_price_and_change "HTTP/1.1 404 Not Found"
2025-07-29 16:51:39,494 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4499118994, username=testuser_4499118994
2025-07-29 16:51:39,501 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=162, telegram_id=4499118994
2025-07-29 16:51:39,750 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:39,999 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 16:51:40,004 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5313302683, username=testuser_5313302683
2025-07-29 16:51:40,012 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=165, telegram_id=5313302683
2025-07-29 16:51:40,255 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:40,515 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 400 Bad Request"
2025-07-29 16:51:40,520 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2778889636, username=testuser_2778889636
2025-07-29 16:51:40,526 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=168, telegram_id=2778889636
2025-07-29 16:51:40,798 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:41,298 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 16:51:41,305 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1423687767, username=testuser_1423687767
2025-07-29 16:51:41,313 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=171, telegram_id=1423687767
2025-07-29 16:51:41,557 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:41,567 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 16:51:41,573 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4394607266, username=testuser_4394607266
2025-07-29 16:51:41,579 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=173, telegram_id=4394607266
2025-07-29 16:51:41,829 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:42,325 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 16:51:42,332 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6302676479, username=testuser_6302676479
2025-07-29 16:51:42,340 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=176, telegram_id=6302676479
2025-07-29 16:51:42,594 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:42,850 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 178
2025-07-29 16:51:42,854 - src.api.services.user_service - DEBUG - User found by id: user_id=178
2025-07-29 16:51:42,860 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 16:51:42,864 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8178716124, username=testuser_8178716124
2025-07-29 16:51:42,870 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=179, telegram_id=8178716124
2025-07-29 16:51:43,183 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:43,189 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:43,196 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8356060306, username=testuser_8356060306
2025-07-29 16:51:43,203 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=181, telegram_id=8356060306
2025-07-29 16:51:43,446 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:43,694 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 183
2025-07-29 16:51:43,697 - src.api.services.user_service - DEBUG - User found by id: user_id=183
2025-07-29 16:51:43,712 - httpx - INFO - HTTP Request: PUT http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 16:51:43,718 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4728735665, username=testuser_4728735665
2025-07-29 16:51:43,723 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=184, telegram_id=4728735665
2025-07-29 16:51:43,964 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:43,980 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 16:51:43,985 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1097728833, username=testuser_1097728833
2025-07-29 16:51:43,991 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=187, telegram_id=1097728833
2025-07-29 16:51:44,234 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:44,508 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 16:51:44,514 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1227072926, username=testuser_1227072926
2025-07-29 16:51:44,521 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=190, telegram_id=1227072926
2025-07-29 16:51:44,774 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:45,021 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/192 "HTTP/1.1 200 OK"
2025-07-29 16:51:45,025 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7020462219, username=testuser_7020462219
2025-07-29 16:51:45,031 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=193, telegram_id=7020462219
2025-07-29 16:51:45,268 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:45,276 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/99999 "HTTP/1.1 404 Not Found"
2025-07-29 16:51:45,281 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2537060991, username=testuser_2537060991
2025-07-29 16:51:45,287 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=195, telegram_id=2537060991
2025-07-29 16:51:45,531 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:46,002 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 197
2025-07-29 16:51:46,005 - src.api.services.user_service - DEBUG - User found by id: user_id=197
2025-07-29 16:51:46,020 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 200 OK"
2025-07-29 16:51:46,025 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8468263640, username=testuser_8468263640
2025-07-29 16:51:46,031 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=199, telegram_id=8468263640
2025-07-29 16:51:46,287 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:46,537 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 201
2025-07-29 16:51:46,539 - src.api.services.user_service - DEBUG - User found by id: user_id=201
2025-07-29 16:51:46,541 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 403 Forbidden"
2025-07-29 16:51:46,547 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1492868425, username=testuser_1492868425
2025-07-29 16:51:46,555 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=202, telegram_id=1492868425
2025-07-29 16:51:46,823 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:46,834 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=204, symbol=005930
2025-07-29 16:51:46,845 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=204, symbol=005930
2025-07-29 16:51:46,847 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 16:51:46,852 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 시도: user_id=204
2025-07-29 16:51:46,856 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 성공: user_id=204, 1개 종목.
2025-07-29 16:51:46,858 - httpx - INFO - HTTP Request: GET http://testserver/watchlist/get/204 "HTTP/1.1 200 OK"
2025-07-29 16:51:46,865 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:46,868 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:51:46,868 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:51:46,874 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:46,877 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12345
2025-07-29 16:51:46,881 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=1, telegram_id=12345
2025-07-29 16:51:46,881 - src.api.services.price_alert_service - DEBUG - 사용자(1)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:51:46,886 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=1
2025-07-29 16:51:46,886 - src.api.services.price_alert_service - DEBUG - 가격 알림(1) 수정 시도: update_data={'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 16:51:46,889 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:51:46,890 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 16:51:46,890 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:51:46,893 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:51:46,893 - src.api.services.price_alert_service - INFO - 가격 알림(1) 수정 성공.
2025-07-29 16:51:46,895 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:51:46,902 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:51:46,903 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:51:46,908 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:46,909 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 16:51:46,912 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 16:51:46,913 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:51:46,915 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 16:51:46,916 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 16:51:46,917 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:51:46,918 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 16:51:46,918 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:51:46,929 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:51:46,929 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 16:51:46,931 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:51:46,935 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:46,936 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 16:51:46,939 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 16:51:46,939 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:51:46,941 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 16:51:46,941 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 16:51:46,943 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:51:46,943 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 16:51:46,944 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:51:46,951 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:51:46,951 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 16:51:46,953 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:51:46,966 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7877467834, username=testuser_7877467834
2025-07-29 16:51:46,975 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=205, telegram_id=7877467834
2025-07-29 16:51:46,978 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:46,981 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:51:46,982 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:46,985 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 7877467834
2025-07-29 16:51:46,989 - src.api.services.user_service - DEBUG - User not found for telegram_id: 7877467834
2025-07-29 16:51:46,990 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7877467834, username=testuser_7877467834
2025-07-29 16:51:46,998 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=196, telegram_id=7877467834
2025-07-29 16:51:46,998 - src.api.services.price_alert_service - DEBUG - 사용자(196)와 종목(GOOG)으로 가격 알림 조회 시도.
2025-07-29 16:51:46,999 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=196, symbol=GOOG
2025-07-29 16:51:46,999 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=196, symbol=GOOG, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:47,006 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=195, user_id=196, symbol=GOOG
2025-07-29 16:51:47,008 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:51:47,010 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:51:47,016 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1779291909, username=testuser_1779291909
2025-07-29 16:51:47,023 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=206, telegram_id=1779291909
2025-07-29 16:51:47,026 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,030 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:51:47,031 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:47,032 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 1779291909
2025-07-29 16:51:47,034 - src.api.services.user_service - DEBUG - User not found for telegram_id: 1779291909
2025-07-29 16:51:47,034 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1779291909, username=telegram_user_1779291909
2025-07-29 16:51:47,042 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=197, telegram_id=1779291909
2025-07-29 16:51:47,043 - src.api.services.price_alert_service - DEBUG - 사용자(197)와 종목(MSFT)으로 가격 알림 조회 시도.
2025-07-29 16:51:47,045 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=197, symbol=MSFT
2025-07-29 16:51:47,045 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=197, symbol=MSFT, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:47,052 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=196, user_id=197, symbol=MSFT
2025-07-29 16:51:47,054 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:51:47,057 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:51:47,064 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6179910988, username=testuser_6179910988
2025-07-29 16:51:47,072 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=207, telegram_id=6179910988
2025-07-29 16:51:47,078 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,081 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:51:47,082 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:47,082 - src.api.routers.bot_router - DEBUG - Before toggle: existing_alert.notify_on_disclosure = True
2025-07-29 16:51:47,083 - src.api.routers.bot_router - DEBUG - Calculated new_status: False
2025-07-29 16:51:47,083 - src.api.routers.bot_router - DEBUG - After update_alert call: updated_alert_orm.notify_on_disclosure = False
2025-07-29 16:51:47,084 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:51:47,086 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:51:47,093 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1813104434, username=testuser_1813104434
2025-07-29 16:51:47,100 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=208, telegram_id=1813104434
2025-07-29 16:51:47,103 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,108 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:51:47,109 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:47,110 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 1813104434
2025-07-29 16:51:47,111 - src.api.services.user_service - DEBUG - User not found for telegram_id: 1813104434
2025-07-29 16:51:47,112 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1813104434, username=telegram_user_1813104434
2025-07-29 16:51:47,116 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=198, telegram_id=1813104434
2025-07-29 16:51:47,117 - src.api.services.price_alert_service - DEBUG - 사용자(198)와 종목(NFLX)으로 가격 알림 조회 시도.
2025-07-29 16:51:47,118 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=198, symbol=NFLX
2025-07-29 16:51:47,118 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=198, symbol=NFLX, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:47,124 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=197, user_id=198, symbol=NFLX
2025-07-29 16:51:47,125 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:51:47,127 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:51:47,132 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9963877916, username=testuser_9963877916
2025-07-29 16:51:47,138 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=209, telegram_id=9963877916
2025-07-29 16:51:47,141 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,144 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:51:47,144 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:47,145 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 9963877916
2025-07-29 16:51:47,147 - src.api.services.user_service - DEBUG - User not found for telegram_id: 9963877916
2025-07-29 16:51:47,148 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9963877916, username=testuser_9963877916
2025-07-29 16:51:47,156 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=199, telegram_id=9963877916
2025-07-29 16:51:47,157 - src.api.services.price_alert_service - DEBUG - 사용자(199)와 종목(NVDA)으로 가격 알림 조회 시도.
2025-07-29 16:51:47,158 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=199, symbol=NVDA
2025-07-29 16:51:47,160 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=199, symbol=NVDA, target_price=1000.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:47,167 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=198, user_id=199, symbol=NVDA
2025-07-29 16:51:47,169 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:51:47,172 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:51:47,180 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2295460914, username=testuser_2295460914
2025-07-29 16:51:47,189 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=210, telegram_id=2295460914
2025-07-29 16:51:47,194 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,197 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:51:47,198 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:47,199 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 2295460914
2025-07-29 16:51:47,202 - src.api.services.user_service - DEBUG - User not found for telegram_id: 2295460914
2025-07-29 16:51:47,202 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2295460914, username=telegram_user_2295460914
2025-07-29 16:51:47,208 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=200, telegram_id=2295460914
2025-07-29 16:51:47,208 - src.api.services.price_alert_service - DEBUG - 사용자(200)와 종목(GOOGL)으로 가격 알림 조회 시도.
2025-07-29 16:51:47,210 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=200, symbol=GOOGL
2025-07-29 16:51:47,210 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=200, symbol=GOOGL, target_price=110.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=weekly
2025-07-29 16:51:47,216 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=199, user_id=200, symbol=GOOGL
2025-07-29 16:51:47,218 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:51:47,221 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:51:47,228 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1959456069, username=testuser_1959456069
2025-07-29 16:51:47,237 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=211, telegram_id=1959456069
2025-07-29 16:51:47,242 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,246 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:51:47,247 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:47,249 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 1959456069
2025-07-29 16:51:47,251 - src.api.services.user_service - DEBUG - User not found for telegram_id: 1959456069
2025-07-29 16:51:47,252 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1959456069, username=telegram_user_1959456069
2025-07-29 16:51:47,260 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=201, telegram_id=1959456069
2025-07-29 16:51:47,260 - src.api.services.price_alert_service - DEBUG - 사용자(201)와 종목(FB)으로 가격 알림 조회 시도.
2025-07-29 16:51:47,263 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=201, symbol=FB
2025-07-29 16:51:47,264 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=201, symbol=FB, target_price=300.0, condition=above, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:47,272 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=200, user_id=201, symbol=FB
2025-07-29 16:51:47,275 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:51:47,278 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:51:47,283 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,283 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,294 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,300 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,302 - src.common.dart_utils - ERROR - DART CORPCODE.xml 요청 실패: Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 25, in dart_get_all_stocks
    resp = await session.get(url, timeout=60)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 16:51:47,308 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,439 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,448 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,457 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,461 - src.common.dart_utils - ERROR - DART 공시 조회 API 요청 실패 (corp_code: 00123456): Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 79, in dart_get_disclosures
    resp = await session.get(url, params=params, timeout=10)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 16:51:47,469 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:47,473 - src.common.dart_utils - ERROR - DART 공시 API가 오류를 반환했습니다. status: 001, message: API 호출 오류, corp_code: 00123456
2025-07-29 16:51:47,605 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4379272337, username=testuser_4379272337
2025-07-29 16:51:47,613 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=212, telegram_id=4379272337
2025-07-29 16:51:47,889 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:48,155 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 16:51:48,412 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 16:51:48,418 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=214, symbol=005930
2025-07-29 16:51:48,425 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=214, symbol=005930
2025-07-29 16:51:48,427 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 16:51:48,432 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 214
2025-07-29 16:51:48,434 - src.api.services.user_service - DEBUG - User found by id: user_id=214
2025-07-29 16:51:48,435 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:51:48,435 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=214, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:51:48,442 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=11, user_id=214, symbol=005930
2025-07-29 16:51:48,444 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:51:48,446 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:51:48,449 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:51:48,449 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 16:51:48,452 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 16:51:48,453 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 16:51:48,458 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 16:51:48,462 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=214, symbol=005930, trade_type=buy
2025-07-29 16:51:48,462 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 16:51:48,465 - src.api.services.stock_service - WARNING - 현재가 없음: 005930. 임시 가격 생성.
2025-07-29 16:51:48,466 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: 60410
2025-07-29 16:51:48,471 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=214, symbol=005930, trade_type=buy
2025-07-29 16:51:48,474 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 16:51:48,477 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=214
2025-07-29 16:51:48,480 - src.api.routers.simulated_trade - DEBUG - 사용자(214)의 모의매매 이력 1건 조회됨.
2025-07-29 16:51:48,480 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 16:51:48,482 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/214 "HTTP/1.1 200 OK"
2025-07-29 16:51:48,492 - src.api.main - INFO - [APScheduler] 가격 알림 체크 잡 실행: 2025-07-29 16:51:48.492336
2025-07-29 16:51:48,492 - src.api.main - DEBUG - 활성 알림 수: 3
2025-07-29 16:51:48,493 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 16:51:48,495 - src.api.main - DEBUG - 종목 정상종목 현재가: 110
2025-07-29 16:51:48,497 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='140500512581680'>, 목표 가격: 100, 조건: gte, 반복 주기: <MagicMock name='mock.repeat_interval' id='140500512638624'>
2025-07-29 16:51:48,497 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목, 현재가: 110, 목표가: 100
2025-07-29 16:51:48,501 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='140500514976768'>)
2025-07-29 16:51:48,502 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 16:51:48,502 - src.api.main - DEBUG - 종목 오류종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 16:51:48,502 - src.api.main - ERROR - 가격 알림 확인 중 '오류종목' 처리 오류: 현재가 조회 실패
Traceback (most recent call last):
  File "/app/src/api/main.py", line 145, in check_price_alerts_job
    price_data = stock_service.get_current_price_and_change(symbol, db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1179, in _execute_mock_call
    result = effect(*args, **kwargs)
  File "/app/src/api/tests/test_main_jobs.py", line 34, in get_current_price_side_effect
    raise ValueError("현재가 조회 실패")
ValueError: 현재가 조회 실패
2025-07-29 16:51:48,503 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 16:51:48,503 - src.api.main - DEBUG - 종목 정상종목2 현재가: 290
2025-07-29 16:51:48,504 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='140500532217840'>, 목표 가격: 300, 조건: lte, 반복 주기: <MagicMock name='mock.repeat_interval' id='140500513535984'>
2025-07-29 16:51:48,504 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목2, 현재가: 290, 목표가: 300
2025-07-29 16:51:48,505 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='140500514976768'>)
2025-07-29 16:51:48,505 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 16:51:48,505 - src.api.main - DEBUG - 모든 가격 알림 체크 및 DB 커밋 완료.
2025-07-29 16:51:48,510 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:51:48,510 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(10일)
2025-07-29 16:51:48,513 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:51:48,514 - src.api.services.predict_service - ERROR - 예측 불가: 데이터 분석 실패
2025-07-29 16:51:48,516 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:51:48,517 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:51:48,523 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 상승 (24일 지속). 금일 변동: 보합. 최근 20일간 상승일: 19일, 하락일: 0일.
2025-07-29 16:51:48,523 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 16:51:48,526 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:51:48,527 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:51:48,532 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 하락 (24일 지속). 금일 변동: 보합. 최근 20일간 상승일: 0일, 하락일: 19일.
2025-07-29 16:51:48,532 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 16:51:48,536 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:51:48,536 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:51:48,543 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 횡보 (1일 지속). 금일 변동: 보합. 최근 20일간 상승일: 12일, 하락일: 7일.
2025-07-29 16:51:48,544 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 16:51:48,548 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:51:48,549 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:51:48,557 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=buy, reason=최근 추세: 하락 (1일 지속). 금일 변동: 횡보. 최근 20일간 상승일: 2일, 하락일: 17일. (저점 횡보 패턴 감지)
2025-07-29 16:51:48,557 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: buy
2025-07-29 16:51:48,562 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:51:48,562 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 22개 데이터.
2025-07-29 16:51:48,568 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, reason=최근 추세: 상승 (21일 지속). 금일 변동: 횡보. 최근 20일간 상승일: 19일, 하락일: 0일. (급등 후 횡보 패턴 감지)
2025-07-29 16:51:48,569 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 16:51:48,572 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:48,579 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 16:51:48,579 - src.api.services.stock_service - INFO - 신규 공시가 없습니다. (DB 기준: 202301010000001)
2025-07-29 16:51:48,585 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:48,591 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 16:51:48,598 - src.api.services.stock_service - INFO - 최초 실행. 기준 접수번호를 202301020000001로 DB에 설정합니다.
2025-07-29 16:51:48,700 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:48,707 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 16:51:48,707 - src.api.services.stock_service - INFO - 2건의 신규 공시를 발견했습니다.
2025-07-29 16:51:48,708 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 16:51:48,710 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 16:51:48,710 - src.api.services.stock_service - INFO - 마지막 확인 접수번호를 202301020000002로 DB에 갱신합니다.
2025-07-29 16:51:48,800 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:48,806 - src.api.services.stock_service - CRITICAL - DART API 사용 한도를 초과했습니다: [020] 사용 한도 초과
2025-07-29 16:51:48,820 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:48,826 - src.api.services.stock_service - ERROR - DART 공시 조회 중 API 오류 발생: [999] 기타 API 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 39, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
src.common.exceptions.DartApiError: [999] 기타 API 오류
2025-07-29 16:51:48,839 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:51:48,848 - src.api.services.stock_service - ERROR - 신규 공시 확인 및 알림 작업 중 예상치 못한 오류 발생: 예상치 못한 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 39, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: 예상치 못한 오류
2025-07-29 16:52:38,294 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:52:38,300 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 16:52:38,303 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:52:38,303 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:52:38,304 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:52:38,304 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 16:52:39,207 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:39,211 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 16:52:39,216 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-07-29 16:52:39,217 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '<unknown>'
2025-07-29 16:52:39,218 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-07-29 16:52:39,479 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:39,482 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 16:52:39,718 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:39,721 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 16:52:39,955 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:39,957 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 16:52:39,959 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 16:52:39,961 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9626613260, username=testuser_9626613260
2025-07-29 16:52:39,974 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=1, telegram_id=9626613260
2025-07-29 16:52:40,218 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:40,486 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 200 OK"
2025-07-29 16:52:40,490 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2589948735, username=testuser_2589948735
2025-07-29 16:52:40,497 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=3, telegram_id=2589948735
2025-07-29 16:52:40,743 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:40,990 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:40,993 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7903469062, username=testuser_7903469062
2025-07-29 16:52:41,000 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=5, telegram_id=7903469062
2025-07-29 16:52:41,236 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:41,241 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:41,244 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9878293546, username=testuser_9878293546
2025-07-29 16:52:41,249 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=7, telegram_id=9878293546
2025-07-29 16:52:41,481 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:41,723 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 200 OK"
2025-07-29 16:52:41,727 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8991244088, username=testuser_8991244088
2025-07-29 16:52:41,734 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=9, telegram_id=8991244088
2025-07-29 16:52:41,964 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:42,206 - src.api.routers.admin - ERROR - /admin/update_master 서버 오류: DB connection error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 36, in update_stock_master
    result = await stock_service.update_stock_master(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DB connection error
2025-07-29 16:52:42,208 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:52:42,213 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8256812271, username=testuser_8256812271
2025-07-29 16:52:42,219 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=11, telegram_id=8256812271
2025-07-29 16:52:42,482 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:42,761 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:42,765 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3029266170, username=testuser_3029266170
2025-07-29 16:52:42,772 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=13, telegram_id=3029266170
2025-07-29 16:52:43,021 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:43,028 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:43,034 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7351893568, username=testuser_7351893568
2025-07-29 16:52:43,042 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=15, telegram_id=7351893568
2025-07-29 16:52:43,313 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:43,565 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 200 OK"
2025-07-29 16:52:43,570 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2788205584, username=testuser_2788205584
2025-07-29 16:52:43,577 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=17, telegram_id=2788205584
2025-07-29 16:52:43,817 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:44,059 - src.api.routers.admin - ERROR - /admin/update_price 서버 오류: API call failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 53, in update_daily_price
    result = await stock_service.update_daily_prices(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: API call failed
2025-07-29 16:52:44,061 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:52:44,065 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3283062181, username=testuser_3283062181
2025-07-29 16:52:44,073 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=19, telegram_id=3283062181
2025-07-29 16:52:44,314 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:44,579 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:44,584 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8668962007, username=testuser_8668962007
2025-07-29 16:52:44,591 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=21, telegram_id=8668962007
2025-07-29 16:52:44,834 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:44,842 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:44,848 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4132025116, username=testuser_4132025116
2025-07-29 16:52:44,855 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=23, telegram_id=4132025116
2025-07-29 16:52:45,088 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:45,334 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f70e47e7a60>
2025-07-29 16:52:45,335 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:52:45,338 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 200 OK"
2025-07-29 16:52:45,344 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2436143430, username=testuser_2436143430
2025-07-29 16:52:45,353 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=25, telegram_id=2436143430
2025-07-29 16:52:45,606 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:45,845 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f70e47fc9d0>
2025-07-29 16:52:45,846 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:52:45,847 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 200 OK"
2025-07-29 16:52:45,851 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9653232589, username=testuser_9653232589
2025-07-29 16:52:45,858 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=27, telegram_id=9653232589
2025-07-29 16:52:46,164 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:46,409 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f70e46cb8e0>
2025-07-29 16:52:46,410 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:52:46,411 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=%EC%B9%B4%EC%B9%B4%EC%98%A4 "HTTP/1.1 200 OK"
2025-07-29 16:52:46,417 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3229488963, username=testuser_3229488963
2025-07-29 16:52:46,425 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=29, telegram_id=3229488963
2025-07-29 16:52:46,660 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:47,000 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f70e4536920>
2025-07-29 16:52:47,000 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:52:47,001 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=0013456 "HTTP/1.1 200 OK"
2025-07-29 16:52:47,007 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5652841417, username=testuser_5652841417
2025-07-29 16:52:47,015 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=31, telegram_id=5652841417
2025-07-29 16:52:47,254 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:47,505 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f70e4537970>
2025-07-29 16:52:47,505 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:52:47,506 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=NONEXIST "HTTP/1.1 404 Not Found"
2025-07-29 16:52:47,511 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2733026704, username=testuser_2733026704
2025-07-29 16:52:47,519 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=33, telegram_id=2733026704
2025-07-29 16:52:47,760 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:48,002 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f70e592e0e0>
2025-07-29 16:52:48,003 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 16:52:48,003 - src.api.routers.admin - ERROR - /admin/update_disclosure 서버 오류: DART API error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 126, in update_disclosure
    result = await stock_service.update_disclosures(db, corp_code=corp_code, stock_code=stock_code or '', stock_name=stock_name or '')
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DART API error
2025-07-29 16:52:48,005 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:52:48,010 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3043175187, username=testuser_3043175187
2025-07-29 16:52:48,016 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=35, telegram_id=3043175187
2025-07-29 16:52:48,250 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:48,498 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:48,502 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3958682570, username=testuser_3958682570
2025-07-29 16:52:48,508 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=37, telegram_id=3958682570
2025-07-29 16:52:48,745 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:48,752 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:48,757 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9573860523, username=testuser_9573860523
2025-07-29 16:52:48,762 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=39, telegram_id=9573860523
2025-07-29 16:52:48,999 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:49,261 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 16:52:49,266 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3064006361, username=testuser_3064006361
2025-07-29 16:52:49,273 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=41, telegram_id=3064006361
2025-07-29 16:52:49,507 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:49,749 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 16:52:49,755 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1306569441, username=testuser_1306569441
2025-07-29 16:52:49,762 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=43, telegram_id=1306569441
2025-07-29 16:52:50,001 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:50,241 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:50,247 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8025156843, username=testuser_8025156843
2025-07-29 16:52:50,254 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=45, telegram_id=8025156843
2025-07-29 16:52:50,487 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:50,492 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:50,497 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5733295091, username=testuser_5733295091
2025-07-29 16:52:50,504 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=47, telegram_id=5733295091
2025-07-29 16:52:50,743 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:50,985 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 16:52:50,986 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 16:52:50,990 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9824992906, username=testuser_9824992906
2025-07-29 16:52:50,996 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=49, telegram_id=9824992906
2025-07-29 16:52:51,234 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:51,481 - src.api.routers.admin - ERROR - [trigger_job] 잡 실행 실패: test_job - Job execution failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 175, in trigger_job
    job.func(*job.args, **job.kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: Job execution failed

2025-07-29 16:52:51,482 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:52:51,486 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4274319598, username=testuser_4274319598
2025-07-29 16:52:51,494 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=51, telegram_id=4274319598
2025-07-29 16:52:51,733 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:51,984 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:51,989 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7681497399, username=testuser_7681497399
2025-07-29 16:52:51,996 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=53, telegram_id=7681497399
2025-07-29 16:52:52,240 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:52,245 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:52,251 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1327568253, username=testuser_1327568253
2025-07-29 16:52:52,258 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=55, telegram_id=1327568253
2025-07-29 16:52:52,500 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:52,737 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 16:52:52,738 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 200 OK"
2025-07-29 16:52:52,742 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3945652005, username=testuser_3945652005
2025-07-29 16:52:52,750 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=57, telegram_id=3945652005
2025-07-29 16:52:53,010 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:53,329 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 16:52:53,329 - src.api.routers.admin - ERROR - 공시 확인 잡 수동 실행 중 오류 발생: Disclosure check failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 193, in trigger_check_disclosures_job
    await stock_service.check_and_notify_new_disclosures(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: Disclosure check failed
2025-07-29 16:52:53,331 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 500 Internal Server Error"
2025-07-29 16:52:53,340 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8438879635, username=testuser_8438879635
2025-07-29 16:52:53,348 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=59, telegram_id=8438879635
2025-07-29 16:52:53,655 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:53,895 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:53,900 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1686466610, username=testuser_1686466610
2025-07-29 16:52:53,907 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=61, telegram_id=1686466610
2025-07-29 16:52:54,146 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:54,153 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:54,159 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4315813680, username=testuser_4315813680
2025-07-29 16:52:54,165 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=63, telegram_id=4315813680
2025-07-29 16:52:54,407 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:54,648 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:54,651 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=65, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:52:54,660 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=1, user_id=65, symbol=005930
2025-07-29 16:52:54,662 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:52:54,669 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2639229709, username=testuser_2639229709
2025-07-29 16:52:54,674 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=66, telegram_id=2639229709
2025-07-29 16:52:54,909 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:54,914 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:54,919 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9267291991, username=testuser_9267291991
2025-07-29 16:52:54,925 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=68, telegram_id=9267291991
2025-07-29 16:52:55,168 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:55,410 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:55,412 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 16:52:55,416 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1166279083, username=testuser_1166279083
2025-07-29 16:52:55,422 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=71, telegram_id=1166279083
2025-07-29 16:52:55,667 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:55,914 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:55,915 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:52:55,920 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=2, user_id=73, symbol=005930
2025-07-29 16:52:55,922 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:52:55,924 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:55,926 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=035720, target_price=50000.0, condition=lte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:52:55,931 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=3, user_id=73, symbol=035720
2025-07-29 16:52:55,933 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:52:55,935 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:55,938 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 조회 시도.
2025-07-29 16:52:55,940 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 2개 조회됨.
2025-07-29 16:52:55,942 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:52:55,948 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8706146985, username=testuser_8706146985
2025-07-29 16:52:55,956 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=74, telegram_id=8706146985
2025-07-29 16:52:56,199 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:56,295 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:56,296 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 조회 시도.
2025-07-29 16:52:56,298 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 0개 조회됨.
2025-07-29 16:52:56,299 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:52:56,305 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9106297261, username=testuser_9106297261
2025-07-29 16:52:56,311 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=77, telegram_id=9106297261
2025-07-29 16:52:56,548 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:56,552 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:56,556 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4479992524, username=testuser_4479992524
2025-07-29 16:52:56,561 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=79, telegram_id=4479992524
2025-07-29 16:52:56,797 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:57,045 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:57,046 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=81, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:52:57,051 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=4, user_id=81, symbol=005930
2025-07-29 16:52:57,052 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:52:57,056 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:57,056 - src.api.services.price_alert_service - DEBUG - 사용자(81)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:52:57,059 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=4
2025-07-29 16:52:57,061 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/81/symbol/005930 "HTTP/1.1 200 OK"
2025-07-29 16:52:57,066 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5099234413, username=testuser_5099234413
2025-07-29 16:52:57,071 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=82, telegram_id=5099234413
2025-07-29 16:52:57,298 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:57,534 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:57,534 - src.api.services.price_alert_service - DEBUG - 사용자(84)와 종목(NONEXISTENT)으로 가격 알림 조회 시도.
2025-07-29 16:52:57,536 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=84, symbol=NONEXISTENT
2025-07-29 16:52:57,537 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/84/symbol/NONEXISTENT "HTTP/1.1 404 Not Found"
2025-07-29 16:52:57,542 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2227422185, username=testuser_2227422185
2025-07-29 16:52:57,547 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=85, telegram_id=2227422185
2025-07-29 16:52:57,775 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:58,008 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:58,009 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=87, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:52:58,014 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=5, user_id=87, symbol=005930
2025-07-29 16:52:58,016 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:52:58,018 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:58,021 - src.api.services.price_alert_service - DEBUG - 가격 알림(5) 수정 시도: update_data={'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 16:52:58,024 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:52:58,025 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 16:52:58,025 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:52:58,031 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:52:58,032 - src.api.services.price_alert_service - INFO - 가격 알림(5) 수정 성공.
2025-07-29 16:52:58,035 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/5 "HTTP/1.1 200 OK"
2025-07-29 16:52:58,040 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1108905592, username=testuser_1108905592
2025-07-29 16:52:58,048 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=88, telegram_id=1108905592
2025-07-29 16:52:58,278 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:58,523 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:58,524 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=90, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:52:58,528 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=6, user_id=90, symbol=005930
2025-07-29 16:52:58,530 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:52:58,532 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/6 "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:58,537 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1709752574, username=testuser_1709752574
2025-07-29 16:52:58,544 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=91, telegram_id=1709752574
2025-07-29 16:52:58,772 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:59,004 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:59,005 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 16:52:59,006 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 16:52:59,008 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 16:52:59,012 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4067867393, username=testuser_4067867393
2025-07-29 16:52:59,017 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=94, telegram_id=4067867393
2025-07-29 16:52:59,249 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:52:59,703 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:59,704 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=96, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:52:59,709 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=7, user_id=96, symbol=005930
2025-07-29 16:52:59,710 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:52:59,712 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:52:59,713 - src.api.services.price_alert_service - DEBUG - 가격 알림(7) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 16:52:59,714 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:52:59,714 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0}
2025-07-29 16:52:59,714 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:52:59,719 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:52:59,719 - src.api.services.price_alert_service - INFO - 가격 알림(7) 수정 성공.
2025-07-29 16:52:59,721 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/7 "HTTP/1.1 403 Forbidden"
2025-07-29 16:52:59,726 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7758227545, username=testuser_7758227545
2025-07-29 16:52:59,731 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=98, telegram_id=7758227545
2025-07-29 16:52:59,970 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:00,282 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:00,283 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=100, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:53:00,290 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=8, user_id=100, symbol=005930
2025-07-29 16:53:00,292 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:53:00,296 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:00,300 - src.api.services.price_alert_service - DEBUG - 가격 알림(8) 삭제 시도.
2025-07-29 16:53:00,306 - src.api.services.price_alert_service - INFO - 가격 알림(8) 삭제 성공.
2025-07-29 16:53:00,308 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/8 "HTTP/1.1 200 OK"
2025-07-29 16:53:00,315 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5411842215, username=testuser_5411842215
2025-07-29 16:53:00,321 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=101, telegram_id=5411842215
2025-07-29 16:53:00,561 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:00,800 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:00,801 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=103, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:53:00,806 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=9, user_id=103, symbol=005930
2025-07-29 16:53:00,808 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:53:00,811 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/9 "HTTP/1.1 403 Forbidden"
2025-07-29 16:53:00,815 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3571647723, username=testuser_3571647723
2025-07-29 16:53:00,821 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=104, telegram_id=3571647723
2025-07-29 16:53:01,055 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:01,289 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:01,291 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 삭제 시도.
2025-07-29 16:53:01,292 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 16:53:01,293 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 16:53:01,297 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1272725276, username=testuser_1272725276
2025-07-29 16:53:01,303 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=107, telegram_id=1272725276
2025-07-29 16:53:01,530 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:01,996 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:01,998 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=109, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:53:02,004 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=10, user_id=109, symbol=005930
2025-07-29 16:53:02,006 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:53:02,010 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:02,016 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/10 "HTTP/1.1 403 Forbidden"
2025-07-29 16:53:02,021 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1579413125, username=testuser_1579413125
2025-07-29 16:53:02,029 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=111, telegram_id=1579413125
2025-07-29 16:53:02,265 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:02,270 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 16:53:02,275 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6720658480, username=testuser_6720658480
2025-07-29 16:53:02,282 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=113, telegram_id=6720658480
2025-07-29 16:53:02,509 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:02,514 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 16:53:02,520 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:02,524 - httpx - INFO - HTTP Request: GET http://testserver/ "HTTP/1.1 200 OK"
2025-07-29 16:53:02,527 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2278989827, username=testuser_2278989827
2025-07-29 16:53:02,533 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=115, telegram_id=2278989827
2025-07-29 16:53:02,772 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:02,777 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:53:02,782 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:53:02,782 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 16:53:02,786 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 16:53:02,787 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 16:53:02,788 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 16:53:02,792 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8091442634, username=testuser_8091442634
2025-07-29 16:53:02,798 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=117, telegram_id=8091442634
2025-07-29 16:53:03,029 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:03,033 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:53:03,037 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=INVALID
2025-07-29 16:53:03,037 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=INVALID, days=40
2025-07-29 16:53:03,039 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 16:53:03,039 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 16:53:03,041 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 16:53:03,049 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7695532561, username=testuser_7695532561
2025-07-29 16:53:03,056 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=119, telegram_id=7695532561
2025-07-29 16:53:03,307 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:03,310 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:53:03,314 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 16:53:03,321 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8393882223, username=testuser_8393882223
2025-07-29 16:53:03,327 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=121, telegram_id=8393882223
2025-07-29 16:53:03,559 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:03,802 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=123, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 16:53:03,806 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 16:53:03,808 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:53:03,810 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/123 "HTTP/1.1 200 OK"
2025-07-29 16:53:03,817 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8743606272, username=testuser_8743606272
2025-07-29 16:53:03,822 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=124, telegram_id=8743606272
2025-07-29 16:53:04,050 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:04,054 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=99999, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 16:53:04,056 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 16:53:04,057 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:53:04,058 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/99999 "HTTP/1.1 200 OK"
2025-07-29 16:53:04,065 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6652689624, username=testuser_6652689624
2025-07-29 16:53:04,070 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=126, telegram_id=6652689624
2025-07-29 16:53:04,314 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:04,550 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=128, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 16:53:04,552 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 16:53:04,553 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:53:04,555 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/128 "HTTP/1.1 200 OK"
2025-07-29 16:53:04,560 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6017349785, username=testuser_6017349785
2025-07-29 16:53:04,566 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=129, telegram_id=6017349785
2025-07-29 16:53:04,801 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:05,077 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=1, page_size=5, symbol=None, prediction=None
2025-07-29 16:53:05,080 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 16:53:05,081 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 1, 페이지 크기 5).
2025-07-29 16:53:05,082 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=1&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 16:53:05,085 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=2, page_size=5, symbol=None, prediction=None
2025-07-29 16:53:05,086 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 16:53:05,088 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 2, 페이지 크기 5).
2025-07-29 16:53:05,089 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=2&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 16:53:05,096 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7137502409, username=testuser_7137502409
2025-07-29 16:53:05,102 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=132, telegram_id=7137502409
2025-07-29 16:53:05,338 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:05,580 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=134, page=1, page_size=10, symbol=005930, prediction=None
2025-07-29 16:53:05,581 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 16:53:05,584 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 16:53:05,585 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:53:05,587 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/134?symbol=005930 "HTTP/1.1 200 OK"
2025-07-29 16:53:05,593 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7203555843, username=testuser_7203555843
2025-07-29 16:53:05,599 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=135, telegram_id=7203555843
2025-07-29 16:53:05,839 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:06,083 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=137, page=1, page_size=10, symbol=None, prediction=상승
2025-07-29 16:53:06,083 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=상승
2025-07-29 16:53:06,086 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 16:53:06,088 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:53:06,090 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/137?prediction=%EC%83%81%EC%8A%B9 "HTTP/1.1 200 OK"
2025-07-29 16:53:06,096 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7908953954, username=testuser_7908953954
2025-07-29 16:53:06,103 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=138, telegram_id=7908953954
2025-07-29 16:53:06,339 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:06,663 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=140, page=1, page_size=10, symbol=005930, prediction=유지
2025-07-29 16:53:06,664 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 16:53:06,665 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=유지
2025-07-29 16:53:06,669 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 16:53:06,672 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 16:53:06,674 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/140?symbol=005930&prediction=%EC%9C%A0%EC%A7%80 "HTTP/1.1 200 OK"
2025-07-29 16:53:06,679 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1767987261, username=testuser_1767987261
2025-07-29 16:53:06,685 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=141, telegram_id=1767987261
2025-07-29 16:53:06,924 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:06,935 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=143, symbol=005930, trade_type=buy
2025-07-29 16:53:06,935 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 16:53:06,937 - src.api.services.stock_service - WARNING - 현재가 없음: 005930. 임시 가격 생성.
2025-07-29 16:53:06,937 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: 72548
2025-07-29 16:53:06,942 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=143, symbol=005930, trade_type=buy
2025-07-29 16:53:06,943 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 16:53:06,947 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=143
2025-07-29 16:53:06,950 - src.api.routers.simulated_trade - DEBUG - 사용자(143)의 모의매매 이력 1건 조회됨.
2025-07-29 16:53:06,950 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 16:53:06,952 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/143 "HTTP/1.1 200 OK"
2025-07-29 16:53:06,958 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8007087248, username=testuser_8007087248
2025-07-29 16:53:06,964 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=144, telegram_id=8007087248
2025-07-29 16:53:07,205 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:07,223 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 16:53:07,231 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7156147005, username=testuser_7156147005
2025-07-29 16:53:07,236 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=146, telegram_id=7156147005
2025-07-29 16:53:07,473 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:07,481 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 16:53:07,488 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9961934838, username=testuser_9961934838
2025-07-29 16:53:07,494 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=148, telegram_id=9961934838
2025-07-29 16:53:07,738 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:07,759 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%82%BC%EC%84%B1%EC%A0%84%EC%9E%90 "HTTP/1.1 200 OK"
2025-07-29 16:53:07,766 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4283336927, username=testuser_4283336927
2025-07-29 16:53:07,773 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=150, telegram_id=4283336927
2025-07-29 16:53:08,007 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:08,026 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=035720 "HTTP/1.1 200 OK"
2025-07-29 16:53:08,037 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4335351302, username=testuser_4335351302
2025-07-29 16:53:08,043 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=152, telegram_id=4335351302
2025-07-29 16:53:08,277 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:08,291 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=sk%ED%95%98%EC%9D%B4%EB%8B%89%EC%8A%A4 "HTTP/1.1 200 OK"
2025-07-29 16:53:08,299 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2987471155, username=testuser_2987471155
2025-07-29 16:53:08,303 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=154, telegram_id=2987471155
2025-07-29 16:53:08,542 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:08,551 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%97%86%EB%8A%94%EC%A2%85%EB%AA%A9 "HTTP/1.1 200 OK"
2025-07-29 16:53:08,559 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1343281721, username=testuser_1343281721
2025-07-29 16:53:08,565 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=156, telegram_id=1343281721
2025-07-29 16:53:08,810 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:08,817 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query= "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 16:53:08,822 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6264288272, username=testuser_6264288272
2025-07-29 16:53:08,827 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=158, telegram_id=6264288272
2025-07-29 16:53:09,058 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:09,065 - httpx - INFO - HTTP Request: GET http://testserver/symbols/005930/current_price_and_change "HTTP/1.1 200 OK"
2025-07-29 16:53:09,072 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4178555793, username=testuser_4178555793
2025-07-29 16:53:09,078 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=160, telegram_id=4178555793
2025-07-29 16:53:09,324 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:09,332 - httpx - INFO - HTTP Request: GET http://testserver/symbols/NONEXISTENT/current_price_and_change "HTTP/1.1 404 Not Found"
2025-07-29 16:53:09,339 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1074568703, username=testuser_1074568703
2025-07-29 16:53:09,345 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=162, telegram_id=1074568703
2025-07-29 16:53:09,583 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:09,831 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 16:53:09,837 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7490951024, username=testuser_7490951024
2025-07-29 16:53:09,844 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=165, telegram_id=7490951024
2025-07-29 16:53:10,078 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:10,318 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 400 Bad Request"
2025-07-29 16:53:10,323 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1885021920, username=testuser_1885021920
2025-07-29 16:53:10,328 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=168, telegram_id=1885021920
2025-07-29 16:53:10,567 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:11,068 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 16:53:11,074 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6250758809, username=testuser_6250758809
2025-07-29 16:53:11,081 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=171, telegram_id=6250758809
2025-07-29 16:53:11,315 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:11,325 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 16:53:11,330 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4048690260, username=testuser_4048690260
2025-07-29 16:53:11,337 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=173, telegram_id=4048690260
2025-07-29 16:53:11,591 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:12,065 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 16:53:12,071 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9032057571, username=testuser_9032057571
2025-07-29 16:53:12,079 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=176, telegram_id=9032057571
2025-07-29 16:53:12,311 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:12,553 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 178
2025-07-29 16:53:12,556 - src.api.services.user_service - DEBUG - User found by id: user_id=178
2025-07-29 16:53:12,560 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 16:53:12,565 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9712028604, username=testuser_9712028604
2025-07-29 16:53:12,571 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=179, telegram_id=9712028604
2025-07-29 16:53:12,803 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:12,807 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 403 Forbidden"
2025-07-29 16:53:12,812 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9519434367, username=testuser_9519434367
2025-07-29 16:53:12,819 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=181, telegram_id=9519434367
2025-07-29 16:53:13,064 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:13,319 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 183
2025-07-29 16:53:13,321 - src.api.services.user_service - DEBUG - User found by id: user_id=183
2025-07-29 16:53:13,335 - httpx - INFO - HTTP Request: PUT http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 16:53:13,342 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3254638497, username=testuser_3254638497
2025-07-29 16:53:13,348 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=184, telegram_id=3254638497
2025-07-29 16:53:13,584 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:13,601 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 16:53:13,607 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7488616520, username=testuser_7488616520
2025-07-29 16:53:13,614 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=187, telegram_id=7488616520
2025-07-29 16:53:13,988 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:14,276 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 16:53:14,280 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4398282497, username=testuser_4398282497
2025-07-29 16:53:14,286 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=190, telegram_id=4398282497
2025-07-29 16:53:14,522 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:14,767 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/192 "HTTP/1.1 200 OK"
2025-07-29 16:53:14,773 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3188644781, username=testuser_3188644781
2025-07-29 16:53:14,779 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=193, telegram_id=3188644781
2025-07-29 16:53:15,016 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:15,025 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/99999 "HTTP/1.1 404 Not Found"
2025-07-29 16:53:15,030 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1744758267, username=testuser_1744758267
2025-07-29 16:53:15,036 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=195, telegram_id=1744758267
2025-07-29 16:53:15,272 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:15,754 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 197
2025-07-29 16:53:15,756 - src.api.services.user_service - DEBUG - User found by id: user_id=197
2025-07-29 16:53:15,774 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 200 OK"
2025-07-29 16:53:15,782 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8059267756, username=testuser_8059267756
2025-07-29 16:53:15,790 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=199, telegram_id=8059267756
2025-07-29 16:53:16,047 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:16,287 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 201
2025-07-29 16:53:16,288 - src.api.services.user_service - DEBUG - User found by id: user_id=201
2025-07-29 16:53:16,290 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 403 Forbidden"
2025-07-29 16:53:16,296 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9819555015, username=testuser_9819555015
2025-07-29 16:53:16,302 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=202, telegram_id=9819555015
2025-07-29 16:53:16,537 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:16,545 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=204, symbol=005930
2025-07-29 16:53:16,552 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=204, symbol=005930
2025-07-29 16:53:16,553 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 16:53:16,556 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 시도: user_id=204
2025-07-29 16:53:16,558 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 성공: user_id=204, 1개 종목.
2025-07-29 16:53:16,559 - httpx - INFO - HTTP Request: GET http://testserver/watchlist/get/204 "HTTP/1.1 200 OK"
2025-07-29 16:53:16,565 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:16,567 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:53:16,567 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:53:16,572 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:16,576 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12345
2025-07-29 16:53:16,581 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=1, telegram_id=12345
2025-07-29 16:53:16,581 - src.api.services.price_alert_service - DEBUG - 사용자(1)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:53:16,588 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=1
2025-07-29 16:53:16,588 - src.api.services.price_alert_service - DEBUG - 가격 알림(1) 수정 시도: update_data={'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 16:53:16,592 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:53:16,593 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 16:53:16,593 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:53:16,597 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:53:16,597 - src.api.services.price_alert_service - INFO - 가격 알림(1) 수정 성공.
2025-07-29 16:53:16,598 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:53:16,604 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:53:16,604 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:53:16,608 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:16,609 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 16:53:16,611 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 16:53:16,612 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:53:16,613 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 16:53:16,614 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 16:53:16,616 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:53:16,617 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 16:53:16,617 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:53:16,624 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:53:16,624 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 16:53:16,625 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:53:16,628 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:16,629 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 16:53:16,630 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 16:53:16,630 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 16:53:16,631 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 16:53:16,632 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 16:53:16,633 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 16:53:16,633 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 16:53:16,633 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 16:53:16,637 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 16:53:16,638 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 16:53:16,639 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:53:16,649 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8492317851, username=testuser_8492317851
2025-07-29 16:53:16,654 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=205, telegram_id=8492317851
2025-07-29 16:53:16,655 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:16,657 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:53:16,658 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:16,661 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 8492317851
2025-07-29 16:53:16,663 - src.api.services.user_service - DEBUG - User not found for telegram_id: 8492317851
2025-07-29 16:53:16,663 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8492317851, username=testuser_8492317851
2025-07-29 16:53:16,670 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=202, telegram_id=8492317851
2025-07-29 16:53:16,671 - src.api.services.price_alert_service - DEBUG - 사용자(202)와 종목(GOOG)으로 가격 알림 조회 시도.
2025-07-29 16:53:16,672 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=202, symbol=GOOG
2025-07-29 16:53:16,672 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=202, symbol=GOOG, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:53:16,678 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=201, user_id=202, symbol=GOOG
2025-07-29 16:53:16,679 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:53:16,683 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:53:16,689 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9963674589, username=testuser_9963674589
2025-07-29 16:53:16,695 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=206, telegram_id=9963674589
2025-07-29 16:53:16,697 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:16,700 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:53:16,701 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:16,701 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 9963674589
2025-07-29 16:53:16,703 - src.api.services.user_service - DEBUG - User not found for telegram_id: 9963674589
2025-07-29 16:53:16,703 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9963674589, username=telegram_user_9963674589
2025-07-29 16:53:16,708 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=203, telegram_id=9963674589
2025-07-29 16:53:16,708 - src.api.services.price_alert_service - DEBUG - 사용자(203)와 종목(MSFT)으로 가격 알림 조회 시도.
2025-07-29 16:53:16,709 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=203, symbol=MSFT
2025-07-29 16:53:16,710 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=203, symbol=MSFT, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:53:16,717 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=202, user_id=203, symbol=MSFT
2025-07-29 16:53:16,719 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:53:16,721 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:53:16,725 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7170948092, username=testuser_7170948092
2025-07-29 16:53:16,731 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=207, telegram_id=7170948092
2025-07-29 16:53:16,734 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:16,736 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:53:16,737 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:16,738 - src.api.routers.bot_router - DEBUG - Before toggle: existing_alert.notify_on_disclosure = True
2025-07-29 16:53:16,738 - src.api.routers.bot_router - DEBUG - Calculated new_status: False
2025-07-29 16:53:16,738 - src.api.routers.bot_router - DEBUG - After update_alert call: updated_alert_orm.notify_on_disclosure = False
2025-07-29 16:53:16,739 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:53:16,741 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:53:16,746 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5334206531, username=testuser_5334206531
2025-07-29 16:53:16,751 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=208, telegram_id=5334206531
2025-07-29 16:53:16,755 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:16,758 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:53:16,759 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:16,760 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 5334206531
2025-07-29 16:53:16,761 - src.api.services.user_service - DEBUG - User not found for telegram_id: 5334206531
2025-07-29 16:53:16,762 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5334206531, username=telegram_user_5334206531
2025-07-29 16:53:16,767 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=204, telegram_id=5334206531
2025-07-29 16:53:16,767 - src.api.services.price_alert_service - DEBUG - 사용자(204)와 종목(NFLX)으로 가격 알림 조회 시도.
2025-07-29 16:53:16,769 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=204, symbol=NFLX
2025-07-29 16:53:16,769 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=204, symbol=NFLX, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:53:16,774 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=203, user_id=204, symbol=NFLX
2025-07-29 16:53:16,775 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:53:16,777 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 16:53:16,785 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6111365165, username=testuser_6111365165
2025-07-29 16:53:16,791 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=209, telegram_id=6111365165
2025-07-29 16:53:16,793 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:16,796 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:53:16,797 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:16,798 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 6111365165
2025-07-29 16:53:16,800 - src.api.services.user_service - DEBUG - User not found for telegram_id: 6111365165
2025-07-29 16:53:16,800 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6111365165, username=testuser_6111365165
2025-07-29 16:53:16,806 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=205, telegram_id=6111365165
2025-07-29 16:53:16,806 - src.api.services.price_alert_service - DEBUG - 사용자(205)와 종목(NVDA)으로 가격 알림 조회 시도.
2025-07-29 16:53:16,808 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=205, symbol=NVDA
2025-07-29 16:53:16,808 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=205, symbol=NVDA, target_price=1000.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:53:16,815 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=204, user_id=205, symbol=NVDA
2025-07-29 16:53:16,816 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:53:16,818 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:53:16,827 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7430733776, username=testuser_7430733776
2025-07-29 16:53:16,834 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=210, telegram_id=7430733776
2025-07-29 16:53:16,837 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:16,840 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:53:16,841 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:16,841 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 7430733776
2025-07-29 16:53:16,844 - src.api.services.user_service - DEBUG - User not found for telegram_id: 7430733776
2025-07-29 16:53:16,844 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7430733776, username=telegram_user_7430733776
2025-07-29 16:53:16,850 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=206, telegram_id=7430733776
2025-07-29 16:53:16,851 - src.api.services.price_alert_service - DEBUG - 사용자(206)와 종목(GOOGL)으로 가격 알림 조회 시도.
2025-07-29 16:53:16,853 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=206, symbol=GOOGL
2025-07-29 16:53:16,853 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=206, symbol=GOOGL, target_price=110.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=weekly
2025-07-29 16:53:16,859 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=205, user_id=206, symbol=GOOGL
2025-07-29 16:53:16,860 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:53:16,862 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:53:16,868 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1733354498, username=testuser_1733354498
2025-07-29 16:53:16,874 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=211, telegram_id=1733354498
2025-07-29 16:53:16,877 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:16,881 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 16:53:16,882 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:16,882 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 1733354498
2025-07-29 16:53:16,884 - src.api.services.user_service - DEBUG - User not found for telegram_id: 1733354498
2025-07-29 16:53:16,884 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1733354498, username=telegram_user_1733354498
2025-07-29 16:53:16,889 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=207, telegram_id=1733354498
2025-07-29 16:53:16,889 - src.api.services.price_alert_service - DEBUG - 사용자(207)와 종목(FB)으로 가격 알림 조회 시도.
2025-07-29 16:53:16,890 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=207, symbol=FB
2025-07-29 16:53:16,890 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=207, symbol=FB, target_price=300.0, condition=above, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:53:16,895 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=206, user_id=207, symbol=FB
2025-07-29 16:53:16,897 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 16:53:16,899 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 16:53:16,904 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:16,905 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:17,010 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:17,015 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:17,018 - src.common.dart_utils - ERROR - DART CORPCODE.xml 요청 실패: Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 25, in dart_get_all_stocks
    resp = await session.get(url, timeout=60)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 16:53:17,023 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:17,032 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:17,040 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:17,046 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:17,048 - src.common.dart_utils - ERROR - DART 공시 조회 API 요청 실패 (corp_code: 00123456): Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 79, in dart_get_disclosures
    resp = await session.get(url, params=params, timeout=10)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 16:53:17,052 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:17,054 - src.common.dart_utils - ERROR - DART 공시 API가 오류를 반환했습니다. status: 001, message: API 호출 오류, corp_code: 00123456
2025-07-29 16:53:17,148 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7904479069, username=testuser_7904479069
2025-07-29 16:53:17,155 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=212, telegram_id=7904479069
2025-07-29 16:53:17,393 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:17,638 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 16:53:17,882 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 16:53:17,886 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=214, symbol=005930
2025-07-29 16:53:17,892 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=214, symbol=005930
2025-07-29 16:53:17,894 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 16:53:17,897 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 214
2025-07-29 16:53:17,899 - src.api.services.user_service - DEBUG - User found by id: user_id=214
2025-07-29 16:53:17,900 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 16:53:17,901 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=214, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 16:53:17,906 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=11, user_id=214, symbol=005930
2025-07-29 16:53:17,907 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 16:53:17,909 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 16:53:17,911 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:53:17,911 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 16:53:17,913 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 16:53:17,914 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 16:53:17,919 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 16:53:17,921 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=214, symbol=005930, trade_type=buy
2025-07-29 16:53:17,921 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 16:53:17,922 - src.api.services.stock_service - WARNING - 현재가 없음: 005930. 임시 가격 생성.
2025-07-29 16:53:17,923 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: 82344
2025-07-29 16:53:17,927 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=214, symbol=005930, trade_type=buy
2025-07-29 16:53:17,928 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 16:53:17,930 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=214
2025-07-29 16:53:17,932 - src.api.routers.simulated_trade - DEBUG - 사용자(214)의 모의매매 이력 1건 조회됨.
2025-07-29 16:53:17,932 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 16:53:17,933 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/214 "HTTP/1.1 200 OK"
2025-07-29 16:53:17,943 - src.api.main - INFO - [APScheduler] 가격 알림 체크 잡 실행: 2025-07-29 16:53:17.943077
2025-07-29 16:53:17,943 - src.api.main - DEBUG - 활성 알림 수: 3
2025-07-29 16:53:17,943 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 16:53:17,944 - src.api.main - DEBUG - 종목 정상종목 현재가: 110
2025-07-29 16:53:17,945 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='140122846614128'>, 목표 가격: 100, 조건: gte, 반복 주기: <MagicMock name='mock.repeat_interval' id='140122847119248'>
2025-07-29 16:53:17,946 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목, 현재가: 110, 목표가: 100
2025-07-29 16:53:17,949 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='140122841317536'>)
2025-07-29 16:53:17,950 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 16:53:17,950 - src.api.main - DEBUG - 종목 오류종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 16:53:17,950 - src.api.main - ERROR - 가격 알림 확인 중 '오류종목' 처리 오류: 현재가 조회 실패
Traceback (most recent call last):
  File "/app/src/api/main.py", line 145, in check_price_alerts_job
    price_data = stock_service.get_current_price_and_change(symbol, db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1179, in _execute_mock_call
    result = effect(*args, **kwargs)
  File "/app/src/api/tests/test_main_jobs.py", line 34, in get_current_price_side_effect
    raise ValueError("현재가 조회 실패")
ValueError: 현재가 조회 실패
2025-07-29 16:53:17,951 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 16:53:17,951 - src.api.main - DEBUG - 종목 정상종목2 현재가: 290
2025-07-29 16:53:17,952 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='140122864753184'>, 목표 가격: 300, 조건: lte, 반복 주기: <MagicMock name='mock.repeat_interval' id='140122847766000'>
2025-07-29 16:53:17,952 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목2, 현재가: 290, 목표가: 300
2025-07-29 16:53:17,953 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='140122841317536'>)
2025-07-29 16:53:17,953 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 16:53:17,953 - src.api.main - DEBUG - 모든 가격 알림 체크 및 DB 커밋 완료.
2025-07-29 16:53:17,959 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:53:17,960 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(10일)
2025-07-29 16:53:17,964 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:53:17,965 - src.api.services.predict_service - ERROR - 예측 불가: 데이터 분석 실패
2025-07-29 16:53:17,969 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:53:17,970 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:53:17,978 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 상승 (24일 지속). 금일 변동: 보합. 최근 20일간 상승일: 19일, 하락일: 0일.
2025-07-29 16:53:17,978 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 16:53:17,982 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:53:17,982 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:53:17,988 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 하락 (24일 지속). 금일 변동: 보합. 최근 20일간 상승일: 0일, 하락일: 19일.
2025-07-29 16:53:17,988 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 16:53:17,992 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:53:17,992 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:53:17,999 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 횡보 (1일 지속). 금일 변동: 보합. 최근 20일간 상승일: 12일, 하락일: 7일.
2025-07-29 16:53:18,000 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 16:53:18,003 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:53:18,003 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 16:53:18,008 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=buy, reason=최근 추세: 하락 (1일 지속). 금일 변동: 횡보. 최근 20일간 상승일: 2일, 하락일: 17일. (저점 횡보 패턴 감지)
2025-07-29 16:53:18,008 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: buy
2025-07-29 16:53:18,011 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 16:53:18,011 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 22개 데이터.
2025-07-29 16:53:18,016 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, reason=최근 추세: 상승 (21일 지속). 금일 변동: 횡보. 최근 20일간 상승일: 19일, 하락일: 0일. (급등 후 횡보 패턴 감지)
2025-07-29 16:53:18,017 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 16:53:18,020 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:18,026 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 16:53:18,027 - src.api.services.stock_service - INFO - 신규 공시가 없습니다. (DB 기준: 202301010000001)
2025-07-29 16:53:18,031 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:18,035 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 16:53:18,043 - src.api.services.stock_service - INFO - 최초 실행. 기준 접수번호를 202301020000001로 DB에 설정합니다.
2025-07-29 16:53:18,045 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 16:53:18,046 - src.api.services.stock_service - INFO - 최초 실행. 기준 접수번호를 202301020000001로 DB에 설정합니다.
2025-07-29 16:53:18,049 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:18,061 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 16:53:18,061 - src.api.services.stock_service - INFO - 2건의 신규 공시를 발견했습니다.
2025-07-29 16:53:18,063 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 16:53:18,063 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 16:53:18,064 - src.api.services.stock_service - INFO - 마지막 확인 접수번호를 202301020000002로 DB에 갱신합니다.
2025-07-29 16:53:18,070 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:18,074 - src.api.services.stock_service - CRITICAL - DART API 사용 한도를 초과했습니다: [020] 사용 한도 초과
2025-07-29 16:53:18,079 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:18,086 - src.api.services.stock_service - ERROR - DART 공시 조회 중 API 오류 발생: [999] 기타 API 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 39, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
src.common.exceptions.DartApiError: [999] 기타 API 오류
2025-07-29 16:53:18,090 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 16:53:18,099 - src.api.services.stock_service - ERROR - 신규 공시 확인 및 알림 작업 중 예상치 못한 오류 발생: 예상치 못한 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 39, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: 예상치 못한 오류
2025-07-29 17:02:48,710 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:02:48,726 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:15:20,660 - main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 17:15:20,668 - main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 17:15:20,673 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:15:20,674 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:15:20,675 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:15:20,675 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:15:28,294 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 17:15:28,300 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 17:15:28,304 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:15:28,304 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:15:28,305 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:15:28,306 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:15:29,724 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:29,729 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 17:15:29,737 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-07-29 17:15:29,739 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '<unknown>'
2025-07-29 17:15:29,740 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-07-29 17:15:30,079 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:30,083 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:15:30,338 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:30,343 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 17:15:30,587 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:30,589 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 17:15:30,591 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 17:15:30,594 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4883794892, username=testuser_4883794892
2025-07-29 17:15:30,607 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=1, telegram_id=4883794892
2025-07-29 17:15:30,861 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:31,113 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 200 OK"
2025-07-29 17:15:31,118 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4466164398, username=testuser_4466164398
2025-07-29 17:15:31,126 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=3, telegram_id=4466164398
2025-07-29 17:15:31,373 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:31,618 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 17:15:31,622 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7688217104, username=testuser_7688217104
2025-07-29 17:15:31,629 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=5, telegram_id=7688217104
2025-07-29 17:15:31,876 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:31,882 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 17:15:31,887 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9635475208, username=testuser_9635475208
2025-07-29 17:15:31,894 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=7, telegram_id=9635475208
2025-07-29 17:15:32,228 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:32,476 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 200 OK"
2025-07-29 17:15:32,483 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6477938211, username=testuser_6477938211
2025-07-29 17:15:32,491 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=9, telegram_id=6477938211
2025-07-29 17:15:32,729 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:32,970 - src.api.routers.admin - ERROR - /admin/update_master 서버 오류: DB connection error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 36, in update_stock_master
    result = await stock_service.update_stock_master(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DB connection error
2025-07-29 17:15:32,972 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:15:32,977 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4841182576, username=testuser_4841182576
2025-07-29 17:15:32,985 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=11, telegram_id=4841182576
2025-07-29 17:15:33,222 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:33,462 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 17:15:33,467 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4878932034, username=testuser_4878932034
2025-07-29 17:15:33,474 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=13, telegram_id=4878932034
2025-07-29 17:15:33,711 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:33,718 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 17:15:33,723 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8707920387, username=testuser_8707920387
2025-07-29 17:15:33,729 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=15, telegram_id=8707920387
2025-07-29 17:15:33,971 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:34,373 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 200 OK"
2025-07-29 17:15:34,377 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3143800163, username=testuser_3143800163
2025-07-29 17:15:34,384 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=17, telegram_id=3143800163
2025-07-29 17:15:34,620 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:34,863 - src.api.routers.admin - ERROR - /admin/update_price 서버 오류: API call failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 53, in update_daily_price
    result = await stock_service.update_daily_prices(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: API call failed
2025-07-29 17:15:34,865 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:15:34,871 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5307269924, username=testuser_5307269924
2025-07-29 17:15:34,878 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=19, telegram_id=5307269924
2025-07-29 17:15:35,120 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:35,372 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 17:15:35,377 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1208453313, username=testuser_1208453313
2025-07-29 17:15:35,384 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=21, telegram_id=1208453313
2025-07-29 17:15:35,627 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:35,635 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 17:15:35,640 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4933198540, username=testuser_4933198540
2025-07-29 17:15:35,647 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=23, telegram_id=4933198540
2025-07-29 17:15:35,891 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:36,148 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f8ff57f9840>
2025-07-29 17:15:36,149 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:15:36,152 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 200 OK"
2025-07-29 17:15:36,163 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5880276519, username=testuser_5880276519
2025-07-29 17:15:36,172 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=25, telegram_id=5880276519
2025-07-29 17:15:36,429 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:36,681 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f8ff564e740>
2025-07-29 17:15:36,682 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:15:36,684 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 200 OK"
2025-07-29 17:15:36,689 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3385024231, username=testuser_3385024231
2025-07-29 17:15:36,696 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=27, telegram_id=3385024231
2025-07-29 17:15:36,937 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:37,184 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f8ff56608e0>
2025-07-29 17:15:37,184 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:15:37,186 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=%EC%B9%B4%EC%B9%B4%EC%98%A4 "HTTP/1.1 200 OK"
2025-07-29 17:15:37,190 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7747668764, username=testuser_7747668764
2025-07-29 17:15:37,198 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=29, telegram_id=7747668764
2025-07-29 17:15:37,435 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:37,690 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f8ff564ef80>
2025-07-29 17:15:37,690 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:15:37,692 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=0013456 "HTTP/1.1 200 OK"
2025-07-29 17:15:37,698 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4402707822, username=testuser_4402707822
2025-07-29 17:15:37,706 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=31, telegram_id=4402707822
2025-07-29 17:15:37,959 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:38,231 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f8ff56475e0>
2025-07-29 17:15:38,231 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:15:38,234 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=NONEXIST "HTTP/1.1 404 Not Found"
2025-07-29 17:15:38,242 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4290667784, username=testuser_4290667784
2025-07-29 17:15:38,253 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=33, telegram_id=4290667784
2025-07-29 17:15:38,517 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:38,789 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f8ff582d510>
2025-07-29 17:15:38,790 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:15:38,790 - src.api.routers.admin - ERROR - /admin/update_disclosure 서버 오류: DART API error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 126, in update_disclosure
    result = await stock_service.update_disclosures(db, corp_code=corp_code, stock_code=stock_code or '', stock_name=stock_name or '')
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DART API error
2025-07-29 17:15:38,791 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:15:38,797 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6249631583, username=testuser_6249631583
2025-07-29 17:15:38,806 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=35, telegram_id=6249631583
2025-07-29 17:15:39,045 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:39,289 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 17:15:39,294 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8135051863, username=testuser_8135051863
2025-07-29 17:15:39,302 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=37, telegram_id=8135051863
2025-07-29 17:15:39,607 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:39,617 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 17:15:39,625 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2950539493, username=testuser_2950539493
2025-07-29 17:15:39,632 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=39, telegram_id=2950539493
2025-07-29 17:15:39,872 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:40,116 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:15:40,121 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5883087693, username=testuser_5883087693
2025-07-29 17:15:40,127 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=41, telegram_id=5883087693
2025-07-29 17:15:40,373 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:40,620 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:15:40,628 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8105354907, username=testuser_8105354907
2025-07-29 17:15:40,635 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=43, telegram_id=8105354907
2025-07-29 17:15:40,907 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:41,155 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 17:15:41,160 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8666576035, username=testuser_8666576035
2025-07-29 17:15:41,168 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=45, telegram_id=8666576035
2025-07-29 17:15:41,407 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:41,412 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 17:15:41,417 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5754371383, username=testuser_5754371383
2025-07-29 17:15:41,422 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=47, telegram_id=5754371383
2025-07-29 17:15:41,660 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:41,902 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 17:15:41,904 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 17:15:41,909 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6932105500, username=testuser_6932105500
2025-07-29 17:15:41,916 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=49, telegram_id=6932105500
2025-07-29 17:15:42,163 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:42,410 - src.api.routers.admin - ERROR - [trigger_job] 잡 실행 실패: test_job - Job execution failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 175, in trigger_job
    job.func(*job.args, **job.kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: Job execution failed

2025-07-29 17:15:42,411 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:15:42,418 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8658161515, username=testuser_8658161515
2025-07-29 17:15:42,428 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=51, telegram_id=8658161515
2025-07-29 17:15:42,687 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:42,930 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 17:15:42,936 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4924249435, username=testuser_4924249435
2025-07-29 17:15:42,943 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=53, telegram_id=4924249435
2025-07-29 17:15:43,195 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:43,201 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 17:15:43,206 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1134504930, username=testuser_1134504930
2025-07-29 17:15:43,212 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=55, telegram_id=1134504930
2025-07-29 17:15:43,456 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:43,698 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 17:15:43,699 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 200 OK"
2025-07-29 17:15:43,705 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1580489121, username=testuser_1580489121
2025-07-29 17:15:43,712 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=57, telegram_id=1580489121
2025-07-29 17:15:43,952 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:44,197 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 17:15:44,197 - src.api.routers.admin - ERROR - 공시 확인 잡 수동 실행 중 오류 발생: Disclosure check failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 193, in trigger_check_disclosures_job
    await stock_service.check_and_notify_new_disclosures(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: Disclosure check failed
2025-07-29 17:15:44,198 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:15:44,203 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6688383810, username=testuser_6688383810
2025-07-29 17:15:44,211 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=59, telegram_id=6688383810
2025-07-29 17:15:44,458 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:44,708 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 17:15:44,713 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4319746193, username=testuser_4319746193
2025-07-29 17:15:44,719 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=61, telegram_id=4319746193
2025-07-29 17:15:44,957 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:44,963 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 17:15:44,967 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9050122942, username=testuser_9050122942
2025-07-29 17:15:44,972 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=63, telegram_id=9050122942
2025-07-29 17:15:45,220 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:45,484 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:15:45,490 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=65, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:15:45,503 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=1, user_id=65, symbol=005930
2025-07-29 17:15:45,507 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:15:45,516 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7809836296, username=testuser_7809836296
2025-07-29 17:15:45,522 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=66, telegram_id=7809836296
2025-07-29 17:15:45,767 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:45,772 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:15:45,776 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2268341191, username=testuser_2268341191
2025-07-29 17:15:45,782 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=68, telegram_id=2268341191
2025-07-29 17:15:46,033 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:46,281 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:15:46,283 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:15:46,287 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4995134999, username=testuser_4995134999
2025-07-29 17:15:46,293 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=71, telegram_id=4995134999
2025-07-29 17:15:46,623 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:46,869 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:15:46,870 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:15:46,877 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=2, user_id=73, symbol=005930
2025-07-29 17:15:46,879 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:15:46,882 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:15:46,884 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=035720, target_price=50000.0, condition=lte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:15:46,889 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=3, user_id=73, symbol=035720
2025-07-29 17:15:46,891 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:15:46,894 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:15:46,896 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 조회 시도.
2025-07-29 17:15:46,900 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 2개 조회됨.
2025-07-29 17:15:46,901 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:15:46,906 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8778231607, username=testuser_8778231607
2025-07-29 17:15:46,911 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=74, telegram_id=8778231607
2025-07-29 17:15:47,154 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:47,397 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:15:47,398 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 조회 시도.
2025-07-29 17:15:47,399 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 0개 조회됨.
2025-07-29 17:15:47,400 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:15:47,405 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9898667281, username=testuser_9898667281
2025-07-29 17:15:47,412 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=77, telegram_id=9898667281
2025-07-29 17:15:47,659 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:47,665 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:15:47,671 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8870784966, username=testuser_8870784966
2025-07-29 17:15:47,677 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=79, telegram_id=8870784966
2025-07-29 17:15:47,923 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:48,166 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:15:48,166 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=81, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:15:48,173 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=4, user_id=81, symbol=005930
2025-07-29 17:15:48,174 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:15:48,178 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:15:48,179 - src.api.services.price_alert_service - DEBUG - 사용자(81)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:15:48,183 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=4
2025-07-29 17:15:48,185 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/81/symbol/005930 "HTTP/1.1 200 OK"
2025-07-29 17:15:48,191 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8559162038, username=testuser_8559162038
2025-07-29 17:15:48,197 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=82, telegram_id=8559162038
2025-07-29 17:15:48,445 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:48,687 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:15:48,687 - src.api.services.price_alert_service - DEBUG - 사용자(84)와 종목(NONEXISTENT)으로 가격 알림 조회 시도.
2025-07-29 17:15:48,689 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=84, symbol=NONEXISTENT
2025-07-29 17:15:48,690 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/84/symbol/NONEXISTENT "HTTP/1.1 404 Not Found"
2025-07-29 17:15:48,695 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3542264236, username=testuser_3542264236
2025-07-29 17:15:48,701 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=85, telegram_id=3542264236
2025-07-29 17:15:48,940 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:49,182 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:15:49,183 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=87, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:15:49,187 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=5, user_id=87, symbol=005930
2025-07-29 17:15:49,189 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:15:49,191 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:15:49,194 - src.api.services.price_alert_service - DEBUG - 가격 알림(5) 수정 시도: update_data={'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 17:15:49,197 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:15:49,198 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 17:15:49,198 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:15:49,204 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:15:49,204 - src.api.services.price_alert_service - INFO - 가격 알림(5) 수정 성공.
2025-07-29 17:15:49,207 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/5 "HTTP/1.1 200 OK"
2025-07-29 17:15:49,212 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7447580262, username=testuser_7447580262
2025-07-29 17:15:49,219 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=88, telegram_id=7447580262
2025-07-29 17:15:49,484 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:49,805 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:15:49,806 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=90, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:15:49,814 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=6, user_id=90, symbol=005930
2025-07-29 17:15:49,818 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:15:49,822 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/6 "HTTP/1.1 403 Forbidden"
2025-07-29 17:15:49,830 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3287857838, username=testuser_3287857838
2025-07-29 17:15:49,837 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=91, telegram_id=3287857838
2025-07-29 17:15:50,094 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:50,352 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:15:50,353 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 17:15:50,355 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 17:15:50,356 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:15:50,362 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7762901920, username=testuser_7762901920
2025-07-29 17:15:50,368 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=94, telegram_id=7762901920
2025-07-29 17:15:50,632 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:51,164 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:15:51,165 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=96, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:15:51,173 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=7, user_id=96, symbol=005930
2025-07-29 17:15:51,175 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:15:51,178 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:15:51,179 - src.api.services.price_alert_service - DEBUG - 가격 알림(7) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 17:15:51,181 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:15:51,181 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0}
2025-07-29 17:15:51,182 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:15:51,188 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:15:51,188 - src.api.services.price_alert_service - INFO - 가격 알림(7) 수정 성공.
2025-07-29 17:15:51,191 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/7 "HTTP/1.1 403 Forbidden"
2025-07-29 17:15:51,196 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7454620610, username=testuser_7454620610
2025-07-29 17:15:51,202 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=98, telegram_id=7454620610
2025-07-29 17:15:51,449 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:51,703 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:15:51,704 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=100, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:15:51,711 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=8, user_id=100, symbol=005930
2025-07-29 17:15:51,712 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:15:51,715 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:15:51,719 - src.api.services.price_alert_service - DEBUG - 가격 알림(8) 삭제 시도.
2025-07-29 17:15:51,726 - src.api.services.price_alert_service - INFO - 가격 알림(8) 삭제 성공.
2025-07-29 17:15:51,727 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/8 "HTTP/1.1 200 OK"
2025-07-29 17:15:51,735 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4622334208, username=testuser_4622334208
2025-07-29 17:15:51,742 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=101, telegram_id=4622334208
2025-07-29 17:15:51,994 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:52,260 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:15:52,261 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=103, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:15:52,270 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=9, user_id=103, symbol=005930
2025-07-29 17:15:52,273 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:15:52,277 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/9 "HTTP/1.1 403 Forbidden"
2025-07-29 17:15:52,284 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2960070676, username=testuser_2960070676
2025-07-29 17:15:52,291 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=104, telegram_id=2960070676
2025-07-29 17:15:52,538 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:52,788 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:15:52,790 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 삭제 시도.
2025-07-29 17:15:52,791 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 17:15:52,792 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:15:52,799 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1904183612, username=testuser_1904183612
2025-07-29 17:15:52,806 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=107, telegram_id=1904183612
2025-07-29 17:15:53,060 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:53,554 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:15:53,555 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=109, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:15:53,561 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=10, user_id=109, symbol=005930
2025-07-29 17:15:53,563 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:15:53,566 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:15:53,570 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/10 "HTTP/1.1 403 Forbidden"
2025-07-29 17:15:53,577 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6227776214, username=testuser_6227776214
2025-07-29 17:15:53,584 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=111, telegram_id=6227776214
2025-07-29 17:15:53,829 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:53,836 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 17:15:53,842 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1444495260, username=testuser_1444495260
2025-07-29 17:15:53,848 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=113, telegram_id=1444495260
2025-07-29 17:15:54,097 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:54,102 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 17:15:54,107 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:54,110 - httpx - INFO - HTTP Request: GET http://testserver/ "HTTP/1.1 200 OK"
2025-07-29 17:15:54,112 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4377240909, username=testuser_4377240909
2025-07-29 17:15:54,118 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=115, telegram_id=4377240909
2025-07-29 17:15:54,460 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:54,466 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:15:54,472 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:15:54,472 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 17:15:54,477 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:15:54,477 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:15:54,479 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 17:15:54,485 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6908313136, username=testuser_6908313136
2025-07-29 17:15:54,496 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=117, telegram_id=6908313136
2025-07-29 17:15:54,753 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:54,758 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:15:54,762 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=INVALID
2025-07-29 17:15:54,762 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=INVALID, days=40
2025-07-29 17:15:54,764 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:15:54,764 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:15:54,766 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 17:15:54,771 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1680375226, username=testuser_1680375226
2025-07-29 17:15:54,777 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=119, telegram_id=1680375226
2025-07-29 17:15:55,023 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:55,028 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:15:55,032 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:15:55,041 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9996122552, username=testuser_9996122552
2025-07-29 17:15:55,048 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=121, telegram_id=9996122552
2025-07-29 17:15:55,291 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:55,553 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=123, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:15:55,557 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 17:15:55,559 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:15:55,561 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/123 "HTTP/1.1 200 OK"
2025-07-29 17:15:55,569 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6549190661, username=testuser_6549190661
2025-07-29 17:15:55,575 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=124, telegram_id=6549190661
2025-07-29 17:15:55,821 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:55,826 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=99999, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:15:55,828 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 17:15:55,830 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:15:55,831 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/99999 "HTTP/1.1 200 OK"
2025-07-29 17:15:55,838 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7093838918, username=testuser_7093838918
2025-07-29 17:15:55,845 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=126, telegram_id=7093838918
2025-07-29 17:15:56,092 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:56,340 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=128, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:15:56,342 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 17:15:56,343 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:15:56,345 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/128 "HTTP/1.1 200 OK"
2025-07-29 17:15:56,351 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9190714541, username=testuser_9190714541
2025-07-29 17:15:56,356 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=129, telegram_id=9190714541
2025-07-29 17:15:56,610 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:56,888 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=1, page_size=5, symbol=None, prediction=None
2025-07-29 17:15:56,891 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 17:15:56,893 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 1, 페이지 크기 5).
2025-07-29 17:15:56,895 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=1&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 17:15:56,897 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=2, page_size=5, symbol=None, prediction=None
2025-07-29 17:15:56,899 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 17:15:56,900 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 2, 페이지 크기 5).
2025-07-29 17:15:56,901 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=2&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 17:15:56,909 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3301013114, username=testuser_3301013114
2025-07-29 17:15:56,914 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=132, telegram_id=3301013114
2025-07-29 17:15:57,172 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:57,478 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=134, page=1, page_size=10, symbol=005930, prediction=None
2025-07-29 17:15:57,479 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 17:15:57,483 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 17:15:57,485 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:15:57,487 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/134?symbol=005930 "HTTP/1.1 200 OK"
2025-07-29 17:15:57,494 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4862739200, username=testuser_4862739200
2025-07-29 17:15:57,501 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=135, telegram_id=4862739200
2025-07-29 17:15:57,469 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:57,300 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=137, page=1, page_size=10, symbol=None, prediction=상승
2025-07-29 17:15:57,301 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=상승
2025-07-29 17:15:57,306 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 17:15:57,310 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:15:57,312 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/137?prediction=%EC%83%81%EC%8A%B9 "HTTP/1.1 200 OK"
2025-07-29 17:15:57,320 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4687981682, username=testuser_4687981682
2025-07-29 17:15:57,330 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=138, telegram_id=4687981682
2025-07-29 17:15:57,584 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:57,847 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=140, page=1, page_size=10, symbol=005930, prediction=유지
2025-07-29 17:15:57,848 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 17:15:57,848 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=유지
2025-07-29 17:15:57,852 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 17:15:57,855 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:15:57,856 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/140?symbol=005930&prediction=%EC%9C%A0%EC%A7%80 "HTTP/1.1 200 OK"
2025-07-29 17:15:57,862 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7734899763, username=testuser_7734899763
2025-07-29 17:15:57,868 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=141, telegram_id=7734899763
2025-07-29 17:15:58,123 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:58,136 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=143, symbol=005930, trade_type=buy
2025-07-29 17:15:58,137 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:15:58,140 - src.api.services.stock_service - WARNING - 현재가 없음: 005930.
2025-07-29 17:15:58,141 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: None
2025-07-29 17:15:58,148 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=143, symbol=005930, trade_type=buy
2025-07-29 17:15:58,150 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 17:15:58,155 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=143
2025-07-29 17:15:58,158 - src.api.routers.simulated_trade - DEBUG - 사용자(143)의 모의매매 이력 1건 조회됨.
2025-07-29 17:15:58,159 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 17:15:58,160 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/143 "HTTP/1.1 200 OK"
2025-07-29 17:15:58,168 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4093029584, username=testuser_4093029584
2025-07-29 17:15:58,174 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=144, telegram_id=4093029584
2025-07-29 17:15:58,435 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:58,457 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 17:15:58,466 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6908541552, username=testuser_6908541552
2025-07-29 17:15:58,473 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=146, telegram_id=6908541552
2025-07-29 17:15:58,728 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:58,736 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 17:15:58,743 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7891604426, username=testuser_7891604426
2025-07-29 17:15:58,749 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=148, telegram_id=7891604426
2025-07-29 17:15:58,993 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:59,008 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%82%BC%EC%84%B1%EC%A0%84%EC%9E%90 "HTTP/1.1 200 OK"
2025-07-29 17:15:59,017 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7201515905, username=testuser_7201515905
2025-07-29 17:15:59,025 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=150, telegram_id=7201515905
2025-07-29 17:15:59,263 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:59,281 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=035720 "HTTP/1.1 200 OK"
2025-07-29 17:15:59,291 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1719623905, username=testuser_1719623905
2025-07-29 17:15:59,297 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=152, telegram_id=1719623905
2025-07-29 17:15:59,539 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:59,554 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=sk%ED%95%98%EC%9D%B4%EB%8B%89%EC%8A%A4 "HTTP/1.1 200 OK"
2025-07-29 17:15:59,562 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1940523184, username=testuser_1940523184
2025-07-29 17:15:59,568 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=154, telegram_id=1940523184
2025-07-29 17:15:59,805 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:15:59,813 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%97%86%EB%8A%94%EC%A2%85%EB%AA%A9 "HTTP/1.1 200 OK"
2025-07-29 17:15:59,819 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5441377504, username=testuser_5441377504
2025-07-29 17:15:59,824 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=156, telegram_id=5441377504
2025-07-29 17:16:00,068 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:00,074 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query= "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:16:00,081 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7210318968, username=testuser_7210318968
2025-07-29 17:16:00,087 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=158, telegram_id=7210318968
2025-07-29 17:16:00,478 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:00,501 - httpx - INFO - HTTP Request: GET http://testserver/symbols/005930/current_price_and_change "HTTP/1.1 200 OK"
2025-07-29 17:16:00,521 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4221137156, username=testuser_4221137156
2025-07-29 17:16:00,534 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=160, telegram_id=4221137156
2025-07-29 17:16:00,789 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:00,796 - httpx - INFO - HTTP Request: GET http://testserver/symbols/NONEXISTENT/current_price_and_change "HTTP/1.1 404 Not Found"
2025-07-29 17:16:00,801 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4017261773, username=testuser_4017261773
2025-07-29 17:16:00,806 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=162, telegram_id=4017261773
2025-07-29 17:16:01,048 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:01,298 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 17:16:01,302 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3829719991, username=testuser_3829719991
2025-07-29 17:16:01,309 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=165, telegram_id=3829719991
2025-07-29 17:16:01,554 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:01,800 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 400 Bad Request"
2025-07-29 17:16:01,805 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7609861345, username=testuser_7609861345
2025-07-29 17:16:01,811 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=168, telegram_id=7609861345
2025-07-29 17:16:02,051 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:02,526 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 17:16:02,531 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6169544508, username=testuser_6169544508
2025-07-29 17:16:02,538 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=171, telegram_id=6169544508
2025-07-29 17:16:02,787 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:02,799 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 17:16:02,805 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3624618032, username=testuser_3624618032
2025-07-29 17:16:02,812 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=173, telegram_id=3624618032
2025-07-29 17:16:03,059 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:03,542 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 17:16:03,548 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8704958141, username=testuser_8704958141
2025-07-29 17:16:03,554 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=176, telegram_id=8704958141
2025-07-29 17:16:03,794 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:04,038 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 178
2025-07-29 17:16:04,042 - src.api.services.user_service - DEBUG - User found by id: user_id=178
2025-07-29 17:16:04,047 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 17:16:04,052 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9067587321, username=testuser_9067587321
2025-07-29 17:16:04,058 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=179, telegram_id=9067587321
2025-07-29 17:16:04,308 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:04,312 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 403 Forbidden"
2025-07-29 17:16:04,315 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3088998387, username=testuser_3088998387
2025-07-29 17:16:04,320 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=181, telegram_id=3088998387
2025-07-29 17:16:04,559 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:04,801 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 183
2025-07-29 17:16:04,803 - src.api.services.user_service - DEBUG - User found by id: user_id=183
2025-07-29 17:16:04,815 - httpx - INFO - HTTP Request: PUT http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 17:16:04,820 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8815711509, username=testuser_8815711509
2025-07-29 17:16:04,825 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=184, telegram_id=8815711509
2025-07-29 17:16:05,091 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:05,111 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 17:16:05,118 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9831750630, username=testuser_9831750630
2025-07-29 17:16:05,126 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=187, telegram_id=9831750630
2025-07-29 17:16:05,372 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:05,633 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 17:16:05,638 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9013790770, username=testuser_9013790770
2025-07-29 17:16:05,644 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=190, telegram_id=9013790770
2025-07-29 17:16:05,884 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:06,135 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/192 "HTTP/1.1 200 OK"
2025-07-29 17:16:06,140 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2651842857, username=testuser_2651842857
2025-07-29 17:16:06,146 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=193, telegram_id=2651842857
2025-07-29 17:16:06,389 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:06,397 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:16:06,402 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2181344760, username=testuser_2181344760
2025-07-29 17:16:06,408 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=195, telegram_id=2181344760
2025-07-29 17:16:06,647 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:07,270 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 197
2025-07-29 17:16:07,273 - src.api.services.user_service - DEBUG - User found by id: user_id=197
2025-07-29 17:16:07,295 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 200 OK"
2025-07-29 17:16:07,300 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1491751892, username=testuser_1491751892
2025-07-29 17:16:07,307 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=199, telegram_id=1491751892
2025-07-29 17:16:07,558 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:07,802 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 201
2025-07-29 17:16:07,804 - src.api.services.user_service - DEBUG - User found by id: user_id=201
2025-07-29 17:16:07,806 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:16:07,810 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4629367106, username=testuser_4629367106
2025-07-29 17:16:07,815 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=202, telegram_id=4629367106
2025-07-29 17:16:08,055 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:08,063 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=204, symbol=005930
2025-07-29 17:16:08,071 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=204, symbol=005930
2025-07-29 17:16:08,072 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 17:16:08,076 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 시도: user_id=204
2025-07-29 17:16:08,079 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 성공: user_id=204, 1개 종목.
2025-07-29 17:16:08,081 - httpx - INFO - HTTP Request: GET http://testserver/watchlist/get/204 "HTTP/1.1 200 OK"
2025-07-29 17:16:08,086 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:08,088 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:16:08,089 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:16:08,093 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:16:08,096 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12345
2025-07-29 17:16:08,101 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=1, telegram_id=12345
2025-07-29 17:16:08,101 - src.api.services.price_alert_service - DEBUG - 사용자(1)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:16:08,105 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=1
2025-07-29 17:16:08,105 - src.api.services.price_alert_service - DEBUG - 가격 알림(1) 수정 시도: update_data={'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 17:16:08,107 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:16:08,107 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 17:16:08,108 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:16:08,111 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:16:08,111 - src.api.services.price_alert_service - INFO - 가격 알림(1) 수정 성공.
2025-07-29 17:16:08,113 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:16:08,118 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:16:08,119 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:16:08,122 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:16:08,122 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 17:16:08,124 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 17:16:08,125 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:16:08,126 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 17:16:08,127 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 17:16:08,129 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:16:08,129 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 17:16:08,129 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:16:08,138 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:16:08,138 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 17:16:08,140 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:16:08,143 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:16:08,144 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 17:16:08,146 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 17:16:08,146 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:16:08,148 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 17:16:08,149 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 17:16:08,150 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:16:08,151 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 17:16:08,151 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:16:08,156 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:16:08,156 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 17:16:08,158 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:16:08,170 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6718953624, username=testuser_6718953624
2025-07-29 17:16:08,178 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=205, telegram_id=6718953624
2025-07-29 17:16:08,180 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:08,183 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:16:08,184 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:16:08,187 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 6718953624
2025-07-29 17:16:08,189 - src.api.services.user_service - DEBUG - User not found for telegram_id: 6718953624
2025-07-29 17:16:08,190 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6718953624, username=testuser_6718953624
2025-07-29 17:16:08,196 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=208, telegram_id=6718953624
2025-07-29 17:16:08,196 - src.api.services.price_alert_service - DEBUG - 사용자(208)와 종목(GOOG)으로 가격 알림 조회 시도.
2025-07-29 17:16:08,198 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=208, symbol=GOOG
2025-07-29 17:16:08,198 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=208, symbol=GOOG, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:16:08,205 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=207, user_id=208, symbol=GOOG
2025-07-29 17:16:08,207 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:16:08,208 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:16:08,214 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8754655998, username=testuser_8754655998
2025-07-29 17:16:08,219 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=206, telegram_id=8754655998
2025-07-29 17:16:08,221 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:08,224 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:16:08,224 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:16:08,225 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 8754655998
2025-07-29 17:16:08,227 - src.api.services.user_service - DEBUG - User not found for telegram_id: 8754655998
2025-07-29 17:16:08,227 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8754655998, username=telegram_user_8754655998
2025-07-29 17:16:08,233 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=209, telegram_id=8754655998
2025-07-29 17:16:08,233 - src.api.services.price_alert_service - DEBUG - 사용자(209)와 종목(MSFT)으로 가격 알림 조회 시도.
2025-07-29 17:16:08,234 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=209, symbol=MSFT
2025-07-29 17:16:08,235 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=209, symbol=MSFT, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:16:08,240 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=208, user_id=209, symbol=MSFT
2025-07-29 17:16:08,241 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:16:08,243 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:16:08,251 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9440922500, username=testuser_9440922500
2025-07-29 17:16:08,258 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=207, telegram_id=9440922500
2025-07-29 17:16:08,262 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:08,265 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:16:08,266 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:16:08,267 - src.api.routers.bot_router - DEBUG - Before toggle: existing_alert.notify_on_disclosure = True
2025-07-29 17:16:08,267 - src.api.routers.bot_router - DEBUG - Calculated new_status: False
2025-07-29 17:16:08,267 - src.api.routers.bot_router - DEBUG - After update_alert call: updated_alert_orm.notify_on_disclosure = False
2025-07-29 17:16:08,268 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:16:08,269 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:16:08,275 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9566891837, username=testuser_9566891837
2025-07-29 17:16:08,281 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=208, telegram_id=9566891837
2025-07-29 17:16:08,286 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:08,288 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:16:08,289 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:16:08,290 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 9566891837
2025-07-29 17:16:08,292 - src.api.services.user_service - DEBUG - User not found for telegram_id: 9566891837
2025-07-29 17:16:08,292 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9566891837, username=telegram_user_9566891837
2025-07-29 17:16:08,297 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=210, telegram_id=9566891837
2025-07-29 17:16:08,298 - src.api.services.price_alert_service - DEBUG - 사용자(210)와 종목(NFLX)으로 가격 알림 조회 시도.
2025-07-29 17:16:08,300 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=210, symbol=NFLX
2025-07-29 17:16:08,300 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=210, symbol=NFLX, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:16:08,305 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=209, user_id=210, symbol=NFLX
2025-07-29 17:16:08,307 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:16:08,309 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:16:08,315 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7684044362, username=testuser_7684044362
2025-07-29 17:16:08,322 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=209, telegram_id=7684044362
2025-07-29 17:16:08,324 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:08,326 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:16:08,327 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:16:08,327 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 7684044362
2025-07-29 17:16:08,329 - src.api.services.user_service - DEBUG - User not found for telegram_id: 7684044362
2025-07-29 17:16:08,330 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7684044362, username=testuser_7684044362
2025-07-29 17:16:08,335 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=211, telegram_id=7684044362
2025-07-29 17:16:08,336 - src.api.services.price_alert_service - DEBUG - 사용자(211)와 종목(NVDA)으로 가격 알림 조회 시도.
2025-07-29 17:16:08,338 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=211, symbol=NVDA
2025-07-29 17:16:08,338 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=211, symbol=NVDA, target_price=1000.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:16:08,343 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=210, user_id=211, symbol=NVDA
2025-07-29 17:16:08,345 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:16:08,347 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:16:08,354 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7100804306, username=testuser_7100804306
2025-07-29 17:16:08,360 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=210, telegram_id=7100804306
2025-07-29 17:16:08,365 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:08,368 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:16:08,369 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:16:08,370 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 7100804306
2025-07-29 17:16:08,372 - src.api.services.user_service - DEBUG - User not found for telegram_id: 7100804306
2025-07-29 17:16:08,372 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7100804306, username=telegram_user_7100804306
2025-07-29 17:16:08,378 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=212, telegram_id=7100804306
2025-07-29 17:16:08,379 - src.api.services.price_alert_service - DEBUG - 사용자(212)와 종목(GOOGL)으로 가격 알림 조회 시도.
2025-07-29 17:16:08,380 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=212, symbol=GOOGL
2025-07-29 17:16:08,381 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=212, symbol=GOOGL, target_price=110.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=weekly
2025-07-29 17:16:08,387 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=211, user_id=212, symbol=GOOGL
2025-07-29 17:16:08,389 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:16:08,391 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:16:08,397 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3817810352, username=testuser_3817810352
2025-07-29 17:16:08,403 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=211, telegram_id=3817810352
2025-07-29 17:16:08,407 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:08,410 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:16:08,411 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:16:08,411 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 3817810352
2025-07-29 17:16:08,413 - src.api.services.user_service - DEBUG - User not found for telegram_id: 3817810352
2025-07-29 17:16:08,414 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3817810352, username=telegram_user_3817810352
2025-07-29 17:16:08,420 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=213, telegram_id=3817810352
2025-07-29 17:16:08,421 - src.api.services.price_alert_service - DEBUG - 사용자(213)와 종목(FB)으로 가격 알림 조회 시도.
2025-07-29 17:16:08,422 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=213, symbol=FB
2025-07-29 17:16:08,423 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=213, symbol=FB, target_price=300.0, condition=above, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:16:08,429 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=212, user_id=213, symbol=FB
2025-07-29 17:16:08,431 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:16:08,433 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:16:08,439 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:08,440 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:08,446 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:08,453 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:08,455 - src.common.dart_utils - ERROR - DART CORPCODE.xml 요청 실패: Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 25, in dart_get_all_stocks
    resp = await session.get(url, timeout=60)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 17:16:08,462 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:08,469 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:08,475 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:08,480 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:08,481 - src.common.dart_utils - ERROR - DART 공시 조회 API 요청 실패 (corp_code: 00123456): Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 79, in dart_get_disclosures
    resp = await session.get(url, params=params, timeout=10)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 17:16:08,487 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:08,491 - src.common.dart_utils - ERROR - DART 공시 API가 오류를 반환했습니다. status: 001, message: API 호출 오류, corp_code: 00123456
2025-07-29 17:16:08,728 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2460643222, username=testuser_2460643222
2025-07-29 17:16:08,736 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=212, telegram_id=2460643222
2025-07-29 17:16:08,973 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:09,224 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 17:16:09,462 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 17:16:09,467 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=214, symbol=005930
2025-07-29 17:16:09,474 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=214, symbol=005930
2025-07-29 17:16:09,476 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 17:16:09,481 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 214
2025-07-29 17:16:09,484 - src.api.services.user_service - DEBUG - User found by id: user_id=214
2025-07-29 17:16:09,486 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:16:09,486 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=214, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:16:09,494 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=11, user_id=214, symbol=005930
2025-07-29 17:16:09,496 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:16:09,498 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:16:09,501 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:16:09,501 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 17:16:09,503 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:16:09,503 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:16:09,509 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 17:16:09,512 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=214, symbol=005930, trade_type=buy
2025-07-29 17:16:09,513 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:16:09,515 - src.api.services.stock_service - WARNING - 현재가 없음: 005930.
2025-07-29 17:16:09,515 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: None
2025-07-29 17:16:09,519 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=214, symbol=005930, trade_type=buy
2025-07-29 17:16:09,521 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 17:16:09,524 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=214
2025-07-29 17:16:09,526 - src.api.routers.simulated_trade - DEBUG - 사용자(214)의 모의매매 이력 1건 조회됨.
2025-07-29 17:16:09,527 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 17:16:09,529 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/214 "HTTP/1.1 200 OK"
2025-07-29 17:16:09,539 - src.api.main - INFO - [APScheduler] 가격 알림 체크 잡 실행: 2025-07-29 17:16:09.539821
2025-07-29 17:16:09,540 - src.api.main - DEBUG - 활성 알림 수: 3
2025-07-29 17:16:09,540 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:16:09,541 - src.api.main - DEBUG - 종목 정상종목 현재가: 110
2025-07-29 17:16:09,542 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='140256264053200'>, 목표 가격: 100, 조건: gte, 반복 주기: <MagicMock name='mock.repeat_interval' id='140256263835072'>
2025-07-29 17:16:09,542 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목, 현재가: 110, 목표가: 100
2025-07-29 17:16:09,546 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='140256275168512'>)
2025-07-29 17:16:09,548 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 17:16:09,549 - src.api.main - DEBUG - 종목 오류종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:16:09,550 - src.api.main - ERROR - 가격 알림 확인 중 '오류종목' 처리 오류: 현재가 조회 실패
Traceback (most recent call last):
  File "/app/src/api/main.py", line 145, in check_price_alerts_job
    price_data = stock_service.get_current_price_and_change(symbol, db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1179, in _execute_mock_call
    result = effect(*args, **kwargs)
  File "/app/src/api/tests/test_main_jobs.py", line 34, in get_current_price_side_effect
    raise ValueError("현재가 조회 실패")
ValueError: 현재가 조회 실패
2025-07-29 17:16:09,551 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:16:09,552 - src.api.main - DEBUG - 종목 정상종목2 현재가: 290
2025-07-29 17:16:09,554 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='140256275048400'>, 목표 가격: 300, 조건: lte, 반복 주기: <MagicMock name='mock.repeat_interval' id='140256274667296'>
2025-07-29 17:16:09,554 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목2, 현재가: 290, 목표가: 300
2025-07-29 17:16:09,555 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='140256275168512'>)
2025-07-29 17:16:09,555 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 17:16:09,556 - src.api.main - DEBUG - 모든 가격 알림 체크 및 DB 커밋 완료.
2025-07-29 17:16:09,561 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:16:09,562 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(10일)
2025-07-29 17:16:09,566 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:16:09,567 - src.api.services.predict_service - ERROR - 예측 불가: 데이터 분석 실패
2025-07-29 17:16:09,576 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:16:09,577 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:16:09,587 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 상승 (24일 지속). 금일 변동: 보합. 최근 20일간 상승일: 19일, 하락일: 0일.
2025-07-29 17:16:09,588 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 17:16:09,596 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:16:09,597 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:16:09,604 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 하락 (24일 지속). 금일 변동: 보합. 최근 20일간 상승일: 0일, 하락일: 19일.
2025-07-29 17:16:09,604 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 17:16:09,609 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:16:09,610 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:16:09,620 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 횡보 (1일 지속). 금일 변동: 보합. 최근 20일간 상승일: 12일, 하락일: 7일.
2025-07-29 17:16:09,621 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 17:16:09,624 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:16:09,625 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:16:09,631 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=buy, reason=최근 추세: 하락 (1일 지속). 금일 변동: 횡보. 최근 20일간 상승일: 2일, 하락일: 17일. (저점 횡보 패턴 감지)
2025-07-29 17:16:09,631 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: buy
2025-07-29 17:16:09,635 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:16:09,636 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 22개 데이터.
2025-07-29 17:16:09,641 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, reason=최근 추세: 상승 (21일 지속). 금일 변동: 횡보. 최근 20일간 상승일: 19일, 하락일: 0일. (급등 후 횡보 패턴 감지)
2025-07-29 17:16:09,641 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 17:16:09,644 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:09,651 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:16:09,651 - src.api.services.stock_service - INFO - 신규 공시가 없습니다. (DB 기준: 202301010000001)
2025-07-29 17:16:09,654 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:09,658 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:16:09,667 - src.api.services.stock_service - INFO - 최초 실행. 기준 접수번호를 202301020000001로 DB에 설정합니다.
2025-07-29 17:16:09,669 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:16:09,671 - src.api.services.stock_service - INFO - 최초 실행. 기준 접수번호를 202301020000001로 DB에 설정합니다.
2025-07-29 17:16:09,675 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:09,684 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:16:09,685 - src.api.services.stock_service - INFO - 2건의 신규 공시를 발견했습니다.
2025-07-29 17:16:09,687 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 17:16:09,688 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 17:16:09,688 - src.api.services.stock_service - INFO - 마지막 확인 접수번호를 202301020000002로 DB에 갱신합니다.
2025-07-29 17:16:09,692 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:09,697 - src.api.services.stock_service - CRITICAL - DART API 사용 한도를 초과했습니다: [020] 사용 한도 초과
2025-07-29 17:16:09,702 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:09,707 - src.api.services.stock_service - ERROR - DART 공시 조회 중 API 오류 발생: [999] 기타 API 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 40, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
src.common.exceptions.DartApiError: [999] 기타 API 오류
2025-07-29 17:16:09,711 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:09,717 - src.api.services.stock_service - ERROR - 신규 공시 확인 및 알림 작업 중 예상치 못한 오류 발생: 예상치 못한 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 40, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: 예상치 못한 오류
2025-07-29 17:16:09,720 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:09,731 - src.api.services.stock_service - DEBUG - update_daily_prices 호출.
2025-07-29 17:16:09,732 - src.api.services.stock_service - DEBUG - DB에서 2개 종목 가져옴.
2025-07-29 17:16:09,733 - src.api.services.stock_service - DEBUG - 종목 005930 (삼성전자) 일별시세 갱신 시작.
2025-07-29 17:16:09,736 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 005930 - 2025-07-29
2025-07-29 17:16:09,737 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 005930 - 2025-07-28
2025-07-29 17:16:09,737 - src.api.services.stock_service - DEBUG - 종목 000660 (SK하이닉스) 일별시세 갱신 시작.
2025-07-29 17:16:09,739 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 000660 - 2025-07-29
2025-07-29 17:16:09,740 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 000660 - 2025-07-28
2025-07-29 17:16:09,743 - src.api.services.stock_service - ERROR - 일별시세 갱신 작업 전체 실패: (psycopg2.ProgrammingError) can't adapt type 'numpy.int64'
[SQL: INSERT INTO daily_prices (symbol, date, open, high, low, close, volume, created_at, updated_at) SELECT p0::VARCHAR, p1::DATE, p2::FLOAT, p3::FLOAT, p4::FLOAT, p5::FLOAT, p6::BIGINT, p7::TIMESTAMP WITHOUT TIME ZONE, p8::TIMESTAMP WITHOUT TIME ZONE FRO ... 571 characters truncated ... r) ORDER BY sen_counter RETURNING daily_prices.id, daily_prices.updated_at, daily_prices.id AS id__1]
[parameters: {'close__0': np.int64(71500), 'date__0': datetime.date(2025, 7, 29), 'high__0': np.int64(72000), 'volume__0': np.int64(1000000), 'created_at__0': datetime.datetime(2025, 7, 29, 17, 16, 9, 736122), 'open__0': np.int64(70000), 'symbol__0': '005930', 'low__0': np.int64(69000), 'close__1': np.int64(72500), 'date__1': datetime.date(2025, 7, 28), 'high__1': np.int64(73000), 'volume__1': np.int64(1200000), 'created_at__1': datetime.datetime(2025, 7, 29, 17, 16, 9, 737543), 'open__1': np.int64(71000), 'symbol__1': '005930', 'low__1': np.int64(70000), 'close__2': np.int64(101500), 'date__2': datetime.date(2025, 7, 29), 'high__2': np.int64(102000), 'volume__2': np.int64(500000), 'created_at__2': datetime.datetime(2025, 7, 29, 17, 16, 9, 738955), 'open__2': np.int64(100000), 'symbol__2': '000660', 'low__2': np.int64(99000), 'close__3': np.int64(102500), 'date__3': datetime.date(2025, 7, 28), 'high__3': np.int64(103000), 'volume__3': np.int64(600000), 'created_at__3': datetime.datetime(2025, 7, 29, 17, 16, 9, 740087), 'open__3': np.int64(101000), 'symbol__3': '000660', 'low__3': np.int64(100000)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2112, in _exec_insertmany_context
    dialect.do_execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 944, in do_execute
    cursor.execute(statement, parameters)
psycopg2.ProgrammingError: can't adapt type 'numpy.int64'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 327, in update_daily_prices
    db.commit()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2032, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1313, in commit
    self._prepare_impl()
  File "<string>", line 2, in _prepare_impl
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1288, in _prepare_impl
    self.session.flush()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4345, in flush
    self._flush(objects)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4480, in _flush
    with util.safe_reraise():
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 4441, in _flush
    flush_context.execute()
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 93, in save_obj
    _emit_insert_statements(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/orm/persistence.py", line 1143, in _emit_insert_statements
    result = connection.execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1413, in execute
    return meth(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 526, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1635, in _execute_clauseelement
    ret = self._execute_context(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1838, in _execute_context
    return self._exec_insertmany_context(dialect, context)
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2120, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2349, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2112, in _exec_insertmany_context
    dialect.do_execute(
  File "/usr/local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 944, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.ProgrammingError) can't adapt type 'numpy.int64'
[SQL: INSERT INTO daily_prices (symbol, date, open, high, low, close, volume, created_at, updated_at) SELECT p0::VARCHAR, p1::DATE, p2::FLOAT, p3::FLOAT, p4::FLOAT, p5::FLOAT, p6::BIGINT, p7::TIMESTAMP WITHOUT TIME ZONE, p8::TIMESTAMP WITHOUT TIME ZONE FRO ... 571 characters truncated ... r) ORDER BY sen_counter RETURNING daily_prices.id, daily_prices.updated_at, daily_prices.id AS id__1]
[parameters: {'close__0': np.int64(71500), 'date__0': datetime.date(2025, 7, 29), 'high__0': np.int64(72000), 'volume__0': np.int64(1000000), 'created_at__0': datetime.datetime(2025, 7, 29, 17, 16, 9, 736122), 'open__0': np.int64(70000), 'symbol__0': '005930', 'low__0': np.int64(69000), 'close__1': np.int64(72500), 'date__1': datetime.date(2025, 7, 28), 'high__1': np.int64(73000), 'volume__1': np.int64(1200000), 'created_at__1': datetime.datetime(2025, 7, 29, 17, 16, 9, 737543), 'open__1': np.int64(71000), 'symbol__1': '005930', 'low__1': np.int64(70000), 'close__2': np.int64(101500), 'date__2': datetime.date(2025, 7, 29), 'high__2': np.int64(102000), 'volume__2': np.int64(500000), 'created_at__2': datetime.datetime(2025, 7, 29, 17, 16, 9, 738955), 'open__2': np.int64(100000), 'symbol__2': '000660', 'low__2': np.int64(99000), 'close__3': np.int64(102500), 'date__3': datetime.date(2025, 7, 28), 'high__3': np.int64(103000), 'volume__3': np.int64(600000), 'created_at__3': datetime.datetime(2025, 7, 29, 17, 16, 9, 740087), 'open__3': np.int64(101000), 'symbol__3': '000660', 'low__3': np.int64(100000)}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-07-29 17:16:09,850 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:10,575 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:11,393 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:11,411 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:16:11,412 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=NONEXIST
2025-07-29 17:16:11,415 - src.api.services.stock_service - WARNING - 현재가 없음: NONEXIST.
2025-07-29 17:16:11,419 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:47,965 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 17:17:47,970 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 17:17:47,975 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:17:47,975 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:17:47,976 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:17:47,976 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:17:48,815 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:48,819 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 17:17:48,824 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-07-29 17:17:48,825 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '<unknown>'
2025-07-29 17:17:48,826 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-07-29 17:17:49,184 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:49,187 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:17:49,425 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:49,428 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 17:17:49,672 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:49,675 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 17:17:49,677 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 17:17:49,679 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6572107080, username=testuser_6572107080
2025-07-29 17:17:49,693 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=1, telegram_id=6572107080
2025-07-29 17:17:49,931 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:50,184 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 200 OK"
2025-07-29 17:17:50,188 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1969025119, username=testuser_1969025119
2025-07-29 17:17:50,195 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=3, telegram_id=1969025119
2025-07-29 17:17:50,540 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:50,826 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 17:17:50,832 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3979685390, username=testuser_3979685390
2025-07-29 17:17:50,839 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=5, telegram_id=3979685390
2025-07-29 17:17:51,083 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:51,089 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 17:17:51,093 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6344795100, username=testuser_6344795100
2025-07-29 17:17:51,098 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=7, telegram_id=6344795100
2025-07-29 17:17:51,335 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:51,591 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 200 OK"
2025-07-29 17:17:51,597 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3557985961, username=testuser_3557985961
2025-07-29 17:17:51,604 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=9, telegram_id=3557985961
2025-07-29 17:17:51,841 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:52,085 - src.api.routers.admin - ERROR - /admin/update_master 서버 오류: DB connection error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 36, in update_stock_master
    result = await stock_service.update_stock_master(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DB connection error
2025-07-29 17:17:52,088 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:17:52,093 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2021028043, username=testuser_2021028043
2025-07-29 17:17:52,100 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=11, telegram_id=2021028043
2025-07-29 17:17:52,340 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:52,589 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 17:17:52,593 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8383923312, username=testuser_8383923312
2025-07-29 17:17:52,601 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=13, telegram_id=8383923312
2025-07-29 17:17:52,862 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:52,869 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 17:17:52,874 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3799434328, username=testuser_3799434328
2025-07-29 17:17:52,880 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=15, telegram_id=3799434328
2025-07-29 17:17:53,143 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:53,389 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 200 OK"
2025-07-29 17:17:53,397 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2722643789, username=testuser_2722643789
2025-07-29 17:17:53,406 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=17, telegram_id=2722643789
2025-07-29 17:17:53,644 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:53,883 - src.api.routers.admin - ERROR - /admin/update_price 서버 오류: API call failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 53, in update_daily_price
    result = await stock_service.update_daily_prices(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: API call failed
2025-07-29 17:17:53,885 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:17:53,890 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1879932261, username=testuser_1879932261
2025-07-29 17:17:53,895 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=19, telegram_id=1879932261
2025-07-29 17:17:54,135 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:54,379 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 17:17:54,383 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2490320716, username=testuser_2490320716
2025-07-29 17:17:54,390 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=21, telegram_id=2490320716
2025-07-29 17:17:54,631 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:54,638 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 17:17:54,643 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8722225550, username=testuser_8722225550
2025-07-29 17:17:54,648 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=23, telegram_id=8722225550
2025-07-29 17:17:54,895 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:54,487 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f7fad87c130>
2025-07-29 17:17:54,487 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:17:54,491 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 200 OK"
2025-07-29 17:17:54,497 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3935845102, username=testuser_3935845102
2025-07-29 17:17:54,503 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=25, telegram_id=3935845102
2025-07-29 17:17:54,762 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:55,031 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f7fad84dcf0>
2025-07-29 17:17:55,032 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:17:55,033 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 200 OK"
2025-07-29 17:17:55,039 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4499873309, username=testuser_4499873309
2025-07-29 17:17:55,046 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=27, telegram_id=4499873309
2025-07-29 17:17:55,300 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:55,571 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f7fada379a0>
2025-07-29 17:17:55,571 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:17:55,573 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=%EC%B9%B4%EC%B9%B4%EC%98%A4 "HTTP/1.1 200 OK"
2025-07-29 17:17:55,579 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5989230735, username=testuser_5989230735
2025-07-29 17:17:55,586 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=29, telegram_id=5989230735
2025-07-29 17:17:55,839 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:56,198 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f7fad8d4070>
2025-07-29 17:17:56,198 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:17:56,202 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=0013456 "HTTP/1.1 200 OK"
2025-07-29 17:17:56,208 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3979794527, username=testuser_3979794527
2025-07-29 17:17:56,216 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=31, telegram_id=3979794527
2025-07-29 17:17:56,467 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:56,769 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f7fad8cfd30>
2025-07-29 17:17:56,769 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:17:56,771 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=NONEXIST "HTTP/1.1 404 Not Found"
2025-07-29 17:17:56,777 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1513191039, username=testuser_1513191039
2025-07-29 17:17:56,786 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=33, telegram_id=1513191039
2025-07-29 17:17:57,028 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:57,283 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f7fad8cff40>
2025-07-29 17:17:57,283 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:17:57,285 - src.api.routers.admin - ERROR - /admin/update_disclosure 서버 오류: DART API error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 126, in update_disclosure
    result = await stock_service.update_disclosures(db, corp_code=corp_code, stock_code=stock_code or '', stock_name=stock_name or '')
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DART API error
2025-07-29 17:17:57,286 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:17:57,293 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2197639345, username=testuser_2197639345
2025-07-29 17:17:57,303 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=35, telegram_id=2197639345
2025-07-29 17:17:57,547 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:57,829 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 17:17:57,835 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3596252679, username=testuser_3596252679
2025-07-29 17:17:57,844 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=37, telegram_id=3596252679
2025-07-29 17:17:58,152 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:58,162 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 17:17:58,167 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6654802743, username=testuser_6654802743
2025-07-29 17:17:58,174 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=39, telegram_id=6654802743
2025-07-29 17:17:58,436 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:58,741 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:17:58,750 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5281208646, username=testuser_5281208646
2025-07-29 17:17:58,758 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=41, telegram_id=5281208646
2025-07-29 17:17:59,142 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:17:59,416 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:17:59,425 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7404755953, username=testuser_7404755953
2025-07-29 17:17:59,434 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=43, telegram_id=7404755953
2025-07-29 17:17:59,715 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:00,024 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 17:18:00,032 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9419485474, username=testuser_9419485474
2025-07-29 17:18:00,042 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=45, telegram_id=9419485474
2025-07-29 17:18:00,345 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:00,353 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 17:18:00,359 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1767064034, username=testuser_1767064034
2025-07-29 17:18:00,367 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=47, telegram_id=1767064034
2025-07-29 17:18:00,647 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:00,984 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 17:18:00,985 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 17:18:00,992 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2601325067, username=testuser_2601325067
2025-07-29 17:18:00,999 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=49, telegram_id=2601325067
2025-07-29 17:18:01,312 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:01,595 - src.api.routers.admin - ERROR - [trigger_job] 잡 실행 실패: test_job - Job execution failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 175, in trigger_job
    job.func(*job.args, **job.kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: Job execution failed

2025-07-29 17:18:01,597 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:18:01,604 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9146621723, username=testuser_9146621723
2025-07-29 17:18:01,615 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=51, telegram_id=9146621723
2025-07-29 17:18:01,885 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:02,155 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 17:18:02,161 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1421687967, username=testuser_1421687967
2025-07-29 17:18:02,169 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=53, telegram_id=1421687967
2025-07-29 17:18:02,431 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:02,437 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 17:18:02,443 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6560934215, username=testuser_6560934215
2025-07-29 17:18:02,450 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=55, telegram_id=6560934215
2025-07-29 17:18:02,820 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:03,092 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 17:18:03,094 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 200 OK"
2025-07-29 17:18:03,101 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1232814947, username=testuser_1232814947
2025-07-29 17:18:03,110 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=57, telegram_id=1232814947
2025-07-29 17:18:03,352 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:03,614 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 17:18:03,614 - src.api.routers.admin - ERROR - 공시 확인 잡 수동 실행 중 오류 발생: Disclosure check failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 193, in trigger_check_disclosures_job
    await stock_service.check_and_notify_new_disclosures(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: Disclosure check failed
2025-07-29 17:18:03,616 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:18:03,623 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8145500004, username=testuser_8145500004
2025-07-29 17:18:03,631 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=59, telegram_id=8145500004
2025-07-29 17:18:03,874 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:04,126 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 17:18:04,131 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4438954991, username=testuser_4438954991
2025-07-29 17:18:04,140 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=61, telegram_id=4438954991
2025-07-29 17:18:04,393 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:04,403 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 17:18:04,410 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2478504239, username=testuser_2478504239
2025-07-29 17:18:04,420 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=63, telegram_id=2478504239
2025-07-29 17:18:04,663 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:04,913 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:04,918 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=65, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:18:04,931 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=1, user_id=65, symbol=005930
2025-07-29 17:18:04,934 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:18:04,942 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3250945876, username=testuser_3250945876
2025-07-29 17:18:04,948 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=66, telegram_id=3250945876
2025-07-29 17:18:05,196 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:05,200 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:18:05,204 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3067304380, username=testuser_3067304380
2025-07-29 17:18:05,209 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=68, telegram_id=3067304380
2025-07-29 17:18:05,451 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:05,700 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:05,702 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:18:05,709 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5830394421, username=testuser_5830394421
2025-07-29 17:18:05,719 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=71, telegram_id=5830394421
2025-07-29 17:18:05,968 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:06,212 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:06,213 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:18:06,220 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=2, user_id=73, symbol=005930
2025-07-29 17:18:06,221 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:18:06,224 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:06,225 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=035720, target_price=50000.0, condition=lte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:18:06,232 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=3, user_id=73, symbol=035720
2025-07-29 17:18:06,233 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:18:06,236 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:06,237 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 조회 시도.
2025-07-29 17:18:06,240 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 2개 조회됨.
2025-07-29 17:18:06,242 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:18:06,246 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1251808796, username=testuser_1251808796
2025-07-29 17:18:06,253 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=74, telegram_id=1251808796
2025-07-29 17:18:06,492 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:06,741 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:06,742 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 조회 시도.
2025-07-29 17:18:06,744 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 0개 조회됨.
2025-07-29 17:18:06,746 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:18:06,751 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3145217957, username=testuser_3145217957
2025-07-29 17:18:06,757 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=77, telegram_id=3145217957
2025-07-29 17:18:07,005 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:07,011 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:18:07,017 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9583440494, username=testuser_9583440494
2025-07-29 17:18:07,024 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=79, telegram_id=9583440494
2025-07-29 17:18:07,265 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:07,510 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:07,511 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=81, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:18:07,517 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=4, user_id=81, symbol=005930
2025-07-29 17:18:07,519 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:18:07,523 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:07,524 - src.api.services.price_alert_service - DEBUG - 사용자(81)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:18:07,528 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=4
2025-07-29 17:18:07,530 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/81/symbol/005930 "HTTP/1.1 200 OK"
2025-07-29 17:18:07,536 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2490836501, username=testuser_2490836501
2025-07-29 17:18:07,557 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=82, telegram_id=2490836501
2025-07-29 17:18:07,803 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:08,064 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:08,065 - src.api.services.price_alert_service - DEBUG - 사용자(84)와 종목(NONEXISTENT)으로 가격 알림 조회 시도.
2025-07-29 17:18:08,067 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=84, symbol=NONEXISTENT
2025-07-29 17:18:08,069 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/84/symbol/NONEXISTENT "HTTP/1.1 404 Not Found"
2025-07-29 17:18:08,075 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7657947596, username=testuser_7657947596
2025-07-29 17:18:08,085 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=85, telegram_id=7657947596
2025-07-29 17:18:08,408 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:08,653 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:08,654 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=87, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:18:08,661 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=5, user_id=87, symbol=005930
2025-07-29 17:18:08,663 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:18:08,667 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:08,671 - src.api.services.price_alert_service - DEBUG - 가격 알림(5) 수정 시도: update_data={'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 17:18:08,674 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:18:08,674 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 17:18:08,674 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:18:08,680 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:18:08,681 - src.api.services.price_alert_service - INFO - 가격 알림(5) 수정 성공.
2025-07-29 17:18:08,684 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/5 "HTTP/1.1 200 OK"
2025-07-29 17:18:08,690 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9219347408, username=testuser_9219347408
2025-07-29 17:18:08,695 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=88, telegram_id=9219347408
2025-07-29 17:18:08,934 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:09,182 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:09,183 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=90, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:18:09,189 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=6, user_id=90, symbol=005930
2025-07-29 17:18:09,190 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:18:09,193 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/6 "HTTP/1.1 403 Forbidden"
2025-07-29 17:18:09,199 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1243963022, username=testuser_1243963022
2025-07-29 17:18:09,205 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=91, telegram_id=1243963022
2025-07-29 17:18:09,452 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:09,698 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:09,699 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 17:18:09,701 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 17:18:09,703 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:18:09,709 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7041860238, username=testuser_7041860238
2025-07-29 17:18:09,716 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=94, telegram_id=7041860238
2025-07-29 17:18:09,959 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:10,478 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:10,478 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=96, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:18:10,484 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=7, user_id=96, symbol=005930
2025-07-29 17:18:10,486 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:18:10,488 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:10,488 - src.api.services.price_alert_service - DEBUG - 가격 알림(7) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 17:18:10,490 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:18:10,490 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0}
2025-07-29 17:18:10,491 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:18:10,495 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:18:10,495 - src.api.services.price_alert_service - INFO - 가격 알림(7) 수정 성공.
2025-07-29 17:18:10,497 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/7 "HTTP/1.1 403 Forbidden"
2025-07-29 17:18:10,502 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1892183359, username=testuser_1892183359
2025-07-29 17:18:10,508 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=98, telegram_id=1892183359
2025-07-29 17:18:10,748 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:11,006 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:11,007 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=100, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:18:11,013 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=8, user_id=100, symbol=005930
2025-07-29 17:18:11,015 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:18:11,017 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:11,021 - src.api.services.price_alert_service - DEBUG - 가격 알림(8) 삭제 시도.
2025-07-29 17:18:11,027 - src.api.services.price_alert_service - INFO - 가격 알림(8) 삭제 성공.
2025-07-29 17:18:11,028 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/8 "HTTP/1.1 200 OK"
2025-07-29 17:18:11,035 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7488893021, username=testuser_7488893021
2025-07-29 17:18:11,041 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=101, telegram_id=7488893021
2025-07-29 17:18:11,290 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:11,536 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:11,537 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=103, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:18:11,542 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=9, user_id=103, symbol=005930
2025-07-29 17:18:11,543 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:18:11,546 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/9 "HTTP/1.1 403 Forbidden"
2025-07-29 17:18:11,552 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8213510985, username=testuser_8213510985
2025-07-29 17:18:11,558 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=104, telegram_id=8213510985
2025-07-29 17:18:11,801 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:12,045 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:12,047 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 삭제 시도.
2025-07-29 17:18:12,050 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 17:18:12,051 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:18:12,058 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4339851018, username=testuser_4339851018
2025-07-29 17:18:12,065 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=107, telegram_id=4339851018
2025-07-29 17:18:12,305 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:12,805 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:12,805 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=109, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:18:12,811 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=10, user_id=109, symbol=005930
2025-07-29 17:18:12,813 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:18:12,815 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:12,820 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/10 "HTTP/1.1 403 Forbidden"
2025-07-29 17:18:12,825 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8238839654, username=testuser_8238839654
2025-07-29 17:18:12,831 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=111, telegram_id=8238839654
2025-07-29 17:18:13,069 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:13,075 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 17:18:13,081 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6643543273, username=testuser_6643543273
2025-07-29 17:18:13,088 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=113, telegram_id=6643543273
2025-07-29 17:18:13,332 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:13,338 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 17:18:13,346 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:13,350 - httpx - INFO - HTTP Request: GET http://testserver/ "HTTP/1.1 200 OK"
2025-07-29 17:18:13,352 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1493860116, username=testuser_1493860116
2025-07-29 17:18:13,359 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=115, telegram_id=1493860116
2025-07-29 17:18:13,602 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:13,606 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:18:13,611 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:18:13,611 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 17:18:13,615 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:18:13,616 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:18:13,617 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 17:18:13,623 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3150174279, username=testuser_3150174279
2025-07-29 17:18:13,629 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=117, telegram_id=3150174279
2025-07-29 17:18:13,867 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:13,871 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:18:13,875 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=INVALID
2025-07-29 17:18:13,876 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=INVALID, days=40
2025-07-29 17:18:13,877 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:18:13,878 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:18:13,879 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 17:18:13,884 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4103421309, username=testuser_4103421309
2025-07-29 17:18:13,890 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=119, telegram_id=4103421309
2025-07-29 17:18:14,214 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:14,219 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:18:14,224 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:18:14,234 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6827922850, username=testuser_6827922850
2025-07-29 17:18:14,242 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=121, telegram_id=6827922850
2025-07-29 17:18:14,495 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:14,779 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=123, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:18:14,784 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 17:18:14,786 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:18:14,788 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/123 "HTTP/1.1 200 OK"
2025-07-29 17:18:14,796 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9575445812, username=testuser_9575445812
2025-07-29 17:18:14,806 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=124, telegram_id=9575445812
2025-07-29 17:18:15,046 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:15,052 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=99999, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:18:15,054 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 17:18:15,056 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:18:15,058 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/99999 "HTTP/1.1 200 OK"
2025-07-29 17:18:15,065 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4705861162, username=testuser_4705861162
2025-07-29 17:18:15,071 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=126, telegram_id=4705861162
2025-07-29 17:18:15,320 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:15,565 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=128, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:18:15,567 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 17:18:15,568 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:18:15,570 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/128 "HTTP/1.1 200 OK"
2025-07-29 17:18:15,577 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5630696920, username=testuser_5630696920
2025-07-29 17:18:15,583 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=129, telegram_id=5630696920
2025-07-29 17:18:15,846 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:16,118 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=1, page_size=5, symbol=None, prediction=None
2025-07-29 17:18:16,120 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 17:18:16,122 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 1, 페이지 크기 5).
2025-07-29 17:18:16,123 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=1&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 17:18:16,126 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=2, page_size=5, symbol=None, prediction=None
2025-07-29 17:18:16,127 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 17:18:16,128 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 2, 페이지 크기 5).
2025-07-29 17:18:16,130 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=2&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 17:18:16,136 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8601118597, username=testuser_8601118597
2025-07-29 17:18:16,141 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=132, telegram_id=8601118597
2025-07-29 17:18:16,394 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:16,643 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=134, page=1, page_size=10, symbol=005930, prediction=None
2025-07-29 17:18:16,644 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 17:18:16,648 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 17:18:16,651 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:18:16,653 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/134?symbol=005930 "HTTP/1.1 200 OK"
2025-07-29 17:18:16,661 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3393691844, username=testuser_3393691844
2025-07-29 17:18:16,669 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=135, telegram_id=3393691844
2025-07-29 17:18:16,923 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:17,190 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=137, page=1, page_size=10, symbol=None, prediction=상승
2025-07-29 17:18:17,190 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=상승
2025-07-29 17:18:17,194 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 17:18:17,197 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:18:17,200 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/137?prediction=%EC%83%81%EC%8A%B9 "HTTP/1.1 200 OK"
2025-07-29 17:18:17,207 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5482072240, username=testuser_5482072240
2025-07-29 17:18:17,212 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=138, telegram_id=5482072240
2025-07-29 17:18:17,459 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:17,706 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=140, page=1, page_size=10, symbol=005930, prediction=유지
2025-07-29 17:18:17,707 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 17:18:17,707 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=유지
2025-07-29 17:18:17,711 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 17:18:17,715 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:18:17,717 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/140?symbol=005930&prediction=%EC%9C%A0%EC%A7%80 "HTTP/1.1 200 OK"
2025-07-29 17:18:17,723 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4358861423, username=testuser_4358861423
2025-07-29 17:18:17,731 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=141, telegram_id=4358861423
2025-07-29 17:18:17,972 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:17,985 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=143, symbol=005930, trade_type=buy
2025-07-29 17:18:17,985 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:18:17,989 - src.api.services.stock_service - WARNING - 현재가 없음: 005930.
2025-07-29 17:18:17,989 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: None
2025-07-29 17:18:17,995 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=143, symbol=005930, trade_type=buy
2025-07-29 17:18:17,997 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 17:18:18,001 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=143
2025-07-29 17:18:18,004 - src.api.routers.simulated_trade - DEBUG - 사용자(143)의 모의매매 이력 1건 조회됨.
2025-07-29 17:18:18,005 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 17:18:18,006 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/143 "HTTP/1.1 200 OK"
2025-07-29 17:18:18,014 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9426643511, username=testuser_9426643511
2025-07-29 17:18:18,021 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=144, telegram_id=9426643511
2025-07-29 17:18:18,261 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:18,282 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 17:18:18,293 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3856889155, username=testuser_3856889155
2025-07-29 17:18:18,300 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=146, telegram_id=3856889155
2025-07-29 17:18:18,539 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:18,547 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 17:18:18,553 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2743795650, username=testuser_2743795650
2025-07-29 17:18:18,559 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=148, telegram_id=2743795650
2025-07-29 17:18:18,799 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:18,814 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%82%BC%EC%84%B1%EC%A0%84%EC%9E%90 "HTTP/1.1 200 OK"
2025-07-29 17:18:18,822 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6731229020, username=testuser_6731229020
2025-07-29 17:18:18,828 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=150, telegram_id=6731229020
2025-07-29 17:18:19,078 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:19,096 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=035720 "HTTP/1.1 200 OK"
2025-07-29 17:18:19,107 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8598054926, username=testuser_8598054926
2025-07-29 17:18:19,116 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=152, telegram_id=8598054926
2025-07-29 17:18:19,491 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:19,515 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=sk%ED%95%98%EC%9D%B4%EB%8B%89%EC%8A%A4 "HTTP/1.1 200 OK"
2025-07-29 17:18:19,524 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7145498857, username=testuser_7145498857
2025-07-29 17:18:19,532 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=154, telegram_id=7145498857
2025-07-29 17:18:19,786 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:19,793 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%97%86%EB%8A%94%EC%A2%85%EB%AA%A9 "HTTP/1.1 200 OK"
2025-07-29 17:18:19,800 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8267361623, username=testuser_8267361623
2025-07-29 17:18:19,805 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=156, telegram_id=8267361623
2025-07-29 17:18:20,060 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:20,067 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query= "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:18:20,073 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4580204387, username=testuser_4580204387
2025-07-29 17:18:20,079 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=158, telegram_id=4580204387
2025-07-29 17:18:20,330 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:20,339 - httpx - INFO - HTTP Request: GET http://testserver/symbols/005930/current_price_and_change "HTTP/1.1 200 OK"
2025-07-29 17:18:20,346 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9305180978, username=testuser_9305180978
2025-07-29 17:18:20,353 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=160, telegram_id=9305180978
2025-07-29 17:18:20,595 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:20,603 - httpx - INFO - HTTP Request: GET http://testserver/symbols/NONEXISTENT/current_price_and_change "HTTP/1.1 404 Not Found"
2025-07-29 17:18:20,609 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9536820207, username=testuser_9536820207
2025-07-29 17:18:20,615 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=162, telegram_id=9536820207
2025-07-29 17:18:20,855 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:21,243 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 17:18:21,249 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2233517718, username=testuser_2233517718
2025-07-29 17:18:21,257 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=165, telegram_id=2233517718
2025-07-29 17:18:21,508 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:21,764 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 400 Bad Request"
2025-07-29 17:18:21,770 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8248532166, username=testuser_8248532166
2025-07-29 17:18:21,777 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=168, telegram_id=8248532166
2025-07-29 17:18:22,016 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:22,498 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 17:18:22,505 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6928902055, username=testuser_6928902055
2025-07-29 17:18:22,513 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=171, telegram_id=6928902055
2025-07-29 17:18:22,754 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:22,764 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 17:18:22,770 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3006995017, username=testuser_3006995017
2025-07-29 17:18:22,777 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=173, telegram_id=3006995017
2025-07-29 17:18:23,013 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:23,487 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 17:18:23,493 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5811270432, username=testuser_5811270432
2025-07-29 17:18:23,501 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=176, telegram_id=5811270432
2025-07-29 17:18:23,765 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:24,030 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 178
2025-07-29 17:18:24,033 - src.api.services.user_service - DEBUG - User found by id: user_id=178
2025-07-29 17:18:24,037 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 17:18:24,043 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9298262364, username=testuser_9298262364
2025-07-29 17:18:24,048 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=179, telegram_id=9298262364
2025-07-29 17:18:24,031 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:24,036 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 403 Forbidden"
2025-07-29 17:18:24,042 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4480379445, username=testuser_4480379445
2025-07-29 17:18:24,050 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=181, telegram_id=4480379445
2025-07-29 17:18:23,861 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:24,163 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 183
2025-07-29 17:18:24,165 - src.api.services.user_service - DEBUG - User found by id: user_id=183
2025-07-29 17:18:24,184 - httpx - INFO - HTTP Request: PUT http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 17:18:24,191 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7523966452, username=testuser_7523966452
2025-07-29 17:18:24,200 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=184, telegram_id=7523966452
2025-07-29 17:18:24,470 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:24,486 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 17:18:24,491 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1208385622, username=testuser_1208385622
2025-07-29 17:18:24,497 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=187, telegram_id=1208385622
2025-07-29 17:18:24,746 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:25,007 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 17:18:25,013 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7552607619, username=testuser_7552607619
2025-07-29 17:18:25,020 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=190, telegram_id=7552607619
2025-07-29 17:18:25,276 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:25,549 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/192 "HTTP/1.1 200 OK"
2025-07-29 17:18:25,555 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4589074559, username=testuser_4589074559
2025-07-29 17:18:25,562 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=193, telegram_id=4589074559
2025-07-29 17:18:25,818 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:25,826 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:18:25,831 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7902466200, username=testuser_7902466200
2025-07-29 17:18:25,839 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=195, telegram_id=7902466200
2025-07-29 17:18:26,086 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:26,565 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 197
2025-07-29 17:18:26,567 - src.api.services.user_service - DEBUG - User found by id: user_id=197
2025-07-29 17:18:26,583 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 200 OK"
2025-07-29 17:18:26,588 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5354634704, username=testuser_5354634704
2025-07-29 17:18:26,594 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=199, telegram_id=5354634704
2025-07-29 17:18:26,837 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:27,079 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 201
2025-07-29 17:18:27,081 - src.api.services.user_service - DEBUG - User found by id: user_id=201
2025-07-29 17:18:27,083 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:18:27,087 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4468305061, username=testuser_4468305061
2025-07-29 17:18:27,093 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=202, telegram_id=4468305061
2025-07-29 17:18:27,336 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:27,343 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=204, symbol=005930
2025-07-29 17:18:27,351 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=204, symbol=005930
2025-07-29 17:18:27,353 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 17:18:27,356 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 시도: user_id=204
2025-07-29 17:18:27,358 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 성공: user_id=204, 1개 종목.
2025-07-29 17:18:27,359 - httpx - INFO - HTTP Request: GET http://testserver/watchlist/get/204 "HTTP/1.1 200 OK"
2025-07-29 17:18:27,367 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:27,369 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:18:27,369 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:18:27,374 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:27,379 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12345
2025-07-29 17:18:27,383 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=1, telegram_id=12345
2025-07-29 17:18:27,384 - src.api.services.price_alert_service - DEBUG - 사용자(1)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:18:27,388 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=1
2025-07-29 17:18:27,389 - src.api.services.price_alert_service - DEBUG - 가격 알림(1) 수정 시도: update_data={'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 17:18:27,393 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:18:27,394 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 17:18:27,394 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:18:27,399 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:18:27,399 - src.api.services.price_alert_service - INFO - 가격 알림(1) 수정 성공.
2025-07-29 17:18:27,401 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:18:27,408 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:18:27,408 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:18:27,412 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:27,413 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 17:18:27,415 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 17:18:27,416 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:18:27,418 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 17:18:27,418 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 17:18:27,419 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:18:27,420 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 17:18:27,420 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:18:27,428 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:18:27,429 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 17:18:27,430 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:18:27,434 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:27,435 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 17:18:27,437 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 17:18:27,438 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:18:27,439 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 17:18:27,440 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 17:18:27,441 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:18:27,441 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 17:18:27,442 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:18:27,447 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:18:27,448 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 17:18:27,449 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:18:27,463 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2905955216, username=testuser_2905955216
2025-07-29 17:18:27,471 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=205, telegram_id=2905955216
2025-07-29 17:18:27,474 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:27,477 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:18:27,479 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:27,483 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 2905955216
2025-07-29 17:18:27,486 - src.api.services.user_service - DEBUG - User not found for telegram_id: 2905955216
2025-07-29 17:18:27,486 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2905955216, username=testuser_2905955216
2025-07-29 17:18:27,495 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=214, telegram_id=2905955216
2025-07-29 17:18:27,495 - src.api.services.price_alert_service - DEBUG - 사용자(214)와 종목(GOOG)으로 가격 알림 조회 시도.
2025-07-29 17:18:27,498 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=214, symbol=GOOG
2025-07-29 17:18:27,498 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=214, symbol=GOOG, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:18:27,507 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=213, user_id=214, symbol=GOOG
2025-07-29 17:18:27,509 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:18:27,512 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:18:27,521 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7218756423, username=testuser_7218756423
2025-07-29 17:18:27,532 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=206, telegram_id=7218756423
2025-07-29 17:18:27,535 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:27,539 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:18:27,542 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:27,543 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 7218756423
2025-07-29 17:18:27,546 - src.api.services.user_service - DEBUG - User not found for telegram_id: 7218756423
2025-07-29 17:18:27,546 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7218756423, username=telegram_user_7218756423
2025-07-29 17:18:27,553 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=215, telegram_id=7218756423
2025-07-29 17:18:27,554 - src.api.services.price_alert_service - DEBUG - 사용자(215)와 종목(MSFT)으로 가격 알림 조회 시도.
2025-07-29 17:18:27,556 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=215, symbol=MSFT
2025-07-29 17:18:27,557 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=215, symbol=MSFT, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:18:27,564 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=214, user_id=215, symbol=MSFT
2025-07-29 17:18:27,566 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:18:27,569 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:18:27,575 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8155812812, username=testuser_8155812812
2025-07-29 17:18:27,583 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=207, telegram_id=8155812812
2025-07-29 17:18:27,588 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:27,591 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:18:27,593 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:27,594 - src.api.routers.bot_router - DEBUG - Before toggle: existing_alert.notify_on_disclosure = True
2025-07-29 17:18:27,594 - src.api.routers.bot_router - DEBUG - Calculated new_status: False
2025-07-29 17:18:27,594 - src.api.routers.bot_router - DEBUG - After update_alert call: updated_alert_orm.notify_on_disclosure = False
2025-07-29 17:18:27,595 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:18:27,597 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:18:27,603 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7870365015, username=testuser_7870365015
2025-07-29 17:18:27,609 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=208, telegram_id=7870365015
2025-07-29 17:18:27,613 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:27,616 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:18:27,617 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:27,618 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 7870365015
2025-07-29 17:18:27,620 - src.api.services.user_service - DEBUG - User not found for telegram_id: 7870365015
2025-07-29 17:18:27,621 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7870365015, username=telegram_user_7870365015
2025-07-29 17:18:27,626 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=216, telegram_id=7870365015
2025-07-29 17:18:27,627 - src.api.services.price_alert_service - DEBUG - 사용자(216)와 종목(NFLX)으로 가격 알림 조회 시도.
2025-07-29 17:18:27,629 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=216, symbol=NFLX
2025-07-29 17:18:27,630 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=216, symbol=NFLX, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:18:27,637 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=215, user_id=216, symbol=NFLX
2025-07-29 17:18:27,639 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:18:27,641 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:18:27,650 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8787214931, username=testuser_8787214931
2025-07-29 17:18:27,656 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=209, telegram_id=8787214931
2025-07-29 17:18:27,657 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:27,660 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:18:27,661 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:27,662 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 8787214931
2025-07-29 17:18:27,664 - src.api.services.user_service - DEBUG - User not found for telegram_id: 8787214931
2025-07-29 17:18:27,664 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8787214931, username=testuser_8787214931
2025-07-29 17:18:27,671 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=217, telegram_id=8787214931
2025-07-29 17:18:27,671 - src.api.services.price_alert_service - DEBUG - 사용자(217)와 종목(NVDA)으로 가격 알림 조회 시도.
2025-07-29 17:18:27,674 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=217, symbol=NVDA
2025-07-29 17:18:27,675 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=217, symbol=NVDA, target_price=1000.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:18:27,680 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=216, user_id=217, symbol=NVDA
2025-07-29 17:18:27,682 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:18:27,684 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:18:27,689 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9533901702, username=testuser_9533901702
2025-07-29 17:18:27,697 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=210, telegram_id=9533901702
2025-07-29 17:18:27,700 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:27,703 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:18:27,704 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:27,705 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 9533901702
2025-07-29 17:18:27,707 - src.api.services.user_service - DEBUG - User not found for telegram_id: 9533901702
2025-07-29 17:18:27,707 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9533901702, username=telegram_user_9533901702
2025-07-29 17:18:27,714 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=218, telegram_id=9533901702
2025-07-29 17:18:27,714 - src.api.services.price_alert_service - DEBUG - 사용자(218)와 종목(GOOGL)으로 가격 알림 조회 시도.
2025-07-29 17:18:27,716 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=218, symbol=GOOGL
2025-07-29 17:18:27,717 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=218, symbol=GOOGL, target_price=110.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=weekly
2025-07-29 17:18:27,723 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=217, user_id=218, symbol=GOOGL
2025-07-29 17:18:27,724 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:18:27,727 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:18:27,733 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8641059241, username=testuser_8641059241
2025-07-29 17:18:27,740 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=211, telegram_id=8641059241
2025-07-29 17:18:27,744 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:27,747 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:18:27,749 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:27,750 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 8641059241
2025-07-29 17:18:27,753 - src.api.services.user_service - DEBUG - User not found for telegram_id: 8641059241
2025-07-29 17:18:27,754 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8641059241, username=telegram_user_8641059241
2025-07-29 17:18:27,760 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=219, telegram_id=8641059241
2025-07-29 17:18:27,761 - src.api.services.price_alert_service - DEBUG - 사용자(219)와 종목(FB)으로 가격 알림 조회 시도.
2025-07-29 17:18:27,763 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=219, symbol=FB
2025-07-29 17:18:27,764 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=219, symbol=FB, target_price=300.0, condition=above, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:18:27,770 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=218, user_id=219, symbol=FB
2025-07-29 17:18:27,772 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:18:27,774 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:18:27,779 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:27,780 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:27,788 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:27,795 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:27,797 - src.common.dart_utils - ERROR - DART CORPCODE.xml 요청 실패: Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 25, in dart_get_all_stocks
    resp = await session.get(url, timeout=60)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 17:18:27,802 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:27,809 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:27,821 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:27,825 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:27,827 - src.common.dart_utils - ERROR - DART 공시 조회 API 요청 실패 (corp_code: 00123456): Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 79, in dart_get_disclosures
    resp = await session.get(url, params=params, timeout=10)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 17:18:27,831 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:27,834 - src.common.dart_utils - ERROR - DART 공시 API가 오류를 반환했습니다. status: 001, message: API 호출 오류, corp_code: 00123456
2025-07-29 17:18:27,923 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2846022277, username=testuser_2846022277
2025-07-29 17:18:27,931 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=212, telegram_id=2846022277
2025-07-29 17:18:28,171 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:28,413 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 17:18:28,650 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 17:18:28,654 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=214, symbol=005930
2025-07-29 17:18:28,661 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=214, symbol=005930
2025-07-29 17:18:28,663 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 17:18:28,666 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 214
2025-07-29 17:18:28,668 - src.api.services.user_service - DEBUG - User found by id: user_id=214
2025-07-29 17:18:28,669 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:18:28,669 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=214, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:18:28,675 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=11, user_id=214, symbol=005930
2025-07-29 17:18:28,677 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:18:28,680 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:18:28,683 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:18:28,683 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 17:18:28,685 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:18:28,685 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:18:28,691 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 17:18:28,695 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=214, symbol=005930, trade_type=buy
2025-07-29 17:18:28,695 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:18:28,697 - src.api.services.stock_service - WARNING - 현재가 없음: 005930.
2025-07-29 17:18:28,698 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: None
2025-07-29 17:18:28,703 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=214, symbol=005930, trade_type=buy
2025-07-29 17:18:28,704 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 17:18:28,706 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=214
2025-07-29 17:18:28,708 - src.api.routers.simulated_trade - DEBUG - 사용자(214)의 모의매매 이력 1건 조회됨.
2025-07-29 17:18:28,708 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 17:18:28,709 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/214 "HTTP/1.1 200 OK"
2025-07-29 17:18:28,718 - src.api.main - INFO - [APScheduler] 가격 알림 체크 잡 실행: 2025-07-29 17:18:28.718070
2025-07-29 17:18:28,718 - src.api.main - DEBUG - 활성 알림 수: 3
2025-07-29 17:18:28,718 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:18:28,718 - src.api.main - DEBUG - 종목 정상종목 현재가: 110
2025-07-29 17:18:28,719 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='140186348704464'>, 목표 가격: 100, 조건: gte, 반복 주기: <MagicMock name='mock.repeat_interval' id='140186348703984'>
2025-07-29 17:18:28,720 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목, 현재가: 110, 목표가: 100
2025-07-29 17:18:28,723 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='140186349583664'>)
2025-07-29 17:18:28,724 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 17:18:28,724 - src.api.main - DEBUG - 종목 오류종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:18:28,725 - src.api.main - ERROR - 가격 알림 확인 중 '오류종목' 처리 오류: 현재가 조회 실패
Traceback (most recent call last):
  File "/app/src/api/main.py", line 145, in check_price_alerts_job
    price_data = stock_service.get_current_price_and_change(symbol, db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1179, in _execute_mock_call
    result = effect(*args, **kwargs)
  File "/app/src/api/tests/test_main_jobs.py", line 34, in get_current_price_side_effect
    raise ValueError("현재가 조회 실패")
ValueError: 현재가 조회 실패
2025-07-29 17:18:28,725 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:18:28,725 - src.api.main - DEBUG - 종목 정상종목2 현재가: 290
2025-07-29 17:18:28,727 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='140186348815744'>, 목표 가격: 300, 조건: lte, 반복 주기: <MagicMock name='mock.repeat_interval' id='140186351193536'>
2025-07-29 17:18:28,727 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목2, 현재가: 290, 목표가: 300
2025-07-29 17:18:28,728 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='140186349583664'>)
2025-07-29 17:18:28,728 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 17:18:28,728 - src.api.main - DEBUG - 모든 가격 알림 체크 및 DB 커밋 완료.
2025-07-29 17:18:28,732 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:18:28,732 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(10일)
2025-07-29 17:18:28,736 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:18:28,737 - src.api.services.predict_service - ERROR - 예측 불가: 데이터 분석 실패
2025-07-29 17:18:28,741 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:18:28,741 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:18:28,753 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 상승 (24일 지속). 금일 변동: 보합. 최근 20일간 상승일: 19일, 하락일: 0일.
2025-07-29 17:18:28,753 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 17:18:28,757 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:18:28,758 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:18:28,764 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 하락 (24일 지속). 금일 변동: 보합. 최근 20일간 상승일: 0일, 하락일: 19일.
2025-07-29 17:18:28,765 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 17:18:28,768 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:18:28,768 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:18:28,776 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 횡보 (1일 지속). 금일 변동: 보합. 최근 20일간 상승일: 12일, 하락일: 7일.
2025-07-29 17:18:28,776 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 17:18:28,782 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:18:28,783 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:18:28,788 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=buy, reason=최근 추세: 하락 (1일 지속). 금일 변동: 횡보. 최근 20일간 상승일: 2일, 하락일: 17일. (저점 횡보 패턴 감지)
2025-07-29 17:18:28,788 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: buy
2025-07-29 17:18:28,793 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:18:28,793 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 22개 데이터.
2025-07-29 17:18:28,799 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, reason=최근 추세: 상승 (21일 지속). 금일 변동: 횡보. 최근 20일간 상승일: 19일, 하락일: 0일. (급등 후 횡보 패턴 감지)
2025-07-29 17:18:28,800 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 17:18:28,805 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:28,811 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:18:28,812 - src.api.services.stock_service - INFO - 신규 공시가 없습니다. (DB 기준: 202301010000001)
2025-07-29 17:18:28,816 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:28,821 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:18:28,829 - src.api.services.stock_service - INFO - 최초 실행. 기준 접수번호를 202301020000001로 DB에 설정합니다.
2025-07-29 17:18:28,832 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:18:28,833 - src.api.services.stock_service - INFO - 최초 실행. 기준 접수번호를 202301020000001로 DB에 설정합니다.
2025-07-29 17:18:28,836 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:28,844 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:18:28,844 - src.api.services.stock_service - INFO - 2건의 신규 공시를 발견했습니다.
2025-07-29 17:18:28,845 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 17:18:28,846 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 17:18:28,846 - src.api.services.stock_service - INFO - 마지막 확인 접수번호를 202301020000002로 DB에 갱신합니다.
2025-07-29 17:18:28,851 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:28,856 - src.api.services.stock_service - CRITICAL - DART API 사용 한도를 초과했습니다: [020] 사용 한도 초과
2025-07-29 17:18:28,859 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:28,864 - src.api.services.stock_service - ERROR - DART 공시 조회 중 API 오류 발생: [999] 기타 API 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 40, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
src.common.exceptions.DartApiError: [999] 기타 API 오류
2025-07-29 17:18:28,868 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:28,875 - src.api.services.stock_service - ERROR - 신규 공시 확인 및 알림 작업 중 예상치 못한 오류 발생: 예상치 못한 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 40, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: 예상치 못한 오류
2025-07-29 17:18:28,878 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:28,888 - src.api.services.stock_service - DEBUG - update_daily_prices 호출.
2025-07-29 17:18:28,891 - src.api.services.stock_service - DEBUG - DB에서 2개 종목 가져옴.
2025-07-29 17:18:28,891 - src.api.services.stock_service - DEBUG - 종목 005930 (삼성전자) 일별시세 갱신 시작.
2025-07-29 17:18:28,895 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 005930 - 2025-07-29
2025-07-29 17:18:28,898 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 005930 - 2025-07-28
2025-07-29 17:18:28,899 - src.api.services.stock_service - DEBUG - 종목 000660 (SK하이닉스) 일별시세 갱신 시작.
2025-07-29 17:18:28,902 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 000660 - 2025-07-29
2025-07-29 17:18:28,905 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 000660 - 2025-07-28
2025-07-29 17:18:28,912 - src.api.services.stock_service - INFO - 일별시세 갱신 완료: 4개 데이터 처리. 오류: 0개 종목
2025-07-29 17:18:29,027 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:29,920 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:30,781 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:30,790 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:18:30,792 - src.api.services.stock_service - DEBUG - 현재가 발견: 005930 - 71500.0
2025-07-29 17:18:30,793 - src.api.services.stock_service - DEBUG - 전일 종가 발견: 005930 - 70500.0
2025-07-29 17:18:30,805 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:30,807 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=NONEXIST
2025-07-29 17:18:30,810 - src.api.services.stock_service - WARNING - 현재가 없음: NONEXIST.
2025-07-29 17:18:30,813 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:18:30,819 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:18:30,821 - src.api.services.stock_service - DEBUG - 현재가 발견: 005930 - 71500.0
2025-07-29 17:18:30,822 - src.api.services.stock_service - DEBUG - 전일 종가 발견: 005930 - 70500.0
2025-07-29 17:19:52,067 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 17:19:52,071 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 17:19:52,074 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:19:52,075 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:19:52,075 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:19:52,075 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:19:52,908 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:19:52,912 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 17:19:52,917 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-07-29 17:19:52,918 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '<unknown>'
2025-07-29 17:19:52,918 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-07-29 17:19:53,362 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:19:53,367 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:19:53,609 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:19:53,613 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 17:19:53,853 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:19:53,856 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 17:19:53,858 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 17:19:53,868 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4337637703, username=testuser_4337637703
2025-07-29 17:19:53,881 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=1, telegram_id=4337637703
2025-07-29 17:19:54,125 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:19:54,396 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 200 OK"
2025-07-29 17:19:54,411 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1234997223, username=testuser_1234997223
2025-07-29 17:19:54,418 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=3, telegram_id=1234997223
2025-07-29 17:19:54,665 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:19:54,936 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 17:19:54,949 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9253623353, username=testuser_9253623353
2025-07-29 17:19:54,955 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=5, telegram_id=9253623353
2025-07-29 17:19:55,195 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:19:55,202 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 17:19:55,212 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2826239155, username=testuser_2826239155
2025-07-29 17:19:55,219 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=7, telegram_id=2826239155
2025-07-29 17:19:55,462 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:19:55,724 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 200 OK"
2025-07-29 17:19:55,742 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5575879193, username=testuser_5575879193
2025-07-29 17:19:55,749 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=9, telegram_id=5575879193
2025-07-29 17:19:56,002 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:19:56,264 - src.api.routers.admin - ERROR - /admin/update_master 서버 오류: DB connection error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 36, in update_stock_master
    result = await stock_service.update_stock_master(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DB connection error
2025-07-29 17:19:56,266 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:19:56,278 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9228175259, username=testuser_9228175259
2025-07-29 17:19:56,284 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=11, telegram_id=9228175259
2025-07-29 17:19:56,523 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:19:56,770 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 17:19:56,784 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8316436489, username=testuser_8316436489
2025-07-29 17:19:56,791 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=13, telegram_id=8316436489
2025-07-29 17:19:57,055 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:19:57,063 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 17:19:57,079 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1934549312, username=testuser_1934549312
2025-07-29 17:19:57,085 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=15, telegram_id=1934549312
2025-07-29 17:19:57,325 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:19:57,572 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 200 OK"
2025-07-29 17:19:57,584 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9461041164, username=testuser_9461041164
2025-07-29 17:19:57,590 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=17, telegram_id=9461041164
2025-07-29 17:19:57,826 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:19:58,068 - src.api.routers.admin - ERROR - /admin/update_price 서버 오류: API call failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 53, in update_daily_price
    result = await stock_service.update_daily_prices(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: API call failed
2025-07-29 17:19:58,069 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:19:58,081 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6956870489, username=testuser_6956870489
2025-07-29 17:19:58,087 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=19, telegram_id=6956870489
2025-07-29 17:19:58,415 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:19:58,664 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 17:19:58,675 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6557713819, username=testuser_6557713819
2025-07-29 17:19:58,681 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=21, telegram_id=6557713819
2025-07-29 17:19:58,917 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:19:58,924 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 17:19:58,934 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7347846254, username=testuser_7347846254
2025-07-29 17:19:58,940 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=23, telegram_id=7347846254
2025-07-29 17:19:59,181 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:19:59,473 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f389ef5e3e0>
2025-07-29 17:19:59,474 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:19:59,476 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 200 OK"
2025-07-29 17:19:59,487 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6928923310, username=testuser_6928923310
2025-07-29 17:19:59,494 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=25, telegram_id=6928923310
2025-07-29 17:19:59,779 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:00,054 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f389ef6d2a0>
2025-07-29 17:20:00,054 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:20:00,056 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 200 OK"
2025-07-29 17:20:00,071 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1277474138, username=testuser_1277474138
2025-07-29 17:20:00,078 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=27, telegram_id=1277474138
2025-07-29 17:20:00,329 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:00,585 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f389f1eeb00>
2025-07-29 17:20:00,585 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:20:00,586 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=%EC%B9%B4%EC%B9%B4%EC%98%A4 "HTTP/1.1 200 OK"
2025-07-29 17:20:00,597 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8142451594, username=testuser_8142451594
2025-07-29 17:20:00,603 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=29, telegram_id=8142451594
2025-07-29 17:20:00,857 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:01,117 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f389f1efa00>
2025-07-29 17:20:01,117 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:20:01,119 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=0013456 "HTTP/1.1 200 OK"
2025-07-29 17:20:01,131 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5592800699, username=testuser_5592800699
2025-07-29 17:20:01,139 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=31, telegram_id=5592800699
2025-07-29 17:20:01,396 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:01,660 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f389efcccd0>
2025-07-29 17:20:01,661 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:20:01,662 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=NONEXIST "HTTP/1.1 404 Not Found"
2025-07-29 17:20:01,675 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5259643758, username=testuser_5259643758
2025-07-29 17:20:01,682 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=33, telegram_id=5259643758
2025-07-29 17:20:01,934 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:02,187 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f389f13ecb0>
2025-07-29 17:20:02,187 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:20:02,188 - src.api.routers.admin - ERROR - /admin/update_disclosure 서버 오류: DART API error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 126, in update_disclosure
    result = await stock_service.update_disclosures(db, corp_code=corp_code, stock_code=stock_code or '', stock_name=stock_name or '')
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DART API error
2025-07-29 17:20:02,189 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:20:02,202 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6085883007, username=testuser_6085883007
2025-07-29 17:20:02,209 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=35, telegram_id=6085883007
2025-07-29 17:20:02,448 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:02,692 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 17:20:02,706 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1123599038, username=testuser_1123599038
2025-07-29 17:20:02,715 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=37, telegram_id=1123599038
2025-07-29 17:20:02,959 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:02,965 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 17:20:02,975 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5387191001, username=testuser_5387191001
2025-07-29 17:20:02,982 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=39, telegram_id=5387191001
2025-07-29 17:20:03,235 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:03,479 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:20:03,492 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7642852264, username=testuser_7642852264
2025-07-29 17:20:03,499 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=41, telegram_id=7642852264
2025-07-29 17:20:03,754 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:04,009 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:20:04,022 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6873999941, username=testuser_6873999941
2025-07-29 17:20:04,031 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=43, telegram_id=6873999941
2025-07-29 17:20:04,366 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:04,619 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 17:20:04,632 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8969271086, username=testuser_8969271086
2025-07-29 17:20:04,638 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=45, telegram_id=8969271086
2025-07-29 17:20:04,878 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:04,886 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 17:20:04,897 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1410070120, username=testuser_1410070120
2025-07-29 17:20:04,903 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=47, telegram_id=1410070120
2025-07-29 17:20:05,145 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:05,386 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 17:20:05,387 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 17:20:05,401 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8649226823, username=testuser_8649226823
2025-07-29 17:20:05,408 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=49, telegram_id=8649226823
2025-07-29 17:20:05,647 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:05,896 - src.api.routers.admin - ERROR - [trigger_job] 잡 실행 실패: test_job - Job execution failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 175, in trigger_job
    job.func(*job.args, **job.kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: Job execution failed

2025-07-29 17:20:05,897 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:20:05,911 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8061745990, username=testuser_8061745990
2025-07-29 17:20:05,918 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=51, telegram_id=8061745990
2025-07-29 17:20:06,175 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:06,420 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 17:20:06,430 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4658854037, username=testuser_4658854037
2025-07-29 17:20:06,436 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=53, telegram_id=4658854037
2025-07-29 17:20:06,679 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:06,684 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 17:20:06,694 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6144575383, username=testuser_6144575383
2025-07-29 17:20:06,700 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=55, telegram_id=6144575383
2025-07-29 17:20:06,940 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:07,195 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 17:20:07,196 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 200 OK"
2025-07-29 17:20:07,208 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3080611787, username=testuser_3080611787
2025-07-29 17:20:07,214 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=57, telegram_id=3080611787
2025-07-29 17:20:07,465 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:07,720 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 17:20:07,720 - src.api.routers.admin - ERROR - 공시 확인 잡 수동 실행 중 오류 발생: Disclosure check failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 193, in trigger_check_disclosures_job
    await stock_service.check_and_notify_new_disclosures(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: Disclosure check failed
2025-07-29 17:20:07,721 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:20:07,732 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2335486804, username=testuser_2335486804
2025-07-29 17:20:07,738 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=59, telegram_id=2335486804
2025-07-29 17:20:07,988 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:08,253 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 17:20:08,271 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8986399327, username=testuser_8986399327
2025-07-29 17:20:08,278 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=61, telegram_id=8986399327
2025-07-29 17:20:08,541 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:08,548 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 17:20:08,562 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1035348649, username=testuser_1035348649
2025-07-29 17:20:08,570 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=63, telegram_id=1035348649
2025-07-29 17:20:08,820 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:09,086 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:09,092 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=65, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:20:09,103 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=1, user_id=65, symbol=005930
2025-07-29 17:20:09,105 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:20:09,118 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4263200012, username=testuser_4263200012
2025-07-29 17:20:09,124 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=66, telegram_id=4263200012
2025-07-29 17:20:09,373 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:09,377 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:20:09,389 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1757876432, username=testuser_1757876432
2025-07-29 17:20:09,395 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=68, telegram_id=1757876432
2025-07-29 17:20:09,651 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:09,903 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:09,905 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:20:09,915 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3977535941, username=testuser_3977535941
2025-07-29 17:20:09,921 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=71, telegram_id=3977535941
2025-07-29 17:20:10,168 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:10,532 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:10,534 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:20:10,549 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=2, user_id=73, symbol=005930
2025-07-29 17:20:10,552 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:20:10,557 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:10,560 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=035720, target_price=50000.0, condition=lte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:20:10,568 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=3, user_id=73, symbol=035720
2025-07-29 17:20:10,571 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:20:10,575 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:10,578 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 조회 시도.
2025-07-29 17:20:10,584 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 2개 조회됨.
2025-07-29 17:20:10,587 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:20:10,602 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5386030129, username=testuser_5386030129
2025-07-29 17:20:10,609 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=74, telegram_id=5386030129
2025-07-29 17:20:10,870 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:11,132 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:11,133 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 조회 시도.
2025-07-29 17:20:11,135 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 0개 조회됨.
2025-07-29 17:20:11,137 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:20:11,150 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4832833664, username=testuser_4832833664
2025-07-29 17:20:11,157 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=77, telegram_id=4832833664
2025-07-29 17:20:11,421 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:11,425 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:20:11,435 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7291853098, username=testuser_7291853098
2025-07-29 17:20:11,441 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=79, telegram_id=7291853098
2025-07-29 17:20:11,689 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:11,932 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:11,933 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=81, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:20:11,938 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=4, user_id=81, symbol=005930
2025-07-29 17:20:11,940 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:20:11,944 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:11,946 - src.api.services.price_alert_service - DEBUG - 사용자(81)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:20:11,949 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=4
2025-07-29 17:20:11,951 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/81/symbol/005930 "HTTP/1.1 200 OK"
2025-07-29 17:20:11,961 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3895172779, username=testuser_3895172779
2025-07-29 17:20:11,966 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=82, telegram_id=3895172779
2025-07-29 17:20:12,206 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:12,449 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:12,449 - src.api.services.price_alert_service - DEBUG - 사용자(84)와 종목(NONEXISTENT)으로 가격 알림 조회 시도.
2025-07-29 17:20:12,451 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=84, symbol=NONEXISTENT
2025-07-29 17:20:12,452 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/84/symbol/NONEXISTENT "HTTP/1.1 404 Not Found"
2025-07-29 17:20:12,462 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9711595511, username=testuser_9711595511
2025-07-29 17:20:12,466 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=85, telegram_id=9711595511
2025-07-29 17:20:12,710 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:12,975 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:12,975 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=87, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:20:12,981 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=5, user_id=87, symbol=005930
2025-07-29 17:20:12,983 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:20:12,987 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:12,991 - src.api.services.price_alert_service - DEBUG - 가격 알림(5) 수정 시도: update_data={'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 17:20:12,994 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:20:12,994 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 17:20:12,994 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:20:13,000 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:20:13,001 - src.api.services.price_alert_service - INFO - 가격 알림(5) 수정 성공.
2025-07-29 17:20:13,003 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/5 "HTTP/1.1 200 OK"
2025-07-29 17:20:13,013 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1847571587, username=testuser_1847571587
2025-07-29 17:20:13,019 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=88, telegram_id=1847571587
2025-07-29 17:20:13,266 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:13,510 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:13,511 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=90, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:20:13,517 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=6, user_id=90, symbol=005930
2025-07-29 17:20:13,518 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:20:13,521 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/6 "HTTP/1.1 403 Forbidden"
2025-07-29 17:20:13,531 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1108650579, username=testuser_1108650579
2025-07-29 17:20:13,537 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=91, telegram_id=1108650579
2025-07-29 17:20:13,781 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:14,026 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:14,027 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 17:20:14,028 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 17:20:14,030 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:20:14,041 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7117513191, username=testuser_7117513191
2025-07-29 17:20:14,047 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=94, telegram_id=7117513191
2025-07-29 17:20:14,285 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:14,780 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:14,781 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=96, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:20:14,787 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=7, user_id=96, symbol=005930
2025-07-29 17:20:14,789 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:20:14,792 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:14,793 - src.api.services.price_alert_service - DEBUG - 가격 알림(7) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 17:20:14,795 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:20:14,795 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0}
2025-07-29 17:20:14,795 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:20:14,801 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:20:14,802 - src.api.services.price_alert_service - INFO - 가격 알림(7) 수정 성공.
2025-07-29 17:20:14,805 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/7 "HTTP/1.1 403 Forbidden"
2025-07-29 17:20:14,817 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1682914125, username=testuser_1682914125
2025-07-29 17:20:14,825 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=98, telegram_id=1682914125
2025-07-29 17:20:15,082 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:15,340 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:15,340 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=100, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:20:15,345 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=8, user_id=100, symbol=005930
2025-07-29 17:20:15,347 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:20:15,349 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:15,353 - src.api.services.price_alert_service - DEBUG - 가격 알림(8) 삭제 시도.
2025-07-29 17:20:15,358 - src.api.services.price_alert_service - INFO - 가격 알림(8) 삭제 성공.
2025-07-29 17:20:15,359 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/8 "HTTP/1.1 200 OK"
2025-07-29 17:20:15,374 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8388384087, username=testuser_8388384087
2025-07-29 17:20:15,380 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=101, telegram_id=8388384087
2025-07-29 17:20:15,623 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:15,870 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:15,871 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=103, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:20:15,876 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=9, user_id=103, symbol=005930
2025-07-29 17:20:15,878 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:20:15,881 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/9 "HTTP/1.1 403 Forbidden"
2025-07-29 17:20:15,892 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7259283250, username=testuser_7259283250
2025-07-29 17:20:15,899 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=104, telegram_id=7259283250
2025-07-29 17:20:16,140 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:16,382 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:16,385 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 삭제 시도.
2025-07-29 17:20:16,386 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 17:20:16,387 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:20:16,399 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8352103483, username=testuser_8352103483
2025-07-29 17:20:16,411 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=107, telegram_id=8352103483
2025-07-29 17:20:16,718 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:17,205 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:17,206 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=109, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:20:17,213 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=10, user_id=109, symbol=005930
2025-07-29 17:20:17,215 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:20:17,218 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:17,223 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/10 "HTTP/1.1 403 Forbidden"
2025-07-29 17:20:17,235 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1643877371, username=testuser_1643877371
2025-07-29 17:20:17,243 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=111, telegram_id=1643877371
2025-07-29 17:20:17,528 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:17,534 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 17:20:17,544 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4354466594, username=testuser_4354466594
2025-07-29 17:20:17,549 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=113, telegram_id=4354466594
2025-07-29 17:20:17,792 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:17,799 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 17:20:17,805 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:17,808 - httpx - INFO - HTTP Request: GET http://testserver/ "HTTP/1.1 200 OK"
2025-07-29 17:20:17,816 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7466488630, username=testuser_7466488630
2025-07-29 17:20:17,822 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=115, telegram_id=7466488630
2025-07-29 17:20:18,067 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:18,071 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:20:18,075 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:20:18,076 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 17:20:18,080 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:20:18,080 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:20:18,082 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 17:20:18,093 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5588949955, username=testuser_5588949955
2025-07-29 17:20:18,098 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=117, telegram_id=5588949955
2025-07-29 17:20:18,348 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:18,352 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:20:18,355 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=INVALID
2025-07-29 17:20:18,356 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=INVALID, days=40
2025-07-29 17:20:18,358 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:20:18,358 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:20:18,360 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 17:20:18,371 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6303316604, username=testuser_6303316604
2025-07-29 17:20:18,379 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=119, telegram_id=6303316604
2025-07-29 17:20:18,626 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:18,630 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:20:18,633 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:20:18,645 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5468252924, username=testuser_5468252924
2025-07-29 17:20:18,651 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=121, telegram_id=5468252924
2025-07-29 17:20:18,904 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:19,159 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=123, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:20:19,164 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 17:20:19,166 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:20:19,168 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/123 "HTTP/1.1 200 OK"
2025-07-29 17:20:19,186 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9395545293, username=testuser_9395545293
2025-07-29 17:20:19,192 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=124, telegram_id=9395545293
2025-07-29 17:20:19,439 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:19,446 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=99999, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:20:19,449 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 17:20:19,451 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:20:19,453 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/99999 "HTTP/1.1 200 OK"
2025-07-29 17:20:19,465 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3738207446, username=testuser_3738207446
2025-07-29 17:20:19,471 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=126, telegram_id=3738207446
2025-07-29 17:20:19,749 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:20,003 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=128, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:20:20,005 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 17:20:20,006 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:20:20,008 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/128 "HTTP/1.1 200 OK"
2025-07-29 17:20:20,020 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6462034058, username=testuser_6462034058
2025-07-29 17:20:20,026 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=129, telegram_id=6462034058
2025-07-29 17:20:20,272 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:20,545 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=1, page_size=5, symbol=None, prediction=None
2025-07-29 17:20:20,547 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 17:20:20,548 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 1, 페이지 크기 5).
2025-07-29 17:20:20,550 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=1&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 17:20:20,553 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=2, page_size=5, symbol=None, prediction=None
2025-07-29 17:20:20,555 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 17:20:20,556 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 2, 페이지 크기 5).
2025-07-29 17:20:20,558 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=2&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 17:20:20,570 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3897579015, username=testuser_3897579015
2025-07-29 17:20:20,575 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=132, telegram_id=3897579015
2025-07-29 17:20:20,814 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:21,070 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=134, page=1, page_size=10, symbol=005930, prediction=None
2025-07-29 17:20:21,071 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 17:20:21,075 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 17:20:21,078 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:20:21,080 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/134?symbol=005930 "HTTP/1.1 200 OK"
2025-07-29 17:20:21,094 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8575512228, username=testuser_8575512228
2025-07-29 17:20:21,099 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=135, telegram_id=8575512228
2025-07-29 17:20:21,343 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:21,323 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=137, page=1, page_size=10, symbol=None, prediction=상승
2025-07-29 17:20:21,324 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=상승
2025-07-29 17:20:21,327 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 17:20:21,330 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:20:21,333 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/137?prediction=%EC%83%81%EC%8A%B9 "HTTP/1.1 200 OK"
2025-07-29 17:20:21,346 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6118158388, username=testuser_6118158388
2025-07-29 17:20:21,352 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=138, telegram_id=6118158388
2025-07-29 17:20:21,170 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:21,424 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=140, page=1, page_size=10, symbol=005930, prediction=유지
2025-07-29 17:20:21,425 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 17:20:21,425 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=유지
2025-07-29 17:20:21,429 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 17:20:21,433 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:20:21,435 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/140?symbol=005930&prediction=%EC%9C%A0%EC%A7%80 "HTTP/1.1 200 OK"
2025-07-29 17:20:21,446 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8645966110, username=testuser_8645966110
2025-07-29 17:20:21,452 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=141, telegram_id=8645966110
2025-07-29 17:20:21,781 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:21,796 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=143, symbol=005930, trade_type=buy
2025-07-29 17:20:21,797 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:20:21,801 - src.api.services.stock_service - WARNING - 현재가 없음: 005930.
2025-07-29 17:20:21,802 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: None
2025-07-29 17:20:21,807 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=143, symbol=005930, trade_type=buy
2025-07-29 17:20:21,809 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 17:20:21,813 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=143
2025-07-29 17:20:21,816 - src.api.routers.simulated_trade - DEBUG - 사용자(143)의 모의매매 이력 1건 조회됨.
2025-07-29 17:20:21,817 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 17:20:21,818 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/143 "HTTP/1.1 200 OK"
2025-07-29 17:20:21,831 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4974713100, username=testuser_4974713100
2025-07-29 17:20:21,836 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=144, telegram_id=4974713100
2025-07-29 17:20:22,076 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:22,094 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 17:20:22,105 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6241479679, username=testuser_6241479679
2025-07-29 17:20:22,110 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=146, telegram_id=6241479679
2025-07-29 17:20:22,353 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:22,361 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 17:20:22,375 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3801562862, username=testuser_3801562862
2025-07-29 17:20:22,382 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=148, telegram_id=3801562862
2025-07-29 17:20:22,624 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:22,642 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%82%BC%EC%84%B1%EC%A0%84%EC%9E%90 "HTTP/1.1 200 OK"
2025-07-29 17:20:22,655 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3432592224, username=testuser_3432592224
2025-07-29 17:20:22,661 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=150, telegram_id=3432592224
2025-07-29 17:20:22,903 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:22,920 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=035720 "HTTP/1.1 200 OK"
2025-07-29 17:20:22,932 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2611689929, username=testuser_2611689929
2025-07-29 17:20:22,937 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=152, telegram_id=2611689929
2025-07-29 17:20:23,181 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:23,198 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=sk%ED%95%98%EC%9D%B4%EB%8B%89%EC%8A%A4 "HTTP/1.1 200 OK"
2025-07-29 17:20:23,210 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5944383177, username=testuser_5944383177
2025-07-29 17:20:23,216 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=154, telegram_id=5944383177
2025-07-29 17:20:23,477 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:23,486 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%97%86%EB%8A%94%EC%A2%85%EB%AA%A9 "HTTP/1.1 200 OK"
2025-07-29 17:20:23,499 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5076874657, username=testuser_5076874657
2025-07-29 17:20:23,505 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=156, telegram_id=5076874657
2025-07-29 17:20:23,749 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:23,754 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query= "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:20:23,765 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3213212688, username=testuser_3213212688
2025-07-29 17:20:23,770 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=158, telegram_id=3213212688
2025-07-29 17:20:24,010 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:24,018 - httpx - INFO - HTTP Request: GET http://testserver/symbols/005930/current_price_and_change "HTTP/1.1 200 OK"
2025-07-29 17:20:24,032 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7815863548, username=testuser_7815863548
2025-07-29 17:20:24,039 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=160, telegram_id=7815863548
2025-07-29 17:20:24,284 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:24,296 - httpx - INFO - HTTP Request: GET http://testserver/symbols/NONEXISTENT/current_price_and_change "HTTP/1.1 404 Not Found"
2025-07-29 17:20:24,311 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3829381243, username=testuser_3829381243
2025-07-29 17:20:24,318 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=162, telegram_id=3829381243
2025-07-29 17:20:24,570 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:24,827 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 17:20:24,838 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5210018995, username=testuser_5210018995
2025-07-29 17:20:24,844 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=165, telegram_id=5210018995
2025-07-29 17:20:25,090 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:25,337 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 400 Bad Request"
2025-07-29 17:20:25,348 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3569975106, username=testuser_3569975106
2025-07-29 17:20:25,355 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=168, telegram_id=3569975106
2025-07-29 17:20:25,610 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:26,105 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 17:20:26,116 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2609604756, username=testuser_2609604756
2025-07-29 17:20:26,121 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=171, telegram_id=2609604756
2025-07-29 17:20:26,372 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:26,381 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 17:20:26,397 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1693171446, username=testuser_1693171446
2025-07-29 17:20:26,405 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=173, telegram_id=1693171446
2025-07-29 17:20:26,652 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:27,234 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 17:20:27,249 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4188314978, username=testuser_4188314978
2025-07-29 17:20:27,254 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=176, telegram_id=4188314978
2025-07-29 17:20:27,511 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:27,760 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 178
2025-07-29 17:20:27,764 - src.api.services.user_service - DEBUG - User found by id: user_id=178
2025-07-29 17:20:27,769 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 17:20:27,783 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1467961020, username=testuser_1467961020
2025-07-29 17:20:27,790 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=179, telegram_id=1467961020
2025-07-29 17:20:28,051 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:28,055 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 403 Forbidden"
2025-07-29 17:20:28,066 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7309380443, username=testuser_7309380443
2025-07-29 17:20:28,072 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=181, telegram_id=7309380443
2025-07-29 17:20:28,318 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:28,563 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 183
2025-07-29 17:20:28,564 - src.api.services.user_service - DEBUG - User found by id: user_id=183
2025-07-29 17:20:28,576 - httpx - INFO - HTTP Request: PUT http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 17:20:28,587 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6387550425, username=testuser_6387550425
2025-07-29 17:20:28,593 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=184, telegram_id=6387550425
2025-07-29 17:20:28,833 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:28,847 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 17:20:28,858 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4093892602, username=testuser_4093892602
2025-07-29 17:20:28,865 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=187, telegram_id=4093892602
2025-07-29 17:20:29,109 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:29,369 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 17:20:29,382 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1013493820, username=testuser_1013493820
2025-07-29 17:20:29,388 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=190, telegram_id=1013493820
2025-07-29 17:20:29,630 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:29,887 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/192 "HTTP/1.1 200 OK"
2025-07-29 17:20:29,899 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3830946870, username=testuser_3830946870
2025-07-29 17:20:29,906 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=193, telegram_id=3830946870
2025-07-29 17:20:30,161 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:30,290 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:20:30,307 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5057944006, username=testuser_5057944006
2025-07-29 17:20:30,314 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=195, telegram_id=5057944006
2025-07-29 17:20:30,560 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:31,049 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 197
2025-07-29 17:20:31,052 - src.api.services.user_service - DEBUG - User found by id: user_id=197
2025-07-29 17:20:31,057 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 200 OK"
2025-07-29 17:20:31,070 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5960584364, username=testuser_5960584364
2025-07-29 17:20:31,076 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=199, telegram_id=5960584364
2025-07-29 17:20:31,318 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:31,580 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 201
2025-07-29 17:20:31,582 - src.api.services.user_service - DEBUG - User found by id: user_id=201
2025-07-29 17:20:31,585 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:20:31,598 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4290502459, username=testuser_4290502459
2025-07-29 17:20:31,604 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=202, telegram_id=4290502459
2025-07-29 17:20:31,847 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:31,856 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=204, symbol=005930
2025-07-29 17:20:31,864 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=204, symbol=005930
2025-07-29 17:20:31,865 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 17:20:31,869 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 시도: user_id=204
2025-07-29 17:20:31,870 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 성공: user_id=204, 1개 종목.
2025-07-29 17:20:31,871 - httpx - INFO - HTTP Request: GET http://testserver/watchlist/get/204 "HTTP/1.1 200 OK"
2025-07-29 17:20:31,876 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:31,878 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:20:31,879 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:20:31,883 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:31,886 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12345
2025-07-29 17:20:31,889 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=1, telegram_id=12345
2025-07-29 17:20:31,889 - src.api.services.price_alert_service - DEBUG - 사용자(1)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:20:31,892 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=1
2025-07-29 17:20:31,893 - src.api.services.price_alert_service - DEBUG - 가격 알림(1) 수정 시도: update_data={'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 17:20:31,896 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:20:31,896 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 17:20:31,897 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:20:31,899 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:20:31,900 - src.api.services.price_alert_service - INFO - 가격 알림(1) 수정 성공.
2025-07-29 17:20:31,901 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:20:31,905 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:20:31,906 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:20:31,909 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:31,910 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 17:20:31,912 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 17:20:31,912 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:20:31,914 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 17:20:31,914 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 17:20:31,915 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:20:31,915 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 17:20:31,916 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:20:31,922 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:20:31,922 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 17:20:31,924 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:20:31,927 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:31,928 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 17:20:31,932 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 17:20:31,932 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:20:31,934 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 17:20:31,934 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 17:20:31,936 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:20:31,936 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 17:20:31,936 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:20:31,942 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:20:31,943 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 17:20:31,944 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:20:31,963 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7125118853, username=testuser_7125118853
2025-07-29 17:20:31,969 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=205, telegram_id=7125118853
2025-07-29 17:20:31,971 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:31,974 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:20:31,976 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:31,981 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 7125118853
2025-07-29 17:20:31,984 - src.api.services.user_service - DEBUG - User not found for telegram_id: 7125118853
2025-07-29 17:20:31,984 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7125118853, username=testuser_7125118853
2025-07-29 17:20:31,993 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=220, telegram_id=7125118853
2025-07-29 17:20:31,993 - src.api.services.price_alert_service - DEBUG - 사용자(220)와 종목(GOOG)으로 가격 알림 조회 시도.
2025-07-29 17:20:31,995 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=220, symbol=GOOG
2025-07-29 17:20:31,995 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=220, symbol=GOOG, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:20:32,002 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=219, user_id=220, symbol=GOOG
2025-07-29 17:20:32,003 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:20:32,006 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:20:32,016 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4590288505, username=testuser_4590288505
2025-07-29 17:20:32,022 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=206, telegram_id=4590288505
2025-07-29 17:20:32,024 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:32,026 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:20:32,027 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:32,027 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 4590288505
2025-07-29 17:20:32,029 - src.api.services.user_service - DEBUG - User not found for telegram_id: 4590288505
2025-07-29 17:20:32,029 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4590288505, username=telegram_user_4590288505
2025-07-29 17:20:32,033 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=221, telegram_id=4590288505
2025-07-29 17:20:32,034 - src.api.services.price_alert_service - DEBUG - 사용자(221)와 종목(MSFT)으로 가격 알림 조회 시도.
2025-07-29 17:20:32,036 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=221, symbol=MSFT
2025-07-29 17:20:32,036 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=221, symbol=MSFT, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:20:32,042 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=220, user_id=221, symbol=MSFT
2025-07-29 17:20:32,044 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:20:32,045 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:20:32,056 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1148073405, username=testuser_1148073405
2025-07-29 17:20:32,062 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=207, telegram_id=1148073405
2025-07-29 17:20:32,066 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:32,069 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:20:32,070 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:32,071 - src.api.routers.bot_router - DEBUG - Before toggle: existing_alert.notify_on_disclosure = True
2025-07-29 17:20:32,071 - src.api.routers.bot_router - DEBUG - Calculated new_status: False
2025-07-29 17:20:32,071 - src.api.routers.bot_router - DEBUG - After update_alert call: updated_alert_orm.notify_on_disclosure = False
2025-07-29 17:20:32,073 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:20:32,074 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:20:32,086 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5449719448, username=testuser_5449719448
2025-07-29 17:20:32,093 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=208, telegram_id=5449719448
2025-07-29 17:20:32,096 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:32,099 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:20:32,101 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:32,102 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 5449719448
2025-07-29 17:20:32,104 - src.api.services.user_service - DEBUG - User not found for telegram_id: 5449719448
2025-07-29 17:20:32,104 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5449719448, username=telegram_user_5449719448
2025-07-29 17:20:32,111 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=222, telegram_id=5449719448
2025-07-29 17:20:32,112 - src.api.services.price_alert_service - DEBUG - 사용자(222)와 종목(NFLX)으로 가격 알림 조회 시도.
2025-07-29 17:20:32,113 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=222, symbol=NFLX
2025-07-29 17:20:32,114 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=222, symbol=NFLX, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:20:32,121 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=221, user_id=222, symbol=NFLX
2025-07-29 17:20:32,122 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:20:32,124 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:20:32,136 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5596553421, username=testuser_5596553421
2025-07-29 17:20:32,142 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=209, telegram_id=5596553421
2025-07-29 17:20:32,144 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:32,147 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:20:32,148 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:32,150 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 5596553421
2025-07-29 17:20:32,153 - src.api.services.user_service - DEBUG - User not found for telegram_id: 5596553421
2025-07-29 17:20:32,153 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5596553421, username=testuser_5596553421
2025-07-29 17:20:32,160 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=223, telegram_id=5596553421
2025-07-29 17:20:32,160 - src.api.services.price_alert_service - DEBUG - 사용자(223)와 종목(NVDA)으로 가격 알림 조회 시도.
2025-07-29 17:20:32,164 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=223, symbol=NVDA
2025-07-29 17:20:32,164 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=223, symbol=NVDA, target_price=1000.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:20:32,170 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=222, user_id=223, symbol=NVDA
2025-07-29 17:20:32,172 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:20:32,173 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:20:32,184 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5544493993, username=testuser_5544493993
2025-07-29 17:20:32,191 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=210, telegram_id=5544493993
2025-07-29 17:20:32,195 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:32,198 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:20:32,199 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:32,200 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 5544493993
2025-07-29 17:20:32,203 - src.api.services.user_service - DEBUG - User not found for telegram_id: 5544493993
2025-07-29 17:20:32,203 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5544493993, username=telegram_user_5544493993
2025-07-29 17:20:32,210 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=224, telegram_id=5544493993
2025-07-29 17:20:32,210 - src.api.services.price_alert_service - DEBUG - 사용자(224)와 종목(GOOGL)으로 가격 알림 조회 시도.
2025-07-29 17:20:32,213 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=224, symbol=GOOGL
2025-07-29 17:20:32,213 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=224, symbol=GOOGL, target_price=110.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=weekly
2025-07-29 17:20:32,221 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=223, user_id=224, symbol=GOOGL
2025-07-29 17:20:32,222 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:20:32,225 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:20:32,239 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3208842964, username=testuser_3208842964
2025-07-29 17:20:32,248 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=211, telegram_id=3208842964
2025-07-29 17:20:32,254 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:32,257 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:20:32,259 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:32,260 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 3208842964
2025-07-29 17:20:32,263 - src.api.services.user_service - DEBUG - User not found for telegram_id: 3208842964
2025-07-29 17:20:32,263 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3208842964, username=telegram_user_3208842964
2025-07-29 17:20:32,269 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=225, telegram_id=3208842964
2025-07-29 17:20:32,270 - src.api.services.price_alert_service - DEBUG - 사용자(225)와 종목(FB)으로 가격 알림 조회 시도.
2025-07-29 17:20:32,271 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=225, symbol=FB
2025-07-29 17:20:32,272 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=225, symbol=FB, target_price=300.0, condition=above, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:20:32,278 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=224, user_id=225, symbol=FB
2025-07-29 17:20:32,280 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:20:32,282 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:20:32,288 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:32,288 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:32,300 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:32,306 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:32,308 - src.common.dart_utils - ERROR - DART CORPCODE.xml 요청 실패: Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 25, in dart_get_all_stocks
    resp = await session.get(url, timeout=60)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 17:20:32,315 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:32,324 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:32,333 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:32,339 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:32,342 - src.common.dart_utils - ERROR - DART 공시 조회 API 요청 실패 (corp_code: 00123456): Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 79, in dart_get_disclosures
    resp = await session.get(url, params=params, timeout=10)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 17:20:32,347 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:32,350 - src.common.dart_utils - ERROR - DART 공시 API가 오류를 반환했습니다. status: 001, message: API 호출 오류, corp_code: 00123456
2025-07-29 17:20:32,659 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3061811391, username=testuser_3061811391
2025-07-29 17:20:32,676 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=212, telegram_id=3061811391
2025-07-29 17:20:32,966 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:33,225 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 17:20:33,476 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 17:20:33,481 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=214, symbol=005930
2025-07-29 17:20:33,487 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=214, symbol=005930
2025-07-29 17:20:33,489 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 17:20:33,492 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 214
2025-07-29 17:20:33,494 - src.api.services.user_service - DEBUG - User found by id: user_id=214
2025-07-29 17:20:33,495 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:20:33,495 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=214, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:20:33,500 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=11, user_id=214, symbol=005930
2025-07-29 17:20:33,502 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:20:33,505 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:20:33,507 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:20:33,508 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 17:20:33,509 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:20:33,510 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:20:33,515 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 17:20:33,518 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=214, symbol=005930, trade_type=buy
2025-07-29 17:20:33,519 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:20:33,520 - src.api.services.stock_service - WARNING - 현재가 없음: 005930.
2025-07-29 17:20:33,521 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: None
2025-07-29 17:20:33,524 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=214, symbol=005930, trade_type=buy
2025-07-29 17:20:33,526 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 17:20:33,528 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=214
2025-07-29 17:20:33,530 - src.api.routers.simulated_trade - DEBUG - 사용자(214)의 모의매매 이력 1건 조회됨.
2025-07-29 17:20:33,530 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 17:20:33,532 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/214 "HTTP/1.1 200 OK"
2025-07-29 17:20:33,540 - src.api.main - INFO - [APScheduler] 가격 알림 체크 잡 실행: 2025-07-29 17:20:33.540696
2025-07-29 17:20:33,541 - src.api.main - DEBUG - 활성 알림 수: 3
2025-07-29 17:20:33,541 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:20:33,541 - src.api.main - DEBUG - 종목 정상종목 현재가: 110
2025-07-29 17:20:33,542 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='139881163783760'>, 목표 가격: 100, 조건: gte, 반복 주기: <MagicMock name='mock.repeat_interval' id='139881162683104'>
2025-07-29 17:20:33,543 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목, 현재가: 110, 목표가: 100
2025-07-29 17:20:33,547 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='139881160970288'>)
2025-07-29 17:20:33,548 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 17:20:33,549 - src.api.main - DEBUG - 종목 오류종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:20:33,549 - src.api.main - ERROR - 가격 알림 확인 중 '오류종목' 처리 오류: 현재가 조회 실패
Traceback (most recent call last):
  File "/app/src/api/main.py", line 145, in check_price_alerts_job
    price_data = stock_service.get_current_price_and_change(symbol, db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1179, in _execute_mock_call
    result = effect(*args, **kwargs)
  File "/app/src/api/tests/test_main_jobs.py", line 34, in get_current_price_side_effect
    raise ValueError("현재가 조회 실패")
ValueError: 현재가 조회 실패
2025-07-29 17:20:33,550 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:20:33,550 - src.api.main - DEBUG - 종목 정상종목2 현재가: 290
2025-07-29 17:20:33,553 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='139881163751968'>, 목표 가격: 300, 조건: lte, 반복 주기: <MagicMock name='mock.repeat_interval' id='139881161876928'>
2025-07-29 17:20:33,553 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목2, 현재가: 290, 목표가: 300
2025-07-29 17:20:33,554 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='139881160970288'>)
2025-07-29 17:20:33,554 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 17:20:33,554 - src.api.main - DEBUG - 모든 가격 알림 체크 및 DB 커밋 완료.
2025-07-29 17:20:33,558 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:20:33,559 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(10일)
2025-07-29 17:20:33,563 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:20:33,563 - src.api.services.predict_service - ERROR - 예측 불가: 데이터 분석 실패
2025-07-29 17:20:33,568 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:20:33,569 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:20:33,576 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 상승 (24일 지속). 금일 변동: 보합. 최근 20일간 상승일: 19일, 하락일: 0일.
2025-07-29 17:20:33,576 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 17:20:33,580 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:20:33,581 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:20:33,587 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 하락 (24일 지속). 금일 변동: 보합. 최근 20일간 상승일: 0일, 하락일: 19일.
2025-07-29 17:20:33,588 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 17:20:33,591 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:20:33,591 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:20:33,595 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 횡보 (1일 지속). 금일 변동: 보합. 최근 20일간 상승일: 12일, 하락일: 7일.
2025-07-29 17:20:33,596 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 17:20:33,601 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:20:33,602 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:20:33,608 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=buy, reason=최근 추세: 하락 (1일 지속). 금일 변동: 횡보. 최근 20일간 상승일: 2일, 하락일: 17일. (저점 횡보 패턴 감지)
2025-07-29 17:20:33,608 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: buy
2025-07-29 17:20:33,612 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:20:33,613 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 22개 데이터.
2025-07-29 17:20:33,617 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, reason=최근 추세: 상승 (21일 지속). 금일 변동: 횡보. 최근 20일간 상승일: 19일, 하락일: 0일. (급등 후 횡보 패턴 감지)
2025-07-29 17:20:33,618 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 17:20:33,626 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:33,631 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:20:33,631 - src.api.services.stock_service - INFO - 신규 공시가 없습니다. (DB 기준: 202301010000001)
2025-07-29 17:20:33,638 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:33,641 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:20:33,647 - src.api.services.stock_service - INFO - 최초 실행. 기준 접수번호를 202301020000001로 DB에 설정합니다.
2025-07-29 17:20:33,649 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:20:33,650 - src.api.services.stock_service - INFO - 최초 실행. 기준 접수번호를 202301020000001로 DB에 설정합니다.
2025-07-29 17:20:33,660 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:33,669 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:20:33,669 - src.api.services.stock_service - INFO - 2건의 신규 공시를 발견했습니다.
2025-07-29 17:20:33,671 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 17:20:33,672 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 17:20:33,672 - src.api.services.stock_service - INFO - 마지막 확인 접수번호를 202301020000002로 DB에 갱신합니다.
2025-07-29 17:20:33,683 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:33,687 - src.api.services.stock_service - CRITICAL - DART API 사용 한도를 초과했습니다: [020] 사용 한도 초과
2025-07-29 17:20:33,696 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:33,700 - src.api.services.stock_service - ERROR - DART 공시 조회 중 API 오류 발생: [999] 기타 API 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 40, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
src.common.exceptions.DartApiError: [999] 기타 API 오류
2025-07-29 17:20:33,707 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:33,715 - src.api.services.stock_service - ERROR - 신규 공시 확인 및 알림 작업 중 예상치 못한 오류 발생: 예상치 못한 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 40, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: 예상치 못한 오류
2025-07-29 17:20:33,721 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:33,733 - src.api.services.stock_service - DEBUG - update_daily_prices 호출.
2025-07-29 17:20:33,735 - src.api.services.stock_service - DEBUG - DB에서 2개 종목 가져옴.
2025-07-29 17:20:33,735 - src.api.services.stock_service - DEBUG - 종목 005930 (삼성전자) 일별시세 갱신 시작.
2025-07-29 17:20:33,741 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 005930 - 2025-07-29
2025-07-29 17:20:33,743 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 005930 - 2025-07-28
2025-07-29 17:20:33,743 - src.api.services.stock_service - DEBUG - 종목 000660 (SK하이닉스) 일별시세 갱신 시작.
2025-07-29 17:20:33,745 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 000660 - 2025-07-29
2025-07-29 17:20:33,747 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 000660 - 2025-07-28
2025-07-29 17:20:33,753 - src.api.services.stock_service - INFO - 일별시세 갱신 완료: 4개 데이터 처리. 오류: 0개 종목
2025-07-29 17:20:33,766 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:33,773 - src.api.services.stock_service - DEBUG - update_daily_prices 호출.
2025-07-29 17:20:33,775 - src.api.services.stock_service - DEBUG - DB에서 1개 종목 가져옴.
2025-07-29 17:20:33,775 - src.api.services.stock_service - DEBUG - 종목 005930 (삼성전자) 일별시세 갱신 시작.
2025-07-29 17:20:33,775 - src.api.services.stock_service - WARNING - 종목 005930에 대한 일별시세 데이터가 없습니다.
2025-07-29 17:20:33,776 - src.api.services.stock_service - INFO - 일별시세 갱신 완료: 0개 데이터 처리. 오류: 1개 종목
2025-07-29 17:20:33,785 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:33,792 - src.api.services.stock_service - DEBUG - update_daily_prices 호출.
2025-07-29 17:20:33,794 - src.api.services.stock_service - DEBUG - DB에서 1개 종목 가져옴.
2025-07-29 17:20:33,794 - src.api.services.stock_service - DEBUG - 종목 005930 (삼성전자) 일별시세 갱신 시작.
2025-07-29 17:20:33,794 - src.api.services.stock_service - ERROR - 일별시세 갱신 중 '005930' 처리에서 오류 발생: API Error
2025-07-29 17:20:33,794 - src.api.services.stock_service - INFO - 일별시세 갱신 완료: 0개 데이터 처리. 오류: 1개 종목
2025-07-29 17:20:33,803 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:33,810 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:20:33,812 - src.api.services.stock_service - DEBUG - 현재가 발견: 005930 - 71500.0
2025-07-29 17:20:33,812 - src.api.services.stock_service - DEBUG - 전일 종가 발견: 005930 - 70500.0
2025-07-29 17:20:33,927 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:33,928 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=NONEXIST
2025-07-29 17:20:33,930 - src.api.services.stock_service - WARNING - 현재가 없음: NONEXIST.
2025-07-29 17:20:33,938 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:20:33,945 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:20:33,947 - src.api.services.stock_service - DEBUG - 현재가 발견: 005930 - 71500.0
2025-07-29 17:20:33,947 - src.api.services.stock_service - WARNING - 전일 종가 없음: 005930. 등락률 계산 불가.
2025-07-29 17:22:38,149 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 17:22:38,154 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 17:22:38,157 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:22:38,157 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:22:38,158 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:22:38,158 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:22:39,030 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:39,035 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 17:22:39,042 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-07-29 17:22:39,043 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '<unknown>'
2025-07-29 17:22:39,044 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-07-29 17:22:39,428 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:39,432 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:22:39,679 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:39,683 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 17:22:40,017 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:40,020 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 17:22:40,022 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 17:22:40,035 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7917919364, username=testuser_7917919364
2025-07-29 17:22:40,050 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=1, telegram_id=7917919364
2025-07-29 17:22:40,297 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:40,569 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 200 OK"
2025-07-29 17:22:40,582 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8005577603, username=testuser_8005577603
2025-07-29 17:22:40,589 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=3, telegram_id=8005577603
2025-07-29 17:22:40,842 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:41,097 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 17:22:41,115 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3271898277, username=testuser_3271898277
2025-07-29 17:22:41,123 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=5, telegram_id=3271898277
2025-07-29 17:22:41,383 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:41,393 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 17:22:41,408 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1111079874, username=testuser_1111079874
2025-07-29 17:22:41,416 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=7, telegram_id=1111079874
2025-07-29 17:22:41,666 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:41,927 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 200 OK"
2025-07-29 17:22:41,940 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7043102522, username=testuser_7043102522
2025-07-29 17:22:41,948 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=9, telegram_id=7043102522
2025-07-29 17:22:42,199 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:42,455 - src.api.routers.admin - ERROR - /admin/update_master 서버 오류: DB connection error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 36, in update_stock_master
    result = await stock_service.update_stock_master(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DB connection error
2025-07-29 17:22:42,457 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:22:42,468 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9167930298, username=testuser_9167930298
2025-07-29 17:22:42,474 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=11, telegram_id=9167930298
2025-07-29 17:22:42,722 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:42,969 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 17:22:42,981 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4664526814, username=testuser_4664526814
2025-07-29 17:22:42,987 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=13, telegram_id=4664526814
2025-07-29 17:22:43,240 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:43,246 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 17:22:43,257 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3108492741, username=testuser_3108492741
2025-07-29 17:22:43,263 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=15, telegram_id=3108492741
2025-07-29 17:22:43,525 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:43,822 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 200 OK"
2025-07-29 17:22:43,834 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2367677538, username=testuser_2367677538
2025-07-29 17:22:43,840 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=17, telegram_id=2367677538
2025-07-29 17:22:44,085 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:44,334 - src.api.routers.admin - ERROR - /admin/update_price 서버 오류: API call failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 53, in update_daily_price
    result = await stock_service.update_daily_prices(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: API call failed
2025-07-29 17:22:44,335 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:22:44,347 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1569295931, username=testuser_1569295931
2025-07-29 17:22:44,353 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=19, telegram_id=1569295931
2025-07-29 17:22:44,603 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:44,855 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 17:22:44,868 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5551445865, username=testuser_5551445865
2025-07-29 17:22:44,876 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=21, telegram_id=5551445865
2025-07-29 17:22:45,229 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:45,239 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 17:22:45,251 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6596537282, username=testuser_6596537282
2025-07-29 17:22:45,257 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=23, telegram_id=6596537282
2025-07-29 17:22:45,501 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:45,767 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7fc396a69cc0>
2025-07-29 17:22:45,767 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:22:45,769 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 200 OK"
2025-07-29 17:22:45,784 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5011315449, username=testuser_5011315449
2025-07-29 17:22:45,790 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=25, telegram_id=5011315449
2025-07-29 17:22:46,047 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:46,301 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7fc396a48f70>
2025-07-29 17:22:46,301 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:22:46,303 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 200 OK"
2025-07-29 17:22:46,314 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9834225869, username=testuser_9834225869
2025-07-29 17:22:46,321 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=27, telegram_id=9834225869
2025-07-29 17:22:46,569 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:46,830 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7fc396c22dd0>
2025-07-29 17:22:46,831 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:22:46,832 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=%EC%B9%B4%EC%B9%B4%EC%98%A4 "HTTP/1.1 200 OK"
2025-07-29 17:22:46,844 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8053165938, username=testuser_8053165938
2025-07-29 17:22:46,850 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=29, telegram_id=8053165938
2025-07-29 17:22:47,110 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:47,371 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7fc396ae9d80>
2025-07-29 17:22:47,371 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:22:47,373 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=0013456 "HTTP/1.1 200 OK"
2025-07-29 17:22:47,384 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3474032023, username=testuser_3474032023
2025-07-29 17:22:47,390 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=31, telegram_id=3474032023
2025-07-29 17:22:47,640 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:47,577 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7fc396a4b2e0>
2025-07-29 17:22:47,578 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:22:47,580 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=NONEXIST "HTTP/1.1 404 Not Found"
2025-07-29 17:22:47,593 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4104440849, username=testuser_4104440849
2025-07-29 17:22:47,601 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=33, telegram_id=4104440849
2025-07-29 17:22:47,423 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:47,684 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7fc396abe9e0>
2025-07-29 17:22:47,684 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:22:47,685 - src.api.routers.admin - ERROR - /admin/update_disclosure 서버 오류: DART API error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 126, in update_disclosure
    result = await stock_service.update_disclosures(db, corp_code=corp_code, stock_code=stock_code or '', stock_name=stock_name or '')
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DART API error
2025-07-29 17:22:47,686 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:22:47,696 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2806076773, username=testuser_2806076773
2025-07-29 17:22:47,702 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=35, telegram_id=2806076773
2025-07-29 17:22:47,951 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:48,211 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 17:22:48,223 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6664379507, username=testuser_6664379507
2025-07-29 17:22:48,229 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=37, telegram_id=6664379507
2025-07-29 17:22:48,477 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:48,483 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 17:22:48,494 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6383949495, username=testuser_6383949495
2025-07-29 17:22:48,500 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=39, telegram_id=6383949495
2025-07-29 17:22:48,746 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:49,006 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:22:49,019 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2309241372, username=testuser_2309241372
2025-07-29 17:22:49,026 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=41, telegram_id=2309241372
2025-07-29 17:22:49,276 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:49,531 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:22:49,542 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4786427837, username=testuser_4786427837
2025-07-29 17:22:49,548 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=43, telegram_id=4786427837
2025-07-29 17:22:49,946 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:50,193 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 17:22:50,206 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4723771383, username=testuser_4723771383
2025-07-29 17:22:50,212 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=45, telegram_id=4723771383
2025-07-29 17:22:50,453 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:50,459 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 17:22:50,470 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6498067449, username=testuser_6498067449
2025-07-29 17:22:50,475 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=47, telegram_id=6498067449
2025-07-29 17:22:50,722 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:50,973 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 17:22:50,973 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 17:22:50,986 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7022766229, username=testuser_7022766229
2025-07-29 17:22:50,992 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=49, telegram_id=7022766229
2025-07-29 17:22:51,244 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:51,490 - src.api.routers.admin - ERROR - [trigger_job] 잡 실행 실패: test_job - Job execution failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 175, in trigger_job
    job.func(*job.args, **job.kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: Job execution failed

2025-07-29 17:22:51,491 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:22:51,502 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9971251616, username=testuser_9971251616
2025-07-29 17:22:51,507 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=51, telegram_id=9971251616
2025-07-29 17:22:51,763 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:52,014 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 17:22:52,028 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9229217257, username=testuser_9229217257
2025-07-29 17:22:52,035 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=53, telegram_id=9229217257
2025-07-29 17:22:52,286 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:52,290 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 17:22:52,300 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8196682115, username=testuser_8196682115
2025-07-29 17:22:52,306 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=55, telegram_id=8196682115
2025-07-29 17:22:52,547 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:52,794 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 17:22:52,795 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 200 OK"
2025-07-29 17:22:52,805 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5148801897, username=testuser_5148801897
2025-07-29 17:22:52,811 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=57, telegram_id=5148801897
2025-07-29 17:22:53,062 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:53,324 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 17:22:53,325 - src.api.routers.admin - ERROR - 공시 확인 잡 수동 실행 중 오류 발생: Disclosure check failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 193, in trigger_check_disclosures_job
    await stock_service.check_and_notify_new_disclosures(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: Disclosure check failed
2025-07-29 17:22:53,326 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:22:53,340 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3219295992, username=testuser_3219295992
2025-07-29 17:22:53,346 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=59, telegram_id=3219295992
2025-07-29 17:22:53,603 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:53,848 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 17:22:53,863 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3357023621, username=testuser_3357023621
2025-07-29 17:22:53,871 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=61, telegram_id=3357023621
2025-07-29 17:22:54,125 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:54,132 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 17:22:54,144 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5908592811, username=testuser_5908592811
2025-07-29 17:22:54,151 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=63, telegram_id=5908592811
2025-07-29 17:22:54,409 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:54,668 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:22:54,672 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=65, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:22:54,681 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=1, user_id=65, symbol=005930
2025-07-29 17:22:54,684 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:22:54,699 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6126955227, username=testuser_6126955227
2025-07-29 17:22:54,706 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=66, telegram_id=6126955227
2025-07-29 17:22:55,147 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:55,154 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:22:55,174 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8285855156, username=testuser_8285855156
2025-07-29 17:22:55,185 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=68, telegram_id=8285855156
2025-07-29 17:22:55,462 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:55,719 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:22:55,721 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:22:55,731 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6840721562, username=testuser_6840721562
2025-07-29 17:22:55,737 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=71, telegram_id=6840721562
2025-07-29 17:22:55,998 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:56,251 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:22:56,252 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:22:56,257 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=2, user_id=73, symbol=005930
2025-07-29 17:22:56,258 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:22:56,261 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:22:56,262 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=035720, target_price=50000.0, condition=lte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:22:56,267 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=3, user_id=73, symbol=035720
2025-07-29 17:22:56,269 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:22:56,271 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:22:56,273 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 조회 시도.
2025-07-29 17:22:56,275 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 2개 조회됨.
2025-07-29 17:22:56,277 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:22:56,287 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3773629820, username=testuser_3773629820
2025-07-29 17:22:56,293 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=74, telegram_id=3773629820
2025-07-29 17:22:56,538 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:56,785 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:22:56,786 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 조회 시도.
2025-07-29 17:22:56,787 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 0개 조회됨.
2025-07-29 17:22:56,789 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:22:56,801 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9749067725, username=testuser_9749067725
2025-07-29 17:22:56,809 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=77, telegram_id=9749067725
2025-07-29 17:22:57,070 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:57,075 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:22:57,086 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5364175216, username=testuser_5364175216
2025-07-29 17:22:57,092 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=79, telegram_id=5364175216
2025-07-29 17:22:57,337 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:57,588 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:22:57,588 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=81, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:22:57,594 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=4, user_id=81, symbol=005930
2025-07-29 17:22:57,596 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:22:57,600 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:22:57,600 - src.api.services.price_alert_service - DEBUG - 사용자(81)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:22:57,604 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=4
2025-07-29 17:22:57,606 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/81/symbol/005930 "HTTP/1.1 200 OK"
2025-07-29 17:22:57,618 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1464701221, username=testuser_1464701221
2025-07-29 17:22:57,623 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=82, telegram_id=1464701221
2025-07-29 17:22:57,867 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:58,133 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:22:58,133 - src.api.services.price_alert_service - DEBUG - 사용자(84)와 종목(NONEXISTENT)으로 가격 알림 조회 시도.
2025-07-29 17:22:58,135 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=84, symbol=NONEXISTENT
2025-07-29 17:22:58,137 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/84/symbol/NONEXISTENT "HTTP/1.1 404 Not Found"
2025-07-29 17:22:58,150 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6187186710, username=testuser_6187186710
2025-07-29 17:22:58,157 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=85, telegram_id=6187186710
2025-07-29 17:22:58,426 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:58,680 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:22:58,680 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=87, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:22:58,687 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=5, user_id=87, symbol=005930
2025-07-29 17:22:58,689 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:22:58,692 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:22:58,696 - src.api.services.price_alert_service - DEBUG - 가격 알림(5) 수정 시도: update_data={'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 17:22:58,699 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:22:58,699 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 17:22:58,700 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:22:58,706 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:22:58,707 - src.api.services.price_alert_service - INFO - 가격 알림(5) 수정 성공.
2025-07-29 17:22:58,710 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/5 "HTTP/1.1 200 OK"
2025-07-29 17:22:58,722 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1411942499, username=testuser_1411942499
2025-07-29 17:22:58,730 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=88, telegram_id=1411942499
2025-07-29 17:22:58,984 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:59,235 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:22:59,236 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=90, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:22:59,243 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=6, user_id=90, symbol=005930
2025-07-29 17:22:59,245 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:22:59,248 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/6 "HTTP/1.1 403 Forbidden"
2025-07-29 17:22:59,261 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8674340927, username=testuser_8674340927
2025-07-29 17:22:59,268 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=91, telegram_id=8674340927
2025-07-29 17:22:59,517 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:22:59,772 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:22:59,773 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 17:22:59,775 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 17:22:59,776 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:22:59,785 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6723863810, username=testuser_6723863810
2025-07-29 17:22:59,791 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=94, telegram_id=6723863810
2025-07-29 17:23:00,108 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:00,628 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:23:00,629 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=96, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:23:00,636 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=7, user_id=96, symbol=005930
2025-07-29 17:23:00,638 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:23:00,641 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:23:00,642 - src.api.services.price_alert_service - DEBUG - 가격 알림(7) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 17:23:00,644 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:23:00,644 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0}
2025-07-29 17:23:00,644 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:23:00,650 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:23:00,651 - src.api.services.price_alert_service - INFO - 가격 알림(7) 수정 성공.
2025-07-29 17:23:00,654 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/7 "HTTP/1.1 403 Forbidden"
2025-07-29 17:23:00,669 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4832657783, username=testuser_4832657783
2025-07-29 17:23:00,676 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=98, telegram_id=4832657783
2025-07-29 17:23:00,942 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:01,290 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:23:01,291 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=100, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:23:01,298 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=8, user_id=100, symbol=005930
2025-07-29 17:23:01,300 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:23:01,304 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:23:01,308 - src.api.services.price_alert_service - DEBUG - 가격 알림(8) 삭제 시도.
2025-07-29 17:23:01,314 - src.api.services.price_alert_service - INFO - 가격 알림(8) 삭제 성공.
2025-07-29 17:23:01,316 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/8 "HTTP/1.1 200 OK"
2025-07-29 17:23:01,330 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2929243402, username=testuser_2929243402
2025-07-29 17:23:01,337 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=101, telegram_id=2929243402
2025-07-29 17:23:01,591 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:01,858 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:23:01,860 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=103, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:23:01,868 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=9, user_id=103, symbol=005930
2025-07-29 17:23:01,870 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:23:01,872 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/9 "HTTP/1.1 403 Forbidden"
2025-07-29 17:23:01,907 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8654834803, username=testuser_8654834803
2025-07-29 17:23:01,917 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=104, telegram_id=8654834803
2025-07-29 17:23:02,200 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:02,470 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:23:02,473 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 삭제 시도.
2025-07-29 17:23:02,475 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 17:23:02,476 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:23:02,487 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9676878852, username=testuser_9676878852
2025-07-29 17:23:02,493 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=107, telegram_id=9676878852
2025-07-29 17:23:02,750 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:03,255 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:23:03,256 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=109, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:23:03,261 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=10, user_id=109, symbol=005930
2025-07-29 17:23:03,263 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:23:03,266 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:23:03,271 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/10 "HTTP/1.1 403 Forbidden"
2025-07-29 17:23:03,286 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9236472527, username=testuser_9236472527
2025-07-29 17:23:03,293 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=111, telegram_id=9236472527
2025-07-29 17:23:03,564 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:03,570 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 17:23:03,580 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3338983030, username=testuser_3338983030
2025-07-29 17:23:03,586 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=113, telegram_id=3338983030
2025-07-29 17:23:03,846 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:03,863 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 17:23:03,876 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:03,882 - httpx - INFO - HTTP Request: GET http://testserver/ "HTTP/1.1 200 OK"
2025-07-29 17:23:03,902 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8067946205, username=testuser_8067946205
2025-07-29 17:23:03,910 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=115, telegram_id=8067946205
2025-07-29 17:23:04,189 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:04,194 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:23:04,199 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:23:04,199 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 17:23:04,203 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:23:04,203 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:23:04,205 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 17:23:04,216 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6533910258, username=testuser_6533910258
2025-07-29 17:23:04,221 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=117, telegram_id=6533910258
2025-07-29 17:23:04,464 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:04,469 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:23:04,473 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=INVALID
2025-07-29 17:23:04,473 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=INVALID, days=40
2025-07-29 17:23:04,475 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:23:04,475 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:23:04,476 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 17:23:04,488 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8097534695, username=testuser_8097534695
2025-07-29 17:23:04,494 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=119, telegram_id=8097534695
2025-07-29 17:23:04,735 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:04,740 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:23:04,744 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:23:04,759 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5126270807, username=testuser_5126270807
2025-07-29 17:23:04,766 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=121, telegram_id=5126270807
2025-07-29 17:23:05,019 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:05,394 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=123, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:23:05,401 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 17:23:05,404 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:23:05,407 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/123 "HTTP/1.1 200 OK"
2025-07-29 17:23:05,423 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6427009410, username=testuser_6427009410
2025-07-29 17:23:05,429 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=124, telegram_id=6427009410
2025-07-29 17:23:05,679 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:05,686 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=99999, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:23:05,688 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 17:23:05,689 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:23:05,691 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/99999 "HTTP/1.1 200 OK"
2025-07-29 17:23:05,705 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1537362480, username=testuser_1537362480
2025-07-29 17:23:05,711 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=126, telegram_id=1537362480
2025-07-29 17:23:05,964 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:06,216 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=128, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:23:06,218 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 17:23:06,221 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:23:06,223 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/128 "HTTP/1.1 200 OK"
2025-07-29 17:23:06,236 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6130764963, username=testuser_6130764963
2025-07-29 17:23:06,242 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=129, telegram_id=6130764963
2025-07-29 17:23:06,483 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:06,757 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=1, page_size=5, symbol=None, prediction=None
2025-07-29 17:23:06,759 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 17:23:06,761 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 1, 페이지 크기 5).
2025-07-29 17:23:06,762 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=1&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 17:23:06,765 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=2, page_size=5, symbol=None, prediction=None
2025-07-29 17:23:06,767 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 17:23:06,768 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 2, 페이지 크기 5).
2025-07-29 17:23:06,769 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=2&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 17:23:06,780 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3003544796, username=testuser_3003544796
2025-07-29 17:23:06,785 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=132, telegram_id=3003544796
2025-07-29 17:23:07,036 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:07,295 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=134, page=1, page_size=10, symbol=005930, prediction=None
2025-07-29 17:23:07,295 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 17:23:07,298 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 17:23:07,300 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:23:07,302 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/134?symbol=005930 "HTTP/1.1 200 OK"
2025-07-29 17:23:07,314 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3661165336, username=testuser_3661165336
2025-07-29 17:23:07,321 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=135, telegram_id=3661165336
2025-07-29 17:23:07,577 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:07,833 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=137, page=1, page_size=10, symbol=None, prediction=상승
2025-07-29 17:23:07,834 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=상승
2025-07-29 17:23:07,838 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 17:23:07,840 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:23:07,842 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/137?prediction=%EC%83%81%EC%8A%B9 "HTTP/1.1 200 OK"
2025-07-29 17:23:07,858 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3342111289, username=testuser_3342111289
2025-07-29 17:23:07,865 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=138, telegram_id=3342111289
2025-07-29 17:23:08,148 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:08,406 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=140, page=1, page_size=10, symbol=005930, prediction=유지
2025-07-29 17:23:08,407 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 17:23:08,407 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=유지
2025-07-29 17:23:08,412 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 17:23:08,420 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:23:08,422 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/140?symbol=005930&prediction=%EC%9C%A0%EC%A7%80 "HTTP/1.1 200 OK"
2025-07-29 17:23:08,434 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5125064029, username=testuser_5125064029
2025-07-29 17:23:08,439 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=141, telegram_id=5125064029
2025-07-29 17:23:08,686 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:08,697 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=143, symbol=005930, trade_type=buy
2025-07-29 17:23:08,698 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:23:08,700 - src.api.services.stock_service - WARNING - 현재가 없음: 005930.
2025-07-29 17:23:08,701 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: None
2025-07-29 17:23:08,707 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=143, symbol=005930, trade_type=buy
2025-07-29 17:23:08,709 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 17:23:08,714 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=143
2025-07-29 17:23:08,718 - src.api.routers.simulated_trade - DEBUG - 사용자(143)의 모의매매 이력 1건 조회됨.
2025-07-29 17:23:08,718 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 17:23:08,720 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/143 "HTTP/1.1 200 OK"
2025-07-29 17:23:08,733 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9930942118, username=testuser_9930942118
2025-07-29 17:23:08,739 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=144, telegram_id=9930942118
2025-07-29 17:23:08,980 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:08,999 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 17:23:09,014 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5961184170, username=testuser_5961184170
2025-07-29 17:23:09,019 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=146, telegram_id=5961184170
2025-07-29 17:23:09,262 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:09,269 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 17:23:09,282 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6859802904, username=testuser_6859802904
2025-07-29 17:23:09,288 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=148, telegram_id=6859802904
2025-07-29 17:23:09,527 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:09,543 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%82%BC%EC%84%B1%EC%A0%84%EC%9E%90 "HTTP/1.1 200 OK"
2025-07-29 17:23:09,556 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3808234859, username=testuser_3808234859
2025-07-29 17:23:09,562 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=150, telegram_id=3808234859
2025-07-29 17:23:09,811 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:09,825 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=035720 "HTTP/1.1 200 OK"
2025-07-29 17:23:09,836 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2755091665, username=testuser_2755091665
2025-07-29 17:23:09,840 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=152, telegram_id=2755091665
2025-07-29 17:23:10,181 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:10,205 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=sk%ED%95%98%EC%9D%B4%EB%8B%89%EC%8A%A4 "HTTP/1.1 200 OK"
2025-07-29 17:23:10,265 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5315809673, username=testuser_5315809673
2025-07-29 17:23:10,275 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=154, telegram_id=5315809673
2025-07-29 17:23:10,536 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:10,544 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%97%86%EB%8A%94%EC%A2%85%EB%AA%A9 "HTTP/1.1 200 OK"
2025-07-29 17:23:10,556 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2930247482, username=testuser_2930247482
2025-07-29 17:23:10,561 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=156, telegram_id=2930247482
2025-07-29 17:23:10,801 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:10,807 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query= "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:23:10,819 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4995905233, username=testuser_4995905233
2025-07-29 17:23:10,826 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=158, telegram_id=4995905233
2025-07-29 17:23:11,067 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:11,074 - httpx - INFO - HTTP Request: GET http://testserver/symbols/005930/current_price_and_change "HTTP/1.1 200 OK"
2025-07-29 17:23:11,086 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1573970696, username=testuser_1573970696
2025-07-29 17:23:11,092 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=160, telegram_id=1573970696
2025-07-29 17:23:11,331 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:11,339 - httpx - INFO - HTTP Request: GET http://testserver/symbols/NONEXISTENT/current_price_and_change "HTTP/1.1 404 Not Found"
2025-07-29 17:23:11,351 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4262056645, username=testuser_4262056645
2025-07-29 17:23:11,357 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=162, telegram_id=4262056645
2025-07-29 17:23:11,598 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:11,970 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 17:23:11,989 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7101026726, username=testuser_7101026726
2025-07-29 17:23:11,996 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=165, telegram_id=7101026726
2025-07-29 17:23:12,260 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:12,556 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 400 Bad Request"
2025-07-29 17:23:12,571 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8830365031, username=testuser_8830365031
2025-07-29 17:23:12,581 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=168, telegram_id=8830365031
2025-07-29 17:23:12,834 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:13,355 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 17:23:13,369 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3570937369, username=testuser_3570937369
2025-07-29 17:23:13,376 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=171, telegram_id=3570937369
2025-07-29 17:23:13,632 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:13,641 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 17:23:13,652 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7753888950, username=testuser_7753888950
2025-07-29 17:23:13,661 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=173, telegram_id=7753888950
2025-07-29 17:23:13,911 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:14,407 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 17:23:14,419 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3606129949, username=testuser_3606129949
2025-07-29 17:23:14,425 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=176, telegram_id=3606129949
2025-07-29 17:23:14,669 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:15,036 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 178
2025-07-29 17:23:15,041 - src.api.services.user_service - DEBUG - User found by id: user_id=178
2025-07-29 17:23:15,048 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 17:23:15,070 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2445922645, username=testuser_2445922645
2025-07-29 17:23:15,079 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=179, telegram_id=2445922645
2025-07-29 17:23:15,329 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:15,333 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 403 Forbidden"
2025-07-29 17:23:15,342 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4947643418, username=testuser_4947643418
2025-07-29 17:23:15,348 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=181, telegram_id=4947643418
2025-07-29 17:23:15,587 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:15,834 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 183
2025-07-29 17:23:15,836 - src.api.services.user_service - DEBUG - User found by id: user_id=183
2025-07-29 17:23:15,849 - httpx - INFO - HTTP Request: PUT http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 17:23:15,860 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3023396310, username=testuser_3023396310
2025-07-29 17:23:15,866 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=184, telegram_id=3023396310
2025-07-29 17:23:16,107 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:16,123 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 17:23:16,135 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2967730100, username=testuser_2967730100
2025-07-29 17:23:16,141 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=187, telegram_id=2967730100
2025-07-29 17:23:16,389 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:16,651 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 17:23:16,662 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2585166365, username=testuser_2585166365
2025-07-29 17:23:16,670 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=190, telegram_id=2585166365
2025-07-29 17:23:16,915 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:16,901 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/192 "HTTP/1.1 200 OK"
2025-07-29 17:23:16,916 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2959221042, username=testuser_2959221042
2025-07-29 17:23:16,923 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=193, telegram_id=2959221042
2025-07-29 17:23:16,750 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:16,762 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:23:16,773 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7459778886, username=testuser_7459778886
2025-07-29 17:23:16,777 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=195, telegram_id=7459778886
2025-07-29 17:23:17,020 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:17,512 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 197
2025-07-29 17:23:17,513 - src.api.services.user_service - DEBUG - User found by id: user_id=197
2025-07-29 17:23:17,518 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 200 OK"
2025-07-29 17:23:17,528 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9700895963, username=testuser_9700895963
2025-07-29 17:23:17,533 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=199, telegram_id=9700895963
2025-07-29 17:23:17,777 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:18,046 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 201
2025-07-29 17:23:18,048 - src.api.services.user_service - DEBUG - User found by id: user_id=201
2025-07-29 17:23:18,051 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:23:18,062 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2127478353, username=testuser_2127478353
2025-07-29 17:23:18,069 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=202, telegram_id=2127478353
2025-07-29 17:23:18,315 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:18,324 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=204, symbol=005930
2025-07-29 17:23:18,331 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=204, symbol=005930
2025-07-29 17:23:18,332 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 17:23:18,336 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 시도: user_id=204
2025-07-29 17:23:18,338 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 성공: user_id=204, 1개 종목.
2025-07-29 17:23:18,339 - httpx - INFO - HTTP Request: GET http://testserver/watchlist/get/204 "HTTP/1.1 200 OK"
2025-07-29 17:23:18,344 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:18,346 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:23:18,347 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:23:18,351 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:23:18,354 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12345
2025-07-29 17:23:18,359 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=1, telegram_id=12345
2025-07-29 17:23:18,359 - src.api.services.price_alert_service - DEBUG - 사용자(1)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:23:18,363 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=1
2025-07-29 17:23:18,363 - src.api.services.price_alert_service - DEBUG - 가격 알림(1) 수정 시도: update_data={'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 17:23:18,366 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:23:18,366 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 17:23:18,367 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:23:18,372 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:23:18,372 - src.api.services.price_alert_service - INFO - 가격 알림(1) 수정 성공.
2025-07-29 17:23:18,374 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:23:18,381 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:23:18,382 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:23:18,385 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:23:18,385 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 17:23:18,388 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 17:23:18,388 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:23:18,390 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 17:23:18,390 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 17:23:18,391 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:23:18,391 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 17:23:18,391 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:23:18,398 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:23:18,399 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 17:23:18,400 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:23:18,403 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:23:18,404 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 17:23:18,406 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 17:23:18,406 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:23:18,407 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 17:23:18,408 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 17:23:18,409 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:23:18,409 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 17:23:18,410 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:23:18,414 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:23:18,415 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 17:23:18,416 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:23:18,431 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9235176390, username=testuser_9235176390
2025-07-29 17:23:18,436 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=205, telegram_id=9235176390
2025-07-29 17:23:18,438 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:18,440 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:23:18,441 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:23:18,445 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 9235176390
2025-07-29 17:23:18,447 - src.api.services.user_service - DEBUG - User not found for telegram_id: 9235176390
2025-07-29 17:23:18,448 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9235176390, username=testuser_9235176390
2025-07-29 17:23:18,455 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=226, telegram_id=9235176390
2025-07-29 17:23:18,455 - src.api.services.price_alert_service - DEBUG - 사용자(226)와 종목(GOOG)으로 가격 알림 조회 시도.
2025-07-29 17:23:18,456 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=226, symbol=GOOG
2025-07-29 17:23:18,457 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=226, symbol=GOOG, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:23:18,465 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=225, user_id=226, symbol=GOOG
2025-07-29 17:23:18,466 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:23:18,468 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:23:18,482 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5417045070, username=testuser_5417045070
2025-07-29 17:23:18,488 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=206, telegram_id=5417045070
2025-07-29 17:23:18,490 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:18,493 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:23:18,495 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:23:18,496 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 5417045070
2025-07-29 17:23:18,498 - src.api.services.user_service - DEBUG - User not found for telegram_id: 5417045070
2025-07-29 17:23:18,499 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5417045070, username=telegram_user_5417045070
2025-07-29 17:23:18,504 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=227, telegram_id=5417045070
2025-07-29 17:23:18,505 - src.api.services.price_alert_service - DEBUG - 사용자(227)와 종목(MSFT)으로 가격 알림 조회 시도.
2025-07-29 17:23:18,509 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=227, symbol=MSFT
2025-07-29 17:23:18,510 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=227, symbol=MSFT, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:23:18,515 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=226, user_id=227, symbol=MSFT
2025-07-29 17:23:18,516 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:23:18,519 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:23:18,531 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8251237574, username=testuser_8251237574
2025-07-29 17:23:18,538 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=207, telegram_id=8251237574
2025-07-29 17:23:18,546 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:18,548 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:23:18,549 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:23:18,550 - src.api.routers.bot_router - DEBUG - Before toggle: existing_alert.notify_on_disclosure = True
2025-07-29 17:23:18,550 - src.api.routers.bot_router - DEBUG - Calculated new_status: False
2025-07-29 17:23:18,551 - src.api.routers.bot_router - DEBUG - After update_alert call: updated_alert_orm.notify_on_disclosure = False
2025-07-29 17:23:18,552 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:23:18,553 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:23:18,566 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3476067079, username=testuser_3476067079
2025-07-29 17:23:18,574 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=208, telegram_id=3476067079
2025-07-29 17:23:18,577 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:18,580 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:23:18,581 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:23:18,581 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 3476067079
2025-07-29 17:23:18,583 - src.api.services.user_service - DEBUG - User not found for telegram_id: 3476067079
2025-07-29 17:23:18,583 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3476067079, username=telegram_user_3476067079
2025-07-29 17:23:18,590 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=228, telegram_id=3476067079
2025-07-29 17:23:18,590 - src.api.services.price_alert_service - DEBUG - 사용자(228)와 종목(NFLX)으로 가격 알림 조회 시도.
2025-07-29 17:23:18,593 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=228, symbol=NFLX
2025-07-29 17:23:18,594 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=228, symbol=NFLX, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:23:18,600 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=227, user_id=228, symbol=NFLX
2025-07-29 17:23:18,602 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:23:18,604 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:23:18,619 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6866324503, username=testuser_6866324503
2025-07-29 17:23:18,626 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=209, telegram_id=6866324503
2025-07-29 17:23:18,629 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:18,632 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:23:18,634 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:23:18,634 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 6866324503
2025-07-29 17:23:18,637 - src.api.services.user_service - DEBUG - User not found for telegram_id: 6866324503
2025-07-29 17:23:18,638 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6866324503, username=testuser_6866324503
2025-07-29 17:23:18,644 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=229, telegram_id=6866324503
2025-07-29 17:23:18,645 - src.api.services.price_alert_service - DEBUG - 사용자(229)와 종목(NVDA)으로 가격 알림 조회 시도.
2025-07-29 17:23:18,648 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=229, symbol=NVDA
2025-07-29 17:23:18,648 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=229, symbol=NVDA, target_price=1000.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:23:18,654 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=228, user_id=229, symbol=NVDA
2025-07-29 17:23:18,656 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:23:18,659 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:23:18,673 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9984852959, username=testuser_9984852959
2025-07-29 17:23:18,680 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=210, telegram_id=9984852959
2025-07-29 17:23:18,685 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:18,688 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:23:18,689 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:23:18,690 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 9984852959
2025-07-29 17:23:18,692 - src.api.services.user_service - DEBUG - User not found for telegram_id: 9984852959
2025-07-29 17:23:18,693 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9984852959, username=telegram_user_9984852959
2025-07-29 17:23:18,699 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=230, telegram_id=9984852959
2025-07-29 17:23:18,699 - src.api.services.price_alert_service - DEBUG - 사용자(230)와 종목(GOOGL)으로 가격 알림 조회 시도.
2025-07-29 17:23:18,702 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=230, symbol=GOOGL
2025-07-29 17:23:18,702 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=230, symbol=GOOGL, target_price=110.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=weekly
2025-07-29 17:23:18,710 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=229, user_id=230, symbol=GOOGL
2025-07-29 17:23:18,712 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:23:18,714 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:23:18,728 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4385240828, username=testuser_4385240828
2025-07-29 17:23:18,736 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=211, telegram_id=4385240828
2025-07-29 17:23:18,740 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:18,745 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:23:18,747 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:23:18,747 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 4385240828
2025-07-29 17:23:18,750 - src.api.services.user_service - DEBUG - User not found for telegram_id: 4385240828
2025-07-29 17:23:18,750 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4385240828, username=telegram_user_4385240828
2025-07-29 17:23:18,756 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=231, telegram_id=4385240828
2025-07-29 17:23:18,757 - src.api.services.price_alert_service - DEBUG - 사용자(231)와 종목(FB)으로 가격 알림 조회 시도.
2025-07-29 17:23:18,759 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=231, symbol=FB
2025-07-29 17:23:18,760 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=231, symbol=FB, target_price=300.0, condition=above, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:23:18,767 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=230, user_id=231, symbol=FB
2025-07-29 17:23:18,770 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:23:18,773 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:23:18,781 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:18,782 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:18,790 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:18,798 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:18,799 - src.common.dart_utils - ERROR - DART CORPCODE.xml 요청 실패: Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 25, in dart_get_all_stocks
    resp = await session.get(url, timeout=60)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 17:23:18,804 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:18,810 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:18,817 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:18,821 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:18,822 - src.common.dart_utils - ERROR - DART 공시 조회 API 요청 실패 (corp_code: 00123456): Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 79, in dart_get_disclosures
    resp = await session.get(url, params=params, timeout=10)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 17:23:18,826 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:18,828 - src.common.dart_utils - ERROR - DART 공시 API가 오류를 반환했습니다. status: 001, message: API 호출 오류, corp_code: 00123456
2025-07-29 17:23:18,982 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4281225938, username=testuser_4281225938
2025-07-29 17:23:18,988 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=212, telegram_id=4281225938
2025-07-29 17:23:19,311 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:19,559 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 17:23:19,810 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 17:23:19,815 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=214, symbol=005930
2025-07-29 17:23:19,822 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=214, symbol=005930
2025-07-29 17:23:19,824 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 17:23:19,827 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 214
2025-07-29 17:23:19,829 - src.api.services.user_service - DEBUG - User found by id: user_id=214
2025-07-29 17:23:19,831 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:23:19,831 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=214, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:23:19,838 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=11, user_id=214, symbol=005930
2025-07-29 17:23:19,840 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:23:19,843 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:23:19,846 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:23:19,847 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 17:23:19,849 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:23:19,849 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:23:19,855 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 17:23:19,859 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=214, symbol=005930, trade_type=buy
2025-07-29 17:23:19,859 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:23:19,863 - src.api.services.stock_service - WARNING - 현재가 없음: 005930.
2025-07-29 17:23:19,863 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: None
2025-07-29 17:23:19,867 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=214, symbol=005930, trade_type=buy
2025-07-29 17:23:19,869 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 17:23:19,871 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=214
2025-07-29 17:23:19,874 - src.api.routers.simulated_trade - DEBUG - 사용자(214)의 모의매매 이력 1건 조회됨.
2025-07-29 17:23:19,874 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 17:23:19,875 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/214 "HTTP/1.1 200 OK"
2025-07-29 17:23:19,886 - src.api.main - INFO - [APScheduler] 가격 알림 체크 잡 실행: 2025-07-29 17:23:19.886491
2025-07-29 17:23:19,887 - src.api.main - DEBUG - 활성 알림 수: 3
2025-07-29 17:23:19,887 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:23:19,887 - src.api.main - DEBUG - 종목 정상종목 현재가: 110
2025-07-29 17:23:19,888 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='140478023201456'>, 목표 가격: 100, 조건: gte, 반복 주기: <MagicMock name='mock.repeat_interval' id='140478022823808'>
2025-07-29 17:23:19,888 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목, 현재가: 110, 목표가: 100
2025-07-29 17:23:19,893 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='140478023454384'>)
2025-07-29 17:23:19,895 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 17:23:19,895 - src.api.main - DEBUG - 종목 오류종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:23:19,896 - src.api.main - ERROR - 가격 알림 확인 중 '오류종목' 처리 오류: 현재가 조회 실패
Traceback (most recent call last):
  File "/app/src/api/main.py", line 145, in check_price_alerts_job
    price_data = stock_service.get_current_price_and_change(symbol, db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1179, in _execute_mock_call
    result = effect(*args, **kwargs)
  File "/app/src/api/tests/test_main_jobs.py", line 34, in get_current_price_side_effect
    raise ValueError("현재가 조회 실패")
ValueError: 현재가 조회 실패
2025-07-29 17:23:19,896 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:23:19,897 - src.api.main - DEBUG - 종목 정상종목2 현재가: 290
2025-07-29 17:23:19,898 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='140478024658720'>, 목표 가격: 300, 조건: lte, 반복 주기: <MagicMock name='mock.repeat_interval' id='140478025347904'>
2025-07-29 17:23:19,899 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목2, 현재가: 290, 목표가: 300
2025-07-29 17:23:19,900 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='140478023454384'>)
2025-07-29 17:23:19,900 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 17:23:19,900 - src.api.main - DEBUG - 모든 가격 알림 체크 및 DB 커밋 완료.
2025-07-29 17:23:19,905 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:23:19,906 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(10일)
2025-07-29 17:23:19,910 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:23:19,911 - src.api.services.predict_service - ERROR - 예측 불가: 데이터 분석 실패
2025-07-29 17:23:19,915 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:23:19,915 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:23:19,925 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 상승 (24일 지속). 금일 변동: 보합. 최근 20일간 상승일: 19일, 하락일: 0일.
2025-07-29 17:23:19,925 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 17:23:19,930 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:23:19,931 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:23:19,939 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 하락 (24일 지속). 금일 변동: 보합. 최근 20일간 상승일: 0일, 하락일: 19일.
2025-07-29 17:23:19,939 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 17:23:19,944 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:23:19,945 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:23:19,950 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=hold, reason=최근 추세: 횡보 (1일 지속). 금일 변동: 보합. 최근 20일간 상승일: 12일, 하락일: 7일.
2025-07-29 17:23:19,950 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: hold
2025-07-29 17:23:19,956 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:23:19,957 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:23:19,965 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=buy, reason=최근 추세: 하락 (1일 지속). 금일 변동: 횡보. 최근 20일간 상승일: 2일, 하락일: 17일. (저점 횡보 패턴 감지)
2025-07-29 17:23:19,966 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: buy
2025-07-29 17:23:19,973 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:23:19,974 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 22개 데이터.
2025-07-29 17:23:19,981 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, reason=최근 추세: 상승 (21일 지속). 금일 변동: 횡보. 최근 20일간 상승일: 19일, 하락일: 0일. (급등 후 횡보 패턴 감지)
2025-07-29 17:23:19,982 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 17:23:19,997 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:20,004 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:23:20,004 - src.api.services.stock_service - INFO - 신규 공시가 없습니다. (DB 기준: 202301010000001)
2025-07-29 17:23:20,016 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:20,023 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:23:20,031 - src.api.services.stock_service - INFO - 최초 실행. 기준 접수번호를 202301020000001로 DB에 설정합니다.
2025-07-29 17:23:20,033 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:23:20,034 - src.api.services.stock_service - INFO - 최초 실행. 기준 접수번호를 202301020000001로 DB에 설정합니다.
2025-07-29 17:23:20,046 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:20,056 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:23:20,057 - src.api.services.stock_service - INFO - 2건의 신규 공시를 발견했습니다.
2025-07-29 17:23:20,058 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 17:23:20,058 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 17:23:20,058 - src.api.services.stock_service - INFO - 마지막 확인 접수번호를 202301020000002로 DB에 갱신합니다.
2025-07-29 17:23:20,066 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:20,071 - src.api.services.stock_service - CRITICAL - DART API 사용 한도를 초과했습니다: [020] 사용 한도 초과
2025-07-29 17:23:20,077 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:20,082 - src.api.services.stock_service - ERROR - DART 공시 조회 중 API 오류 발생: [999] 기타 API 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 40, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
src.common.exceptions.DartApiError: [999] 기타 API 오류
2025-07-29 17:23:20,091 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:20,101 - src.api.services.stock_service - ERROR - 신규 공시 확인 및 알림 작업 중 예상치 못한 오류 발생: 예상치 못한 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 40, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: 예상치 못한 오류
2025-07-29 17:23:20,112 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:20,127 - src.api.services.stock_service - DEBUG - update_daily_prices 호출.
2025-07-29 17:23:20,130 - src.api.services.stock_service - DEBUG - DB에서 2개 종목 가져옴.
2025-07-29 17:23:20,130 - src.api.services.stock_service - DEBUG - 종목 005930 (삼성전자) 일별시세 갱신 시작.
2025-07-29 17:23:20,134 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 005930 - 2025-07-29
2025-07-29 17:23:20,138 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 005930 - 2025-07-28
2025-07-29 17:23:20,138 - src.api.services.stock_service - DEBUG - 종목 000660 (SK하이닉스) 일별시세 갱신 시작.
2025-07-29 17:23:20,141 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 000660 - 2025-07-29
2025-07-29 17:23:20,144 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 000660 - 2025-07-28
2025-07-29 17:23:20,154 - src.api.services.stock_service - INFO - 일별시세 갱신 완료: 4개 데이터 처리. 오류: 0개 종목
2025-07-29 17:23:20,172 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:20,184 - src.api.services.stock_service - DEBUG - update_daily_prices 호출.
2025-07-29 17:23:20,186 - src.api.services.stock_service - DEBUG - DB에서 1개 종목 가져옴.
2025-07-29 17:23:20,186 - src.api.services.stock_service - DEBUG - 종목 005930 (삼성전자) 일별시세 갱신 시작.
2025-07-29 17:23:20,187 - src.api.services.stock_service - WARNING - 종목 005930에 대한 일별시세 데이터가 없습니다.
2025-07-29 17:23:20,188 - src.api.services.stock_service - INFO - 일별시세 갱신 완료: 0개 데이터 처리. 오류: 1개 종목
2025-07-29 17:23:20,206 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:20,215 - src.api.services.stock_service - DEBUG - update_daily_prices 호출.
2025-07-29 17:23:20,218 - src.api.services.stock_service - DEBUG - DB에서 1개 종목 가져옴.
2025-07-29 17:23:20,218 - src.api.services.stock_service - DEBUG - 종목 005930 (삼성전자) 일별시세 갱신 시작.
2025-07-29 17:23:20,219 - src.api.services.stock_service - ERROR - 일별시세 갱신 중 '005930' 처리에서 오류 발생: API Error
2025-07-29 17:23:20,220 - src.api.services.stock_service - INFO - 일별시세 갱신 완료: 0개 데이터 처리. 오류: 1개 종목
2025-07-29 17:23:20,238 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:20,249 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:23:20,252 - src.api.services.stock_service - DEBUG - 현재가 발견: 005930 - 71500.0
2025-07-29 17:23:20,253 - src.api.services.stock_service - DEBUG - 전일 종가 발견: 005930 - 70500.0
2025-07-29 17:23:20,266 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:20,268 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=NONEXIST
2025-07-29 17:23:20,272 - src.api.services.stock_service - WARNING - 현재가 없음: NONEXIST.
2025-07-29 17:23:20,289 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:23:20,305 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:23:20,308 - src.api.services.stock_service - DEBUG - 현재가 발견: 005930 - 71500.0
2025-07-29 17:23:20,309 - src.api.services.stock_service - WARNING - 전일 종가 없음: 005930. 등락률 계산 불가.
2025-07-29 17:28:32,001 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 17:28:32,007 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 17:28:32,010 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:28:32,011 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:28:32,011 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:28:32,012 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:28:32,975 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:32,979 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 17:28:32,984 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-07-29 17:28:32,986 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '<unknown>'
2025-07-29 17:28:32,986 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-07-29 17:28:33,256 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:33,260 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:28:33,499 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:33,504 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 17:28:33,748 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:33,751 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 17:28:33,753 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 17:28:33,765 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8165245320, username=testuser_8165245320
2025-07-29 17:28:33,877 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=1, telegram_id=8165245320
2025-07-29 17:28:34,217 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:34,474 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 200 OK"
2025-07-29 17:28:34,486 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9622583021, username=testuser_9622583021
2025-07-29 17:28:34,492 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=3, telegram_id=9622583021
2025-07-29 17:28:34,740 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:34,986 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 17:28:34,997 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2551707064, username=testuser_2551707064
2025-07-29 17:28:35,003 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=5, telegram_id=2551707064
2025-07-29 17:28:35,252 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:35,258 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 17:28:35,267 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4041822127, username=testuser_4041822127
2025-07-29 17:28:35,273 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=7, telegram_id=4041822127
2025-07-29 17:28:35,524 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:35,773 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 200 OK"
2025-07-29 17:28:35,783 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8356769514, username=testuser_8356769514
2025-07-29 17:28:35,790 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=9, telegram_id=8356769514
2025-07-29 17:28:36,035 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:36,298 - src.api.routers.admin - ERROR - /admin/update_master 서버 오류: DB connection error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 36, in update_stock_master
    result = await stock_service.update_stock_master(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DB connection error
2025-07-29 17:28:36,303 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:28:36,314 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5083644507, username=testuser_5083644507
2025-07-29 17:28:36,320 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=11, telegram_id=5083644507
2025-07-29 17:28:36,562 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:36,807 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 17:28:36,819 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6179890786, username=testuser_6179890786
2025-07-29 17:28:36,824 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=13, telegram_id=6179890786
2025-07-29 17:28:37,071 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:37,077 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 17:28:37,087 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6541936779, username=testuser_6541936779
2025-07-29 17:28:37,093 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=15, telegram_id=6541936779
2025-07-29 17:28:37,338 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:37,592 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 200 OK"
2025-07-29 17:28:37,612 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4303989062, username=testuser_4303989062
2025-07-29 17:28:37,619 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=17, telegram_id=4303989062
2025-07-29 17:28:37,888 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:38,234 - src.api.routers.admin - ERROR - /admin/update_price 서버 오류: API call failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 53, in update_daily_price
    result = await stock_service.update_daily_prices(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: API call failed
2025-07-29 17:28:38,236 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:28:38,254 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7871694140, username=testuser_7871694140
2025-07-29 17:28:38,262 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=19, telegram_id=7871694140
2025-07-29 17:28:38,513 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:38,756 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 17:28:38,768 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9376790571, username=testuser_9376790571
2025-07-29 17:28:38,774 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=21, telegram_id=9376790571
2025-07-29 17:28:39,014 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:39,022 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 17:28:39,036 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8320862310, username=testuser_8320862310
2025-07-29 17:28:39,044 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=23, telegram_id=8320862310
2025-07-29 17:28:38,551 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:38,801 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f46f0773910>
2025-07-29 17:28:38,801 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:28:38,805 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 200 OK"
2025-07-29 17:28:38,817 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5133706105, username=testuser_5133706105
2025-07-29 17:28:38,824 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=25, telegram_id=5133706105
2025-07-29 17:28:39,066 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:39,311 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f46f07e1750>
2025-07-29 17:28:39,312 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:28:39,313 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 200 OK"
2025-07-29 17:28:39,326 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9534997889, username=testuser_9534997889
2025-07-29 17:28:39,332 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=27, telegram_id=9534997889
2025-07-29 17:28:39,571 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:39,825 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f46f07e15a0>
2025-07-29 17:28:39,825 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:28:39,827 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=%EC%B9%B4%EC%B9%B4%EC%98%A4 "HTTP/1.1 200 OK"
2025-07-29 17:28:39,842 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9008610789, username=testuser_9008610789
2025-07-29 17:28:39,848 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=29, telegram_id=9008610789
2025-07-29 17:28:40,107 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:40,364 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f46f069d030>
2025-07-29 17:28:40,364 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:28:40,366 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=0013456 "HTTP/1.1 200 OK"
2025-07-29 17:28:40,379 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6052191975, username=testuser_6052191975
2025-07-29 17:28:40,386 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=31, telegram_id=6052191975
2025-07-29 17:28:40,665 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:40,931 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f46f069dcc0>
2025-07-29 17:28:40,931 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:28:40,932 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=NONEXIST "HTTP/1.1 404 Not Found"
2025-07-29 17:28:40,945 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9174453774, username=testuser_9174453774
2025-07-29 17:28:40,951 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=33, telegram_id=9174453774
2025-07-29 17:28:41,200 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:41,462 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f46f06ecd90>
2025-07-29 17:28:41,463 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:28:41,463 - src.api.routers.admin - ERROR - /admin/update_disclosure 서버 오류: DART API error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 126, in update_disclosure
    result = await stock_service.update_disclosures(db, corp_code=corp_code, stock_code=stock_code or '', stock_name=stock_name or '')
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DART API error
2025-07-29 17:28:41,465 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:28:41,480 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9940104726, username=testuser_9940104726
2025-07-29 17:28:41,487 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=35, telegram_id=9940104726
2025-07-29 17:28:41,836 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:42,100 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 17:28:42,116 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4152133903, username=testuser_4152133903
2025-07-29 17:28:42,124 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=37, telegram_id=4152133903
2025-07-29 17:28:42,389 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:42,397 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 17:28:42,410 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1042558061, username=testuser_1042558061
2025-07-29 17:28:42,418 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=39, telegram_id=1042558061
2025-07-29 17:28:42,682 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:42,955 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:28:42,976 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7647550659, username=testuser_7647550659
2025-07-29 17:28:42,983 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=41, telegram_id=7647550659
2025-07-29 17:28:43,228 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:43,498 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:28:43,511 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7294296719, username=testuser_7294296719
2025-07-29 17:28:43,517 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=43, telegram_id=7294296719
2025-07-29 17:28:43,773 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:44,023 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 17:28:44,034 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4668020248, username=testuser_4668020248
2025-07-29 17:28:44,040 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=45, telegram_id=4668020248
2025-07-29 17:28:44,294 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:44,301 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 17:28:44,313 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4168120565, username=testuser_4168120565
2025-07-29 17:28:44,320 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=47, telegram_id=4168120565
2025-07-29 17:28:44,580 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:44,838 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 17:28:44,838 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 17:28:44,849 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7575165834, username=testuser_7575165834
2025-07-29 17:28:44,854 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=49, telegram_id=7575165834
2025-07-29 17:28:45,107 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:45,358 - src.api.routers.admin - ERROR - [trigger_job] 잡 실행 실패: test_job - Job execution failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 175, in trigger_job
    job.func(*job.args, **job.kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: Job execution failed

2025-07-29 17:28:45,359 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:28:45,369 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5791496405, username=testuser_5791496405
2025-07-29 17:28:45,375 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=51, telegram_id=5791496405
2025-07-29 17:28:45,620 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:45,867 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 17:28:45,879 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1023498440, username=testuser_1023498440
2025-07-29 17:28:45,884 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=53, telegram_id=1023498440
2025-07-29 17:28:46,172 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:46,179 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 17:28:46,192 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9381720918, username=testuser_9381720918
2025-07-29 17:28:46,199 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=55, telegram_id=9381720918
2025-07-29 17:28:46,455 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:46,709 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 17:28:46,710 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 200 OK"
2025-07-29 17:28:46,723 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1338075204, username=testuser_1338075204
2025-07-29 17:28:46,729 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=57, telegram_id=1338075204
2025-07-29 17:28:46,976 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:47,219 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 17:28:47,220 - src.api.routers.admin - ERROR - 공시 확인 잡 수동 실행 중 오류 발생: Disclosure check failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 193, in trigger_check_disclosures_job
    await stock_service.check_and_notify_new_disclosures(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: Disclosure check failed
2025-07-29 17:28:47,221 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:28:47,233 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6998261717, username=testuser_6998261717
2025-07-29 17:28:47,239 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=59, telegram_id=6998261717
2025-07-29 17:28:47,493 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:47,744 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 17:28:47,757 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7201014937, username=testuser_7201014937
2025-07-29 17:28:47,763 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=61, telegram_id=7201014937
2025-07-29 17:28:48,005 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:48,013 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 17:28:48,025 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8898493435, username=testuser_8898493435
2025-07-29 17:28:48,031 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=63, telegram_id=8898493435
2025-07-29 17:28:48,269 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:48,513 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:28:48,518 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=65, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:28:48,532 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=1, user_id=65, symbol=005930
2025-07-29 17:28:48,535 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:28:48,555 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3769505688, username=testuser_3769505688
2025-07-29 17:28:48,563 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=66, telegram_id=3769505688
2025-07-29 17:28:48,831 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:48,836 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:28:48,848 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8514862012, username=testuser_8514862012
2025-07-29 17:28:48,854 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=68, telegram_id=8514862012
2025-07-29 17:28:49,103 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:49,358 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:28:49,360 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:28:49,370 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3951147092, username=testuser_3951147092
2025-07-29 17:28:49,376 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=71, telegram_id=3951147092
2025-07-29 17:28:49,621 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:49,870 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:28:49,871 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:28:49,876 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=2, user_id=73, symbol=005930
2025-07-29 17:28:49,878 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:28:49,880 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:28:49,882 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=035720, target_price=50000.0, condition=lte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:28:49,887 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=3, user_id=73, symbol=035720
2025-07-29 17:28:49,888 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:28:49,890 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:28:49,892 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 조회 시도.
2025-07-29 17:28:49,895 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 2개 조회됨.
2025-07-29 17:28:49,896 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:28:49,906 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9939465774, username=testuser_9939465774
2025-07-29 17:28:49,911 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=74, telegram_id=9939465774
2025-07-29 17:28:50,158 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:50,545 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:28:50,548 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 조회 시도.
2025-07-29 17:28:50,550 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 0개 조회됨.
2025-07-29 17:28:50,553 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:28:50,565 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5947129838, username=testuser_5947129838
2025-07-29 17:28:50,572 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=77, telegram_id=5947129838
2025-07-29 17:28:50,825 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:50,829 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:28:50,839 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1264930589, username=testuser_1264930589
2025-07-29 17:28:50,844 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=79, telegram_id=1264930589
2025-07-29 17:28:51,098 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:51,349 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:28:51,350 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=81, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:28:51,357 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=4, user_id=81, symbol=005930
2025-07-29 17:28:51,359 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:28:51,363 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:28:51,364 - src.api.services.price_alert_service - DEBUG - 사용자(81)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:28:51,367 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=4
2025-07-29 17:28:51,369 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/81/symbol/005930 "HTTP/1.1 200 OK"
2025-07-29 17:28:51,380 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7385267925, username=testuser_7385267925
2025-07-29 17:28:51,385 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=82, telegram_id=7385267925
2025-07-29 17:28:51,629 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:51,877 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:28:51,878 - src.api.services.price_alert_service - DEBUG - 사용자(84)와 종목(NONEXISTENT)으로 가격 알림 조회 시도.
2025-07-29 17:28:51,880 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=84, symbol=NONEXISTENT
2025-07-29 17:28:51,882 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/84/symbol/NONEXISTENT "HTTP/1.1 404 Not Found"
2025-07-29 17:28:51,892 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1955915011, username=testuser_1955915011
2025-07-29 17:28:51,898 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=85, telegram_id=1955915011
2025-07-29 17:28:52,143 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:52,386 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:28:52,387 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=87, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:28:52,392 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=5, user_id=87, symbol=005930
2025-07-29 17:28:52,394 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:28:52,397 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:28:52,400 - src.api.services.price_alert_service - DEBUG - 가격 알림(5) 수정 시도: update_data={'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 17:28:52,402 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:28:52,403 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 17:28:52,403 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:28:52,408 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:28:52,409 - src.api.services.price_alert_service - INFO - 가격 알림(5) 수정 성공.
2025-07-29 17:28:52,411 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/5 "HTTP/1.1 200 OK"
2025-07-29 17:28:52,422 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9921476456, username=testuser_9921476456
2025-07-29 17:28:52,429 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=88, telegram_id=9921476456
2025-07-29 17:28:52,671 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:52,916 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:28:52,917 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=90, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:28:52,923 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=6, user_id=90, symbol=005930
2025-07-29 17:28:52,925 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:28:52,927 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/6 "HTTP/1.1 403 Forbidden"
2025-07-29 17:28:52,938 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1275477613, username=testuser_1275477613
2025-07-29 17:28:52,944 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=91, telegram_id=1275477613
2025-07-29 17:28:53,185 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:53,439 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:28:53,440 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 17:28:53,441 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 17:28:53,443 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:28:53,454 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9219932945, username=testuser_9219932945
2025-07-29 17:28:53,459 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=94, telegram_id=9219932945
2025-07-29 17:28:53,708 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:54,201 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:28:54,202 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=96, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:28:54,210 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=7, user_id=96, symbol=005930
2025-07-29 17:28:54,212 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:28:54,215 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:28:54,216 - src.api.services.price_alert_service - DEBUG - 가격 알림(7) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 17:28:54,218 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:28:54,218 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0}
2025-07-29 17:28:54,218 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:28:54,224 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:28:54,224 - src.api.services.price_alert_service - INFO - 가격 알림(7) 수정 성공.
2025-07-29 17:28:54,228 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/7 "HTTP/1.1 403 Forbidden"
2025-07-29 17:28:54,240 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4484718969, username=testuser_4484718969
2025-07-29 17:28:54,245 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=98, telegram_id=4484718969
2025-07-29 17:28:54,487 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:54,850 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:28:54,851 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=100, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:28:54,857 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=8, user_id=100, symbol=005930
2025-07-29 17:28:54,859 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:28:54,861 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:28:54,864 - src.api.services.price_alert_service - DEBUG - 가격 알림(8) 삭제 시도.
2025-07-29 17:28:54,872 - src.api.services.price_alert_service - INFO - 가격 알림(8) 삭제 성공.
2025-07-29 17:28:54,873 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/8 "HTTP/1.1 200 OK"
2025-07-29 17:28:54,888 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2589405011, username=testuser_2589405011
2025-07-29 17:28:54,895 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=101, telegram_id=2589405011
2025-07-29 17:28:55,150 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:55,402 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:28:55,402 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=103, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:28:55,408 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=9, user_id=103, symbol=005930
2025-07-29 17:28:55,409 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:28:55,411 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/9 "HTTP/1.1 403 Forbidden"
2025-07-29 17:28:55,421 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8370429101, username=testuser_8370429101
2025-07-29 17:28:55,426 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=104, telegram_id=8370429101
2025-07-29 17:28:55,673 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:55,935 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:28:55,938 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 삭제 시도.
2025-07-29 17:28:55,940 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 17:28:55,941 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:28:55,952 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7034985109, username=testuser_7034985109
2025-07-29 17:28:55,958 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=107, telegram_id=7034985109
2025-07-29 17:28:56,207 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:56,701 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:28:56,702 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=109, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:28:56,707 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=10, user_id=109, symbol=005930
2025-07-29 17:28:56,709 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:28:56,711 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:28:56,715 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/10 "HTTP/1.1 403 Forbidden"
2025-07-29 17:28:56,724 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7153322109, username=testuser_7153322109
2025-07-29 17:28:56,730 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=111, telegram_id=7153322109
2025-07-29 17:28:56,979 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:56,985 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 17:28:56,996 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2381850750, username=testuser_2381850750
2025-07-29 17:28:57,002 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=113, telegram_id=2381850750
2025-07-29 17:28:57,245 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:57,250 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 17:28:57,256 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:57,260 - httpx - INFO - HTTP Request: GET http://testserver/ "HTTP/1.1 200 OK"
2025-07-29 17:28:57,270 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3357284023, username=testuser_3357284023
2025-07-29 17:28:57,276 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=115, telegram_id=3357284023
2025-07-29 17:28:57,524 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:57,529 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:28:57,534 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:28:57,534 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 17:28:57,539 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:28:57,539 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:28:58,175 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6121507325, username=testuser_6121507325
2025-07-29 17:28:58,182 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=117, telegram_id=6121507325
2025-07-29 17:28:58,423 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:58,428 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:28:58,431 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=INVALID
2025-07-29 17:28:58,431 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=INVALID, days=40
2025-07-29 17:28:58,433 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:28:58,433 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:28:59,011 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9538166711, username=testuser_9538166711
2025-07-29 17:28:59,017 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=119, telegram_id=9538166711
2025-07-29 17:28:59,270 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:59,275 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:28:59,279 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:28:59,293 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3994332389, username=testuser_3994332389
2025-07-29 17:28:59,300 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=121, telegram_id=3994332389
2025-07-29 17:28:59,551 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:28:59,897 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=123, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:28:59,900 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 17:28:59,902 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:28:59,903 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/123 "HTTP/1.1 200 OK"
2025-07-29 17:28:59,915 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7532853936, username=testuser_7532853936
2025-07-29 17:28:59,921 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=124, telegram_id=7532853936
2025-07-29 17:29:00,190 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:00,196 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=99999, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:29:00,198 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 17:29:00,199 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:29:00,201 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/99999 "HTTP/1.1 200 OK"
2025-07-29 17:29:00,213 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3441394248, username=testuser_3441394248
2025-07-29 17:29:00,219 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=126, telegram_id=3441394248
2025-07-29 17:29:00,465 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:00,711 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=128, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:29:00,714 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 17:29:00,716 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:29:00,717 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/128 "HTTP/1.1 200 OK"
2025-07-29 17:29:00,729 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8721257356, username=testuser_8721257356
2025-07-29 17:29:00,736 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=129, telegram_id=8721257356
2025-07-29 17:29:01,017 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:01,356 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=1, page_size=5, symbol=None, prediction=None
2025-07-29 17:29:01,360 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 17:29:01,364 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 1, 페이지 크기 5).
2025-07-29 17:29:01,367 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=1&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 17:29:01,371 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=2, page_size=5, symbol=None, prediction=None
2025-07-29 17:29:01,373 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 17:29:01,375 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 2, 페이지 크기 5).
2025-07-29 17:29:01,378 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=2&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 17:29:01,394 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1793645087, username=testuser_1793645087
2025-07-29 17:29:01,401 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=132, telegram_id=1793645087
2025-07-29 17:29:01,675 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:01,926 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=134, page=1, page_size=10, symbol=005930, prediction=None
2025-07-29 17:29:01,927 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 17:29:01,931 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 17:29:01,933 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:29:01,934 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/134?symbol=005930 "HTTP/1.1 200 OK"
2025-07-29 17:29:01,946 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1339173922, username=testuser_1339173922
2025-07-29 17:29:01,951 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=135, telegram_id=1339173922
2025-07-29 17:29:02,199 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:02,462 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=137, page=1, page_size=10, symbol=None, prediction=상승
2025-07-29 17:29:02,463 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=상승
2025-07-29 17:29:02,466 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 17:29:02,468 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:29:02,470 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/137?prediction=%EC%83%81%EC%8A%B9 "HTTP/1.1 200 OK"
2025-07-29 17:29:02,481 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6226338716, username=testuser_6226338716
2025-07-29 17:29:02,487 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=138, telegram_id=6226338716
2025-07-29 17:29:02,728 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:02,978 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=140, page=1, page_size=10, symbol=005930, prediction=유지
2025-07-29 17:29:02,978 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 17:29:02,979 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=유지
2025-07-29 17:29:02,982 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 17:29:02,983 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:29:02,985 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/140?symbol=005930&prediction=%EC%9C%A0%EC%A7%80 "HTTP/1.1 200 OK"
2025-07-29 17:29:02,995 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8220750758, username=testuser_8220750758
2025-07-29 17:29:03,001 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=141, telegram_id=8220750758
2025-07-29 17:29:03,253 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:03,263 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=143, symbol=005930, trade_type=buy
2025-07-29 17:29:03,263 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:29:03,266 - src.api.services.stock_service - WARNING - 현재가 없음: 005930.
2025-07-29 17:29:03,266 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: None
2025-07-29 17:29:03,271 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=143, symbol=005930, trade_type=buy
2025-07-29 17:29:03,273 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 17:29:03,278 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=143
2025-07-29 17:29:03,282 - src.api.routers.simulated_trade - DEBUG - 사용자(143)의 모의매매 이력 1건 조회됨.
2025-07-29 17:29:03,283 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 17:29:03,285 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/143 "HTTP/1.1 200 OK"
2025-07-29 17:29:03,303 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9851658460, username=testuser_9851658460
2025-07-29 17:29:03,311 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=144, telegram_id=9851658460
2025-07-29 17:29:03,573 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:03,598 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 17:29:03,616 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1223873277, username=testuser_1223873277
2025-07-29 17:29:03,626 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=146, telegram_id=1223873277
2025-07-29 17:29:03,917 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:03,925 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 17:29:03,939 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7370151700, username=testuser_7370151700
2025-07-29 17:29:03,946 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=148, telegram_id=7370151700
2025-07-29 17:29:04,214 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:04,257 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%82%BC%EC%84%B1%EC%A0%84%EC%9E%90 "HTTP/1.1 200 OK"
2025-07-29 17:29:04,297 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9674185240, username=testuser_9674185240
2025-07-29 17:29:04,323 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=150, telegram_id=9674185240
2025-07-29 17:29:04,619 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:04,642 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=035720 "HTTP/1.1 200 OK"
2025-07-29 17:29:04,657 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1047735051, username=testuser_1047735051
2025-07-29 17:29:04,666 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=152, telegram_id=1047735051
2025-07-29 17:29:04,919 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:04,938 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=sk%ED%95%98%EC%9D%B4%EB%8B%89%EC%8A%A4 "HTTP/1.1 200 OK"
2025-07-29 17:29:04,951 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7935892583, username=testuser_7935892583
2025-07-29 17:29:04,960 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=154, telegram_id=7935892583
2025-07-29 17:29:05,214 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:05,225 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%97%86%EB%8A%94%EC%A2%85%EB%AA%A9 "HTTP/1.1 200 OK"
2025-07-29 17:29:05,241 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5309287184, username=testuser_5309287184
2025-07-29 17:29:05,249 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=156, telegram_id=5309287184
2025-07-29 17:29:05,539 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:05,546 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query= "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:29:05,560 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3145701482, username=testuser_3145701482
2025-07-29 17:29:05,568 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=158, telegram_id=3145701482
2025-07-29 17:29:05,838 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:05,848 - httpx - INFO - HTTP Request: GET http://testserver/symbols/005930/current_price_and_change "HTTP/1.1 200 OK"
2025-07-29 17:29:05,864 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8659012486, username=testuser_8659012486
2025-07-29 17:29:05,872 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=160, telegram_id=8659012486
2025-07-29 17:29:06,133 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:06,142 - httpx - INFO - HTTP Request: GET http://testserver/symbols/NONEXISTENT/current_price_and_change "HTTP/1.1 404 Not Found"
2025-07-29 17:29:06,154 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2987193147, username=testuser_2987193147
2025-07-29 17:29:06,161 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=162, telegram_id=2987193147
2025-07-29 17:29:06,413 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:06,773 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 17:29:06,788 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2964158427, username=testuser_2964158427
2025-07-29 17:29:06,795 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=165, telegram_id=2964158427
2025-07-29 17:29:07,044 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:07,293 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 400 Bad Request"
2025-07-29 17:29:07,302 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4301139939, username=testuser_4301139939
2025-07-29 17:29:07,310 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=168, telegram_id=4301139939
2025-07-29 17:29:07,564 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:08,063 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 17:29:08,078 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5654474978, username=testuser_5654474978
2025-07-29 17:29:08,085 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=171, telegram_id=5654474978
2025-07-29 17:29:08,140 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:08,150 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 17:29:08,161 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7860431361, username=testuser_7860431361
2025-07-29 17:29:08,168 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=173, telegram_id=7860431361
2025-07-29 17:29:07,962 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:08,455 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 17:29:08,466 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3092312387, username=testuser_3092312387
2025-07-29 17:29:08,472 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=176, telegram_id=3092312387
2025-07-29 17:29:08,709 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:08,981 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 178
2025-07-29 17:29:08,985 - src.api.services.user_service - DEBUG - User found by id: user_id=178
2025-07-29 17:29:08,991 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 17:29:09,006 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4977627850, username=testuser_4977627850
2025-07-29 17:29:09,014 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=179, telegram_id=4977627850
2025-07-29 17:29:09,321 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:09,326 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 403 Forbidden"
2025-07-29 17:29:09,339 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1743916700, username=testuser_1743916700
2025-07-29 17:29:09,345 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=181, telegram_id=1743916700
2025-07-29 17:29:09,597 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:09,847 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 183
2025-07-29 17:29:09,848 - src.api.services.user_service - DEBUG - User found by id: user_id=183
2025-07-29 17:29:09,860 - httpx - INFO - HTTP Request: PUT http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 17:29:09,871 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6469555149, username=testuser_6469555149
2025-07-29 17:29:09,877 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=184, telegram_id=6469555149
2025-07-29 17:29:10,126 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:10,141 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 17:29:10,153 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6499290477, username=testuser_6499290477
2025-07-29 17:29:10,159 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=187, telegram_id=6499290477
2025-07-29 17:29:10,404 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:10,678 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 17:29:10,691 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7593333903, username=testuser_7593333903
2025-07-29 17:29:10,698 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=190, telegram_id=7593333903
2025-07-29 17:29:10,945 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:11,195 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/192 "HTTP/1.1 200 OK"
2025-07-29 17:29:11,207 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5297400511, username=testuser_5297400511
2025-07-29 17:29:11,213 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=193, telegram_id=5297400511
2025-07-29 17:29:11,465 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:11,478 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:29:11,489 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5483571454, username=testuser_5483571454
2025-07-29 17:29:11,495 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=195, telegram_id=5483571454
2025-07-29 17:29:11,743 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:12,319 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 197
2025-07-29 17:29:12,321 - src.api.services.user_service - DEBUG - User found by id: user_id=197
2025-07-29 17:29:12,327 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 200 OK"
2025-07-29 17:29:12,339 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3380802150, username=testuser_3380802150
2025-07-29 17:29:12,349 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=199, telegram_id=3380802150
2025-07-29 17:29:12,598 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:12,856 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 201
2025-07-29 17:29:12,858 - src.api.services.user_service - DEBUG - User found by id: user_id=201
2025-07-29 17:29:12,860 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:29:12,872 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3964132055, username=testuser_3964132055
2025-07-29 17:29:12,879 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=202, telegram_id=3964132055
2025-07-29 17:29:13,124 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:13,134 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=204, symbol=005930
2025-07-29 17:29:13,143 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=204, symbol=005930
2025-07-29 17:29:13,145 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 17:29:13,151 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 시도: user_id=204
2025-07-29 17:29:13,153 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 성공: user_id=204, 1개 종목.
2025-07-29 17:29:13,154 - httpx - INFO - HTTP Request: GET http://testserver/watchlist/get/204 "HTTP/1.1 200 OK"
2025-07-29 17:29:13,161 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:13,162 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:29:13,163 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:29:13,167 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:29:13,171 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12345
2025-07-29 17:29:13,175 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=1, telegram_id=12345
2025-07-29 17:29:13,176 - src.api.services.price_alert_service - DEBUG - 사용자(1)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:29:13,179 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=1
2025-07-29 17:29:13,179 - src.api.services.price_alert_service - DEBUG - 가격 알림(1) 수정 시도: update_data={'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 17:29:13,183 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:29:13,183 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 17:29:13,183 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:29:13,187 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:29:13,187 - src.api.services.price_alert_service - INFO - 가격 알림(1) 수정 성공.
2025-07-29 17:29:13,188 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:29:13,194 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:29:13,194 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:29:13,199 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:29:13,199 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 17:29:13,201 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 17:29:13,202 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:29:13,203 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 17:29:13,203 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 17:29:13,204 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:29:13,205 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 17:29:13,205 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:29:13,212 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:29:13,212 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 17:29:13,214 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:29:13,217 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:29:13,217 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 17:29:13,219 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 17:29:13,219 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:29:13,221 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 17:29:13,222 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 17:29:13,224 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:29:13,224 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 17:29:13,225 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:29:13,234 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:29:13,235 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 17:29:13,237 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:29:13,256 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8649293651, username=testuser_8649293651
2025-07-29 17:29:13,263 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=205, telegram_id=8649293651
2025-07-29 17:29:13,265 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:13,268 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:29:13,269 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:29:13,272 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 8649293651
2025-07-29 17:29:13,276 - src.api.services.user_service - DEBUG - User not found for telegram_id: 8649293651
2025-07-29 17:29:13,276 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8649293651, username=testuser_8649293651
2025-07-29 17:29:13,285 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=232, telegram_id=8649293651
2025-07-29 17:29:13,286 - src.api.services.price_alert_service - DEBUG - 사용자(232)와 종목(GOOG)으로 가격 알림 조회 시도.
2025-07-29 17:29:13,289 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=232, symbol=GOOG
2025-07-29 17:29:13,289 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=232, symbol=GOOG, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:29:13,297 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=231, user_id=232, symbol=GOOG
2025-07-29 17:29:13,300 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:29:13,302 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:29:13,314 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7254407550, username=testuser_7254407550
2025-07-29 17:29:13,320 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=206, telegram_id=7254407550
2025-07-29 17:29:13,322 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:13,324 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:29:13,325 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:29:13,325 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 7254407550
2025-07-29 17:29:13,327 - src.api.services.user_service - DEBUG - User not found for telegram_id: 7254407550
2025-07-29 17:29:13,328 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7254407550, username=telegram_user_7254407550
2025-07-29 17:29:13,332 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=233, telegram_id=7254407550
2025-07-29 17:29:13,332 - src.api.services.price_alert_service - DEBUG - 사용자(233)와 종목(MSFT)으로 가격 알림 조회 시도.
2025-07-29 17:29:13,333 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=233, symbol=MSFT
2025-07-29 17:29:13,334 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=233, symbol=MSFT, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:29:13,338 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=232, user_id=233, symbol=MSFT
2025-07-29 17:29:13,339 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:29:13,341 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:29:13,353 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5505487789, username=testuser_5505487789
2025-07-29 17:29:13,360 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=207, telegram_id=5505487789
2025-07-29 17:29:13,366 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:13,368 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:29:13,369 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:29:13,370 - src.api.routers.bot_router - DEBUG - Before toggle: existing_alert.notify_on_disclosure = True
2025-07-29 17:29:13,370 - src.api.routers.bot_router - DEBUG - Calculated new_status: False
2025-07-29 17:29:13,370 - src.api.routers.bot_router - DEBUG - After update_alert call: updated_alert_orm.notify_on_disclosure = False
2025-07-29 17:29:13,371 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:29:13,373 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:29:13,386 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5375330294, username=testuser_5375330294
2025-07-29 17:29:13,395 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=208, telegram_id=5375330294
2025-07-29 17:29:13,399 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:13,402 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:29:13,403 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:29:13,403 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 5375330294
2025-07-29 17:29:13,405 - src.api.services.user_service - DEBUG - User not found for telegram_id: 5375330294
2025-07-29 17:29:13,406 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5375330294, username=telegram_user_5375330294
2025-07-29 17:29:13,413 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=234, telegram_id=5375330294
2025-07-29 17:29:13,414 - src.api.services.price_alert_service - DEBUG - 사용자(234)와 종목(NFLX)으로 가격 알림 조회 시도.
2025-07-29 17:29:13,416 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=234, symbol=NFLX
2025-07-29 17:29:13,417 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=234, symbol=NFLX, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:29:13,424 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=233, user_id=234, symbol=NFLX
2025-07-29 17:29:13,425 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:29:13,427 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:29:13,440 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9205034580, username=testuser_9205034580
2025-07-29 17:29:13,445 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=209, telegram_id=9205034580
2025-07-29 17:29:13,447 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:13,450 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:29:13,451 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:29:13,452 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 9205034580
2025-07-29 17:29:13,454 - src.api.services.user_service - DEBUG - User not found for telegram_id: 9205034580
2025-07-29 17:29:13,454 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9205034580, username=testuser_9205034580
2025-07-29 17:29:13,459 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=235, telegram_id=9205034580
2025-07-29 17:29:13,459 - src.api.services.price_alert_service - DEBUG - 사용자(235)와 종목(NVDA)으로 가격 알림 조회 시도.
2025-07-29 17:29:13,460 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=235, symbol=NVDA
2025-07-29 17:29:13,461 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=235, symbol=NVDA, target_price=1000.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:29:13,467 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=234, user_id=235, symbol=NVDA
2025-07-29 17:29:13,469 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:29:13,471 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:29:13,482 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2370654378, username=testuser_2370654378
2025-07-29 17:29:13,490 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=210, telegram_id=2370654378
2025-07-29 17:29:13,493 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:13,495 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:29:13,497 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:29:13,497 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 2370654378
2025-07-29 17:29:13,499 - src.api.services.user_service - DEBUG - User not found for telegram_id: 2370654378
2025-07-29 17:29:13,500 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2370654378, username=telegram_user_2370654378
2025-07-29 17:29:13,506 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=236, telegram_id=2370654378
2025-07-29 17:29:13,506 - src.api.services.price_alert_service - DEBUG - 사용자(236)와 종목(GOOGL)으로 가격 알림 조회 시도.
2025-07-29 17:29:13,507 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=236, symbol=GOOGL
2025-07-29 17:29:13,507 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=236, symbol=GOOGL, target_price=110.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=weekly
2025-07-29 17:29:13,512 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=235, user_id=236, symbol=GOOGL
2025-07-29 17:29:13,514 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:29:13,516 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:29:13,542 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6830811582, username=testuser_6830811582
2025-07-29 17:29:13,550 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=211, telegram_id=6830811582
2025-07-29 17:29:13,555 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:13,558 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:29:13,560 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:29:13,561 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 6830811582
2025-07-29 17:29:13,563 - src.api.services.user_service - DEBUG - User not found for telegram_id: 6830811582
2025-07-29 17:29:13,564 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6830811582, username=telegram_user_6830811582
2025-07-29 17:29:13,572 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=237, telegram_id=6830811582
2025-07-29 17:29:13,572 - src.api.services.price_alert_service - DEBUG - 사용자(237)와 종목(FB)으로 가격 알림 조회 시도.
2025-07-29 17:29:13,574 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=237, symbol=FB
2025-07-29 17:29:13,574 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=237, symbol=FB, target_price=300.0, condition=above, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:29:13,580 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=236, user_id=237, symbol=FB
2025-07-29 17:29:13,582 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:29:13,584 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:29:13,590 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:13,590 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:13,597 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:13,603 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:13,604 - src.common.dart_utils - ERROR - DART CORPCODE.xml 요청 실패: Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 25, in dart_get_all_stocks
    resp = await session.get(url, timeout=60)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 17:29:13,610 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:13,618 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:13,624 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:13,630 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:13,632 - src.common.dart_utils - ERROR - DART 공시 조회 API 요청 실패 (corp_code: 00123456): Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 79, in dart_get_disclosures
    resp = await session.get(url, params=params, timeout=10)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 17:29:13,638 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:13,641 - src.common.dart_utils - ERROR - DART 공시 API가 오류를 반환했습니다. status: 001, message: API 호출 오류, corp_code: 00123456
2025-07-29 17:29:13,818 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9088912085, username=testuser_9088912085
2025-07-29 17:29:13,826 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=212, telegram_id=9088912085
2025-07-29 17:29:14,077 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:14,325 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 17:29:14,570 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 17:29:14,574 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=214, symbol=005930
2025-07-29 17:29:14,581 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=214, symbol=005930
2025-07-29 17:29:14,583 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 17:29:14,586 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 214
2025-07-29 17:29:14,588 - src.api.services.user_service - DEBUG - User found by id: user_id=214
2025-07-29 17:29:14,589 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:29:14,590 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=214, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:29:14,597 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=11, user_id=214, symbol=005930
2025-07-29 17:29:14,599 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:29:14,600 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:29:14,603 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:29:14,604 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 17:29:14,605 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:29:14,606 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:29:15,311 - src.api.main - INFO - [APScheduler] 가격 알림 체크 잡 실행: 2025-07-29 17:29:15.311787
2025-07-29 17:29:15,313 - src.api.main - DEBUG - 활성 알림 수: 3
2025-07-29 17:29:15,314 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:29:15,314 - src.api.main - DEBUG - 종목 정상종목 현재가: 110
2025-07-29 17:29:15,316 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='139942653758288'>, 목표 가격: 100, 조건: gte, 반복 주기: <MagicMock name='mock.repeat_interval' id='139942655184272'>
2025-07-29 17:29:15,316 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목, 현재가: 110, 목표가: 100
2025-07-29 17:29:15,320 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='139942657614192'>)
2025-07-29 17:29:15,322 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 17:29:15,323 - src.api.main - DEBUG - 종목 오류종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:29:15,323 - src.api.main - ERROR - 가격 알림 확인 중 '오류종목' 처리 오류: 현재가 조회 실패
Traceback (most recent call last):
  File "/app/src/api/main.py", line 145, in check_price_alerts_job
    price_data = stock_service.get_current_price_and_change(symbol, db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1179, in _execute_mock_call
    result = effect(*args, **kwargs)
  File "/app/src/api/tests/test_main_jobs.py", line 34, in get_current_price_side_effect
    raise ValueError("현재가 조회 실패")
ValueError: 현재가 조회 실패
2025-07-29 17:29:15,324 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:29:15,324 - src.api.main - DEBUG - 종목 정상종목2 현재가: 290
2025-07-29 17:29:15,325 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='139942654501136'>, 목표 가격: 300, 조건: lte, 반복 주기: <MagicMock name='mock.repeat_interval' id='139942678578176'>
2025-07-29 17:29:15,326 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목2, 현재가: 290, 목표가: 300
2025-07-29 17:29:15,327 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='139942657614192'>)
2025-07-29 17:29:15,327 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 17:29:15,328 - src.api.main - DEBUG - 모든 가격 알림 체크 및 DB 커밋 완료.
2025-07-29 17:29:15,332 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:29:15,333 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(10일)
2025-07-29 17:29:15,337 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:29:15,338 - src.api.services.predict_service - ERROR - 예측 불가: 데이터 분석 실패
2025-07-29 17:29:15,345 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:29:15,345 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:29:15,355 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=buy, confidence=90, reason=단기 이동평균선이 장기 이동평균선 위에 있습니다 (골든 크로스 또는 정배열). 현재가가 단기 이동평균선 위에 있습니다. 단기 및 장기 이동평균선이 모두 상승 중입니다. RSI(100)가 70 이상으로 과매수 구간입니다. MACD가 시그널 라인 위에 있고 MACD 히스토그램이 양수입니다 (매수 신호).
2025-07-29 17:29:15,356 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: buy
2025-07-29 17:29:15,367 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:29:15,368 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:29:15,377 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, confidence=50, reason=단기 이동평균선이 장기 이동평균선 아래에 있습니다 (데드 크로스 또는 역배열). 현재가가 단기 이동평균선 아래에 있습니다. 단기 및 장기 이동평균선이 모두 하락 중입니다. RSI(0)가 30 이하로 과매도 구간입니다. MACD가 시그널 라인 아래에 있고 MACD 히스토그램이 음수입니다 (매도 신호).
2025-07-29 17:29:15,378 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 17:29:15,386 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:29:15,387 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:29:15,397 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, confidence=55, reason=단기 이동평균선과 장기 이동평균선이 수렴 중입니다 (횡보). RSI(47)는 중립 구간입니다. MACD가 시그널 라인 아래에 있고 MACD 히스토그램이 음수입니다 (매도 신호).
2025-07-29 17:29:15,398 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 17:29:15,411 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:29:15,412 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:29:15,421 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, confidence=50, reason=단기 이동평균선이 장기 이동평균선 아래에 있습니다 (데드 크로스 또는 역배열). 현재가가 단기 이동평균선 아래에 있습니다. 단기 및 장기 이동평균선이 모두 하락 중입니다. RSI(3)가 30 이하로 과매도 구간입니다. MACD가 시그널 라인 아래에 있고 MACD 히스토그램이 음수입니다 (매도 신호).
2025-07-29 17:29:15,421 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 17:29:15,432 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:29:15,432 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 22개 데이터.
2025-07-29 17:29:15,454 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, confidence=100, reason=단기 이동평균선이 장기 이동평균선 위에 있습니다 (골든 크로스 또는 정배열). 현재가가 단기 이동평균선 위에 있습니다. 단기 및 장기 이동평균선이 모두 상승 중입니다. RSI(100)가 70 이상으로 과매수 구간입니다. MACD가 시그널 라인 위에 있고 MACD 히스토그램이 양수입니다 (매수 신호). 급등 후 횡보 패턴 감지 (차익 실현 가능성).
2025-07-29 17:29:15,454 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 17:29:15,470 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:15,478 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:29:15,478 - src.api.services.stock_service - INFO - 신규 공시가 없습니다. (DB 기준: 202301010000001)
2025-07-29 17:29:15,489 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:15,494 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:29:15,500 - src.api.services.stock_service - INFO - 최초 실행. 기준 접수번호를 202301020000001로 DB에 설정합니다.
2025-07-29 17:29:15,502 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:29:15,502 - src.api.services.stock_service - INFO - 최초 실행. 기준 접수번호를 202301020000001로 DB에 설정합니다.
2025-07-29 17:29:15,511 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:15,520 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:29:15,520 - src.api.services.stock_service - INFO - 2건의 신규 공시를 발견했습니다.
2025-07-29 17:29:15,521 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 17:29:15,522 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 17:29:15,522 - src.api.services.stock_service - INFO - 마지막 확인 접수번호를 202301020000002로 DB에 갱신합니다.
2025-07-29 17:29:15,531 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:15,538 - src.api.services.stock_service - CRITICAL - DART API 사용 한도를 초과했습니다: [020] 사용 한도 초과
2025-07-29 17:29:15,545 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:15,549 - src.api.services.stock_service - ERROR - DART 공시 조회 중 API 오류 발생: [999] 기타 API 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 40, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
src.common.exceptions.DartApiError: [999] 기타 API 오류
2025-07-29 17:29:15,557 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:15,563 - src.api.services.stock_service - ERROR - 신규 공시 확인 및 알림 작업 중 예상치 못한 오류 발생: 예상치 못한 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 40, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: 예상치 못한 오류
2025-07-29 17:29:15,571 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:15,582 - src.api.services.stock_service - DEBUG - update_daily_prices 호출.
2025-07-29 17:29:15,583 - src.api.services.stock_service - DEBUG - DB에서 2개 종목 가져옴.
2025-07-29 17:29:15,584 - src.api.services.stock_service - DEBUG - 종목 005930 (삼성전자) 일별시세 갱신 시작.
2025-07-29 17:29:15,587 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 005930 - 2025-07-29
2025-07-29 17:29:15,589 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 005930 - 2025-07-28
2025-07-29 17:29:15,590 - src.api.services.stock_service - DEBUG - 종목 000660 (SK하이닉스) 일별시세 갱신 시작.
2025-07-29 17:29:15,592 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 000660 - 2025-07-29
2025-07-29 17:29:15,594 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 000660 - 2025-07-28
2025-07-29 17:29:15,601 - src.api.services.stock_service - INFO - 일별시세 갱신 완료: 4개 데이터 처리. 오류: 0개 종목
2025-07-29 17:29:15,613 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:15,624 - src.api.services.stock_service - DEBUG - update_daily_prices 호출.
2025-07-29 17:29:15,626 - src.api.services.stock_service - DEBUG - DB에서 1개 종목 가져옴.
2025-07-29 17:29:15,627 - src.api.services.stock_service - DEBUG - 종목 005930 (삼성전자) 일별시세 갱신 시작.
2025-07-29 17:29:15,627 - src.api.services.stock_service - WARNING - 종목 005930에 대한 일별시세 데이터가 없습니다.
2025-07-29 17:29:15,627 - src.api.services.stock_service - INFO - 일별시세 갱신 완료: 0개 데이터 처리. 오류: 1개 종목
2025-07-29 17:29:15,637 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:15,643 - src.api.services.stock_service - DEBUG - update_daily_prices 호출.
2025-07-29 17:29:15,644 - src.api.services.stock_service - DEBUG - DB에서 1개 종목 가져옴.
2025-07-29 17:29:15,645 - src.api.services.stock_service - DEBUG - 종목 005930 (삼성전자) 일별시세 갱신 시작.
2025-07-29 17:29:15,645 - src.api.services.stock_service - ERROR - 일별시세 갱신 중 '005930' 처리에서 오류 발생: API Error
2025-07-29 17:29:15,646 - src.api.services.stock_service - INFO - 일별시세 갱신 완료: 0개 데이터 처리. 오류: 1개 종목
2025-07-29 17:29:15,656 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:15,663 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:29:15,665 - src.api.services.stock_service - DEBUG - 현재가 발견: 005930 - 71500.0
2025-07-29 17:29:15,665 - src.api.services.stock_service - DEBUG - 전일 종가 발견: 005930 - 70500.0
2025-07-29 17:29:15,678 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:15,680 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=NONEXIST
2025-07-29 17:29:15,683 - src.api.services.stock_service - WARNING - 현재가 없음: NONEXIST.
2025-07-29 17:29:15,692 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:29:15,700 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:29:15,703 - src.api.services.stock_service - DEBUG - 현재가 발견: 005930 - 71500.0
2025-07-29 17:29:15,703 - src.api.services.stock_service - WARNING - 전일 종가 없음: 005930. 등락률 계산 불가.
2025-07-29 17:32:18,207 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 17:32:18,216 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 17:32:18,221 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:32:18,221 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:32:18,223 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:32:18,223 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:32:19,131 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:19,136 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 17:32:19,229 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-07-29 17:32:19,231 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '<unknown>'
2025-07-29 17:32:19,232 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-07-29 17:32:19,614 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:19,618 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:32:19,871 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:19,875 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 17:32:20,125 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:20,129 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 17:32:20,131 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 17:32:20,140 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3172625975, username=testuser_3172625975
2025-07-29 17:32:20,152 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=1, telegram_id=3172625975
2025-07-29 17:32:20,397 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:20,677 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 200 OK"
2025-07-29 17:32:20,696 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2543648236, username=testuser_2543648236
2025-07-29 17:32:20,704 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=3, telegram_id=2543648236
2025-07-29 17:32:21,001 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:21,247 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 17:32:21,259 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7299234221, username=testuser_7299234221
2025-07-29 17:32:21,264 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=5, telegram_id=7299234221
2025-07-29 17:32:21,505 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:21,512 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 17:32:21,521 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4893924067, username=testuser_4893924067
2025-07-29 17:32:21,527 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=7, telegram_id=4893924067
2025-07-29 17:32:21,771 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:22,023 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 200 OK"
2025-07-29 17:32:22,034 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5700224854, username=testuser_5700224854
2025-07-29 17:32:22,040 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=9, telegram_id=5700224854
2025-07-29 17:32:22,301 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:22,557 - src.api.routers.admin - ERROR - /admin/update_master 서버 오류: DB connection error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 36, in update_stock_master
    result = await stock_service.update_stock_master(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DB connection error
2025-07-29 17:32:22,559 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:32:22,570 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5290503584, username=testuser_5290503584
2025-07-29 17:32:22,577 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=11, telegram_id=5290503584
2025-07-29 17:32:22,825 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:23,107 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 17:32:23,121 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1736706496, username=testuser_1736706496
2025-07-29 17:32:23,129 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=13, telegram_id=1736706496
2025-07-29 17:32:23,383 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:23,389 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 17:32:23,398 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4208605380, username=testuser_4208605380
2025-07-29 17:32:23,404 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=15, telegram_id=4208605380
2025-07-29 17:32:23,645 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:23,899 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 200 OK"
2025-07-29 17:32:23,911 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9596633526, username=testuser_9596633526
2025-07-29 17:32:23,917 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=17, telegram_id=9596633526
2025-07-29 17:32:24,286 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:24,616 - src.api.routers.admin - ERROR - /admin/update_price 서버 오류: API call failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 53, in update_daily_price
    result = await stock_service.update_daily_prices(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: API call failed
2025-07-29 17:32:24,618 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:32:24,638 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7236917599, username=testuser_7236917599
2025-07-29 17:32:24,647 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=19, telegram_id=7236917599
2025-07-29 17:32:24,904 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:25,196 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 17:32:25,206 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3679980115, username=testuser_3679980115
2025-07-29 17:32:25,211 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=21, telegram_id=3679980115
2025-07-29 17:32:25,521 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:25,534 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 17:32:25,549 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7838830119, username=testuser_7838830119
2025-07-29 17:32:25,557 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=23, telegram_id=7838830119
2025-07-29 17:32:25,809 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:26,066 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f76595a8ca0>
2025-07-29 17:32:26,066 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:32:26,074 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 200 OK"
2025-07-29 17:32:26,098 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6170474151, username=testuser_6170474151
2025-07-29 17:32:26,111 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=25, telegram_id=6170474151
2025-07-29 17:32:26,377 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:26,647 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f76595a8d90>
2025-07-29 17:32:26,648 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:32:26,652 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 200 OK"
2025-07-29 17:32:26,669 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9580676582, username=testuser_9580676582
2025-07-29 17:32:26,678 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=27, telegram_id=9580676582
2025-07-29 17:32:26,981 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:27,250 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f76593e9c60>
2025-07-29 17:32:27,253 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:32:27,256 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=%EC%B9%B4%EC%B9%B4%EC%98%A4 "HTTP/1.1 200 OK"
2025-07-29 17:32:27,280 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9956867056, username=testuser_9956867056
2025-07-29 17:32:27,290 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=29, telegram_id=9956867056
2025-07-29 17:32:27,577 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:27,853 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f7659546590>
2025-07-29 17:32:27,854 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:32:27,857 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=0013456 "HTTP/1.1 200 OK"
2025-07-29 17:32:27,878 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1532125183, username=testuser_1532125183
2025-07-29 17:32:27,886 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=31, telegram_id=1532125183
2025-07-29 17:32:28,162 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:28,547 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f765946c6d0>
2025-07-29 17:32:28,547 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:32:28,550 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=NONEXIST "HTTP/1.1 404 Not Found"
2025-07-29 17:32:28,578 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7247909073, username=testuser_7247909073
2025-07-29 17:32:28,585 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=33, telegram_id=7247909073
2025-07-29 17:32:28,840 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:29,150 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f76595a8ac0>
2025-07-29 17:32:29,150 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:32:29,151 - src.api.routers.admin - ERROR - /admin/update_disclosure 서버 오류: DART API error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 126, in update_disclosure
    result = await stock_service.update_disclosures(db, corp_code=corp_code, stock_code=stock_code or '', stock_name=stock_name or '')
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DART API error
2025-07-29 17:32:29,154 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:32:29,186 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1370457119, username=testuser_1370457119
2025-07-29 17:32:29,199 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=35, telegram_id=1370457119
2025-07-29 17:32:29,487 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:29,748 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 17:32:29,766 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9552246013, username=testuser_9552246013
2025-07-29 17:32:29,783 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=37, telegram_id=9552246013
2025-07-29 17:32:30,128 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:30,139 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 17:32:30,164 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3855395870, username=testuser_3855395870
2025-07-29 17:32:30,179 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=39, telegram_id=3855395870
2025-07-29 17:32:30,478 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:30,795 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:32:30,813 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3927636221, username=testuser_3927636221
2025-07-29 17:32:30,821 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=41, telegram_id=3927636221
2025-07-29 17:32:31,109 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:31,451 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:32:31,480 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6523223860, username=testuser_6523223860
2025-07-29 17:32:31,493 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=43, telegram_id=6523223860
2025-07-29 17:32:31,822 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:32,090 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 17:32:32,103 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4318257061, username=testuser_4318257061
2025-07-29 17:32:32,109 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=45, telegram_id=4318257061
2025-07-29 17:32:32,373 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:32,379 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 17:32:32,391 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1979295641, username=testuser_1979295641
2025-07-29 17:32:32,397 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=47, telegram_id=1979295641
2025-07-29 17:32:32,751 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:33,029 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 17:32:33,030 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 17:32:33,053 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2356707335, username=testuser_2356707335
2025-07-29 17:32:33,061 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=49, telegram_id=2356707335
2025-07-29 17:32:32,579 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:32,853 - src.api.routers.admin - ERROR - [trigger_job] 잡 실행 실패: test_job - Job execution failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 175, in trigger_job
    job.func(*job.args, **job.kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: Job execution failed

2025-07-29 17:32:32,854 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:32:32,866 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9156888597, username=testuser_9156888597
2025-07-29 17:32:32,872 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=51, telegram_id=9156888597
2025-07-29 17:32:33,150 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:33,412 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 17:32:33,425 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1789287527, username=testuser_1789287527
2025-07-29 17:32:33,433 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=53, telegram_id=1789287527
2025-07-29 17:32:33,705 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:33,712 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 17:32:33,729 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8694763876, username=testuser_8694763876
2025-07-29 17:32:33,738 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=55, telegram_id=8694763876
2025-07-29 17:32:34,003 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:34,280 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 17:32:34,282 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 200 OK"
2025-07-29 17:32:34,294 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9015037893, username=testuser_9015037893
2025-07-29 17:32:34,300 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=57, telegram_id=9015037893
2025-07-29 17:32:34,557 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:34,826 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 17:32:34,826 - src.api.routers.admin - ERROR - 공시 확인 잡 수동 실행 중 오류 발생: Disclosure check failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 193, in trigger_check_disclosures_job
    await stock_service.check_and_notify_new_disclosures(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: Disclosure check failed
2025-07-29 17:32:34,830 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:32:34,845 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5354299089, username=testuser_5354299089
2025-07-29 17:32:34,854 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=59, telegram_id=5354299089
2025-07-29 17:32:35,116 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:35,505 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 17:32:35,521 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1431241804, username=testuser_1431241804
2025-07-29 17:32:35,530 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=61, telegram_id=1431241804
2025-07-29 17:32:35,791 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:35,798 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 17:32:35,810 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3050732319, username=testuser_3050732319
2025-07-29 17:32:35,818 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=63, telegram_id=3050732319
2025-07-29 17:32:36,095 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:36,372 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:32:36,377 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=65, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:32:36,391 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=1, user_id=65, symbol=005930
2025-07-29 17:32:36,394 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:32:36,430 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3770369179, username=testuser_3770369179
2025-07-29 17:32:36,439 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=66, telegram_id=3770369179
2025-07-29 17:32:36,721 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:36,729 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:32:36,746 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7416815324, username=testuser_7416815324
2025-07-29 17:32:36,754 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=68, telegram_id=7416815324
2025-07-29 17:32:37,060 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:37,328 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:32:37,329 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:32:37,343 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8686893350, username=testuser_8686893350
2025-07-29 17:32:37,351 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=71, telegram_id=8686893350
2025-07-29 17:32:37,623 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:37,913 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:32:37,914 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:32:37,922 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=2, user_id=73, symbol=005930
2025-07-29 17:32:37,924 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:32:37,928 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:32:37,931 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=035720, target_price=50000.0, condition=lte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:32:37,938 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=3, user_id=73, symbol=035720
2025-07-29 17:32:37,941 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:32:37,944 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:32:37,946 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 조회 시도.
2025-07-29 17:32:37,951 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 2개 조회됨.
2025-07-29 17:32:37,954 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:32:37,968 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7847514083, username=testuser_7847514083
2025-07-29 17:32:37,976 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=74, telegram_id=7847514083
2025-07-29 17:32:38,275 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:38,548 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:32:38,549 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 조회 시도.
2025-07-29 17:32:38,551 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 0개 조회됨.
2025-07-29 17:32:38,553 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:32:38,569 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3651743285, username=testuser_3651743285
2025-07-29 17:32:38,577 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=77, telegram_id=3651743285
2025-07-29 17:32:38,847 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:38,852 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:32:38,867 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9944529184, username=testuser_9944529184
2025-07-29 17:32:38,874 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=79, telegram_id=9944529184
2025-07-29 17:32:39,141 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:39,442 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:32:39,443 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=81, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:32:39,451 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=4, user_id=81, symbol=005930
2025-07-29 17:32:39,454 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:32:39,460 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:32:39,461 - src.api.services.price_alert_service - DEBUG - 사용자(81)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:32:39,466 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=4
2025-07-29 17:32:39,470 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/81/symbol/005930 "HTTP/1.1 200 OK"
2025-07-29 17:32:39,501 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2950286820, username=testuser_2950286820
2025-07-29 17:32:39,512 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=82, telegram_id=2950286820
2025-07-29 17:32:39,879 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:40,188 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:32:40,189 - src.api.services.price_alert_service - DEBUG - 사용자(84)와 종목(NONEXISTENT)으로 가격 알림 조회 시도.
2025-07-29 17:32:40,191 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=84, symbol=NONEXISTENT
2025-07-29 17:32:40,193 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/84/symbol/NONEXISTENT "HTTP/1.1 404 Not Found"
2025-07-29 17:32:40,205 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6629199779, username=testuser_6629199779
2025-07-29 17:32:40,212 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=85, telegram_id=6629199779
2025-07-29 17:32:40,468 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:40,746 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:32:40,748 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=87, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:32:40,754 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=5, user_id=87, symbol=005930
2025-07-29 17:32:40,755 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:32:40,759 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:32:40,766 - src.api.services.price_alert_service - DEBUG - 가격 알림(5) 수정 시도: update_data={'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 17:32:40,769 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:32:40,769 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 17:32:40,769 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:32:40,777 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:32:40,777 - src.api.services.price_alert_service - INFO - 가격 알림(5) 수정 성공.
2025-07-29 17:32:40,781 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/5 "HTTP/1.1 200 OK"
2025-07-29 17:32:40,797 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5020313089, username=testuser_5020313089
2025-07-29 17:32:40,804 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=88, telegram_id=5020313089
2025-07-29 17:32:41,071 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:41,341 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:32:41,342 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=90, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:32:41,348 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=6, user_id=90, symbol=005930
2025-07-29 17:32:41,350 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:32:41,353 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/6 "HTTP/1.1 403 Forbidden"
2025-07-29 17:32:41,368 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4614440541, username=testuser_4614440541
2025-07-29 17:32:41,374 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=91, telegram_id=4614440541
2025-07-29 17:32:41,648 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:41,934 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:32:41,934 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 17:32:41,937 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 17:32:41,939 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:32:41,954 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8424397971, username=testuser_8424397971
2025-07-29 17:32:41,962 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=94, telegram_id=8424397971
2025-07-29 17:32:42,243 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:42,855 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:32:42,857 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=96, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:32:42,883 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=7, user_id=96, symbol=005930
2025-07-29 17:32:42,885 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:32:42,899 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:32:42,900 - src.api.services.price_alert_service - DEBUG - 가격 알림(7) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 17:32:42,903 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:32:42,903 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0}
2025-07-29 17:32:42,904 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:32:42,917 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:32:42,918 - src.api.services.price_alert_service - INFO - 가격 알림(7) 수정 성공.
2025-07-29 17:32:42,923 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/7 "HTTP/1.1 403 Forbidden"
2025-07-29 17:32:42,957 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8555836420, username=testuser_8555836420
2025-07-29 17:32:42,966 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=98, telegram_id=8555836420
2025-07-29 17:32:43,294 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:43,757 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:32:43,759 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=100, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:32:43,778 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=8, user_id=100, symbol=005930
2025-07-29 17:32:43,782 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:32:43,786 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:32:43,795 - src.api.services.price_alert_service - DEBUG - 가격 알림(8) 삭제 시도.
2025-07-29 17:32:43,803 - src.api.services.price_alert_service - INFO - 가격 알림(8) 삭제 성공.
2025-07-29 17:32:43,806 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/8 "HTTP/1.1 200 OK"
2025-07-29 17:32:43,836 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1551438589, username=testuser_1551438589
2025-07-29 17:32:43,845 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=101, telegram_id=1551438589
2025-07-29 17:32:44,189 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:44,514 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:32:44,516 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=103, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:32:44,528 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=9, user_id=103, symbol=005930
2025-07-29 17:32:44,531 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:32:44,539 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/9 "HTTP/1.1 403 Forbidden"
2025-07-29 17:32:44,565 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8732760304, username=testuser_8732760304
2025-07-29 17:32:44,576 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=104, telegram_id=8732760304
2025-07-29 17:32:44,900 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:45,234 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:32:45,245 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 삭제 시도.
2025-07-29 17:32:45,247 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 17:32:45,249 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:32:45,263 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2469371039, username=testuser_2469371039
2025-07-29 17:32:45,271 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=107, telegram_id=2469371039
2025-07-29 17:32:45,559 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:46,158 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:32:46,159 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=109, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:32:46,167 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=10, user_id=109, symbol=005930
2025-07-29 17:32:46,170 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:32:46,175 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:32:46,182 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/10 "HTTP/1.1 403 Forbidden"
2025-07-29 17:32:46,199 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3659163146, username=testuser_3659163146
2025-07-29 17:32:46,209 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=111, telegram_id=3659163146
2025-07-29 17:32:46,520 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:46,532 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 17:32:46,553 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4822684435, username=testuser_4822684435
2025-07-29 17:32:46,561 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=113, telegram_id=4822684435
2025-07-29 17:32:46,894 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:46,904 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 17:32:46,914 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:46,920 - httpx - INFO - HTTP Request: GET http://testserver/ "HTTP/1.1 200 OK"
2025-07-29 17:32:46,936 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8684734348, username=testuser_8684734348
2025-07-29 17:32:46,945 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=115, telegram_id=8684734348
2025-07-29 17:32:47,250 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:47,256 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:32:47,264 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:32:47,264 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 17:32:47,273 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:32:47,273 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:32:47,275 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 17:32:47,292 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3376503546, username=testuser_3376503546
2025-07-29 17:32:47,300 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=117, telegram_id=3376503546
2025-07-29 17:32:47,603 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:47,610 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:32:47,616 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=INVALID
2025-07-29 17:32:47,616 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=INVALID, days=40
2025-07-29 17:32:47,619 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:32:47,620 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:32:47,621 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 17:32:47,636 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1038830880, username=testuser_1038830880
2025-07-29 17:32:47,644 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=119, telegram_id=1038830880
2025-07-29 17:32:47,943 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:47,948 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:32:47,955 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:32:47,978 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5908873525, username=testuser_5908873525
2025-07-29 17:32:47,987 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=121, telegram_id=5908873525
2025-07-29 17:32:48,260 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:48,709 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=123, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:32:48,716 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 17:32:48,726 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:32:48,729 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/123 "HTTP/1.1 200 OK"
2025-07-29 17:32:48,750 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5700362865, username=testuser_5700362865
2025-07-29 17:32:48,767 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=124, telegram_id=5700362865
2025-07-29 17:32:49,066 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:49,074 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=99999, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:32:49,077 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 17:32:49,079 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:32:49,081 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/99999 "HTTP/1.1 200 OK"
2025-07-29 17:32:49,096 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5608245943, username=testuser_5608245943
2025-07-29 17:32:49,108 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=126, telegram_id=5608245943
2025-07-29 17:32:49,464 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:49,813 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=128, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:32:49,817 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 17:32:49,819 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:32:49,822 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/128 "HTTP/1.1 200 OK"
2025-07-29 17:32:49,842 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1870372121, username=testuser_1870372121
2025-07-29 17:32:49,852 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=129, telegram_id=1870372121
2025-07-29 17:32:50,140 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:50,499 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=1, page_size=5, symbol=None, prediction=None
2025-07-29 17:32:50,502 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 17:32:50,504 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 1, 페이지 크기 5).
2025-07-29 17:32:50,507 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=1&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 17:32:50,513 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=2, page_size=5, symbol=None, prediction=None
2025-07-29 17:32:50,517 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 17:32:50,520 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 2, 페이지 크기 5).
2025-07-29 17:32:50,522 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=2&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 17:32:50,539 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7396967298, username=testuser_7396967298
2025-07-29 17:32:50,545 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=132, telegram_id=7396967298
2025-07-29 17:32:50,876 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:51,220 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=134, page=1, page_size=10, symbol=005930, prediction=None
2025-07-29 17:32:51,221 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 17:32:51,226 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 17:32:51,230 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:32:51,232 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/134?symbol=005930 "HTTP/1.1 200 OK"
2025-07-29 17:32:51,249 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8751738997, username=testuser_8751738997
2025-07-29 17:32:51,257 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=135, telegram_id=8751738997
2025-07-29 17:32:51,570 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:51,926 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=137, page=1, page_size=10, symbol=None, prediction=상승
2025-07-29 17:32:51,927 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=상승
2025-07-29 17:32:51,932 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 17:32:51,936 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:32:51,939 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/137?prediction=%EC%83%81%EC%8A%B9 "HTTP/1.1 200 OK"
2025-07-29 17:32:51,960 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4557201606, username=testuser_4557201606
2025-07-29 17:32:51,970 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=138, telegram_id=4557201606
2025-07-29 17:32:52,274 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:52,561 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=140, page=1, page_size=10, symbol=005930, prediction=유지
2025-07-29 17:32:52,562 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 17:32:52,562 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=유지
2025-07-29 17:32:52,567 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 17:32:52,569 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:32:52,571 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/140?symbol=005930&prediction=%EC%9C%A0%EC%A7%80 "HTTP/1.1 200 OK"
2025-07-29 17:32:52,586 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1518549292, username=testuser_1518549292
2025-07-29 17:32:52,593 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=141, telegram_id=1518549292
2025-07-29 17:32:52,886 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:52,898 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=143, symbol=005930, trade_type=buy
2025-07-29 17:32:52,899 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:32:52,901 - src.api.services.stock_service - WARNING - 현재가 없음: 005930.
2025-07-29 17:32:52,902 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: None
2025-07-29 17:32:52,908 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=143, symbol=005930, trade_type=buy
2025-07-29 17:32:52,909 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 17:32:52,914 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=143
2025-07-29 17:32:52,917 - src.api.routers.simulated_trade - DEBUG - 사용자(143)의 모의매매 이력 1건 조회됨.
2025-07-29 17:32:52,918 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 17:32:52,919 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/143 "HTTP/1.1 200 OK"
2025-07-29 17:32:52,938 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7711864093, username=testuser_7711864093
2025-07-29 17:32:52,946 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=144, telegram_id=7711864093
2025-07-29 17:32:53,312 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:53,338 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 17:32:53,352 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9330592886, username=testuser_9330592886
2025-07-29 17:32:53,359 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=146, telegram_id=9330592886
2025-07-29 17:32:53,689 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:53,701 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 17:32:53,720 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7103163422, username=testuser_7103163422
2025-07-29 17:32:53,736 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=148, telegram_id=7103163422
2025-07-29 17:32:54,108 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:54,146 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%82%BC%EC%84%B1%EC%A0%84%EC%9E%90 "HTTP/1.1 200 OK"
2025-07-29 17:32:54,172 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6185312637, username=testuser_6185312637
2025-07-29 17:32:54,180 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=150, telegram_id=6185312637
2025-07-29 17:32:54,554 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:54,580 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=035720 "HTTP/1.1 200 OK"
2025-07-29 17:32:54,597 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2555654188, username=testuser_2555654188
2025-07-29 17:32:54,605 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=152, telegram_id=2555654188
2025-07-29 17:32:54,918 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:54,949 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=sk%ED%95%98%EC%9D%B4%EB%8B%89%EC%8A%A4 "HTTP/1.1 200 OK"
2025-07-29 17:32:54,972 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1590686758, username=testuser_1590686758
2025-07-29 17:32:54,982 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=154, telegram_id=1590686758
2025-07-29 17:32:55,329 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:55,346 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%97%86%EB%8A%94%EC%A2%85%EB%AA%A9 "HTTP/1.1 200 OK"
2025-07-29 17:32:55,376 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6068494449, username=testuser_6068494449
2025-07-29 17:32:55,389 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=156, telegram_id=6068494449
2025-07-29 17:32:55,753 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:55,761 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query= "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:32:55,804 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5234397366, username=testuser_5234397366
2025-07-29 17:32:55,819 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=158, telegram_id=5234397366
2025-07-29 17:32:56,137 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:56,163 - httpx - INFO - HTTP Request: GET http://testserver/symbols/005930/current_price_and_change "HTTP/1.1 200 OK"
2025-07-29 17:32:56,213 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9342674985, username=testuser_9342674985
2025-07-29 17:32:56,229 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=160, telegram_id=9342674985
2025-07-29 17:32:56,557 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:56,753 - httpx - INFO - HTTP Request: GET http://testserver/symbols/NONEXISTENT/current_price_and_change "HTTP/1.1 404 Not Found"
2025-07-29 17:32:56,781 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3989228088, username=testuser_3989228088
2025-07-29 17:32:56,792 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=162, telegram_id=3989228088
2025-07-29 17:32:57,150 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:57,530 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 17:32:57,556 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1096971962, username=testuser_1096971962
2025-07-29 17:32:57,577 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=165, telegram_id=1096971962
2025-07-29 17:32:58,007 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:58,569 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 400 Bad Request"
2025-07-29 17:32:58,624 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2018074185, username=testuser_2018074185
2025-07-29 17:32:58,638 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=168, telegram_id=2018074185
2025-07-29 17:32:59,064 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:32:59,735 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 17:32:59,776 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1347918638, username=testuser_1347918638
2025-07-29 17:32:59,790 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=171, telegram_id=1347918638
2025-07-29 17:33:00,150 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:00,162 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 17:33:00,180 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2709040340, username=testuser_2709040340
2025-07-29 17:33:00,190 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=173, telegram_id=2709040340
2025-07-29 17:33:00,527 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:01,150 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 17:33:01,168 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3776671542, username=testuser_3776671542
2025-07-29 17:33:01,178 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=176, telegram_id=3776671542
2025-07-29 17:33:01,507 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:01,792 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 178
2025-07-29 17:33:01,796 - src.api.services.user_service - DEBUG - User found by id: user_id=178
2025-07-29 17:33:01,805 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 17:33:01,820 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8789471881, username=testuser_8789471881
2025-07-29 17:33:01,828 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=179, telegram_id=8789471881
2025-07-29 17:33:02,106 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:02,112 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 403 Forbidden"
2025-07-29 17:33:02,128 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9348224318, username=testuser_9348224318
2025-07-29 17:33:02,135 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=181, telegram_id=9348224318
2025-07-29 17:33:02,105 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:01,916 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 183
2025-07-29 17:33:01,918 - src.api.services.user_service - DEBUG - User found by id: user_id=183
2025-07-29 17:33:01,932 - httpx - INFO - HTTP Request: PUT http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 17:33:01,949 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6009061897, username=testuser_6009061897
2025-07-29 17:33:01,955 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=184, telegram_id=6009061897
2025-07-29 17:33:02,367 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:02,383 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 17:33:02,401 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5088191143, username=testuser_5088191143
2025-07-29 17:33:02,408 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=187, telegram_id=5088191143
2025-07-29 17:33:02,763 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:03,036 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 17:33:03,046 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4138781138, username=testuser_4138781138
2025-07-29 17:33:03,052 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=190, telegram_id=4138781138
2025-07-29 17:33:03,297 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:03,556 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/192 "HTTP/1.1 200 OK"
2025-07-29 17:33:03,568 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8337002282, username=testuser_8337002282
2025-07-29 17:33:03,573 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=193, telegram_id=8337002282
2025-07-29 17:33:03,830 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:03,837 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:33:03,846 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2818454793, username=testuser_2818454793
2025-07-29 17:33:03,852 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=195, telegram_id=2818454793
2025-07-29 17:33:04,099 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:04,593 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 197
2025-07-29 17:33:04,595 - src.api.services.user_service - DEBUG - User found by id: user_id=197
2025-07-29 17:33:04,600 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 200 OK"
2025-07-29 17:33:04,612 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6404739300, username=testuser_6404739300
2025-07-29 17:33:04,618 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=199, telegram_id=6404739300
2025-07-29 17:33:04,896 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:05,198 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 201
2025-07-29 17:33:05,200 - src.api.services.user_service - DEBUG - User found by id: user_id=201
2025-07-29 17:33:05,203 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:33:05,216 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8370171248, username=testuser_8370171248
2025-07-29 17:33:05,222 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=202, telegram_id=8370171248
2025-07-29 17:33:05,530 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:05,544 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=204, symbol=005930
2025-07-29 17:33:05,553 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=204, symbol=005930
2025-07-29 17:33:05,554 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 17:33:05,560 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 시도: user_id=204
2025-07-29 17:33:05,562 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 성공: user_id=204, 1개 종목.
2025-07-29 17:33:05,565 - httpx - INFO - HTTP Request: GET http://testserver/watchlist/get/204 "HTTP/1.1 200 OK"
2025-07-29 17:33:05,573 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:05,576 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:33:05,577 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:33:05,582 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:33:05,587 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12345
2025-07-29 17:33:05,591 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=1, telegram_id=12345
2025-07-29 17:33:05,592 - src.api.services.price_alert_service - DEBUG - 사용자(1)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:33:05,596 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=1
2025-07-29 17:33:05,596 - src.api.services.price_alert_service - DEBUG - 가격 알림(1) 수정 시도: update_data={'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 17:33:05,600 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:33:05,600 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 17:33:05,600 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:33:05,605 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:33:05,606 - src.api.services.price_alert_service - INFO - 가격 알림(1) 수정 성공.
2025-07-29 17:33:05,607 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:33:05,614 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:33:05,614 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:33:05,617 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:33:05,618 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 17:33:05,620 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 17:33:05,620 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:33:05,622 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 17:33:05,623 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 17:33:05,624 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:33:05,624 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 17:33:05,624 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:33:05,631 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:33:05,632 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 17:33:05,633 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:33:05,636 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:33:05,637 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 17:33:05,638 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 17:33:05,639 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:33:05,640 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 17:33:05,641 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 17:33:05,642 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:33:05,643 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 17:33:05,643 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:33:05,649 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:33:05,649 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 17:33:05,650 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:33:05,679 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6411838914, username=testuser_6411838914
2025-07-29 17:33:05,686 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=205, telegram_id=6411838914
2025-07-29 17:33:05,688 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:05,690 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:33:05,692 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:33:05,696 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 6411838914
2025-07-29 17:33:05,700 - src.api.services.user_service - DEBUG - User not found for telegram_id: 6411838914
2025-07-29 17:33:05,701 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6411838914, username=testuser_6411838914
2025-07-29 17:33:05,709 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=238, telegram_id=6411838914
2025-07-29 17:33:05,710 - src.api.services.price_alert_service - DEBUG - 사용자(238)와 종목(GOOG)으로 가격 알림 조회 시도.
2025-07-29 17:33:05,712 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=238, symbol=GOOG
2025-07-29 17:33:05,713 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=238, symbol=GOOG, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:33:05,722 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=237, user_id=238, symbol=GOOG
2025-07-29 17:33:05,723 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:33:05,725 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:33:05,741 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3340072359, username=testuser_3340072359
2025-07-29 17:33:05,747 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=206, telegram_id=3340072359
2025-07-29 17:33:05,750 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:05,753 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:33:05,754 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:33:05,755 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 3340072359
2025-07-29 17:33:05,757 - src.api.services.user_service - DEBUG - User not found for telegram_id: 3340072359
2025-07-29 17:33:05,757 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3340072359, username=telegram_user_3340072359
2025-07-29 17:33:05,762 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=239, telegram_id=3340072359
2025-07-29 17:33:05,763 - src.api.services.price_alert_service - DEBUG - 사용자(239)와 종목(MSFT)으로 가격 알림 조회 시도.
2025-07-29 17:33:05,765 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=239, symbol=MSFT
2025-07-29 17:33:05,766 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=239, symbol=MSFT, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:33:05,772 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=238, user_id=239, symbol=MSFT
2025-07-29 17:33:05,775 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:33:05,777 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:33:05,794 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6213213059, username=testuser_6213213059
2025-07-29 17:33:05,801 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=207, telegram_id=6213213059
2025-07-29 17:33:05,808 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:05,815 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:33:05,817 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:33:05,819 - src.api.routers.bot_router - DEBUG - Before toggle: existing_alert.notify_on_disclosure = True
2025-07-29 17:33:05,819 - src.api.routers.bot_router - DEBUG - Calculated new_status: False
2025-07-29 17:33:05,820 - src.api.routers.bot_router - DEBUG - After update_alert call: updated_alert_orm.notify_on_disclosure = False
2025-07-29 17:33:05,821 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:33:05,824 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:33:05,841 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3596209082, username=testuser_3596209082
2025-07-29 17:33:05,852 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=208, telegram_id=3596209082
2025-07-29 17:33:05,858 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:05,862 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:33:05,864 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:33:05,866 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 3596209082
2025-07-29 17:33:05,871 - src.api.services.user_service - DEBUG - User not found for telegram_id: 3596209082
2025-07-29 17:33:05,872 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3596209082, username=telegram_user_3596209082
2025-07-29 17:33:05,882 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=240, telegram_id=3596209082
2025-07-29 17:33:05,882 - src.api.services.price_alert_service - DEBUG - 사용자(240)와 종목(NFLX)으로 가격 알림 조회 시도.
2025-07-29 17:33:05,884 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=240, symbol=NFLX
2025-07-29 17:33:05,884 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=240, symbol=NFLX, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:33:05,891 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=239, user_id=240, symbol=NFLX
2025-07-29 17:33:05,893 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:33:05,895 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:33:05,908 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2705145010, username=testuser_2705145010
2025-07-29 17:33:05,914 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=209, telegram_id=2705145010
2025-07-29 17:33:05,917 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:05,920 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:33:05,921 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:33:05,922 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 2705145010
2025-07-29 17:33:05,926 - src.api.services.user_service - DEBUG - User not found for telegram_id: 2705145010
2025-07-29 17:33:05,926 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2705145010, username=testuser_2705145010
2025-07-29 17:33:05,932 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=241, telegram_id=2705145010
2025-07-29 17:33:05,933 - src.api.services.price_alert_service - DEBUG - 사용자(241)와 종목(NVDA)으로 가격 알림 조회 시도.
2025-07-29 17:33:05,938 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=241, symbol=NVDA
2025-07-29 17:33:05,938 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=241, symbol=NVDA, target_price=1000.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:33:05,944 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=240, user_id=241, symbol=NVDA
2025-07-29 17:33:05,946 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:33:05,948 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:33:05,961 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9469486643, username=testuser_9469486643
2025-07-29 17:33:05,966 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=210, telegram_id=9469486643
2025-07-29 17:33:05,971 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:05,973 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:33:05,975 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:33:05,975 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 9469486643
2025-07-29 17:33:05,977 - src.api.services.user_service - DEBUG - User not found for telegram_id: 9469486643
2025-07-29 17:33:05,978 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9469486643, username=telegram_user_9469486643
2025-07-29 17:33:05,984 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=242, telegram_id=9469486643
2025-07-29 17:33:05,984 - src.api.services.price_alert_service - DEBUG - 사용자(242)와 종목(GOOGL)으로 가격 알림 조회 시도.
2025-07-29 17:33:05,987 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=242, symbol=GOOGL
2025-07-29 17:33:05,988 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=242, symbol=GOOGL, target_price=110.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=weekly
2025-07-29 17:33:05,996 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=241, user_id=242, symbol=GOOGL
2025-07-29 17:33:05,999 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:33:06,003 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:33:06,016 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5444154355, username=testuser_5444154355
2025-07-29 17:33:06,023 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=211, telegram_id=5444154355
2025-07-29 17:33:06,027 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:06,030 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:33:06,031 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:33:06,032 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 5444154355
2025-07-29 17:33:06,034 - src.api.services.user_service - DEBUG - User not found for telegram_id: 5444154355
2025-07-29 17:33:06,034 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5444154355, username=telegram_user_5444154355
2025-07-29 17:33:06,042 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=243, telegram_id=5444154355
2025-07-29 17:33:06,042 - src.api.services.price_alert_service - DEBUG - 사용자(243)와 종목(FB)으로 가격 알림 조회 시도.
2025-07-29 17:33:06,044 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=243, symbol=FB
2025-07-29 17:33:06,045 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=243, symbol=FB, target_price=300.0, condition=above, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:33:06,051 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=242, user_id=243, symbol=FB
2025-07-29 17:33:06,053 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:33:06,055 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:33:06,060 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:06,061 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:06,068 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:06,072 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:06,074 - src.common.dart_utils - ERROR - DART CORPCODE.xml 요청 실패: Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 25, in dart_get_all_stocks
    resp = await session.get(url, timeout=60)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 17:33:06,078 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:06,085 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:06,094 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:06,099 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:06,100 - src.common.dart_utils - ERROR - DART 공시 조회 API 요청 실패 (corp_code: 00123456): Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 79, in dart_get_disclosures
    resp = await session.get(url, params=params, timeout=10)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 17:33:06,105 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:06,108 - src.common.dart_utils - ERROR - DART 공시 API가 오류를 반환했습니다. status: 001, message: API 호출 오류, corp_code: 00123456
2025-07-29 17:33:06,271 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3780247658, username=testuser_3780247658
2025-07-29 17:33:06,280 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=212, telegram_id=3780247658
2025-07-29 17:33:06,660 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:06,937 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 17:33:07,212 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 17:33:07,216 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=214, symbol=005930
2025-07-29 17:33:07,224 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=214, symbol=005930
2025-07-29 17:33:07,226 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 17:33:07,229 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 214
2025-07-29 17:33:07,232 - src.api.services.user_service - DEBUG - User found by id: user_id=214
2025-07-29 17:33:07,233 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:33:07,234 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=214, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:33:07,240 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=11, user_id=214, symbol=005930
2025-07-29 17:33:07,244 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:33:07,247 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:33:07,250 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:33:07,251 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 17:33:07,253 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:33:07,254 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:33:07,261 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 17:33:07,265 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=214, symbol=005930, trade_type=buy
2025-07-29 17:33:07,266 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:33:07,268 - src.api.services.stock_service - WARNING - 현재가 없음: 005930.
2025-07-29 17:33:07,269 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: None
2025-07-29 17:33:07,273 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=214, symbol=005930, trade_type=buy
2025-07-29 17:33:07,275 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 17:33:07,278 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=214
2025-07-29 17:33:07,280 - src.api.routers.simulated_trade - DEBUG - 사용자(214)의 모의매매 이력 1건 조회됨.
2025-07-29 17:33:07,281 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 17:33:07,282 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/214 "HTTP/1.1 200 OK"
2025-07-29 17:33:07,298 - src.api.main - INFO - [APScheduler] 가격 알림 체크 잡 실행: 2025-07-29 17:33:07.298301
2025-07-29 17:33:07,298 - src.api.main - DEBUG - 활성 알림 수: 3
2025-07-29 17:33:07,299 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:33:07,299 - src.api.main - DEBUG - 종목 정상종목 현재가: 110
2025-07-29 17:33:07,300 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='140146280322464'>, 목표 가격: 100, 조건: gte, 반복 주기: <MagicMock name='mock.repeat_interval' id='140146280915120'>
2025-07-29 17:33:07,301 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목, 현재가: 110, 목표가: 100
2025-07-29 17:33:07,307 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='140146280222912'>)
2025-07-29 17:33:07,309 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 17:33:07,309 - src.api.main - DEBUG - 종목 오류종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:33:07,309 - src.api.main - ERROR - 가격 알림 확인 중 '오류종목' 처리 오류: 현재가 조회 실패
Traceback (most recent call last):
  File "/app/src/api/main.py", line 145, in check_price_alerts_job
    price_data = stock_service.get_current_price_and_change(symbol, db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1179, in _execute_mock_call
    result = effect(*args, **kwargs)
  File "/app/src/api/tests/test_main_jobs.py", line 34, in get_current_price_side_effect
    raise ValueError("현재가 조회 실패")
ValueError: 현재가 조회 실패
2025-07-29 17:33:07,310 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:33:07,310 - src.api.main - DEBUG - 종목 정상종목2 현재가: 290
2025-07-29 17:33:07,312 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='140146281495952'>, 목표 가격: 300, 조건: lte, 반복 주기: <MagicMock name='mock.repeat_interval' id='140146282632848'>
2025-07-29 17:33:07,312 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목2, 현재가: 290, 목표가: 300
2025-07-29 17:33:07,313 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='140146280222912'>)
2025-07-29 17:33:07,313 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 17:33:07,313 - src.api.main - DEBUG - 모든 가격 알림 체크 및 DB 커밋 완료.
2025-07-29 17:33:07,319 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:33:07,319 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(10일)
2025-07-29 17:33:07,324 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:33:07,325 - src.api.services.predict_service - ERROR - 예측 불가: 데이터 분석 실패
2025-07-29 17:33:07,330 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:33:07,331 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:33:07,347 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=buy, confidence=90, reason=단기 이동평균선이 장기 이동평균선 위에 있습니다 (골든 크로스 또는 정배열). 현재가가 단기 이동평균선 위에 있습니다. 단기 및 장기 이동평균선이 모두 상승 중입니다. RSI(100)가 70 이상으로 과매수 구간입니다. MACD가 시그널 라인 위에 있고 MACD 히스토그램이 양수입니다 (매수 신호).
2025-07-29 17:33:07,347 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: buy
2025-07-29 17:33:07,354 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:33:07,354 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:33:07,367 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, confidence=50, reason=단기 이동평균선이 장기 이동평균선 아래에 있습니다 (데드 크로스 또는 역배열). 현재가가 단기 이동평균선 아래에 있습니다. 단기 및 장기 이동평균선이 모두 하락 중입니다. RSI(0)가 30 이하로 과매도 구간입니다. MACD가 시그널 라인 아래에 있고 MACD 히스토그램이 음수입니다 (매도 신호).
2025-07-29 17:33:07,368 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 17:33:07,496 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:33:07,497 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:33:07,509 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, confidence=55, reason=단기 이동평균선과 장기 이동평균선이 수렴 중입니다 (횡보). RSI(47)는 중립 구간입니다. MACD가 시그널 라인 아래에 있고 MACD 히스토그램이 음수입니다 (매도 신호).
2025-07-29 17:33:07,510 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 17:33:07,533 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:33:07,533 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:33:07,545 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, confidence=50, reason=단기 이동평균선이 장기 이동평균선 아래에 있습니다 (데드 크로스 또는 역배열). 현재가가 단기 이동평균선 아래에 있습니다. 단기 및 장기 이동평균선이 모두 하락 중입니다. RSI(3)가 30 이하로 과매도 구간입니다. MACD가 시그널 라인 아래에 있고 MACD 히스토그램이 음수입니다 (매도 신호).
2025-07-29 17:33:07,546 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 17:33:07,563 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:33:07,563 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 22개 데이터.
2025-07-29 17:33:07,580 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, confidence=100, reason=단기 이동평균선이 장기 이동평균선 위에 있습니다 (골든 크로스 또는 정배열). 현재가가 단기 이동평균선 위에 있습니다. 단기 및 장기 이동평균선이 모두 상승 중입니다. RSI(100)가 70 이상으로 과매수 구간입니다. MACD가 시그널 라인 위에 있고 MACD 히스토그램이 양수입니다 (매수 신호). 급등 후 횡보 패턴 감지 (차익 실현 가능성).
2025-07-29 17:33:07,580 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 17:33:07,605 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:07,614 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:33:07,615 - src.api.services.stock_service - INFO - 신규 공시가 없습니다. (DB 기준: 202301010000001)
2025-07-29 17:33:07,623 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:07,629 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:33:07,636 - src.api.services.stock_service - INFO - 최초 실행. 기준 접수번호를 202301020000001로 DB에 설정합니다.
2025-07-29 17:33:07,638 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:33:07,639 - src.api.services.stock_service - INFO - 최초 실행. 기준 접수번호를 202301020000001로 DB에 설정합니다.
2025-07-29 17:33:07,650 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:07,660 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:33:07,660 - src.api.services.stock_service - INFO - 2건의 신규 공시를 발견했습니다.
2025-07-29 17:33:07,662 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 17:33:07,664 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 17:33:07,665 - src.api.services.stock_service - INFO - 마지막 확인 접수번호를 202301020000002로 DB에 갱신합니다.
2025-07-29 17:33:07,676 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:07,683 - src.api.services.stock_service - CRITICAL - DART API 사용 한도를 초과했습니다: [020] 사용 한도 초과
2025-07-29 17:33:07,693 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:07,702 - src.api.services.stock_service - ERROR - DART 공시 조회 중 API 오류 발생: [999] 기타 API 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 40, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
src.common.exceptions.DartApiError: [999] 기타 API 오류
2025-07-29 17:33:07,713 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:07,720 - src.api.services.stock_service - ERROR - 신규 공시 확인 및 알림 작업 중 예상치 못한 오류 발생: 예상치 못한 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 40, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: 예상치 못한 오류
2025-07-29 17:33:07,728 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:07,739 - src.api.services.stock_service - DEBUG - update_daily_prices 호출.
2025-07-29 17:33:07,740 - src.api.services.stock_service - DEBUG - DB에서 2개 종목 가져옴.
2025-07-29 17:33:07,741 - src.api.services.stock_service - DEBUG - 종목 005930 (삼성전자) 일별시세 갱신 시작.
2025-07-29 17:33:07,744 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 005930 - 2025-07-29
2025-07-29 17:33:07,746 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 005930 - 2025-07-28
2025-07-29 17:33:07,747 - src.api.services.stock_service - DEBUG - 종목 000660 (SK하이닉스) 일별시세 갱신 시작.
2025-07-29 17:33:07,749 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 000660 - 2025-07-29
2025-07-29 17:33:07,752 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 000660 - 2025-07-28
2025-07-29 17:33:07,759 - src.api.services.stock_service - INFO - 일별시세 갱신 완료: 4개 데이터 처리. 오류: 0개 종목
2025-07-29 17:33:07,774 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:07,782 - src.api.services.stock_service - DEBUG - update_daily_prices 호출.
2025-07-29 17:33:07,784 - src.api.services.stock_service - DEBUG - DB에서 1개 종목 가져옴.
2025-07-29 17:33:07,785 - src.api.services.stock_service - DEBUG - 종목 005930 (삼성전자) 일별시세 갱신 시작.
2025-07-29 17:33:07,785 - src.api.services.stock_service - WARNING - 종목 005930에 대한 일별시세 데이터가 없습니다.
2025-07-29 17:33:07,785 - src.api.services.stock_service - INFO - 일별시세 갱신 완료: 0개 데이터 처리. 오류: 1개 종목
2025-07-29 17:33:07,795 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:07,800 - src.api.services.stock_service - DEBUG - update_daily_prices 호출.
2025-07-29 17:33:07,802 - src.api.services.stock_service - DEBUG - DB에서 1개 종목 가져옴.
2025-07-29 17:33:07,802 - src.api.services.stock_service - DEBUG - 종목 005930 (삼성전자) 일별시세 갱신 시작.
2025-07-29 17:33:07,802 - src.api.services.stock_service - ERROR - 일별시세 갱신 중 '005930' 처리에서 오류 발생: API Error
2025-07-29 17:33:07,802 - src.api.services.stock_service - INFO - 일별시세 갱신 완료: 0개 데이터 처리. 오류: 1개 종목
2025-07-29 17:33:07,812 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:07,820 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:33:07,823 - src.api.services.stock_service - DEBUG - 현재가 발견: 005930 - 71500.0
2025-07-29 17:33:07,823 - src.api.services.stock_service - DEBUG - 전일 종가 발견: 005930 - 70500.0
2025-07-29 17:33:07,834 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:07,836 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=NONEXIST
2025-07-29 17:33:07,838 - src.api.services.stock_service - WARNING - 현재가 없음: NONEXIST.
2025-07-29 17:33:07,847 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:33:07,857 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:33:07,859 - src.api.services.stock_service - DEBUG - 현재가 발견: 005930 - 71500.0
2025-07-29 17:33:07,860 - src.api.services.stock_service - WARNING - 전일 종가 없음: 005930. 등락률 계산 불가.
2025-07-29 17:34:06,103 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 17:34:06,119 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 17:34:06,124 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:34:06,125 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:34:06,126 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:34:06,127 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:34:07,169 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:07,176 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 17:34:07,182 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-07-29 17:34:07,184 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '<unknown>'
2025-07-29 17:34:07,185 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-07-29 17:34:07,466 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:07,470 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:34:07,729 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:07,733 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 17:34:08,084 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:08,088 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 17:34:08,091 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 17:34:08,105 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5476254627, username=testuser_5476254627
2025-07-29 17:34:08,120 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=1, telegram_id=5476254627
2025-07-29 17:34:08,389 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:08,783 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 200 OK"
2025-07-29 17:34:08,799 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8135884780, username=testuser_8135884780
2025-07-29 17:34:08,807 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=3, telegram_id=8135884780
2025-07-29 17:34:09,068 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:09,326 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 17:34:09,339 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1768372087, username=testuser_1768372087
2025-07-29 17:34:09,346 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=5, telegram_id=1768372087
2025-07-29 17:34:09,598 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:09,611 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 17:34:09,633 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9788263542, username=testuser_9788263542
2025-07-29 17:34:09,642 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=7, telegram_id=9788263542
2025-07-29 17:34:09,899 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:10,157 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 200 OK"
2025-07-29 17:34:10,170 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3761629652, username=testuser_3761629652
2025-07-29 17:34:10,177 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=9, telegram_id=3761629652
2025-07-29 17:34:10,427 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:10,706 - src.api.routers.admin - ERROR - /admin/update_master 서버 오류: DB connection error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 36, in update_stock_master
    result = await stock_service.update_stock_master(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DB connection error
2025-07-29 17:34:10,710 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:34:10,733 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3294542010, username=testuser_3294542010
2025-07-29 17:34:10,741 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=11, telegram_id=3294542010
2025-07-29 17:34:10,989 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:11,243 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 17:34:11,258 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1276688089, username=testuser_1276688089
2025-07-29 17:34:11,264 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=13, telegram_id=1276688089
2025-07-29 17:34:11,512 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:11,518 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 17:34:11,528 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4606491667, username=testuser_4606491667
2025-07-29 17:34:11,534 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=15, telegram_id=4606491667
2025-07-29 17:34:11,803 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:12,165 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 200 OK"
2025-07-29 17:34:12,186 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6075485259, username=testuser_6075485259
2025-07-29 17:34:12,194 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=17, telegram_id=6075485259
2025-07-29 17:34:12,458 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:12,741 - src.api.routers.admin - ERROR - /admin/update_price 서버 오류: API call failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 53, in update_daily_price
    result = await stock_service.update_daily_prices(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: API call failed
2025-07-29 17:34:12,743 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:34:12,757 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5990797722, username=testuser_5990797722
2025-07-29 17:34:12,764 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=19, telegram_id=5990797722
2025-07-29 17:34:13,070 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:13,346 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 17:34:13,363 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9603975856, username=testuser_9603975856
2025-07-29 17:34:13,371 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=21, telegram_id=9603975856
2025-07-29 17:34:13,640 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:13,651 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 17:34:13,665 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2296436336, username=testuser_2296436336
2025-07-29 17:34:13,673 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=23, telegram_id=2296436336
2025-07-29 17:34:13,941 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:14,240 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f763237e080>
2025-07-29 17:34:14,241 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:34:14,245 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 200 OK"
2025-07-29 17:34:14,264 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2911823091, username=testuser_2911823091
2025-07-29 17:34:14,273 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=25, telegram_id=2911823091
2025-07-29 17:34:14,535 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:14,807 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f763237dc90>
2025-07-29 17:34:14,808 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:34:14,809 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 200 OK"
2025-07-29 17:34:14,821 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8828916031, username=testuser_8828916031
2025-07-29 17:34:14,827 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=27, telegram_id=8828916031
2025-07-29 17:34:15,072 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:15,370 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f76323b3a30>
2025-07-29 17:34:15,370 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:34:15,372 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=%EC%B9%B4%EC%B9%B4%EC%98%A4 "HTTP/1.1 200 OK"
2025-07-29 17:34:15,384 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1908111517, username=testuser_1908111517
2025-07-29 17:34:15,389 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=29, telegram_id=1908111517
2025-07-29 17:34:15,640 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:15,899 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f763237d510>
2025-07-29 17:34:15,899 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:34:15,901 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=0013456 "HTTP/1.1 200 OK"
2025-07-29 17:34:15,914 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7967773379, username=testuser_7967773379
2025-07-29 17:34:15,920 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=31, telegram_id=7967773379
2025-07-29 17:34:16,256 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:16,511 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f76323de8f0>
2025-07-29 17:34:16,511 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:34:16,513 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=NONEXIST "HTTP/1.1 404 Not Found"
2025-07-29 17:34:16,526 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5770808890, username=testuser_5770808890
2025-07-29 17:34:16,532 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=33, telegram_id=5770808890
2025-07-29 17:34:16,785 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:17,034 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f76323e85e0>
2025-07-29 17:34:17,034 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:34:17,035 - src.api.routers.admin - ERROR - /admin/update_disclosure 서버 오류: DART API error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 126, in update_disclosure
    result = await stock_service.update_disclosures(db, corp_code=corp_code, stock_code=stock_code or '', stock_name=stock_name or '')
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DART API error
2025-07-29 17:34:17,036 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:34:17,048 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4567037281, username=testuser_4567037281
2025-07-29 17:34:17,055 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=35, telegram_id=4567037281
2025-07-29 17:34:17,297 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:17,561 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 17:34:17,577 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7586109974, username=testuser_7586109974
2025-07-29 17:34:17,583 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=37, telegram_id=7586109974
2025-07-29 17:34:17,833 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:17,840 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 17:34:17,851 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1698184335, username=testuser_1698184335
2025-07-29 17:34:17,859 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=39, telegram_id=1698184335
2025-07-29 17:34:18,105 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:18,354 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:34:18,366 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1609739058, username=testuser_1609739058
2025-07-29 17:34:18,372 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=41, telegram_id=1609739058
2025-07-29 17:34:18,614 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:18,869 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:34:18,882 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9389950437, username=testuser_9389950437
2025-07-29 17:34:18,887 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=43, telegram_id=9389950437
2025-07-29 17:34:19,142 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:19,404 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 17:34:19,417 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4737356628, username=testuser_4737356628
2025-07-29 17:34:19,425 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=45, telegram_id=4737356628
2025-07-29 17:34:19,674 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:19,684 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 17:34:19,702 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7912065754, username=testuser_7912065754
2025-07-29 17:34:19,709 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=47, telegram_id=7912065754
2025-07-29 17:34:19,964 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:20,274 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 17:34:20,275 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 17:34:20,290 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8924349560, username=testuser_8924349560
2025-07-29 17:34:20,308 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=49, telegram_id=8924349560
2025-07-29 17:34:20,555 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:20,806 - src.api.routers.admin - ERROR - [trigger_job] 잡 실행 실패: test_job - Job execution failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 175, in trigger_job
    job.func(*job.args, **job.kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: Job execution failed

2025-07-29 17:34:20,807 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:34:20,819 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7740070087, username=testuser_7740070087
2025-07-29 17:34:20,828 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=51, telegram_id=7740070087
2025-07-29 17:34:21,067 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:21,318 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 17:34:21,336 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1545687469, username=testuser_1545687469
2025-07-29 17:34:21,344 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=53, telegram_id=1545687469
2025-07-29 17:34:21,601 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:21,609 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 17:34:21,638 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5762238715, username=testuser_5762238715
2025-07-29 17:34:21,650 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=55, telegram_id=5762238715
2025-07-29 17:34:21,937 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:22,200 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 17:34:22,201 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 200 OK"
2025-07-29 17:34:22,215 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5434208194, username=testuser_5434208194
2025-07-29 17:34:22,222 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=57, telegram_id=5434208194
2025-07-29 17:34:22,469 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:22,716 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 17:34:22,717 - src.api.routers.admin - ERROR - 공시 확인 잡 수동 실행 중 오류 발생: Disclosure check failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 193, in trigger_check_disclosures_job
    await stock_service.check_and_notify_new_disclosures(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: Disclosure check failed
2025-07-29 17:34:22,718 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:34:22,729 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1384015777, username=testuser_1384015777
2025-07-29 17:34:22,735 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=59, telegram_id=1384015777
2025-07-29 17:34:22,982 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:23,228 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 17:34:23,241 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8607010833, username=testuser_8607010833
2025-07-29 17:34:23,247 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=61, telegram_id=8607010833
2025-07-29 17:34:23,486 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:23,494 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 17:34:23,505 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2666082187, username=testuser_2666082187
2025-07-29 17:34:23,512 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=63, telegram_id=2666082187
2025-07-29 17:34:23,784 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:24,094 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:24,109 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=65, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:34:24,124 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=1, user_id=65, symbol=005930
2025-07-29 17:34:24,128 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:34:24,149 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2466744963, username=testuser_2466744963
2025-07-29 17:34:24,157 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=66, telegram_id=2466744963
2025-07-29 17:34:24,433 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:24,439 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:34:24,450 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8585980723, username=testuser_8585980723
2025-07-29 17:34:24,456 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=68, telegram_id=8585980723
2025-07-29 17:34:24,702 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:24,949 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:24,950 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:34:24,960 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9394706164, username=testuser_9394706164
2025-07-29 17:34:24,965 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=71, telegram_id=9394706164
2025-07-29 17:34:25,207 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:25,452 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:25,453 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:34:25,461 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=2, user_id=73, symbol=005930
2025-07-29 17:34:25,463 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:34:25,466 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:25,468 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=035720, target_price=50000.0, condition=lte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:34:25,475 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=3, user_id=73, symbol=035720
2025-07-29 17:34:25,476 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:34:25,479 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:25,481 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 조회 시도.
2025-07-29 17:34:25,485 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 2개 조회됨.
2025-07-29 17:34:25,487 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:34:25,501 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7208632558, username=testuser_7208632558
2025-07-29 17:34:25,509 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=74, telegram_id=7208632558
2025-07-29 17:34:25,768 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:26,021 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:26,022 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 조회 시도.
2025-07-29 17:34:26,023 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 0개 조회됨.
2025-07-29 17:34:26,025 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:34:26,035 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9245076474, username=testuser_9245076474
2025-07-29 17:34:26,042 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=77, telegram_id=9245076474
2025-07-29 17:34:26,288 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:26,292 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:34:26,305 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8966598634, username=testuser_8966598634
2025-07-29 17:34:26,311 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=79, telegram_id=8966598634
2025-07-29 17:34:26,621 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:26,882 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:26,883 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=81, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:34:26,889 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=4, user_id=81, symbol=005930
2025-07-29 17:34:26,891 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:34:26,895 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:26,896 - src.api.services.price_alert_service - DEBUG - 사용자(81)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:34:26,901 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=4
2025-07-29 17:34:26,903 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/81/symbol/005930 "HTTP/1.1 200 OK"
2025-07-29 17:34:26,915 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7131531666, username=testuser_7131531666
2025-07-29 17:34:26,921 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=82, telegram_id=7131531666
2025-07-29 17:34:27,166 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:27,518 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:27,519 - src.api.services.price_alert_service - DEBUG - 사용자(84)와 종목(NONEXISTENT)으로 가격 알림 조회 시도.
2025-07-29 17:34:27,522 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=84, symbol=NONEXISTENT
2025-07-29 17:34:27,525 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/84/symbol/NONEXISTENT "HTTP/1.1 404 Not Found"
2025-07-29 17:34:27,548 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1434769249, username=testuser_1434769249
2025-07-29 17:34:27,557 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=85, telegram_id=1434769249
2025-07-29 17:34:27,805 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:28,054 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:28,055 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=87, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:34:28,060 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=5, user_id=87, symbol=005930
2025-07-29 17:34:28,062 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:34:28,065 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:28,068 - src.api.services.price_alert_service - DEBUG - 가격 알림(5) 수정 시도: update_data={'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 17:34:28,071 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:34:28,072 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 17:34:28,072 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:34:28,080 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:34:28,081 - src.api.services.price_alert_service - INFO - 가격 알림(5) 수정 성공.
2025-07-29 17:34:28,084 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/5 "HTTP/1.1 200 OK"
2025-07-29 17:34:28,098 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2086879908, username=testuser_2086879908
2025-07-29 17:34:28,105 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=88, telegram_id=2086879908
2025-07-29 17:34:28,360 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:28,611 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:28,612 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=90, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:34:28,618 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=6, user_id=90, symbol=005930
2025-07-29 17:34:28,620 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:34:28,624 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/6 "HTTP/1.1 403 Forbidden"
2025-07-29 17:34:28,636 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1305720967, username=testuser_1305720967
2025-07-29 17:34:28,643 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=91, telegram_id=1305720967
2025-07-29 17:34:28,910 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:29,161 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:29,162 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 17:34:29,164 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 17:34:29,166 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:34:29,179 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4574947258, username=testuser_4574947258
2025-07-29 17:34:29,186 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=94, telegram_id=4574947258
2025-07-29 17:34:29,430 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:29,928 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:29,929 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=96, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:34:29,935 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=7, user_id=96, symbol=005930
2025-07-29 17:34:29,937 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:34:29,940 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:29,940 - src.api.services.price_alert_service - DEBUG - 가격 알림(7) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 17:34:29,942 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:34:29,942 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0}
2025-07-29 17:34:29,942 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:34:29,948 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:34:29,948 - src.api.services.price_alert_service - INFO - 가격 알림(7) 수정 성공.
2025-07-29 17:34:29,951 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/7 "HTTP/1.1 403 Forbidden"
2025-07-29 17:34:29,962 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5370911110, username=testuser_5370911110
2025-07-29 17:34:29,967 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=98, telegram_id=5370911110
2025-07-29 17:34:29,909 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:29,705 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:29,706 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=100, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:34:29,713 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=8, user_id=100, symbol=005930
2025-07-29 17:34:29,716 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:34:29,718 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:29,722 - src.api.services.price_alert_service - DEBUG - 가격 알림(8) 삭제 시도.
2025-07-29 17:34:29,728 - src.api.services.price_alert_service - INFO - 가격 알림(8) 삭제 성공.
2025-07-29 17:34:29,729 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/8 "HTTP/1.1 200 OK"
2025-07-29 17:34:29,742 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7901063006, username=testuser_7901063006
2025-07-29 17:34:29,748 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=101, telegram_id=7901063006
2025-07-29 17:34:30,016 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:30,283 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:30,285 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=103, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:34:30,294 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=9, user_id=103, symbol=005930
2025-07-29 17:34:30,296 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:34:30,300 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/9 "HTTP/1.1 403 Forbidden"
2025-07-29 17:34:30,317 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4262595763, username=testuser_4262595763
2025-07-29 17:34:30,324 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=104, telegram_id=4262595763
2025-07-29 17:34:30,685 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:30,943 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:30,946 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 삭제 시도.
2025-07-29 17:34:30,948 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 17:34:30,949 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:34:30,961 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2295135665, username=testuser_2295135665
2025-07-29 17:34:30,968 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=107, telegram_id=2295135665
2025-07-29 17:34:31,210 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:31,699 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:31,700 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=109, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:34:31,706 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=10, user_id=109, symbol=005930
2025-07-29 17:34:31,708 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:34:31,710 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:31,715 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/10 "HTTP/1.1 403 Forbidden"
2025-07-29 17:34:31,727 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4735949681, username=testuser_4735949681
2025-07-29 17:34:31,733 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=111, telegram_id=4735949681
2025-07-29 17:34:31,980 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:31,987 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 17:34:31,998 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9634768328, username=testuser_9634768328
2025-07-29 17:34:32,005 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=113, telegram_id=9634768328
2025-07-29 17:34:32,246 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:32,251 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 17:34:32,258 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:32,262 - httpx - INFO - HTTP Request: GET http://testserver/ "HTTP/1.1 200 OK"
2025-07-29 17:34:32,271 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6179410407, username=testuser_6179410407
2025-07-29 17:34:32,278 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=115, telegram_id=6179410407
2025-07-29 17:34:32,546 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:32,553 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:34:32,561 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:34:32,561 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 17:34:32,567 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:34:32,568 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:34:32,570 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 17:34:32,588 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5984329852, username=testuser_5984329852
2025-07-29 17:34:32,596 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=117, telegram_id=5984329852
2025-07-29 17:34:32,847 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:32,852 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:34:32,856 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=INVALID
2025-07-29 17:34:32,857 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=INVALID, days=40
2025-07-29 17:34:32,859 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:34:32,859 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:34:32,861 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 17:34:32,875 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8596517301, username=testuser_8596517301
2025-07-29 17:34:32,881 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=119, telegram_id=8596517301
2025-07-29 17:34:33,145 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:33,150 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:34:33,155 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:34:33,171 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6102926434, username=testuser_6102926434
2025-07-29 17:34:33,178 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=121, telegram_id=6102926434
2025-07-29 17:34:33,659 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:34,251 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=123, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:34:34,257 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 17:34:34,273 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:34:34,277 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/123 "HTTP/1.1 200 OK"
2025-07-29 17:34:34,312 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8890466388, username=testuser_8890466388
2025-07-29 17:34:34,324 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=124, telegram_id=8890466388
2025-07-29 17:34:34,735 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:34,744 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=99999, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:34:34,747 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 17:34:34,750 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:34:34,752 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/99999 "HTTP/1.1 200 OK"
2025-07-29 17:34:34,783 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6895195114, username=testuser_6895195114
2025-07-29 17:34:34,803 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=126, telegram_id=6895195114
2025-07-29 17:34:35,314 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:35,725 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=128, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:34:35,728 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 17:34:35,731 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:34:35,733 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/128 "HTTP/1.1 200 OK"
2025-07-29 17:34:35,771 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3900599617, username=testuser_3900599617
2025-07-29 17:34:35,786 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=129, telegram_id=3900599617
2025-07-29 17:34:36,160 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:36,627 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=1, page_size=5, symbol=None, prediction=None
2025-07-29 17:34:36,631 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 17:34:36,634 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 1, 페이지 크기 5).
2025-07-29 17:34:36,643 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=1&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 17:34:36,649 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=2, page_size=5, symbol=None, prediction=None
2025-07-29 17:34:36,652 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 17:34:36,658 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 2, 페이지 크기 5).
2025-07-29 17:34:36,660 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=2&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 17:34:36,690 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6687471029, username=testuser_6687471029
2025-07-29 17:34:36,705 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=132, telegram_id=6687471029
2025-07-29 17:34:37,040 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:37,468 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=134, page=1, page_size=10, symbol=005930, prediction=None
2025-07-29 17:34:37,470 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 17:34:37,476 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 17:34:37,479 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:34:37,482 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/134?symbol=005930 "HTTP/1.1 200 OK"
2025-07-29 17:34:37,509 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3667994314, username=testuser_3667994314
2025-07-29 17:34:37,519 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=135, telegram_id=3667994314
2025-07-29 17:34:37,958 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:38,263 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=137, page=1, page_size=10, symbol=None, prediction=상승
2025-07-29 17:34:38,264 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=상승
2025-07-29 17:34:38,268 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 17:34:38,271 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:34:38,274 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/137?prediction=%EC%83%81%EC%8A%B9 "HTTP/1.1 200 OK"
2025-07-29 17:34:38,288 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3492106074, username=testuser_3492106074
2025-07-29 17:34:38,294 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=138, telegram_id=3492106074
2025-07-29 17:34:38,537 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:38,794 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=140, page=1, page_size=10, symbol=005930, prediction=유지
2025-07-29 17:34:38,795 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 17:34:38,795 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=유지
2025-07-29 17:34:38,799 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 17:34:38,802 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:34:38,803 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/140?symbol=005930&prediction=%EC%9C%A0%EC%A7%80 "HTTP/1.1 200 OK"
2025-07-29 17:34:38,815 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1299740912, username=testuser_1299740912
2025-07-29 17:34:38,823 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=141, telegram_id=1299740912
2025-07-29 17:34:39,153 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:39,176 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=143, symbol=005930, trade_type=buy
2025-07-29 17:34:39,176 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:34:39,181 - src.api.services.stock_service - WARNING - 현재가 없음: 005930.
2025-07-29 17:34:39,182 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: None
2025-07-29 17:34:39,202 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=143, symbol=005930, trade_type=buy
2025-07-29 17:34:39,205 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 17:34:39,211 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=143
2025-07-29 17:34:39,215 - src.api.routers.simulated_trade - DEBUG - 사용자(143)의 모의매매 이력 1건 조회됨.
2025-07-29 17:34:39,215 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 17:34:39,216 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/143 "HTTP/1.1 200 OK"
2025-07-29 17:34:39,249 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9213795891, username=testuser_9213795891
2025-07-29 17:34:39,258 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=144, telegram_id=9213795891
2025-07-29 17:34:39,507 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:39,529 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 17:34:39,545 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9691288819, username=testuser_9691288819
2025-07-29 17:34:39,551 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=146, telegram_id=9691288819
2025-07-29 17:34:39,792 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:39,799 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 17:34:39,810 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9358321361, username=testuser_9358321361
2025-07-29 17:34:39,815 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=148, telegram_id=9358321361
2025-07-29 17:34:40,111 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:40,133 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%82%BC%EC%84%B1%EC%A0%84%EC%9E%90 "HTTP/1.1 200 OK"
2025-07-29 17:34:40,150 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1805595196, username=testuser_1805595196
2025-07-29 17:34:40,157 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=150, telegram_id=1805595196
2025-07-29 17:34:40,403 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:40,422 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=035720 "HTTP/1.1 200 OK"
2025-07-29 17:34:40,436 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1056815723, username=testuser_1056815723
2025-07-29 17:34:40,443 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=152, telegram_id=1056815723
2025-07-29 17:34:40,687 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:40,707 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=sk%ED%95%98%EC%9D%B4%EB%8B%89%EC%8A%A4 "HTTP/1.1 200 OK"
2025-07-29 17:34:40,722 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2676126034, username=testuser_2676126034
2025-07-29 17:34:40,730 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=154, telegram_id=2676126034
2025-07-29 17:34:40,981 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:40,989 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%97%86%EB%8A%94%EC%A2%85%EB%AA%A9 "HTTP/1.1 200 OK"
2025-07-29 17:34:41,002 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3811803919, username=testuser_3811803919
2025-07-29 17:34:41,007 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=156, telegram_id=3811803919
2025-07-29 17:34:41,255 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:41,260 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query= "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:34:41,271 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6572321497, username=testuser_6572321497
2025-07-29 17:34:41,277 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=158, telegram_id=6572321497
2025-07-29 17:34:41,526 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:41,533 - httpx - INFO - HTTP Request: GET http://testserver/symbols/005930/current_price_and_change "HTTP/1.1 200 OK"
2025-07-29 17:34:41,545 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3824866171, username=testuser_3824866171
2025-07-29 17:34:41,552 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=160, telegram_id=3824866171
2025-07-29 17:34:41,799 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:41,806 - httpx - INFO - HTTP Request: GET http://testserver/symbols/NONEXISTENT/current_price_and_change "HTTP/1.1 404 Not Found"
2025-07-29 17:34:41,820 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5789561167, username=testuser_5789561167
2025-07-29 17:34:41,826 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=162, telegram_id=5789561167
2025-07-29 17:34:42,070 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:42,366 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 17:34:42,382 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7139627637, username=testuser_7139627637
2025-07-29 17:34:42,388 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=165, telegram_id=7139627637
2025-07-29 17:34:42,732 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:42,982 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 400 Bad Request"
2025-07-29 17:34:42,994 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3286161653, username=testuser_3286161653
2025-07-29 17:34:42,999 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=168, telegram_id=3286161653
2025-07-29 17:34:43,244 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:43,743 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 17:34:43,757 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1301110428, username=testuser_1301110428
2025-07-29 17:34:43,764 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=171, telegram_id=1301110428
2025-07-29 17:34:44,011 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:44,019 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 17:34:44,032 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4903381518, username=testuser_4903381518
2025-07-29 17:34:44,037 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=173, telegram_id=4903381518
2025-07-29 17:34:44,287 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:44,810 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 17:34:44,821 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8118277670, username=testuser_8118277670
2025-07-29 17:34:44,826 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=176, telegram_id=8118277670
2025-07-29 17:34:45,080 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:45,344 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 178
2025-07-29 17:34:45,348 - src.api.services.user_service - DEBUG - User found by id: user_id=178
2025-07-29 17:34:45,352 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 17:34:45,365 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8688074880, username=testuser_8688074880
2025-07-29 17:34:45,371 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=179, telegram_id=8688074880
2025-07-29 17:34:45,613 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:45,618 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 403 Forbidden"
2025-07-29 17:34:45,628 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8143438557, username=testuser_8143438557
2025-07-29 17:34:45,633 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=181, telegram_id=8143438557
2025-07-29 17:34:45,879 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:46,130 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 183
2025-07-29 17:34:46,133 - src.api.services.user_service - DEBUG - User found by id: user_id=183
2025-07-29 17:34:46,145 - httpx - INFO - HTTP Request: PUT http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 17:34:46,156 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8757822995, username=testuser_8757822995
2025-07-29 17:34:46,163 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=184, telegram_id=8757822995
2025-07-29 17:34:46,531 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:46,549 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 17:34:46,559 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5648982213, username=testuser_5648982213
2025-07-29 17:34:46,563 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=187, telegram_id=5648982213
2025-07-29 17:34:46,830 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:47,099 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 17:34:47,110 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8426914115, username=testuser_8426914115
2025-07-29 17:34:47,117 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=190, telegram_id=8426914115
2025-07-29 17:34:47,365 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:47,620 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/192 "HTTP/1.1 200 OK"
2025-07-29 17:34:47,630 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4069174055, username=testuser_4069174055
2025-07-29 17:34:47,636 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=193, telegram_id=4069174055
2025-07-29 17:34:47,888 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:47,897 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:34:47,912 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3762122119, username=testuser_3762122119
2025-07-29 17:34:47,919 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=195, telegram_id=3762122119
2025-07-29 17:34:48,164 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:48,654 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 197
2025-07-29 17:34:48,656 - src.api.services.user_service - DEBUG - User found by id: user_id=197
2025-07-29 17:34:48,663 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 200 OK"
2025-07-29 17:34:48,675 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6486856564, username=testuser_6486856564
2025-07-29 17:34:48,681 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=199, telegram_id=6486856564
2025-07-29 17:34:48,929 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:49,360 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 201
2025-07-29 17:34:49,363 - src.api.services.user_service - DEBUG - User found by id: user_id=201
2025-07-29 17:34:49,365 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:34:49,377 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6570531187, username=testuser_6570531187
2025-07-29 17:34:49,384 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=202, telegram_id=6570531187
2025-07-29 17:34:49,630 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:49,641 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=204, symbol=005930
2025-07-29 17:34:49,649 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=204, symbol=005930
2025-07-29 17:34:49,650 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 17:34:49,654 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 시도: user_id=204
2025-07-29 17:34:49,657 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 성공: user_id=204, 1개 종목.
2025-07-29 17:34:49,658 - httpx - INFO - HTTP Request: GET http://testserver/watchlist/get/204 "HTTP/1.1 200 OK"
2025-07-29 17:34:49,663 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:49,665 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:34:49,665 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:34:49,670 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:49,673 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12345
2025-07-29 17:34:49,677 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=1, telegram_id=12345
2025-07-29 17:34:49,678 - src.api.services.price_alert_service - DEBUG - 사용자(1)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:34:49,681 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=1
2025-07-29 17:34:49,681 - src.api.services.price_alert_service - DEBUG - 가격 알림(1) 수정 시도: update_data={'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 17:34:49,684 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:34:49,685 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 17:34:49,685 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:34:49,690 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:34:49,690 - src.api.services.price_alert_service - INFO - 가격 알림(1) 수정 성공.
2025-07-29 17:34:49,692 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:34:49,697 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:34:49,697 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:34:49,700 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:49,702 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 17:34:49,704 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 17:34:49,705 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:34:49,706 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 17:34:49,707 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 17:34:49,708 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:34:49,708 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 17:34:49,708 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:34:49,715 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:34:49,715 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 17:34:49,717 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:34:49,720 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:49,720 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 17:34:49,722 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 17:34:49,722 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:34:49,724 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 17:34:49,724 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 17:34:49,726 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:34:49,726 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 17:34:49,726 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:34:49,732 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:34:49,732 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 17:34:49,734 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:34:49,757 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6905458685, username=testuser_6905458685
2025-07-29 17:34:49,763 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=205, telegram_id=6905458685
2025-07-29 17:34:49,765 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:49,769 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:34:49,771 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:49,775 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 6905458685
2025-07-29 17:34:49,779 - src.api.services.user_service - DEBUG - User not found for telegram_id: 6905458685
2025-07-29 17:34:49,780 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6905458685, username=testuser_6905458685
2025-07-29 17:34:49,789 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=244, telegram_id=6905458685
2025-07-29 17:34:49,789 - src.api.services.price_alert_service - DEBUG - 사용자(244)와 종목(GOOG)으로 가격 알림 조회 시도.
2025-07-29 17:34:49,791 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=244, symbol=GOOG
2025-07-29 17:34:49,791 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=244, symbol=GOOG, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:34:49,798 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=243, user_id=244, symbol=GOOG
2025-07-29 17:34:49,800 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:34:49,802 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:34:49,815 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7632705566, username=testuser_7632705566
2025-07-29 17:34:49,820 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=206, telegram_id=7632705566
2025-07-29 17:34:49,822 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:49,825 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:34:49,825 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:49,826 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 7632705566
2025-07-29 17:34:49,828 - src.api.services.user_service - DEBUG - User not found for telegram_id: 7632705566
2025-07-29 17:34:49,828 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7632705566, username=telegram_user_7632705566
2025-07-29 17:34:49,834 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=245, telegram_id=7632705566
2025-07-29 17:34:49,834 - src.api.services.price_alert_service - DEBUG - 사용자(245)와 종목(MSFT)으로 가격 알림 조회 시도.
2025-07-29 17:34:49,837 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=245, symbol=MSFT
2025-07-29 17:34:49,837 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=245, symbol=MSFT, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:34:49,844 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=244, user_id=245, symbol=MSFT
2025-07-29 17:34:49,846 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:34:49,848 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:34:49,865 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5819878963, username=testuser_5819878963
2025-07-29 17:34:49,871 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=207, telegram_id=5819878963
2025-07-29 17:34:49,876 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:49,879 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:34:49,880 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:49,881 - src.api.routers.bot_router - DEBUG - Before toggle: existing_alert.notify_on_disclosure = True
2025-07-29 17:34:49,881 - src.api.routers.bot_router - DEBUG - Calculated new_status: False
2025-07-29 17:34:49,881 - src.api.routers.bot_router - DEBUG - After update_alert call: updated_alert_orm.notify_on_disclosure = False
2025-07-29 17:34:49,882 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:34:49,884 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:34:49,895 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1610543077, username=testuser_1610543077
2025-07-29 17:34:49,901 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=208, telegram_id=1610543077
2025-07-29 17:34:49,904 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:49,907 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:34:49,908 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:49,908 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 1610543077
2025-07-29 17:34:49,910 - src.api.services.user_service - DEBUG - User not found for telegram_id: 1610543077
2025-07-29 17:34:49,911 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1610543077, username=telegram_user_1610543077
2025-07-29 17:34:49,916 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=246, telegram_id=1610543077
2025-07-29 17:34:49,916 - src.api.services.price_alert_service - DEBUG - 사용자(246)와 종목(NFLX)으로 가격 알림 조회 시도.
2025-07-29 17:34:49,917 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=246, symbol=NFLX
2025-07-29 17:34:49,918 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=246, symbol=NFLX, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:34:49,923 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=245, user_id=246, symbol=NFLX
2025-07-29 17:34:49,924 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:34:49,927 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:34:49,938 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3575694974, username=testuser_3575694974
2025-07-29 17:34:49,944 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=209, telegram_id=3575694974
2025-07-29 17:34:49,946 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:49,949 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:34:49,950 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:49,950 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 3575694974
2025-07-29 17:34:49,952 - src.api.services.user_service - DEBUG - User not found for telegram_id: 3575694974
2025-07-29 17:34:49,952 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3575694974, username=testuser_3575694974
2025-07-29 17:34:49,957 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=247, telegram_id=3575694974
2025-07-29 17:34:49,957 - src.api.services.price_alert_service - DEBUG - 사용자(247)와 종목(NVDA)으로 가격 알림 조회 시도.
2025-07-29 17:34:49,960 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=247, symbol=NVDA
2025-07-29 17:34:49,960 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=247, symbol=NVDA, target_price=1000.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:34:49,966 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=246, user_id=247, symbol=NVDA
2025-07-29 17:34:49,968 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:34:49,970 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:34:49,986 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4826228999, username=testuser_4826228999
2025-07-29 17:34:49,993 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=210, telegram_id=4826228999
2025-07-29 17:34:49,997 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:50,000 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:34:50,002 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:50,003 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 4826228999
2025-07-29 17:34:50,005 - src.api.services.user_service - DEBUG - User not found for telegram_id: 4826228999
2025-07-29 17:34:50,005 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4826228999, username=telegram_user_4826228999
2025-07-29 17:34:50,011 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=248, telegram_id=4826228999
2025-07-29 17:34:50,012 - src.api.services.price_alert_service - DEBUG - 사용자(248)와 종목(GOOGL)으로 가격 알림 조회 시도.
2025-07-29 17:34:50,014 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=248, symbol=GOOGL
2025-07-29 17:34:50,015 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=248, symbol=GOOGL, target_price=110.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=weekly
2025-07-29 17:34:50,023 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=247, user_id=248, symbol=GOOGL
2025-07-29 17:34:50,025 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:34:50,028 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:34:50,047 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1442054011, username=testuser_1442054011
2025-07-29 17:34:50,053 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=211, telegram_id=1442054011
2025-07-29 17:34:50,057 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:50,060 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:34:50,061 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:50,062 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 1442054011
2025-07-29 17:34:50,063 - src.api.services.user_service - DEBUG - User not found for telegram_id: 1442054011
2025-07-29 17:34:50,064 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1442054011, username=telegram_user_1442054011
2025-07-29 17:34:50,070 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=249, telegram_id=1442054011
2025-07-29 17:34:50,070 - src.api.services.price_alert_service - DEBUG - 사용자(249)와 종목(FB)으로 가격 알림 조회 시도.
2025-07-29 17:34:50,071 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=249, symbol=FB
2025-07-29 17:34:50,072 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=249, symbol=FB, target_price=300.0, condition=above, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:34:50,079 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=248, user_id=249, symbol=FB
2025-07-29 17:34:50,080 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:34:50,083 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:34:50,090 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:50,091 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:50,098 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:50,105 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:50,106 - src.common.dart_utils - ERROR - DART CORPCODE.xml 요청 실패: Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 25, in dart_get_all_stocks
    resp = await session.get(url, timeout=60)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 17:34:50,112 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:50,119 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:50,123 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:50,127 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:50,129 - src.common.dart_utils - ERROR - DART 공시 조회 API 요청 실패 (corp_code: 00123456): Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 79, in dart_get_disclosures
    resp = await session.get(url, params=params, timeout=10)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 17:34:50,132 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:50,135 - src.common.dart_utils - ERROR - DART 공시 API가 오류를 반환했습니다. status: 001, message: API 호출 오류, corp_code: 00123456
2025-07-29 17:34:50,281 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5125424829, username=testuser_5125424829
2025-07-29 17:34:50,289 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=212, telegram_id=5125424829
2025-07-29 17:34:50,638 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:50,892 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 17:34:51,134 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 17:34:51,138 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=214, symbol=005930
2025-07-29 17:34:51,144 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=214, symbol=005930
2025-07-29 17:34:51,145 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 17:34:51,149 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 214
2025-07-29 17:34:51,151 - src.api.services.user_service - DEBUG - User found by id: user_id=214
2025-07-29 17:34:51,152 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:34:51,152 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=214, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:34:51,158 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=11, user_id=214, symbol=005930
2025-07-29 17:34:51,160 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:34:51,162 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:34:51,165 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:34:51,165 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 17:34:51,167 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:34:51,167 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:34:51,173 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 17:34:51,177 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=214, symbol=005930, trade_type=buy
2025-07-29 17:34:51,178 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:34:51,180 - src.api.services.stock_service - WARNING - 현재가 없음: 005930.
2025-07-29 17:34:51,180 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: None
2025-07-29 17:34:51,188 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=214, symbol=005930, trade_type=buy
2025-07-29 17:34:51,190 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 17:34:51,192 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=214
2025-07-29 17:34:51,195 - src.api.routers.simulated_trade - DEBUG - 사용자(214)의 모의매매 이력 1건 조회됨.
2025-07-29 17:34:51,195 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 17:34:51,196 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/214 "HTTP/1.1 200 OK"
2025-07-29 17:34:51,208 - src.api.main - INFO - [APScheduler] 가격 알림 체크 잡 실행: 2025-07-29 17:34:51.208204
2025-07-29 17:34:51,208 - src.api.main - DEBUG - 활성 알림 수: 3
2025-07-29 17:34:51,209 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:34:51,209 - src.api.main - DEBUG - 종목 정상종목 현재가: 110
2025-07-29 17:34:51,211 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='140145624716896'>, 목표 가격: 100, 조건: gte, 반복 주기: <MagicMock name='mock.repeat_interval' id='140145625778352'>
2025-07-29 17:34:51,212 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목, 현재가: 110, 목표가: 100
2025-07-29 17:34:51,216 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='140145625884960'>)
2025-07-29 17:34:51,218 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 17:34:51,219 - src.api.main - DEBUG - 종목 오류종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:34:51,220 - src.api.main - ERROR - 가격 알림 확인 중 '오류종목' 처리 오류: 현재가 조회 실패
Traceback (most recent call last):
  File "/app/src/api/main.py", line 145, in check_price_alerts_job
    price_data = stock_service.get_current_price_and_change(symbol, db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1179, in _execute_mock_call
    result = effect(*args, **kwargs)
  File "/app/src/api/tests/test_main_jobs.py", line 34, in get_current_price_side_effect
    raise ValueError("현재가 조회 실패")
ValueError: 현재가 조회 실패
2025-07-29 17:34:51,222 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:34:51,222 - src.api.main - DEBUG - 종목 정상종목2 현재가: 290
2025-07-29 17:34:51,227 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='140145628091472'>, 목표 가격: 300, 조건: lte, 반복 주기: <MagicMock name='mock.repeat_interval' id='140145628301872'>
2025-07-29 17:34:51,228 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목2, 현재가: 290, 목표가: 300
2025-07-29 17:34:51,229 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='140145625884960'>)
2025-07-29 17:34:51,229 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 17:34:51,229 - src.api.main - DEBUG - 모든 가격 알림 체크 및 DB 커밋 완료.
2025-07-29 17:34:51,239 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:34:51,240 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(10일)
2025-07-29 17:34:51,246 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:34:51,246 - src.api.services.predict_service - ERROR - 예측 불가: 데이터 분석 실패
2025-07-29 17:34:51,253 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:34:51,254 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:34:51,304 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=buy, confidence=70, reason=단기 이동평균선이 장기 이동평균선 위에 있습니다 (골든 크로스 또는 정배열). 현재가가 단기 이동평균선 위에 있습니다. 단기 및 장기 이동평균선이 모두 상승 중입니다. RSI(100)가 70 이상으로 과매수 구간입니다. MACD가 시그널 라인 위에 있고 MACD 히스토그램이 양수입니다 (매수 신호).
2025-07-29 17:34:51,305 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: buy
2025-07-29 17:34:51,310 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:34:51,311 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:34:51,342 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, confidence=70, reason=단기 이동평균선이 장기 이동평균선 아래에 있습니다 (데드 크로스 또는 역배열). 현재가가 단기 이동평균선 아래에 있습니다. 단기 및 장기 이동평균선이 모두 하락 중입니다. RSI(0)가 30 이하로 과매도 구간입니다. MACD가 시그널 라인 아래에 있고 MACD 히스토그램이 음수입니다 (매도 신호).
2025-07-29 17:34:51,343 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 17:34:51,509 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:34:51,509 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:34:51,517 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, confidence=55, reason=단기 이동평균선과 장기 이동평균선이 수렴 중입니다 (횡보). RSI(47)는 중립 구간입니다. MACD가 시그널 라인 아래에 있고 MACD 히스토그램이 음수입니다 (매도 신호). 저점 횡보 패턴 감지 (매수 기회).
2025-07-29 17:34:51,518 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 17:34:51,531 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:34:51,531 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:34:51,540 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, confidence=70, reason=단기 이동평균선이 장기 이동평균선 아래에 있습니다 (데드 크로스 또는 역배열). 현재가가 단기 이동평균선 아래에 있습니다. 단기 및 장기 이동평균선이 모두 하락 중입니다. RSI(3)가 30 이하로 과매도 구간입니다. MACD가 시그널 라인 아래에 있고 MACD 히스토그램이 음수입니다 (매도 신호).
2025-07-29 17:34:51,541 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 17:34:51,553 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:34:51,553 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 22개 데이터.
2025-07-29 17:34:51,561 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=buy, confidence=60, reason=단기 이동평균선이 장기 이동평균선 위에 있습니다 (골든 크로스 또는 정배열). 현재가가 단기 이동평균선 위에 있습니다. 단기 및 장기 이동평균선이 모두 상승 중입니다. RSI(100)가 70 이상으로 과매수 구간입니다. MACD가 시그널 라인 위에 있고 MACD 히스토그램이 양수입니다 (매수 신호). 급등 후 횡보 패턴 감지 (차익 실현 가능성).
2025-07-29 17:34:51,562 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: buy
2025-07-29 17:34:51,578 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:51,585 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:34:51,585 - src.api.services.stock_service - INFO - 신규 공시가 없습니다. (DB 기준: 202301010000001)
2025-07-29 17:34:51,593 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:51,597 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:34:51,603 - src.api.services.stock_service - INFO - 최초 실행. 기준 접수번호를 202301020000001로 DB에 설정합니다.
2025-07-29 17:34:51,604 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:34:51,605 - src.api.services.stock_service - INFO - 최초 실행. 기준 접수번호를 202301020000001로 DB에 설정합니다.
2025-07-29 17:34:51,614 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:51,623 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:34:51,624 - src.api.services.stock_service - INFO - 2건의 신규 공시를 발견했습니다.
2025-07-29 17:34:51,627 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 17:34:51,628 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 17:34:51,629 - src.api.services.stock_service - INFO - 마지막 확인 접수번호를 202301020000002로 DB에 갱신합니다.
2025-07-29 17:34:51,640 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:51,647 - src.api.services.stock_service - CRITICAL - DART API 사용 한도를 초과했습니다: [020] 사용 한도 초과
2025-07-29 17:34:51,655 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:51,660 - src.api.services.stock_service - ERROR - DART 공시 조회 중 API 오류 발생: [999] 기타 API 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 40, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
src.common.exceptions.DartApiError: [999] 기타 API 오류
2025-07-29 17:34:51,668 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:51,674 - src.api.services.stock_service - ERROR - 신규 공시 확인 및 알림 작업 중 예상치 못한 오류 발생: 예상치 못한 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 40, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: 예상치 못한 오류
2025-07-29 17:34:51,680 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:51,691 - src.api.services.stock_service - DEBUG - update_daily_prices 호출.
2025-07-29 17:34:51,692 - src.api.services.stock_service - DEBUG - DB에서 2개 종목 가져옴.
2025-07-29 17:34:51,693 - src.api.services.stock_service - DEBUG - 종목 005930 (삼성전자) 일별시세 갱신 시작.
2025-07-29 17:34:51,696 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 005930 - 2025-07-29
2025-07-29 17:34:51,699 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 005930 - 2025-07-28
2025-07-29 17:34:51,699 - src.api.services.stock_service - DEBUG - 종목 000660 (SK하이닉스) 일별시세 갱신 시작.
2025-07-29 17:34:51,701 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 000660 - 2025-07-29
2025-07-29 17:34:51,703 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 000660 - 2025-07-28
2025-07-29 17:34:51,711 - src.api.services.stock_service - INFO - 일별시세 갱신 완료: 4개 데이터 처리. 오류: 0개 종목
2025-07-29 17:34:51,724 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:51,731 - src.api.services.stock_service - DEBUG - update_daily_prices 호출.
2025-07-29 17:34:51,733 - src.api.services.stock_service - DEBUG - DB에서 1개 종목 가져옴.
2025-07-29 17:34:51,733 - src.api.services.stock_service - DEBUG - 종목 005930 (삼성전자) 일별시세 갱신 시작.
2025-07-29 17:34:51,733 - src.api.services.stock_service - WARNING - 종목 005930에 대한 일별시세 데이터가 없습니다.
2025-07-29 17:34:51,734 - src.api.services.stock_service - INFO - 일별시세 갱신 완료: 0개 데이터 처리. 오류: 1개 종목
2025-07-29 17:34:51,744 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:51,752 - src.api.services.stock_service - DEBUG - update_daily_prices 호출.
2025-07-29 17:34:51,753 - src.api.services.stock_service - DEBUG - DB에서 1개 종목 가져옴.
2025-07-29 17:34:51,754 - src.api.services.stock_service - DEBUG - 종목 005930 (삼성전자) 일별시세 갱신 시작.
2025-07-29 17:34:51,754 - src.api.services.stock_service - ERROR - 일별시세 갱신 중 '005930' 처리에서 오류 발생: API Error
2025-07-29 17:34:51,754 - src.api.services.stock_service - INFO - 일별시세 갱신 완료: 0개 데이터 처리. 오류: 1개 종목
2025-07-29 17:34:51,765 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:51,772 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:34:51,774 - src.api.services.stock_service - DEBUG - 현재가 발견: 005930 - 71500.0
2025-07-29 17:34:51,775 - src.api.services.stock_service - DEBUG - 전일 종가 발견: 005930 - 70500.0
2025-07-29 17:34:51,804 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:51,805 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=NONEXIST
2025-07-29 17:34:51,808 - src.api.services.stock_service - WARNING - 현재가 없음: NONEXIST.
2025-07-29 17:34:51,820 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:34:51,827 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:34:51,829 - src.api.services.stock_service - DEBUG - 현재가 발견: 005930 - 71500.0
2025-07-29 17:34:51,829 - src.api.services.stock_service - WARNING - 전일 종가 없음: 005930. 등락률 계산 불가.
2025-07-29 17:36:24,307 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 17:36:24,312 - src.api.main - INFO - DB 테이블이 성공적으로 생성되었거나 이미 존재합니다.
2025-07-29 17:36:24,316 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:36:24,316 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:36:24,316 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:36:24,317 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-07-29 17:36:25,192 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:25,197 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 17:36:25,203 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-07-29 17:36:25,204 - passlib.handlers.bcrypt - DEBUG - detected 'bcrypt' backend, version '<unknown>'
2025-07-29 17:36:25,204 - passlib.handlers.bcrypt - DEBUG - 'bcrypt' backend lacks $2$ support, enabling workaround
2025-07-29 17:36:25,469 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:25,472 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:36:25,790 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:25,795 - httpx - INFO - HTTP Request: GET http://testserver/health "HTTP/1.1 200 OK"
2025-07-29 17:36:26,235 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:26,238 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 17:36:26,239 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 17:36:26,248 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3859744359, username=testuser_3859744359
2025-07-29 17:36:26,260 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=1, telegram_id=3859744359
2025-07-29 17:36:26,512 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:26,768 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 200 OK"
2025-07-29 17:36:26,779 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6174081702, username=testuser_6174081702
2025-07-29 17:36:26,786 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=3, telegram_id=6174081702
2025-07-29 17:36:27,030 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:26,513 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 17:36:26,524 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7869758264, username=testuser_7869758264
2025-07-29 17:36:26,531 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=5, telegram_id=7869758264
2025-07-29 17:36:26,770 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:26,775 - httpx - INFO - HTTP Request: GET http://testserver/admin/admin_stats "HTTP/1.1 403 Forbidden"
2025-07-29 17:36:26,786 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6624623001, username=testuser_6624623001
2025-07-29 17:36:26,795 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=7, telegram_id=6624623001
2025-07-29 17:36:27,039 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:27,398 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 200 OK"
2025-07-29 17:36:27,412 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6306976977, username=testuser_6306976977
2025-07-29 17:36:27,419 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=9, telegram_id=6306976977
2025-07-29 17:36:27,666 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:27,911 - src.api.routers.admin - ERROR - /admin/update_master 서버 오류: DB connection error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 36, in update_stock_master
    result = await stock_service.update_stock_master(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DB connection error
2025-07-29 17:36:27,919 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:36:27,936 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6728946969, username=testuser_6728946969
2025-07-29 17:36:27,943 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=11, telegram_id=6728946969
2025-07-29 17:36:28,202 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:28,451 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 17:36:28,463 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9699801492, username=testuser_9699801492
2025-07-29 17:36:28,468 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=13, telegram_id=9699801492
2025-07-29 17:36:28,715 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:28,721 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_master "HTTP/1.1 403 Forbidden"
2025-07-29 17:36:28,731 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4073951459, username=testuser_4073951459
2025-07-29 17:36:28,737 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=15, telegram_id=4073951459
2025-07-29 17:36:29,022 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:29,296 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 200 OK"
2025-07-29 17:36:29,308 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5673954695, username=testuser_5673954695
2025-07-29 17:36:29,314 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=17, telegram_id=5673954695
2025-07-29 17:36:29,589 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:29,845 - src.api.routers.admin - ERROR - /admin/update_price 서버 오류: API call failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 53, in update_daily_price
    result = await stock_service.update_daily_prices(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: API call failed
2025-07-29 17:36:29,846 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:36:29,860 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8520621381, username=testuser_8520621381
2025-07-29 17:36:29,866 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=19, telegram_id=8520621381
2025-07-29 17:36:30,121 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:30,368 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 17:36:30,379 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7122514540, username=testuser_7122514540
2025-07-29 17:36:30,384 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=21, telegram_id=7122514540
2025-07-29 17:36:30,626 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:30,632 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_price "HTTP/1.1 403 Forbidden"
2025-07-29 17:36:30,643 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5037848814, username=testuser_5037848814
2025-07-29 17:36:30,649 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=23, telegram_id=5037848814
2025-07-29 17:36:30,910 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:31,161 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f46aff248b0>
2025-07-29 17:36:31,162 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:36:31,164 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 200 OK"
2025-07-29 17:36:31,178 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1095114300, username=testuser_1095114300
2025-07-29 17:36:31,184 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=25, telegram_id=1095114300
2025-07-29 17:36:31,430 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:31,686 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f46aff310f0>
2025-07-29 17:36:31,687 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:36:31,689 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 200 OK"
2025-07-29 17:36:31,706 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6282042113, username=testuser_6282042113
2025-07-29 17:36:31,715 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=27, telegram_id=6282042113
2025-07-29 17:36:31,985 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:32,243 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f46b40fbf10>
2025-07-29 17:36:32,244 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:36:32,245 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=%EC%B9%B4%EC%B9%B4%EC%98%A4 "HTTP/1.1 200 OK"
2025-07-29 17:36:32,258 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6740239826, username=testuser_6740239826
2025-07-29 17:36:32,265 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=29, telegram_id=6740239826
2025-07-29 17:36:32,574 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:32,837 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f46b4106ef0>
2025-07-29 17:36:32,838 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:36:32,840 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=0013456 "HTTP/1.1 200 OK"
2025-07-29 17:36:32,852 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9350229236, username=testuser_9350229236
2025-07-29 17:36:32,858 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=31, telegram_id=9350229236
2025-07-29 17:36:33,105 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:33,363 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f46affaa200>
2025-07-29 17:36:33,363 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:36:33,366 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=NONEXIST "HTTP/1.1 404 Not Found"
2025-07-29 17:36:33,391 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3711990575, username=testuser_3711990575
2025-07-29 17:36:33,398 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=33, telegram_id=3711990575
2025-07-29 17:36:33,654 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:33,907 - src.api.routers.admin - INFO - Authenticated User: <src.api.models.user.User object at 0x7f46b40a1990>
2025-07-29 17:36:33,908 - src.api.routers.admin - INFO - User Role: admin
2025-07-29 17:36:33,908 - src.api.routers.admin - ERROR - /admin/update_disclosure 서버 오류: DART API error
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 126, in update_disclosure
    result = await stock_service.update_disclosures(db, corp_code=corp_code, stock_code=stock_code or '', stock_name=stock_name or '')
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: DART API error
2025-07-29 17:36:33,909 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure?code_or_name=005930 "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:36:33,921 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9068864067, username=testuser_9068864067
2025-07-29 17:36:33,932 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=35, telegram_id=9068864067
2025-07-29 17:36:34,202 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:34,451 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 17:36:34,463 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5659237449, username=testuser_5659237449
2025-07-29 17:36:34,469 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=37, telegram_id=5659237449
2025-07-29 17:36:34,716 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:34,722 - httpx - INFO - HTTP Request: POST http://testserver/admin/update_disclosure "HTTP/1.1 403 Forbidden"
2025-07-29 17:36:34,733 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2421195729, username=testuser_2421195729
2025-07-29 17:36:34,741 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=39, telegram_id=2421195729
2025-07-29 17:36:34,986 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:35,258 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:36:35,271 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6959873233, username=testuser_6959873233
2025-07-29 17:36:35,278 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=41, telegram_id=6959873233
2025-07-29 17:36:35,521 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:35,787 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 200 OK"
2025-07-29 17:36:35,837 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7304438154, username=testuser_7304438154
2025-07-29 17:36:35,857 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=43, telegram_id=7304438154
2025-07-29 17:36:36,138 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:36,421 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 17:36:36,432 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9793319918, username=testuser_9793319918
2025-07-29 17:36:36,437 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=45, telegram_id=9793319918
2025-07-29 17:36:36,682 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:36,689 - httpx - INFO - HTTP Request: GET http://testserver/admin/schedule/status "HTTP/1.1 403 Forbidden"
2025-07-29 17:36:36,701 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3981861700, username=testuser_3981861700
2025-07-29 17:36:36,707 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=47, telegram_id=3981861700
2025-07-29 17:36:36,956 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:37,206 - src.api.routers.admin - ERROR - [trigger_job] 잡을 찾을 수 없습니다: nonexistent_job
2025-07-29 17:36:37,207 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/nonexistent_job "HTTP/1.1 404 Not Found"
2025-07-29 17:36:37,218 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9789215774, username=testuser_9789215774
2025-07-29 17:36:37,224 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=49, telegram_id=9789215774
2025-07-29 17:36:37,471 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:37,720 - src.api.routers.admin - ERROR - [trigger_job] 잡 실행 실패: test_job - Job execution failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 175, in trigger_job
    job.func(*job.args, **job.kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1173, in _execute_mock_call
    raise effect
Exception: Job execution failed

2025-07-29 17:36:37,722 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:36:37,737 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5451802254, username=testuser_5451802254
2025-07-29 17:36:37,743 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=51, telegram_id=5451802254
2025-07-29 17:36:37,993 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:38,253 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 17:36:38,266 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8072562580, username=testuser_8072562580
2025-07-29 17:36:38,272 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=53, telegram_id=8072562580
2025-07-29 17:36:38,531 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:38,538 - httpx - INFO - HTTP Request: POST http://testserver/admin/schedule/trigger/test_job "HTTP/1.1 403 Forbidden"
2025-07-29 17:36:38,551 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4901372559, username=testuser_4901372559
2025-07-29 17:36:38,558 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=55, telegram_id=4901372559
2025-07-29 17:36:38,811 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:39,154 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 17:36:39,156 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 200 OK"
2025-07-29 17:36:39,175 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4078281708, username=testuser_4078281708
2025-07-29 17:36:39,181 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=57, telegram_id=4078281708
2025-07-29 17:36:39,426 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:39,670 - src.api.routers.admin - INFO - 관리자에 의해 공시 확인 잡이 수동으로 트리거되었습니다.
2025-07-29 17:36:39,671 - src.api.routers.admin - ERROR - 공시 확인 잡 수동 실행 중 오류 발생: Disclosure check failed
Traceback (most recent call last):
  File "/app/src/api/routers/admin.py", line 193, in trigger_check_disclosures_job
    await stock_service.check_and_notify_new_disclosures(db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: Disclosure check failed
2025-07-29 17:36:39,672 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 500 Internal Server Error"
2025-07-29 17:36:39,685 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3776873146, username=testuser_3776873146
2025-07-29 17:36:39,691 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=59, telegram_id=3776873146
2025-07-29 17:36:39,931 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:40,185 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 17:36:40,200 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8877816875, username=testuser_8877816875
2025-07-29 17:36:40,206 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=61, telegram_id=8877816875
2025-07-29 17:36:40,450 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:40,457 - httpx - INFO - HTTP Request: POST http://testserver/admin/trigger/check_disclosures "HTTP/1.1 403 Forbidden"
2025-07-29 17:36:40,470 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1957079075, username=testuser_1957079075
2025-07-29 17:36:40,476 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=63, telegram_id=1957079075
2025-07-29 17:36:40,727 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:40,991 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:36:40,996 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=65, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:36:41,006 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=1, user_id=65, symbol=005930
2025-07-29 17:36:41,008 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:36:41,022 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7250503705, username=testuser_7250503705
2025-07-29 17:36:41,030 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=66, telegram_id=7250503705
2025-07-29 17:36:41,277 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:41,282 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:36:41,294 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1012089966, username=testuser_1012089966
2025-07-29 17:36:41,300 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=68, telegram_id=1012089966
2025-07-29 17:36:41,543 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:41,792 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:36:41,793 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:36:41,807 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4286324118, username=testuser_4286324118
2025-07-29 17:36:41,815 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=71, telegram_id=4286324118
2025-07-29 17:36:42,059 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:42,309 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:36:42,310 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:36:42,317 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=2, user_id=73, symbol=005930
2025-07-29 17:36:42,318 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:36:42,321 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:36:42,324 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=73, symbol=035720, target_price=50000.0, condition=lte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:36:42,331 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=3, user_id=73, symbol=035720
2025-07-29 17:36:42,332 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:36:42,335 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:36:42,337 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 조회 시도.
2025-07-29 17:36:42,341 - src.api.services.price_alert_service - DEBUG - 사용자(73)의 가격 알림 2개 조회됨.
2025-07-29 17:36:42,345 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:36:42,355 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5365349422, username=testuser_5365349422
2025-07-29 17:36:42,362 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=74, telegram_id=5365349422
2025-07-29 17:36:42,683 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:42,942 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:36:42,943 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 조회 시도.
2025-07-29 17:36:42,944 - src.api.services.price_alert_service - DEBUG - 사용자(76)의 가격 알림 0개 조회됨.
2025-07-29 17:36:42,946 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:36:42,956 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7176142621, username=testuser_7176142621
2025-07-29 17:36:42,962 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=77, telegram_id=7176142621
2025-07-29 17:36:43,266 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:43,273 - httpx - INFO - HTTP Request: GET http://testserver/alerts/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:36:43,288 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4731408942, username=testuser_4731408942
2025-07-29 17:36:43,295 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=79, telegram_id=4731408942
2025-07-29 17:36:43,542 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:43,802 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:36:43,803 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=81, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:36:43,810 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=4, user_id=81, symbol=005930
2025-07-29 17:36:43,813 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:36:43,817 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:36:43,818 - src.api.services.price_alert_service - DEBUG - 사용자(81)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:36:43,821 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=4
2025-07-29 17:36:43,823 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/81/symbol/005930 "HTTP/1.1 200 OK"
2025-07-29 17:36:43,834 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4689815971, username=testuser_4689815971
2025-07-29 17:36:43,840 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=82, telegram_id=4689815971
2025-07-29 17:36:44,090 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:44,340 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:36:44,341 - src.api.services.price_alert_service - DEBUG - 사용자(84)와 종목(NONEXISTENT)으로 가격 알림 조회 시도.
2025-07-29 17:36:44,343 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=84, symbol=NONEXISTENT
2025-07-29 17:36:44,344 - httpx - INFO - HTTP Request: GET http://testserver/alerts/user/84/symbol/NONEXISTENT "HTTP/1.1 404 Not Found"
2025-07-29 17:36:44,359 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3647860658, username=testuser_3647860658
2025-07-29 17:36:44,366 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=85, telegram_id=3647860658
2025-07-29 17:36:44,610 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:44,861 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:36:44,862 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=87, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:36:44,867 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=5, user_id=87, symbol=005930
2025-07-29 17:36:44,869 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:36:44,871 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:36:44,876 - src.api.services.price_alert_service - DEBUG - 가격 알림(5) 수정 시도: update_data={'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 17:36:44,879 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:36:44,879 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0, 'condition': 'lte', 'is_active': False}
2025-07-29 17:36:44,879 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:36:44,885 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:36:44,885 - src.api.services.price_alert_service - INFO - 가격 알림(5) 수정 성공.
2025-07-29 17:36:44,887 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/5 "HTTP/1.1 200 OK"
2025-07-29 17:36:44,898 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2182662056, username=testuser_2182662056
2025-07-29 17:36:44,903 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=88, telegram_id=2182662056
2025-07-29 17:36:45,157 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:45,434 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:36:45,435 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=90, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:36:45,443 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=6, user_id=90, symbol=005930
2025-07-29 17:36:45,446 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:36:45,450 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/6 "HTTP/1.1 403 Forbidden"
2025-07-29 17:36:45,464 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1625051384, username=testuser_1625051384
2025-07-29 17:36:45,473 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=91, telegram_id=1625051384
2025-07-29 17:36:45,723 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:45,972 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:36:45,973 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 17:36:45,975 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 17:36:45,982 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:36:45,995 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5446857972, username=testuser_5446857972
2025-07-29 17:36:46,003 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=94, telegram_id=5446857972
2025-07-29 17:36:46,263 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:46,845 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:36:46,846 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=96, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:36:46,853 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=7, user_id=96, symbol=005930
2025-07-29 17:36:46,855 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:36:46,858 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:36:46,859 - src.api.services.price_alert_service - DEBUG - 가격 알림(7) 수정 시도: update_data={'target_price': 95000.0}
2025-07-29 17:36:46,861 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:36:46,861 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 95000.0}
2025-07-29 17:36:46,861 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:36:46,867 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:36:46,868 - src.api.services.price_alert_service - INFO - 가격 알림(7) 수정 성공.
2025-07-29 17:36:46,870 - httpx - INFO - HTTP Request: PUT http://testserver/alerts/7 "HTTP/1.1 403 Forbidden"
2025-07-29 17:36:46,881 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2295848041, username=testuser_2295848041
2025-07-29 17:36:46,888 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=98, telegram_id=2295848041
2025-07-29 17:36:47,132 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:47,382 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:36:47,383 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=100, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:36:47,389 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=8, user_id=100, symbol=005930
2025-07-29 17:36:47,391 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:36:47,394 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:36:47,397 - src.api.services.price_alert_service - DEBUG - 가격 알림(8) 삭제 시도.
2025-07-29 17:36:47,401 - src.api.services.price_alert_service - INFO - 가격 알림(8) 삭제 성공.
2025-07-29 17:36:47,402 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/8 "HTTP/1.1 200 OK"
2025-07-29 17:36:47,416 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3537785120, username=testuser_3537785120
2025-07-29 17:36:47,422 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=101, telegram_id=3537785120
2025-07-29 17:36:47,693 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:47,951 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:36:47,952 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=103, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:36:47,958 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=9, user_id=103, symbol=005930
2025-07-29 17:36:47,959 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:36:47,962 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/9 "HTTP/1.1 403 Forbidden"
2025-07-29 17:36:47,971 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6900464545, username=testuser_6900464545
2025-07-29 17:36:47,977 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=104, telegram_id=6900464545
2025-07-29 17:36:48,220 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:48,485 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:36:48,487 - src.api.services.price_alert_service - DEBUG - 가격 알림(99999) 삭제 시도.
2025-07-29 17:36:48,491 - src.api.services.price_alert_service - ERROR - Alert not found: 99999
2025-07-29 17:36:48,493 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:36:48,507 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9141831161, username=testuser_9141831161
2025-07-29 17:36:48,516 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=107, telegram_id=9141831161
2025-07-29 17:36:48,797 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:49,299 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:36:49,300 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=109, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:36:49,306 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=10, user_id=109, symbol=005930
2025-07-29 17:36:49,308 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:36:49,311 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:36:49,315 - httpx - INFO - HTTP Request: DELETE http://testserver/alerts/10 "HTTP/1.1 403 Forbidden"
2025-07-29 17:36:49,326 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5059314680, username=testuser_5059314680
2025-07-29 17:36:49,332 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=111, telegram_id=5059314680
2025-07-29 17:36:49,579 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:49,584 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 17:36:49,594 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1701055403, username=testuser_1701055403
2025-07-29 17:36:49,600 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=113, telegram_id=1701055403
2025-07-29 17:36:49,846 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:49,853 - httpx - INFO - HTTP Request: POST http://testserver/alerts/test_notify "HTTP/1.1 200 OK"
2025-07-29 17:36:49,861 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:49,864 - httpx - INFO - HTTP Request: GET http://testserver/ "HTTP/1.1 200 OK"
2025-07-29 17:36:49,880 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4489595450, username=testuser_4489595450
2025-07-29 17:36:49,889 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=115, telegram_id=4489595450
2025-07-29 17:36:50,148 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:50,151 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:36:50,155 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:36:50,155 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 17:36:50,159 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:36:50,159 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:36:50,161 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 17:36:50,173 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8023834292, username=testuser_8023834292
2025-07-29 17:36:50,179 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=117, telegram_id=8023834292
2025-07-29 17:36:50,430 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:50,434 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:36:50,439 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=INVALID
2025-07-29 17:36:50,440 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=INVALID, days=40
2025-07-29 17:36:50,442 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:36:50,443 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:36:50,444 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 17:36:50,458 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7203547934, username=testuser_7203547934
2025-07-29 17:36:50,463 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=119, telegram_id=7203547934
2025-07-29 17:36:50,734 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:50,740 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:36:50,745 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:36:50,778 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9723145879, username=testuser_9723145879
2025-07-29 17:36:50,799 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=121, telegram_id=9723145879
2025-07-29 17:36:51,075 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:51,333 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=123, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:36:51,337 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 17:36:51,339 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:36:51,342 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/123 "HTTP/1.1 200 OK"
2025-07-29 17:36:51,359 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3237867929, username=testuser_3237867929
2025-07-29 17:36:51,365 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=124, telegram_id=3237867929
2025-07-29 17:36:51,610 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:51,618 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=99999, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:36:51,620 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 17:36:51,621 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:36:51,623 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/99999 "HTTP/1.1 200 OK"
2025-07-29 17:36:51,636 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2643767132, username=testuser_2643767132
2025-07-29 17:36:51,642 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=126, telegram_id=2643767132
2025-07-29 17:36:51,887 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:52,151 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=128, page=1, page_size=10, symbol=None, prediction=None
2025-07-29 17:36:52,154 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 0
2025-07-29 17:36:52,156 - src.api.routers.prediction_history - DEBUG - 예측 이력 0개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:36:52,158 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/128 "HTTP/1.1 200 OK"
2025-07-29 17:36:52,174 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3455709719, username=testuser_3455709719
2025-07-29 17:36:52,182 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=129, telegram_id=3455709719
2025-07-29 17:36:52,438 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:52,704 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=1, page_size=5, symbol=None, prediction=None
2025-07-29 17:36:52,706 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 17:36:52,709 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 1, 페이지 크기 5).
2025-07-29 17:36:52,711 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=1&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 17:36:52,714 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=131, page=2, page_size=5, symbol=None, prediction=None
2025-07-29 17:36:52,716 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 14
2025-07-29 17:36:52,719 - src.api.routers.prediction_history - DEBUG - 예측 이력 5개 조회됨 (페이지 2, 페이지 크기 5).
2025-07-29 17:36:52,721 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/131?page=2&page_size=5 "HTTP/1.1 200 OK"
2025-07-29 17:36:52,735 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2285042096, username=testuser_2285042096
2025-07-29 17:36:52,741 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=132, telegram_id=2285042096
2025-07-29 17:36:52,994 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:53,253 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=134, page=1, page_size=10, symbol=005930, prediction=None
2025-07-29 17:36:53,254 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 17:36:53,258 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 2
2025-07-29 17:36:53,262 - src.api.routers.prediction_history - DEBUG - 예측 이력 2개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:36:53,264 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/134?symbol=005930 "HTTP/1.1 200 OK"
2025-07-29 17:36:53,281 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3812098329, username=testuser_3812098329
2025-07-29 17:36:53,287 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=135, telegram_id=3812098329
2025-07-29 17:36:53,545 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:53,803 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=137, page=1, page_size=10, symbol=None, prediction=상승
2025-07-29 17:36:53,804 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=상승
2025-07-29 17:36:53,808 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 17:36:53,811 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:36:53,813 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/137?prediction=%EC%83%81%EC%8A%B9 "HTTP/1.1 200 OK"
2025-07-29 17:36:53,828 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7026719796, username=testuser_7026719796
2025-07-29 17:36:53,836 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=138, telegram_id=7026719796
2025-07-29 17:36:54,142 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:54,451 - src.api.routers.prediction_history - DEBUG - get_prediction_history 호출: user_id=140, page=1, page_size=10, symbol=005930, prediction=유지
2025-07-29 17:36:54,452 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: symbol=005930
2025-07-29 17:36:54,453 - src.api.routers.prediction_history - DEBUG - 예측 이력 필터 적용: prediction=유지
2025-07-29 17:36:54,458 - src.api.routers.prediction_history - DEBUG - 예측 이력 총 개수: 1
2025-07-29 17:36:54,462 - src.api.routers.prediction_history - DEBUG - 예측 이력 1개 조회됨 (페이지 1, 페이지 크기 10).
2025-07-29 17:36:54,464 - httpx - INFO - HTTP Request: GET http://testserver/prediction/history/140?symbol=005930&prediction=%EC%9C%A0%EC%A7%80 "HTTP/1.1 200 OK"
2025-07-29 17:36:54,484 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3466875862, username=testuser_3466875862
2025-07-29 17:36:54,493 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=141, telegram_id=3466875862
2025-07-29 17:36:54,745 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:54,756 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=143, symbol=005930, trade_type=buy
2025-07-29 17:36:54,756 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:36:54,759 - src.api.services.stock_service - WARNING - 현재가 없음: 005930.
2025-07-29 17:36:54,760 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: None
2025-07-29 17:36:54,766 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=143, symbol=005930, trade_type=buy
2025-07-29 17:36:54,768 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 17:36:54,774 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=143
2025-07-29 17:36:54,777 - src.api.routers.simulated_trade - DEBUG - 사용자(143)의 모의매매 이력 1건 조회됨.
2025-07-29 17:36:54,777 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 17:36:54,779 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/143 "HTTP/1.1 200 OK"
2025-07-29 17:36:54,793 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1945425080, username=testuser_1945425080
2025-07-29 17:36:54,801 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=144, telegram_id=1945425080
2025-07-29 17:36:55,049 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:55,072 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 17:36:55,087 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6903813482, username=testuser_6903813482
2025-07-29 17:36:55,094 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=146, telegram_id=6903813482
2025-07-29 17:36:55,344 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:55,352 - httpx - INFO - HTTP Request: GET http://testserver/symbols/ "HTTP/1.1 200 OK"
2025-07-29 17:36:55,367 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6564497152, username=testuser_6564497152
2025-07-29 17:36:55,372 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=148, telegram_id=6564497152
2025-07-29 17:36:55,617 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:55,635 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%82%BC%EC%84%B1%EC%A0%84%EC%9E%90 "HTTP/1.1 200 OK"
2025-07-29 17:36:55,650 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5610715005, username=testuser_5610715005
2025-07-29 17:36:55,656 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=150, telegram_id=5610715005
2025-07-29 17:36:55,913 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:56,038 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=035720 "HTTP/1.1 200 OK"
2025-07-29 17:36:56,058 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2080301199, username=testuser_2080301199
2025-07-29 17:36:56,065 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=152, telegram_id=2080301199
2025-07-29 17:36:56,008 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:56,026 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=sk%ED%95%98%EC%9D%B4%EB%8B%89%EC%8A%A4 "HTTP/1.1 200 OK"
2025-07-29 17:36:56,040 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5022001680, username=testuser_5022001680
2025-07-29 17:36:56,047 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=154, telegram_id=5022001680
2025-07-29 17:36:55,833 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:55,844 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query=%EC%97%86%EB%8A%94%EC%A2%85%EB%AA%A9 "HTTP/1.1 200 OK"
2025-07-29 17:36:55,861 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6723498498, username=testuser_6723498498
2025-07-29 17:36:55,868 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=156, telegram_id=6723498498
2025-07-29 17:36:56,131 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:56,138 - httpx - INFO - HTTP Request: GET http://testserver/symbols/search?query= "HTTP/1.1 422 Unprocessable Entity"
2025-07-29 17:36:56,152 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1616468449, username=testuser_1616468449
2025-07-29 17:36:56,158 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=158, telegram_id=1616468449
2025-07-29 17:36:56,403 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:56,411 - httpx - INFO - HTTP Request: GET http://testserver/symbols/005930/current_price_and_change "HTTP/1.1 200 OK"
2025-07-29 17:36:56,425 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6878693599, username=testuser_6878693599
2025-07-29 17:36:56,431 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=160, telegram_id=6878693599
2025-07-29 17:36:56,779 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:56,789 - httpx - INFO - HTTP Request: GET http://testserver/symbols/NONEXISTENT/current_price_and_change "HTTP/1.1 404 Not Found"
2025-07-29 17:36:56,806 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5073318430, username=testuser_5073318430
2025-07-29 17:36:56,813 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=162, telegram_id=5073318430
2025-07-29 17:36:57,061 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:57,321 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 17:36:57,334 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8009482264, username=testuser_8009482264
2025-07-29 17:36:57,340 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=165, telegram_id=8009482264
2025-07-29 17:36:57,589 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:57,852 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 400 Bad Request"
2025-07-29 17:36:57,863 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2422624728, username=testuser_2422624728
2025-07-29 17:36:57,872 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=168, telegram_id=2422624728
2025-07-29 17:36:58,125 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:58,635 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 17:36:58,646 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8635871645, username=testuser_8635871645
2025-07-29 17:36:58,651 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=171, telegram_id=8635871645
2025-07-29 17:36:58,893 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:58,901 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 17:36:58,912 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1770405279, username=testuser_1770405279
2025-07-29 17:36:58,918 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=173, telegram_id=1770405279
2025-07-29 17:36:59,165 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:36:59,653 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 401 Unauthorized"
2025-07-29 17:36:59,667 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=9973923470, username=testuser_9973923470
2025-07-29 17:36:59,674 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=176, telegram_id=9973923470
2025-07-29 17:36:59,918 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:00,170 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 178
2025-07-29 17:37:00,172 - src.api.services.user_service - DEBUG - User found by id: user_id=178
2025-07-29 17:37:00,177 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 17:37:00,189 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7397883193, username=testuser_7397883193
2025-07-29 17:37:00,195 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=179, telegram_id=7397883193
2025-07-29 17:37:00,561 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:00,568 - httpx - INFO - HTTP Request: GET http://testserver/users/me "HTTP/1.1 403 Forbidden"
2025-07-29 17:37:00,599 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7699299861, username=testuser_7699299861
2025-07-29 17:37:00,614 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=181, telegram_id=7699299861
2025-07-29 17:37:00,882 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:01,138 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 183
2025-07-29 17:37:01,140 - src.api.services.user_service - DEBUG - User found by id: user_id=183
2025-07-29 17:37:01,152 - httpx - INFO - HTTP Request: PUT http://testserver/users/me "HTTP/1.1 200 OK"
2025-07-29 17:37:01,165 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=4384938600, username=testuser_4384938600
2025-07-29 17:37:01,172 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=184, telegram_id=4384938600
2025-07-29 17:37:01,423 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:01,441 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 17:37:01,454 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6082292727, username=testuser_6082292727
2025-07-29 17:37:01,460 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=187, telegram_id=6082292727
2025-07-29 17:37:01,712 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:01,988 - httpx - INFO - HTTP Request: PUT http://testserver/users/telegram_register "HTTP/1.1 200 OK"
2025-07-29 17:37:01,999 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6087232840, username=testuser_6087232840
2025-07-29 17:37:02,006 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=190, telegram_id=6087232840
2025-07-29 17:37:02,251 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:02,509 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/192 "HTTP/1.1 200 OK"
2025-07-29 17:37:02,520 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6963669742, username=testuser_6963669742
2025-07-29 17:37:02,527 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=193, telegram_id=6963669742
2025-07-29 17:37:02,776 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:02,787 - httpx - INFO - HTTP Request: GET http://testserver/users/stats/99999 "HTTP/1.1 404 Not Found"
2025-07-29 17:37:02,802 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=7839775281, username=testuser_7839775281
2025-07-29 17:37:02,811 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=195, telegram_id=7839775281
2025-07-29 17:37:03,094 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:03,594 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 197
2025-07-29 17:37:03,595 - src.api.services.user_service - DEBUG - User found by id: user_id=197
2025-07-29 17:37:03,603 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 200 OK"
2025-07-29 17:37:03,617 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5685710451, username=testuser_5685710451
2025-07-29 17:37:03,624 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=199, telegram_id=5685710451
2025-07-29 17:37:03,866 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:04,118 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 201
2025-07-29 17:37:04,120 - src.api.services.user_service - DEBUG - User found by id: user_id=201
2025-07-29 17:37:04,122 - httpx - INFO - HTTP Request: GET http://testserver/users/ "HTTP/1.1 403 Forbidden"
2025-07-29 17:37:04,134 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=5217613685, username=testuser_5217613685
2025-07-29 17:37:04,141 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=202, telegram_id=5217613685
2025-07-29 17:37:04,471 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:04,480 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=204, symbol=005930
2025-07-29 17:37:04,492 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=204, symbol=005930
2025-07-29 17:37:04,495 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 17:37:04,502 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 시도: user_id=204
2025-07-29 17:37:04,507 - src.api.routers.watchlist - DEBUG - 관심 종목 조회 성공: user_id=204, 1개 종목.
2025-07-29 17:37:04,509 - httpx - INFO - HTTP Request: GET http://testserver/watchlist/get/204 "HTTP/1.1 200 OK"
2025-07-29 17:37:04,516 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:04,518 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:37:04,519 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:37:04,524 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:37:04,527 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12345
2025-07-29 17:37:04,532 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=1, telegram_id=12345
2025-07-29 17:37:04,532 - src.api.services.price_alert_service - DEBUG - 사용자(1)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:37:04,539 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=1
2025-07-29 17:37:04,539 - src.api.services.price_alert_service - DEBUG - 가격 알림(1) 수정 시도: update_data={'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 17:37:04,542 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:37:04,543 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 75000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'daily'}
2025-07-29 17:37:04,543 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:37:04,547 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:37:04,547 - src.api.services.price_alert_service - INFO - 가격 알림(1) 수정 성공.
2025-07-29 17:37:04,549 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:37:04,554 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:37:04,554 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:37:04,558 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:37:04,559 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 17:37:04,561 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 17:37:04,562 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:37:04,563 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 17:37:04,564 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 17:37:04,565 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:37:04,566 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 70000.0, 'condition': 'lte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': None}
2025-07-29 17:37:04,566 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:37:04,576 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:37:04,576 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 17:37:04,579 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:37:04,582 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:37:04,583 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 12346
2025-07-29 17:37:04,585 - src.api.services.user_service - DEBUG - User found by telegram_id: user_id=2, telegram_id=12346
2025-07-29 17:37:04,586 - src.api.services.price_alert_service - DEBUG - 사용자(2)와 종목(005930)으로 가격 알림 조회 시도.
2025-07-29 17:37:04,587 - src.api.services.price_alert_service - DEBUG - 가격 알림 발견: alert_id=2
2025-07-29 17:37:04,587 - src.api.services.price_alert_service - DEBUG - 가격 알림(2) 수정 시도: update_data={'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 17:37:04,588 - src.api.services.price_alert_service - DEBUG - Alert before update: notify_on_disclosure=True, is_active=True
2025-07-29 17:37:04,589 - src.api.services.price_alert_service - DEBUG - Update data: {'target_price': 76000.0, 'condition': 'gte', 'is_active': True, 'notify_on_disclosure': True, 'repeat_interval': 'weekly'}
2025-07-29 17:37:04,589 - src.api.services.price_alert_service - DEBUG - After setattr: alert.notify_on_disclosure = True
2025-07-29 17:37:04,594 - src.api.services.price_alert_service - DEBUG - After db.refresh: alert.notify_on_disclosure = True
2025-07-29 17:37:04,594 - src.api.services.price_alert_service - INFO - 가격 알림(2) 수정 성공.
2025-07-29 17:37:04,596 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:37:04,612 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6941967086, username=testuser_6941967086
2025-07-29 17:37:04,619 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=205, telegram_id=6941967086
2025-07-29 17:37:04,621 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:04,623 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:37:04,625 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:37:04,628 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 6941967086
2025-07-29 17:37:04,631 - src.api.services.user_service - DEBUG - User not found for telegram_id: 6941967086
2025-07-29 17:37:04,632 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6941967086, username=testuser_6941967086
2025-07-29 17:37:04,641 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=250, telegram_id=6941967086
2025-07-29 17:37:04,641 - src.api.services.price_alert_service - DEBUG - 사용자(250)와 종목(GOOG)으로 가격 알림 조회 시도.
2025-07-29 17:37:04,644 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=250, symbol=GOOG
2025-07-29 17:37:04,644 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=250, symbol=GOOG, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:37:04,654 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=249, user_id=250, symbol=GOOG
2025-07-29 17:37:04,656 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:37:04,658 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:37:04,670 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3920996163, username=testuser_3920996163
2025-07-29 17:37:04,677 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=206, telegram_id=3920996163
2025-07-29 17:37:04,679 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:04,682 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:37:04,684 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:37:04,684 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 3920996163
2025-07-29 17:37:04,687 - src.api.services.user_service - DEBUG - User not found for telegram_id: 3920996163
2025-07-29 17:37:04,687 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=3920996163, username=telegram_user_3920996163
2025-07-29 17:37:04,694 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=251, telegram_id=3920996163
2025-07-29 17:37:04,695 - src.api.services.price_alert_service - DEBUG - 사용자(251)와 종목(MSFT)으로 가격 알림 조회 시도.
2025-07-29 17:37:04,698 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=251, symbol=MSFT
2025-07-29 17:37:04,698 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=251, symbol=MSFT, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:37:04,705 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=250, user_id=251, symbol=MSFT
2025-07-29 17:37:04,706 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:37:04,709 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:37:04,724 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=6171980331, username=testuser_6171980331
2025-07-29 17:37:04,731 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=207, telegram_id=6171980331
2025-07-29 17:37:04,735 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:04,738 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:37:04,739 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:37:04,740 - src.api.routers.bot_router - DEBUG - Before toggle: existing_alert.notify_on_disclosure = True
2025-07-29 17:37:04,740 - src.api.routers.bot_router - DEBUG - Calculated new_status: False
2025-07-29 17:37:04,741 - src.api.routers.bot_router - DEBUG - After update_alert call: updated_alert_orm.notify_on_disclosure = False
2025-07-29 17:37:04,742 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:37:04,745 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:37:04,758 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8560986212, username=testuser_8560986212
2025-07-29 17:37:04,765 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=208, telegram_id=8560986212
2025-07-29 17:37:04,769 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:04,772 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:37:04,773 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:37:04,773 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 8560986212
2025-07-29 17:37:04,775 - src.api.services.user_service - DEBUG - User not found for telegram_id: 8560986212
2025-07-29 17:37:04,776 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=8560986212, username=telegram_user_8560986212
2025-07-29 17:37:04,784 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=252, telegram_id=8560986212
2025-07-29 17:37:04,785 - src.api.services.price_alert_service - DEBUG - 사용자(252)와 종목(NFLX)으로 가격 알림 조회 시도.
2025-07-29 17:37:04,787 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=252, symbol=NFLX
2025-07-29 17:37:04,788 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=252, symbol=NFLX, target_price=None, condition=None, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:37:04,795 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=251, user_id=252, symbol=NFLX
2025-07-29 17:37:04,798 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:37:04,801 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/disclosure-toggle "HTTP/1.1 200 OK"
2025-07-29 17:37:04,815 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1672517562, username=testuser_1672517562
2025-07-29 17:37:04,821 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=209, telegram_id=1672517562
2025-07-29 17:37:04,823 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:04,827 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:37:04,829 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:37:04,830 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 1672517562
2025-07-29 17:37:04,833 - src.api.services.user_service - DEBUG - User not found for telegram_id: 1672517562
2025-07-29 17:37:04,833 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1672517562, username=testuser_1672517562
2025-07-29 17:37:04,842 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=253, telegram_id=1672517562
2025-07-29 17:37:04,843 - src.api.services.price_alert_service - DEBUG - 사용자(253)와 종목(NVDA)으로 가격 알림 조회 시도.
2025-07-29 17:37:04,844 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=253, symbol=NVDA
2025-07-29 17:37:04,845 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=253, symbol=NVDA, target_price=1000.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:37:04,852 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=252, user_id=253, symbol=NVDA
2025-07-29 17:37:04,854 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:37:04,857 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:37:04,870 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1917366552, username=testuser_1917366552
2025-07-29 17:37:04,878 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=210, telegram_id=1917366552
2025-07-29 17:37:04,882 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:04,886 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:37:04,887 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:37:04,888 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 1917366552
2025-07-29 17:37:04,890 - src.api.services.user_service - DEBUG - User not found for telegram_id: 1917366552
2025-07-29 17:37:04,890 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1917366552, username=telegram_user_1917366552
2025-07-29 17:37:04,896 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=254, telegram_id=1917366552
2025-07-29 17:37:04,896 - src.api.services.price_alert_service - DEBUG - 사용자(254)와 종목(GOOGL)으로 가격 알림 조회 시도.
2025-07-29 17:37:04,898 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=254, symbol=GOOGL
2025-07-29 17:37:04,898 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=254, symbol=GOOGL, target_price=110.0, condition=below, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=weekly
2025-07-29 17:37:04,905 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=253, user_id=254, symbol=GOOGL
2025-07-29 17:37:04,907 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:37:04,909 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:37:04,921 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2726783528, username=testuser_2726783528
2025-07-29 17:37:04,927 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=211, telegram_id=2726783528
2025-07-29 17:37:04,932 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:04,936 - src.common.db_connector - DEBUG - DB 세션 시작.
2025-07-29 17:37:04,940 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:37:04,942 - src.api.services.user_service - DEBUG - Attempting to retrieve user by telegram_id: 2726783528
2025-07-29 17:37:04,945 - src.api.services.user_service - DEBUG - User not found for telegram_id: 2726783528
2025-07-29 17:37:04,946 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=2726783528, username=telegram_user_2726783528
2025-07-29 17:37:04,954 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=255, telegram_id=2726783528
2025-07-29 17:37:04,954 - src.api.services.price_alert_service - DEBUG - 사용자(255)와 종목(FB)으로 가격 알림 조회 시도.
2025-07-29 17:37:04,957 - src.api.services.price_alert_service - DEBUG - 가격 알림 없음: user_id=255, symbol=FB
2025-07-29 17:37:04,958 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=255, symbol=FB, target_price=300.0, condition=above, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:37:04,966 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=254, user_id=255, symbol=FB
2025-07-29 17:37:04,972 - src.common.db_connector - DEBUG - DB 세션 종료.
2025-07-29 17:37:04,977 - httpx - INFO - HTTP Request: POST http://testserver/bot/alert/price "HTTP/1.1 200 OK"
2025-07-29 17:37:04,984 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:04,984 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:04,995 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:05,005 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:05,008 - src.common.dart_utils - ERROR - DART CORPCODE.xml 요청 실패: Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 25, in dart_get_all_stocks
    resp = await session.get(url, timeout=60)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 17:37:05,019 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:05,026 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:05,033 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:05,042 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:05,043 - src.common.dart_utils - ERROR - DART 공시 조회 API 요청 실패 (corp_code: 00123456): Network error
Traceback (most recent call last):
  File "/app/src/common/dart_utils.py", line 79, in dart_get_disclosures
    resp = await session.get(url, params=params, timeout=10)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
httpx.RequestError: Network error
2025-07-29 17:37:05,057 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:05,062 - src.common.dart_utils - ERROR - DART 공시 API가 오류를 반환했습니다. status: 001, message: API 호출 오류, corp_code: 00123456
2025-07-29 17:37:05,403 - src.api.services.user_service - DEBUG - Attempting to create user from telegram: telegram_id=1401853329, username=testuser_1401853329
2025-07-29 17:37:05,411 - src.api.services.user_service - DEBUG - User created from telegram successfully: user_id=212, telegram_id=1401853329
2025-07-29 17:37:05,662 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:05,913 - httpx - INFO - HTTP Request: POST http://testserver/users/register "HTTP/1.1 200 OK"
2025-07-29 17:37:06,155 - httpx - INFO - HTTP Request: POST http://testserver/users/login "HTTP/1.1 200 OK"
2025-07-29 17:37:06,159 - src.api.routers.watchlist - DEBUG - 관심 종목 추가 시도: user_id=214, symbol=005930
2025-07-29 17:37:06,166 - src.api.routers.watchlist - INFO - 관심 종목 추가 성공: user_id=214, symbol=005930
2025-07-29 17:37:06,167 - httpx - INFO - HTTP Request: POST http://testserver/watchlist/add "HTTP/1.1 200 OK"
2025-07-29 17:37:06,170 - src.api.services.user_service - DEBUG - Attempting to retrieve user by id: 214
2025-07-29 17:37:06,172 - src.api.services.user_service - DEBUG - User found by id: user_id=214
2025-07-29 17:37:06,173 - src.api.services.price_alert_service - DEBUG - PriceAlertService 초기화.
2025-07-29 17:37:06,173 - src.api.services.price_alert_service - DEBUG - 가격 알림 생성 시도: user_id=214, symbol=005930, target_price=90000.0, condition=gte, change_percent=None, change_type=None, notify_on_disclosure=True, repeat_interval=None
2025-07-29 17:37:06,179 - src.api.services.price_alert_service - INFO - 가격 알림 생성 성공: alert_id=11, user_id=214, symbol=005930
2025-07-29 17:37:06,180 - httpx - INFO - HTTP Request: POST http://testserver/alerts/ "HTTP/1.1 200 OK"
2025-07-29 17:37:06,182 - httpx - INFO - HTTP Request: POST http://testserver/predict "HTTP/1.1 307 Temporary Redirect"
2025-07-29 17:37:06,184 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:37:06,185 - src.api.services.predict_service - DEBUG - get_recent_prices 호출: symbol=005930, days=40
2025-07-29 17:37:06,186 - src.api.services.predict_service - DEBUG - get_recent_prices 결과: 0개 데이터.
2025-07-29 17:37:06,186 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(0일)
2025-07-29 17:37:06,191 - httpx - INFO - HTTP Request: POST http://testserver/predict/ "HTTP/1.1 200 OK"
2025-07-29 17:37:06,194 - src.api.routers.simulated_trade - DEBUG - simulate_trade 호출: user_id=214, symbol=005930, trade_type=buy
2025-07-29 17:37:06,194 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:37:06,196 - src.api.services.stock_service - WARNING - 현재가 없음: 005930.
2025-07-29 17:37:06,196 - src.api.routers.simulated_trade - DEBUG - 종목 005930의 현재가: None
2025-07-29 17:37:06,201 - src.api.routers.simulated_trade - INFO - 모의매매 기록 완료: user_id=214, symbol=005930, trade_type=buy
2025-07-29 17:37:06,202 - httpx - INFO - HTTP Request: POST http://testserver/trade/simulate "HTTP/1.1 200 OK"
2025-07-29 17:37:06,204 - src.api.routers.simulated_trade - DEBUG - get_trade_history 호출: user_id=214
2025-07-29 17:37:06,206 - src.api.routers.simulated_trade - DEBUG - 사용자(214)의 모의매매 이력 1건 조회됨.
2025-07-29 17:37:06,206 - src.api.routers.simulated_trade - DEBUG - 모의매매 통계: {'total_trades': 1, 'total_profit_loss': 0, 'profitable_trades': 0, 'win_rate': 0.0}
2025-07-29 17:37:06,207 - httpx - INFO - HTTP Request: GET http://testserver/trade/history/214 "HTTP/1.1 200 OK"
2025-07-29 17:37:06,219 - src.api.main - INFO - [APScheduler] 가격 알림 체크 잡 실행: 2025-07-29 17:37:06.219200
2025-07-29 17:37:06,220 - src.api.main - DEBUG - 활성 알림 수: 3
2025-07-29 17:37:06,220 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:37:06,220 - src.api.main - DEBUG - 종목 정상종목 현재가: 110
2025-07-29 17:37:06,222 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='139941575634432'>, 목표 가격: 100, 조건: gte, 반복 주기: <MagicMock name='mock.repeat_interval' id='139941575143104'>
2025-07-29 17:37:06,222 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목, 현재가: 110, 목표가: 100
2025-07-29 17:37:06,226 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='139941575428800'>)
2025-07-29 17:37:06,227 - src.api.main - DEBUG - 종목 정상종목에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 17:37:06,228 - src.api.main - DEBUG - 종목 오류종목에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:37:06,228 - src.api.main - ERROR - 가격 알림 확인 중 '오류종목' 처리 오류: 현재가 조회 실패
Traceback (most recent call last):
  File "/app/src/api/main.py", line 145, in check_price_alerts_job
    price_data = stock_service.get_current_price_and_change(symbol, db)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1114, in __call__
    return self._mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1118, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 1179, in _execute_mock_call
    result = effect(*args, **kwargs)
  File "/app/src/api/tests/test_main_jobs.py", line 34, in get_current_price_side_effect
    raise ValueError("현재가 조회 실패")
ValueError: 현재가 조회 실패
2025-07-29 17:37:06,228 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 확인 시작. 알림 수: 1
2025-07-29 17:37:06,229 - src.api.main - DEBUG - 종목 정상종목2 현재가: 290
2025-07-29 17:37:06,230 - src.api.main - DEBUG - 알림 ID: <MagicMock name='mock.id' id='139941644886096'>, 목표 가격: 300, 조건: lte, 반복 주기: <MagicMock name='mock.repeat_interval' id='139941645091600'>
2025-07-29 17:37:06,230 - src.api.main - INFO - 가격 알림 트리거됨: 정상종목2, 현재가: 290, 목표가: 300
2025-07-29 17:37:06,230 - src.api.main - DEBUG - 텔레그램 메시지 전송 완료 (chat_id: <MagicMock name='mock.query().filter().first().telegram_id' id='139941575428800'>)
2025-07-29 17:37:06,231 - src.api.main - DEBUG - 종목 정상종목2에 대한 알림 처리 완료 및 DB 커밋.
2025-07-29 17:37:06,231 - src.api.main - DEBUG - 모든 가격 알림 체크 및 DB 커밋 완료.
2025-07-29 17:37:06,236 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:37:06,237 - src.api.services.predict_service - WARNING - 예측 불가: 데이터 부족(10일)
2025-07-29 17:37:06,240 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:37:06,241 - src.api.services.predict_service - ERROR - 예측 불가: 데이터 분석 실패
2025-07-29 17:37:06,244 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:37:06,244 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:37:06,259 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=buy, confidence=70, reason=단기 이동평균선이 장기 이동평균선 위에 있습니다 (골든 크로스 또는 정배열). 현재가가 단기 이동평균선 위에 있습니다. 단기 및 장기 이동평균선이 모두 상승 중입니다. RSI(100)가 70 이상으로 과매수 구간입니다. MACD가 시그널 라인 위에 있고 MACD 히스토그램이 양수입니다 (매수 신호).
2025-07-29 17:37:06,260 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: buy
2025-07-29 17:37:06,264 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:37:06,265 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:37:06,277 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, confidence=70, reason=단기 이동평균선이 장기 이동평균선 아래에 있습니다 (데드 크로스 또는 역배열). 현재가가 단기 이동평균선 아래에 있습니다. 단기 및 장기 이동평균선이 모두 하락 중입니다. RSI(0)가 30 이하로 과매도 구간입니다. MACD가 시그널 라인 아래에 있고 MACD 히스토그램이 음수입니다 (매도 신호).
2025-07-29 17:37:06,278 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 17:37:06,284 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:37:06,285 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:37:06,294 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, confidence=55, reason=단기 이동평균선과 장기 이동평균선이 수렴 중입니다 (횡보). RSI(47)는 중립 구간입니다. MACD가 시그널 라인 아래에 있고 MACD 히스토그램이 음수입니다 (매도 신호). 저점 횡보 패턴 감지 (매수 기회).
2025-07-29 17:37:06,294 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 17:37:06,407 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:37:06,408 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 25개 데이터.
2025-07-29 17:37:06,415 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=sell, confidence=70, reason=단기 이동평균선이 장기 이동평균선 아래에 있습니다 (데드 크로스 또는 역배열). 현재가가 단기 이동평균선 아래에 있습니다. 단기 및 장기 이동평균선이 모두 하락 중입니다. RSI(3)가 30 이하로 과매도 구간입니다. MACD가 시그널 라인 아래에 있고 MACD 히스토그램이 음수입니다 (매도 신호).
2025-07-29 17:37:06,415 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: sell
2025-07-29 17:37:06,426 - src.api.services.predict_service - DEBUG - predict_stock_movement 호출: symbol=005930
2025-07-29 17:37:06,426 - src.api.services.predict_service - DEBUG - calculate_analysis_items 호출: 22개 데이터.
2025-07-29 17:37:06,440 - src.api.services.predict_service - DEBUG - calculate_analysis_items 결과: prediction=buy, confidence=60, reason=단기 이동평균선이 장기 이동평균선 위에 있습니다 (골든 크로스 또는 정배열). 현재가가 단기 이동평균선 위에 있습니다. 단기 및 장기 이동평균선이 모두 상승 중입니다. RSI(100)가 70 이상으로 과매수 구간입니다. MACD가 시그널 라인 위에 있고 MACD 히스토그램이 양수입니다 (매수 신호). 급등 후 횡보 패턴 감지 (차익 실현 가능성).
2025-07-29 17:37:06,441 - src.api.services.predict_service - DEBUG - predict_stock_movement 결과: buy
2025-07-29 17:37:06,452 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:06,457 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:37:06,458 - src.api.services.stock_service - INFO - 신규 공시가 없습니다. (DB 기준: 202301010000001)
2025-07-29 17:37:06,464 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:06,469 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:37:06,476 - src.api.services.stock_service - INFO - 최초 실행. 기준 접수번호를 202301020000001로 DB에 설정합니다.
2025-07-29 17:37:06,478 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:37:06,480 - src.api.services.stock_service - INFO - 최초 실행. 기준 접수번호를 202301020000001로 DB에 설정합니다.
2025-07-29 17:37:06,491 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:06,502 - src.api.services.stock_service - INFO - DART에서 최신 공시 목록을 조회합니다.
2025-07-29 17:37:06,502 - src.api.services.stock_service - INFO - 2건의 신규 공시를 발견했습니다.
2025-07-29 17:37:06,503 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 17:37:06,504 - src.api.services.stock_service - INFO - '삼성전자' 공시를 1명에게 알렸습니다.
2025-07-29 17:37:06,504 - src.api.services.stock_service - INFO - 마지막 확인 접수번호를 202301020000002로 DB에 갱신합니다.
2025-07-29 17:37:06,514 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:06,518 - src.api.services.stock_service - CRITICAL - DART API 사용 한도를 초과했습니다: [020] 사용 한도 초과
2025-07-29 17:37:06,527 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:06,533 - src.api.services.stock_service - ERROR - DART 공시 조회 중 API 오류 발생: [999] 기타 API 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 40, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
src.common.exceptions.DartApiError: [999] 기타 API 오류
2025-07-29 17:37:06,541 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:06,550 - src.api.services.stock_service - ERROR - 신규 공시 확인 및 알림 작업 중 예상치 못한 오류 발생: 예상치 못한 오류
Traceback (most recent call last):
  File "/app/src/api/services/stock_service.py", line 40, in check_and_notify_new_disclosures
    latest_disclosures = await dart_get_disclosures(corp_code=None, max_count=15)
  File "/usr/local/lib/python3.10/unittest/mock.py", line 2234, in _execute_mock_call
    raise effect
Exception: 예상치 못한 오류
2025-07-29 17:37:06,557 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:06,568 - src.api.services.stock_service - DEBUG - update_daily_prices 호출.
2025-07-29 17:37:06,569 - src.api.services.stock_service - DEBUG - DB에서 2개 종목 가져옴.
2025-07-29 17:37:06,570 - src.api.services.stock_service - DEBUG - 종목 005930 (삼성전자) 일별시세 갱신 시작.
2025-07-29 17:37:06,573 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 005930 - 2025-07-29
2025-07-29 17:37:06,574 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 005930 - 2025-07-28
2025-07-29 17:37:06,575 - src.api.services.stock_service - DEBUG - 종목 000660 (SK하이닉스) 일별시세 갱신 시작.
2025-07-29 17:37:06,576 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 000660 - 2025-07-29
2025-07-29 17:37:06,577 - src.api.services.stock_service - DEBUG - 새 일별시세 추가: 000660 - 2025-07-28
2025-07-29 17:37:06,583 - src.api.services.stock_service - INFO - 일별시세 갱신 완료: 4개 데이터 처리. 오류: 0개 종목
2025-07-29 17:37:06,594 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:06,602 - src.api.services.stock_service - DEBUG - update_daily_prices 호출.
2025-07-29 17:37:06,604 - src.api.services.stock_service - DEBUG - DB에서 1개 종목 가져옴.
2025-07-29 17:37:06,604 - src.api.services.stock_service - DEBUG - 종목 005930 (삼성전자) 일별시세 갱신 시작.
2025-07-29 17:37:06,604 - src.api.services.stock_service - WARNING - 종목 005930에 대한 일별시세 데이터가 없습니다.
2025-07-29 17:37:06,605 - src.api.services.stock_service - INFO - 일별시세 갱신 완료: 0개 데이터 처리. 오류: 1개 종목
2025-07-29 17:37:06,619 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:06,625 - src.api.services.stock_service - DEBUG - update_daily_prices 호출.
2025-07-29 17:37:06,627 - src.api.services.stock_service - DEBUG - DB에서 1개 종목 가져옴.
2025-07-29 17:37:06,628 - src.api.services.stock_service - DEBUG - 종목 005930 (삼성전자) 일별시세 갱신 시작.
2025-07-29 17:37:06,628 - src.api.services.stock_service - ERROR - 일별시세 갱신 중 '005930' 처리에서 오류 발생: API Error
2025-07-29 17:37:06,629 - src.api.services.stock_service - INFO - 일별시세 갱신 완료: 0개 데이터 처리. 오류: 1개 종목
2025-07-29 17:37:06,640 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:06,647 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:37:06,650 - src.api.services.stock_service - DEBUG - 현재가 발견: 005930 - 71500.0
2025-07-29 17:37:06,650 - src.api.services.stock_service - DEBUG - 전일 종가 발견: 005930 - 70500.0
2025-07-29 17:37:06,660 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:06,662 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=NONEXIST
2025-07-29 17:37:06,664 - src.api.services.stock_service - WARNING - 현재가 없음: NONEXIST.
2025-07-29 17:37:06,672 - asyncio - DEBUG - Using selector: EpollSelector
2025-07-29 17:37:06,677 - src.api.services.stock_service - DEBUG - get_current_price_and_change 호출: symbol=005930
2025-07-29 17:37:06,680 - src.api.services.stock_service - DEBUG - 현재가 발견: 005930 - 71500.0
2025-07-29 17:37:06,681 - src.api.services.stock_service - WARNING - 전일 종가 없음: 005930. 등락률 계산 불가.
