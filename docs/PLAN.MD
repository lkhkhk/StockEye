# StockEye ê°œë°œ ê³„íš ë° í˜„í™©

## ğŸš¨ ìµœìš°ì„  ê³¼ì œ: ì•„í‚¤í…ì²˜ ì¬ì„¤ê³„ ë° ì•ˆì •í™”

> **í˜„í™©:** E2E í…ŒìŠ¤íŠ¸ ê³¼ì •ì—ì„œ `api`ì™€ `bot` ì„œë¹„ìŠ¤ ê°„ì˜ ìˆœí™˜ ì˜ì¡´ì„±ìœ¼ë¡œ ì¸í•œ ì‹¬ê°í•œ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ë° ê¸°ëŠ¥ ë¯¸ì‘ë™ ë¬¸ì œê°€ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ Message Queue(Redis)ë¥¼ ë„ì…í•˜ê³ , ë¹„ë™ê¸° ì‘ì—…ì„ ì²˜ë¦¬í•˜ëŠ” ë³„ë„ì˜ `worker` ì„œë¹„ìŠ¤ë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒìœ¼ë¡œ ì•„í‚¤í…ì²˜ë¥¼ ì¬ì„¤ê³„í•˜ê¸°ë¡œ ê²°ì •í–ˆìŠµë‹ˆë‹¤.

> **ëª©í‘œ:** ìƒˆë¡œìš´ ì•„í‚¤í…ì²˜ë¥¼ ì„±ê³µì ìœ¼ë¡œ ë„ì…í•˜ì—¬ ì„œë¹„ìŠ¤ ê°„ ê²°í•©ë„ë¥¼ ë‚®ì¶”ê³ , ì‹œìŠ¤í…œ ì „ì²´ì˜ ì•ˆì •ì„±ê³¼ í™•ì¥ì„±ì„ í™•ë³´í•©ë‹ˆë‹¤. ì´ ê³¼ì •ì—ì„œ ê¸°ì¡´ì˜ í•µì‹¬ ê¸°ëŠ¥ ë¯¸ì‘ë™ ë²„ê·¸ë“¤ì„ ëª¨ë‘ í•´ê²°í•˜ê³ , ì•ˆì •ì ì¸ E2E í…ŒìŠ¤íŠ¸ë¥¼ êµ¬ì¶•í•©ë‹ˆë‹¤.

---

### Phase 1: ì•„í‚¤í…ì²˜ ì¬ì„¤ê³„ ë° ì¸í”„ë¼ êµ¬ì¶•

-   [x] **[ì¸í”„ë¼] `docker-compose.yml` ìˆ˜ì •:**
    -   [x] `redis` ì„œë¹„ìŠ¤ë¥¼ ì‹ ê·œ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.
    -   [x] `worker` ì„œë¹„ìŠ¤ë¥¼ ì‹ ê·œ ì¶”ê°€í•˜ê³  `Dockerfile`ì„ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.
    -   [x] ëª¨ë“  ì„œë¹„ìŠ¤(`api`, `bot`, `db`, `redis`, `worker`)ì˜ ì´ë¦„ê³¼ `container_name`ì— `stockeye-` ì ‘ë‘ì‚¬ë¥¼ ë¶™ì—¬ ëª…ëª… ê·œì¹™ì„ í†µì¼í–ˆìŠµë‹ˆë‹¤.
    -   [x] ì„œë¹„ìŠ¤ ê°„ í†µì‹ ì— ì‚¬ìš©ë˜ëŠ” í˜¸ìŠ¤íŠ¸ ì´ë¦„ì„ ìƒˆë¡œìš´ ì„œë¹„ìŠ¤ëª…ìœ¼ë¡œ ì—…ë°ì´íŠ¸í–ˆìŠµë‹ˆë‹¤.
-   [x] **[ë¦¬íŒ©í† ë§] ì„œë¹„ìŠ¤ëª… ë³€ê²½ì— ë”°ë¥¸ í”„ë¡œì íŠ¸ ì „ì²´ ìˆ˜ì •:**
    -   [x] `docker-compose.yml`ì˜ ì„œë¹„ìŠ¤ëª… ë³€ê²½ì‚¬í•­ì„ `bot` í•¸ë“¤ëŸ¬, í…ŒìŠ¤íŠ¸ ì½”ë“œ, ì‰˜ ìŠ¤í¬ë¦½íŠ¸ ë“± í”„ë¡œì íŠ¸ ë‚´ì˜ ëª¨ë“  ê´€ë ¨ íŒŒì¼ì— ì¼ê´„ ì ìš©í–ˆìŠµë‹ˆë‹¤.
-   [x] **[ì‹ ê·œ] `worker` ì„œë¹„ìŠ¤ ê¸°ë³¸ êµ¬í˜„:**
    -   [x] `src/worker/main.py`ë¥¼ ìƒì„±í•˜ê³ , Redis Pub/Sub êµ¬ë… ë° ê¸°ë³¸ ë¡œê¹… ë¡œì§ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.
    -   [x] `docker compose up --build`ë¥¼ í†µí•´ ëª¨ë“  ì„œë¹„ìŠ¤ê°€ ì •ìƒì ìœ¼ë¡œ ê¸°ë™ë¨ì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤ã€‚

### Phase 2: Worker ì„œë¹„ìŠ¤ ê¸°ëŠ¥ ì´ì „ ë° í…ŒìŠ¤íŠ¸

-   [x] **[ì™„ë£Œ] ìŠ¤ì¼€ì¤„ëŸ¬ ê¸°ëŠ¥ ì´ì „ ë° í…ŒìŠ¤íŠ¸:**
    -   **ëª©í‘œ:** `api` ì„œë¹„ìŠ¤ì˜ APScheduler ê´€ë ¨ ì½”ë“œë¥¼ `worker` ì„œë¹„ìŠ¤ë¡œ ì´ì „í•˜ê³ , ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•˜ì—¬ ì•ˆì •ì„±ì„ ê²€ì¦í•©ë‹ˆë‹¤.
    -   **ì‘ì—… ë‹¨ê³„:**
        1.  `api/main.py`ì˜ ìŠ¤ì¼€ì¤„ëŸ¬ ê´€ë ¨ ì½”ë“œë¥¼ `worker/main.py`ë¡œ ì´ì „í•©ë‹ˆë‹¤.
        2.  `worker`ê°€ DB ë° ì„œë¹„ìŠ¤(StockService, PriceAlertService)ì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ ì˜ì¡´ì„±ì„ ì„¤ì •í•©ë‹ˆë‹¤.
        3.  `api/main.py`ì—ì„œ ìŠ¤ì¼€ì¤„ëŸ¬ ê´€ë ¨ ì½”ë“œë¥¼ ì™„ì „íˆ ì œê±°í•©ë‹ˆë‹¤.
        4.  `src/worker/tests/unit/test_scheduler.py`ë¥¼ ì‘ì„±í•˜ì—¬ ê° ìŠ¤ì¼€ì¤„ë§ ì¡(`update_stock_master_job` ë“±)ì— ëŒ€í•œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤. (ì„œë¹„ìŠ¤ ë¡œì§ Mocking)
        5.  ëª¨ë“  ì„œë¹„ìŠ¤ ì¬ê¸°ë™ í›„, `worker` ë¡œê·¸ë¥¼ í†µí•´ ìŠ¤ì¼€ì¤„ëŸ¬ê°€ ì •ìƒì ìœ¼ë¡œ ì¡ì„ ë“±ë¡í•˜ê³  ì‹¤í–‰í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

-   [x] **[ì™„ë£Œ] ì•Œë¦¼ ê¸°ëŠ¥ ë¦¬íŒ©í† ë§ ë° í…ŒìŠ¤íŠ¸:**
    -   **ëª©í‘œ:** ê¸°ì¡´ì˜ ë™ê¸°ì  ì•Œë¦¼ ë¡œì§ì„ Redis Pub/Sub ê¸°ë°˜ì˜ ë¹„ë™ê¸° ë°©ì‹ìœ¼ë¡œ ë³€ê²½í•˜ê³ , ì´ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.
    -   **ì‘ì—… ë‹¨ê³„:**
        1.  **`api` ì„œë¹„ìŠ¤:** `price_alert_service.py` ë“±ì—ì„œ `bot`ì„ ì§ì ‘ í˜¸ì¶œí•˜ë˜ ë¡œì§ì„ ì œê±°í•˜ê³ , `chat_id`ì™€ ë©”ì‹œì§€ ë‚´ìš©ì„ Redisì˜ `notifications` ì±„ë„ì— ë°œí–‰(Publish)í•˜ë„ë¡ ìˆ˜ì •í•©ë‹ˆë‹¤. (í™•ì¸ ê²°ê³¼, ì´ ë¡œì§ì€ `worker` ì„œë¹„ìŠ¤ì— ì´ë¯¸ êµ¬í˜„ë˜ì–´ ìˆì—ˆìŒ)
        2.  **`worker` ì„œë¹„ìŠ¤:** `notification_listener`ê°€ ìˆ˜ì‹ í•œ ë©”ì‹œì§€ë¥¼ ë°”íƒ•ìœ¼ë¡œ `telegram-bot` ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹¤ì œ í…”ë ˆê·¸ë¨ ë©”ì‹œì§€ë¥¼ ë°œì†¡í•˜ë„ë¡ êµ¬í˜„í•©ë‹ˆë‹¤.
        3.  [x] **`src/worker/tests/unit/test_listener.py`ë¥¼ ì‘ì„±í•˜ì—¬ `notification_listener`ì— ëŒ€í•œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤.** (Redis ë©”ì‹œì§€ ìˆ˜ì‹  ë° `send_telegram_message` í˜¸ì¶œ ê²€ì¦)
        4.  **`src/api/tests/integration/test_notification_publish.py`ë¥¼ ì‘ì„±í•˜ì—¬ `api`ê°€ Redisì— ë©”ì‹œì§€ë¥¼ ì˜¬ë°”ë¥´ê²Œ ë°œí–‰í•˜ëŠ”ì§€ í†µí•© í…ŒìŠ¤íŠ¸ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤.**
            -   **í˜„í™©:** ìˆ˜ë§ì€ í…ŒìŠ¤íŠ¸ í™˜ê²½ ë¬¸ì œ(DB ì†ìƒ, Fixture ì„¤ê³„ ì˜¤ë¥˜, ë¼ìš°í„° ì„¤ì • ì˜¤ë¥˜ ë“±)ë¥¼ í•´ê²°í•˜ê³ , ìµœì¢…ì ìœ¼ë¡œ `async/await` ëˆ„ë½ ë²„ê·¸ë¥¼ ìˆ˜ì •í•˜ì—¬ **ì•Œë¦¼ ìƒì„± ê¸°ëŠ¥ì— ëŒ€í•œ í†µí•© í…ŒìŠ¤íŠ¸(`test_create_price_alert_successfully`)ê°€ í†µê³¼ë¨ì„ í™•ì¸**í–ˆìŠµë‹ˆë‹¤.
            -   **ë‹¤ìŒ ë‹¨ê³„:** ì•Œë¦¼ 'ìƒì„±'ì´ ì•„ë‹Œ, `worker`ì˜ ìŠ¤ì¼€ì¤„ëŸ¬ì— ì˜í•´ ì•Œë¦¼ ì¡°ê±´ì´ ë§ëŠ”ë‹¤ê³  íŒë‹¨ë˜ì—ˆì„ ë•Œ Redisì— ë©”ì‹œì§€ë¥¼ **'ë°œí–‰'**í•˜ëŠ” ë¡œì§(`price_alert_service.check_price_alerts`)ì— ëŒ€í•œ ë³„ë„ì˜ í†µí•© í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤.
        5.  [x] **`price_alert_service.check_price_alerts`ì— ëŒ€í•œ í†µí•© í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.**
            -   **í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì„¤ê³„:**
                -   **Given (ì¤€ë¹„):**
                    -   í…ŒìŠ¤íŠ¸ìš© ì‚¬ìš©ì, ì£¼ì‹(ì˜ˆ: ì‚¼ì„±ì „ì), ê°€ê²© ì •ë³´(ì˜ˆ: 75,000ì›)ë¥¼ DBì— ìƒì„±í•©ë‹ˆë‹¤.
                    -   í•´ë‹¹ ì‚¬ìš©ìì™€ ì£¼ì‹ì— ëŒ€í•œ ì•Œë¦¼(ì˜ˆ: 80,000ì› ì´ìƒì¼ ë•Œ ì•Œë¦¼)ì„ ìƒì„±í•©ë‹ˆë‹¤.
                    -   Redis í´ë¼ì´ì–¸íŠ¸ë¥¼ ì¤€ë¹„í•˜ê³  `notifications` ì±„ë„ì„ êµ¬ë…í•©ë‹ˆë‹¤.
                -   **When (ì‹¤í–‰):**
                    -   ì•Œë¦¼ ì¡°ê±´ì„ ì¶©ì¡±ì‹œí‚¤ëŠ” ìƒˆë¡œìš´ ê°€ê²© ì •ë³´(ì˜ˆ: 81,000ì›)ë¥¼ DBì— ì¶”ê°€í•©ë‹ˆë‹¤.
                    -   `PriceAlertService`ì˜ `check_price_alerts` ë©”ì„œë“œë¥¼ ì§ì ‘ í˜¸ì¶œí•©ë‹ˆë‹¤.
                -   **Then (ê²€ì¦):**
                    -   Redis `notifications` ì±„ë„ì— ë©”ì‹œì§€ê°€ ë°œí–‰ë˜ì—ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
                    -   ë°œí–‰ëœ ë©”ì‹œì§€ì˜ `chat_id`ì™€ ë‚´ìš©ì´ ì˜ˆìƒê³¼ ì¼ì¹˜í•˜ëŠ”ì§€ ê²€ì¦í•©ë‹ˆë‹¤.
                    -   ì•Œë¦¼ì´ ì •ìƒì ìœ¼ë¡œ ì²˜ë¦¬ëœ í›„, DBì—ì„œ í•´ë‹¹ ì•Œë¦¼ì˜ ìƒíƒœ(`is_active` ë“±)ê°€ ì˜¬ë°”ë¥´ê²Œ ë³€ê²½ë˜ì—ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
            -   **êµ¬í˜„ ìœ„ì¹˜:** `src/api/tests/unit/test_price_alert_service.py`

### Phase 3: í•µì‹¬ ê¸°ëŠ¥ ì •ìƒí™” ë° E2E í…ŒìŠ¤íŠ¸ êµ¬ì¶•

> **ëª©í‘œ:** ìƒˆë¡œìš´ ì•„í‚¤í…ì²˜ ìœ„ì—ì„œ ê¸°ì¡´ì˜ ëª¨ë“  ë²„ê·¸ë¥¼ í•´ê²°í•˜ê³ , ê° ê¸°ëŠ¥ì— ëŒ€í•œ E2E í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•˜ì—¬ ì•ˆì •ì„±ì„ ê²€ì¦í•©ë‹ˆë‹¤.

-   [x] **[ì™„ë£Œ] ì‚¬ìš©ì ë°ì´í„° ì—°ë™ ê¸°ëŠ¥ ì •ìƒí™”:**
    -   **ëŒ€ìƒ:** `alert`, `history`, `trade`, `watchlist` ë“±
    -   **í•´ê²° ë°©ì•ˆ:** `telegram_id` ê¸°ë°˜ì˜ ì‚¬ìš©ì ì‹ë³„ ë¡œì§ì„ `api` ì„œë¹„ìŠ¤ì— ì¤‘ì•™í™”í•˜ì—¬ êµ¬í˜„í–ˆë˜ ë‚´ìš©ì„ ìƒˆë¡œìš´ ì•„í‚¤í…ì²˜ì— ë§ê²Œ ì¬ê²€ì¦í•˜ê³  ì•ˆì •í™”í•©ë‹ˆë‹¤ã€‚
    -   **ê²€ì¦:** ê° ê¸°ëŠ¥ì— ëŒ€í•œ **Bot-API-Worker ì—°ë™ E2E í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ë°˜ë“œì‹œ ì‘ì„±**í•˜ì—¬ ë²„ê·¸ ì¬ë°œì„ ë°©ì§€í•©ë‹ˆë‹¤ã€‚

-   [x] **[ì™„ë£Œ] `natural` í•¸ë“¤ëŸ¬ API ì‘ë‹µ í˜•ì‹ ë¶ˆì¼ì¹˜ ë¬¸ì œ í•´ê²°:**
    -   **í•´ê²°:** `natural.py`ì—ì„œ API ì‘ë‹µ(`{"items": [...]}`)ì„ ì˜¬ë°”ë¥´ê²Œ íŒŒì‹±í•˜ë„ë¡ ìˆ˜ì •í•©ë‹ˆë‹¤ã€‚
    -   **ê²€ì¦:** E2E í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´ ìì—°ì–´ ì²˜ë¦¬ ê¸°ëŠ¥ì˜ ì •ìƒ ë™ì‘ì„ í™•ì¸í•©ë‹ˆë‹¤ã€‚

-   [x] **[ì™„ë£Œ] ì˜ˆì¸¡ ì´ë ¥ ì €ì¥ì„ ìœ„í•œ `user_id` ì „ë‹¬:**
    -   **í˜„í™©:** `predict`, `natural` í•¸ë“¤ëŸ¬ì—ì„œ `/predict` API í˜¸ì¶œ ì‹œ `telegram_id`ë¥¼ í¬í•¨í•˜ê³ , `api`ëŠ” ì´ë¥¼ `user_id`ë¡œ ë³€í™˜í•˜ì—¬ ì´ë ¥ì„ ì €ì¥í•˜ë„ë¡ í•˜ëŠ” ê¸°ëŠ¥ êµ¬í˜„ ì¤‘.
    -   **ë°œìƒ ë¬¸ì œ:**
        *   **API ë¼ìš°í„° ê²½ë¡œ ë¶ˆì¼ì¹˜:** `bot`ì—ì„œ `/predict`ë¡œ í˜¸ì¶œí–ˆìœ¼ë‚˜ `api` ë¼ìš°í„°ê°€ `/predict/`ë¡œ ì„¤ì •ë˜ì–´ `307 Temporary Redirect` ë°œìƒ ë° POST ë³¸ë¬¸ ìœ ì‹¤. (`/predict`ë¡œ ìˆ˜ì • ì™„ë£Œ)
        *   **í…ŒìŠ¤íŠ¸ ë°ì´í„° ì‹œë”© ë¶ˆì¼ì¹˜:** `api` ì„œë¹„ìŠ¤ ì‹œì‘ ì‹œ `StockMaster` í…Œì´ë¸”ì— í…ŒìŠ¤íŠ¸ ë°ì´í„°ê°€ ì´ë¯¸ ì¡´ì¬í•œë‹¤ê³  íŒë‹¨í•˜ì—¬ ì‹œë”©ì„ ê±´ë„ˆë›°ì—ˆìœ¼ë‚˜, ì‹¤ì œ ê²€ìƒ‰ ì‹œ ë°ì´í„°ê°€ ì¡°íšŒë˜ì§€ ì•ŠëŠ” ë¬¸ì œ ë°œìƒ. (ì‹œë”© ë¡œì§ ë³´ê°• ì™„ë£Œ)
        *   **`predict_service` ë¡œì§ ì˜¤ë¥˜:** `predict_stock_movement` í•¨ìˆ˜ê°€ `calculate_analysis_items`ì˜ ê²°ê³¼ë¥¼ `None`ìœ¼ë¡œ ì˜ëª» íŒë‹¨í•˜ì—¬ "ì˜ˆì¸¡ ë¶ˆê°€"ë¥¼ ë°˜í™˜í•˜ëŠ” ë¬¸ì œ ë°œìƒ. (`predict_service` ë¡œì§ ìˆ˜ì • ì™„ë£Œ)
        *   **E2E í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ì§€ì†:** ìœ„ ëª¨ë“  ìˆ˜ì •ì—ë„ ë¶ˆêµ¬í•˜ê³  E2E í…ŒìŠ¤íŠ¸ê°€ ë™ì¼í•œ ì˜¤ë¥˜ë¡œ ê³„ì† ì‹¤íŒ¨í•˜ê³  ìˆìŒ. ì´ëŠ” DB í™˜ê²½, Docker ë„¤íŠ¸ì›Œí¬, ë˜ëŠ” `pytest`ì™€ `asyncio`ì˜ ìƒí˜¸ì‘ìš© ë“± ë” ê·¼ë³¸ì ì¸ í™˜ê²½ì  ë¬¸ì œì¼ ê°€ëŠ¥ì„±ì´ ë†’ìŒ.
    -   **í•´ê²°:** `httpx.Response.ok` ì†ì„± Deprecated ë¬¸ì œë¡œ í™•ì¸ë˜ì–´, `response.is_success` ë˜ëŠ” `response.status_code < 400`ìœ¼ë¡œ ë³€ê²½í•˜ì—¬ í•´ê²°í–ˆìŠµë‹ˆë‹¤.
    -   **ê²€ì¦:** `src/bot/tests/e2e/test_prediction_history_e2e.py` í…ŒìŠ¤íŠ¸ í†µê³¼ í™•ì¸.

## ğŸŒŸ Phase 4: í…ŒìŠ¤íŠ¸ ê³ ë„í™” ë° ì§€ì¹¨ ê°œì„  (ìœ ì§€)

-   [ ] **(ê¸°ì¡´) ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ 100% ë‹¬ì„±**
    -   [x] **Bot í•¸ë“¤ëŸ¬:** `start.py` ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‹ ê·œ ì‘ì„± ì™„ë£Œ.
    -   [x] **Bot í•¸ë“¤ëŸ¬:** `history.py` ë“± ëˆ„ë½ëœ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.
    -   [ ] **API ë¼ìš°í„°:** `admin.py` ë“± ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ê°€ ì—†ëŠ” ëª¨ë“  ë¼ìš°í„°ì— ëŒ€í•´ ì‹ ê·œ ì‘ì„±í•©ë‹ˆë‹¤.
    -   [ ] **API ì„œë¹„ìŠ¤:** `stock_service.py` ë“± ê¸°ì¡´ í…ŒìŠ¤íŠ¸ë¥¼ ë³´ê°•í•˜ê³  ìˆœìˆ˜ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¡œ ë¦¬íŒ©í† ë§í•©ë‹ˆë‹¤.
    -   [ ] **`common` ëª¨ë“ˆ:** ëª¨ë“  ê³µí†µ ëª¨ë“ˆì— ëŒ€í•œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.
-   [ ] **(ê¸°ì¡´) í†µí•© í…ŒìŠ¤íŠ¸ ë³´ê°•**
    -   [ ] `predict.py` ë“± í†µí•© í…ŒìŠ¤íŠ¸ê°€ ì—†ëŠ” API ë¼ìš°í„°ì— ëŒ€í•´ ì‹ ê·œ ì‘ì„±í•©ë‹ˆë‹¤.

## âš™ï¸ Phase 5: í™˜ê²½ ë³€ìˆ˜ ë° DB ì„¤ì • ì•ˆì •í™”

-   [x] **`TELEGRAM_BOT_TOKEN` í™˜ê²½ ë³€ìˆ˜ ë¬¸ì œ í•´ê²°:**
    -   `worker` ì„œë¹„ìŠ¤ ë¡œê·¸ì— `The "TELEGRAM_BOT_TOKEN" variable is not set.` ê²½ê³ ê°€ ë°œìƒí•˜ëŠ” ë¬¸ì œ í•´ê²°.
    -   `docker-compose.yml` ë° ê´€ë ¨ íŒŒì¼ ê²€í† í•˜ì—¬ `TELEGRAM_BOT_TOKEN`ì´ ëª¨ë“  ì„œë¹„ìŠ¤ì— ì˜¬ë°”ë¥´ê²Œ ì „ë‹¬ë˜ëŠ”ì§€ í™•ì¸.
-   [x] **`.env` íŒŒì¼ ë° í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ì „ë°˜ ê²€í† :**
    -   `docker-compose.yml`, `Dockerfile`ë“¤, `settings.env.example` ë“±ì„ ê²€í† í•˜ì—¬ í™˜ê²½ ë³€ìˆ˜ ì„¤ì •ì˜ ì¼ê´€ì„± í™•ë³´.
    -   `db` ì„œë¹„ìŠ¤ ë•Œë¬¸ì— í•„ìš”í•˜ë‹¤ê³  ì•Œë ¤ì§„ `.env` íŒŒì¼ì˜ í•„ìš”ì„±ì„ ì¬ê²€í† í•˜ê³ , ê°€ëŠ¥í•˜ë‹¤ë©´ ì˜ì¡´ì„± ì œê±° ë°©ì•ˆ ëª¨ìƒ‰.

## âš™ï¸ Phase 6: ì „ì—­ HTTP í´ë¼ì´ì–¸íŠ¸(session) ì œê±° ë¦¬íŒ©í† ë§

> **ëª©í‘œ:** í”„ë¡œì íŠ¸ ì „ë°˜ì— ê±¸ì³ ì‚¬ìš©ë˜ëŠ” `src/common/http_client.py`ì˜ ì „ì—­ `session` ê°ì²´ë¥¼ ì œê±°í•˜ì—¬, ëª¨ë“ˆ ë¡œë”© ì‹œì ì˜ ì˜ì¡´ì„±ì„ ì—†ì• ê³  í…ŒìŠ¤íŠ¸ ìš©ì´ì„±ì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤. ëª¨ë“  HTTP ìš”ì²­ì€ `get_retry_client()` íŒ©í† ë¦¬ í•¨ìˆ˜ë¥¼ í†µí•´ ìƒì„±ëœ í´ë¼ì´ì–¸íŠ¸ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ë³€ê²½í•©ë‹ˆë‹¤.

-   [x] **`src/bot/handlers/predict.py`**
-   [x] **`src/bot/handlers/register.py`**
-   [x] `src/common/dart_utils.py`
-   [x] `src/bot/handlers/history.py`
-   [x] `src/bot/handlers/alert.py`
-   [x] `src/bot/handlers/symbols.py`
-   [x] `src/bot/handlers/trade.py`
-   [x] `src/bot/handlers/watchlist.py`
-   [x] `src/bot/handlers/admin.py`
-   [x] ê´€ë ¨ í…ŒìŠ¤íŠ¸ íŒŒì¼ ëª¨ë‘ ìˆ˜ì • (`test_dart_utils.py`, `test_bot_admin.py` ë“±)

---

## ğŸ ì´ì „ì— í•´ê²°ëœ ì£¼ìš” ë¬¸ì œì 

-   [x] **[API] í†µí•© í…ŒìŠ¤íŠ¸ 404 ì˜¤ë¥˜ í•´ê²°:** `src/api/main.py`ì˜ ë¼ìš°í„° `prefix` ì„¤ì •ê³¼ `TestClient` í˜¸ì¶œ ê²½ë¡œì˜ ì¼ê´€ì„± í™•ì¸ ë° ìˆ˜ì •.
-   [x] **[Bot/API] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ Mocking/Import ì˜¤ë¥˜ í•´ê²°:**
    -   [x] `src/bot/tests/unit/test_alert_handler.py`, `test_bot_natural.py`, `test_bot_predict.py`, `test_bot_register.py` ë“±ì—ì„œ Mocking ê´€ë ¨ ì˜¤ë¥˜ (`TypeError: object AsyncMock can't be used in 'await' expression` ë“±)ê°€ ë°œìƒí•©ë‹ˆë‹¤.
    -   [x] `src/bot/tests/unit/test_bot_natural.py`ì—ì„œ `ModuleNotFoundError: No module named 'src.bot.handlers.natural.session'` ì˜¤ë¥˜ê°€ ë°œìƒí•©ë‹ˆë‹¤.
    -   [x] `src/api/tests/unit/test_auth_service.py`ì—ì„œ `ModuleNotFoundError: No module named 'src/api.services.auth_service.pwd_context'` ì˜¤ë¥˜ê°€ ë°œìƒí•©ë‹ˆë‹¤.
-   [x] **[API] ì„œë¹„ìŠ¤ ë¡œì§ ì˜¤ë¥˜ í•´ê²°:** `src/api/tests/unit/test_predict_service.py`, `test_price_alert_service.py`, `test_stock_service.py` ë“±ì—ì„œ `KeyError` ë˜ëŠ” `TypeError`ì™€ ê°™ì€ ë¡œì§ ì˜¤ë¥˜ê°€ ë°œìƒí•©ë‹ˆë‹¤.
-   [x] **[Worker] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜ í•´ê²°:**
    -   [x] `src/worker/tests/unit/test_listener.py`ì—ì„œ `TypeError: object AsyncMock can't be used in 'await' expression` ì˜¤ë¥˜ê°€ ë°œìƒí•©ë‹ˆë‹¤.
    -   [x] `src/worker/tests/unit/test_main_jobs.py`ì—ì„œ `ModuleNotFoundError: No module named 'src.api.main'` ì˜¤ë¥˜ê°€ ë°œìƒí•©ë‹ˆë‹¤.
